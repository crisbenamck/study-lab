var x0=i=>{throw TypeError(i)};var cf=(i,e,t)=>e.has(i)||x0("Cannot "+t);var ct=(i,e,t)=>(cf(i,e,"read from private field"),t?t.call(i):e.get(i)),Qn=(i,e,t)=>e.has(i)?x0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),hn=(i,e,t,n)=>(cf(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),Zn=(i,e,t)=>(cf(i,e,"access private method"),t);var b0=(i,e,t,n)=>({set _(s){hn(i,e,s,t)},get _(){return ct(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();var Xl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function i_(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var uf={exports:{}},ta={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function s_(){if(S0)return ta;S0=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,r){var l=null;if(r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:r}}return ta.Fragment=e,ta.jsx=t,ta.jsxs=t,ta}var C0;function o_(){return C0||(C0=1,uf.exports=s_()),uf.exports}var y=o_(),df={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A0;function r_(){if(A0)return Oe;A0=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function b(L){return L===null||typeof L!="object"?null:(L=v&&L[v]||L["@@iterator"],typeof L=="function"?L:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,A={};function _(L,V,W){this.props=L,this.context=V,this.refs=A,this.updater=W||C}_.prototype.isReactComponent={},_.prototype.setState=function(L,V){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,V,"setState")},_.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function w(){}w.prototype=_.prototype;function N(L,V,W){this.props=L,this.context=V,this.refs=A,this.updater=W||C}var M=N.prototype=new w;M.constructor=N,E(M,_.prototype),M.isPureReactComponent=!0;var k=Array.isArray,R={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function P(L,V,W,z,le,xe){return W=xe.ref,{$$typeof:i,type:L,key:V,ref:W!==void 0?W:null,props:xe}}function q(L,V){return P(L.type,V,void 0,void 0,void 0,L.props)}function F(L){return typeof L=="object"&&L!==null&&L.$$typeof===i}function $(L){var V={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(W){return V[W]})}var K=/\/+/g;function ne(L,V){return typeof L=="object"&&L!==null&&L.key!=null?$(""+L.key):V.toString(36)}function ae(){}function ce(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ae,ae):(L.status="pending",L.then(function(V){L.status==="pending"&&(L.status="fulfilled",L.value=V)},function(V){L.status==="pending"&&(L.status="rejected",L.reason=V)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function me(L,V,W,z,le){var xe=typeof L;(xe==="undefined"||xe==="boolean")&&(L=null);var he=!1;if(L===null)he=!0;else switch(xe){case"bigint":case"string":case"number":he=!0;break;case"object":switch(L.$$typeof){case i:case e:he=!0;break;case g:return he=L._init,me(he(L._payload),V,W,z,le)}}if(he)return le=le(L),he=z===""?"."+ne(L,0):z,k(le)?(W="",he!=null&&(W=he.replace(K,"$&/")+"/"),me(le,V,W,"",function(Te){return Te})):le!=null&&(F(le)&&(le=q(le,W+(le.key==null||L&&L.key===le.key?"":(""+le.key).replace(K,"$&/")+"/")+he)),V.push(le)),1;he=0;var Ee=z===""?".":z+":";if(k(L))for(var Ne=0;Ne<L.length;Ne++)z=L[Ne],xe=Ee+ne(z,Ne),he+=me(z,V,W,xe,le);else if(Ne=b(L),typeof Ne=="function")for(L=Ne.call(L),Ne=0;!(z=L.next()).done;)z=z.value,xe=Ee+ne(z,Ne++),he+=me(z,V,W,xe,le);else if(xe==="object"){if(typeof L.then=="function")return me(ce(L),V,W,z,le);throw V=String(L),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return he}function U(L,V,W){if(L==null)return L;var z=[],le=0;return me(L,z,"","",function(xe){return V.call(W,xe,le++)}),z}function X(L){if(L._status===-1){var V=L._result;V=V(),V.then(function(W){(L._status===0||L._status===-1)&&(L._status=1,L._result=W)},function(W){(L._status===0||L._status===-1)&&(L._status=2,L._result=W)}),L._status===-1&&(L._status=0,L._result=V)}if(L._status===1)return L._result.default;throw L._result}var de=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)};function te(){}return Oe.Children={map:U,forEach:function(L,V,W){U(L,function(){V.apply(this,arguments)},W)},count:function(L){var V=0;return U(L,function(){V++}),V},toArray:function(L){return U(L,function(V){return V})||[]},only:function(L){if(!F(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},Oe.Component=_,Oe.Fragment=t,Oe.Profiler=s,Oe.PureComponent=N,Oe.StrictMode=n,Oe.Suspense=f,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},Oe.cache=function(L){return function(){return L.apply(null,arguments)}},Oe.cloneElement=function(L,V,W){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var z=E({},L.props),le=L.key,xe=void 0;if(V!=null)for(he in V.ref!==void 0&&(xe=void 0),V.key!==void 0&&(le=""+V.key),V)!I.call(V,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&V.ref===void 0||(z[he]=V[he]);var he=arguments.length-2;if(he===1)z.children=W;else if(1<he){for(var Ee=Array(he),Ne=0;Ne<he;Ne++)Ee[Ne]=arguments[Ne+2];z.children=Ee}return P(L.type,le,void 0,void 0,xe,z)},Oe.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:r,_context:L},L},Oe.createElement=function(L,V,W){var z,le={},xe=null;if(V!=null)for(z in V.key!==void 0&&(xe=""+V.key),V)I.call(V,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(le[z]=V[z]);var he=arguments.length-2;if(he===1)le.children=W;else if(1<he){for(var Ee=Array(he),Ne=0;Ne<he;Ne++)Ee[Ne]=arguments[Ne+2];le.children=Ee}if(L&&L.defaultProps)for(z in he=L.defaultProps,he)le[z]===void 0&&(le[z]=he[z]);return P(L,xe,void 0,void 0,null,le)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(L){return{$$typeof:c,render:L}},Oe.isValidElement=F,Oe.lazy=function(L){return{$$typeof:g,_payload:{_status:-1,_result:L},_init:X}},Oe.memo=function(L,V){return{$$typeof:d,type:L,compare:V===void 0?null:V}},Oe.startTransition=function(L){var V=R.T,W={};R.T=W;try{var z=L(),le=R.S;le!==null&&le(W,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(te,de)}catch(xe){de(xe)}finally{R.T=V}},Oe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Oe.use=function(L){return R.H.use(L)},Oe.useActionState=function(L,V,W){return R.H.useActionState(L,V,W)},Oe.useCallback=function(L,V){return R.H.useCallback(L,V)},Oe.useContext=function(L){return R.H.useContext(L)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(L,V){return R.H.useDeferredValue(L,V)},Oe.useEffect=function(L,V,W){var z=R.H;if(typeof W=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return z.useEffect(L,V)},Oe.useId=function(){return R.H.useId()},Oe.useImperativeHandle=function(L,V,W){return R.H.useImperativeHandle(L,V,W)},Oe.useInsertionEffect=function(L,V){return R.H.useInsertionEffect(L,V)},Oe.useLayoutEffect=function(L,V){return R.H.useLayoutEffect(L,V)},Oe.useMemo=function(L,V){return R.H.useMemo(L,V)},Oe.useOptimistic=function(L,V){return R.H.useOptimistic(L,V)},Oe.useReducer=function(L,V,W){return R.H.useReducer(L,V,W)},Oe.useRef=function(L){return R.H.useRef(L)},Oe.useState=function(L){return R.H.useState(L)},Oe.useSyncExternalStore=function(L,V,W){return R.H.useSyncExternalStore(L,V,W)},Oe.useTransition=function(){return R.H.useTransition()},Oe.version="19.1.0",Oe}var E0;function Bh(){return E0||(E0=1,df.exports=r_()),df.exports}var O=Bh();const Ve=i_(O);var ff={exports:{}},na={},hf={exports:{}},pf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _0;function a_(){return _0||(_0=1,function(i){function e(U,X){var de=U.length;U.push(X);e:for(;0<de;){var te=de-1>>>1,L=U[te];if(0<s(L,X))U[te]=X,U[de]=L,de=te;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],de=U.pop();if(de!==X){U[0]=de;e:for(var te=0,L=U.length,V=L>>>1;te<V;){var W=2*(te+1)-1,z=U[W],le=W+1,xe=U[le];if(0>s(z,de))le<L&&0>s(xe,z)?(U[te]=xe,U[le]=de,te=le):(U[te]=z,U[W]=de,te=W);else if(le<L&&0>s(xe,de))U[te]=xe,U[le]=de,te=le;else break e}}return X}function s(U,X){var de=U.sortIndex-X.sortIndex;return de!==0?de:U.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var f=[],d=[],g=1,v=null,b=3,C=!1,E=!1,A=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var X=t(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=U)n(d),X.sortIndex=X.expirationTime,e(f,X);else break;X=t(d)}}function R(U){if(A=!1,k(U),!E)if(t(f)!==null)E=!0,I||(I=!0,ne());else{var X=t(d);X!==null&&me(R,X.startTime-U)}}var I=!1,P=-1,q=5,F=-1;function $(){return _?!0:!(i.unstable_now()-F<q)}function K(){if(_=!1,I){var U=i.unstable_now();F=U;var X=!0;try{e:{E=!1,A&&(A=!1,N(P),P=-1),C=!0;var de=b;try{t:{for(k(U),v=t(f);v!==null&&!(v.expirationTime>U&&$());){var te=v.callback;if(typeof te=="function"){v.callback=null,b=v.priorityLevel;var L=te(v.expirationTime<=U);if(U=i.unstable_now(),typeof L=="function"){v.callback=L,k(U),X=!0;break t}v===t(f)&&n(f),k(U)}else n(f);v=t(f)}if(v!==null)X=!0;else{var V=t(d);V!==null&&me(R,V.startTime-U),X=!1}}break e}finally{v=null,b=de,C=!1}X=void 0}}finally{X?ne():I=!1}}}var ne;if(typeof M=="function")ne=function(){M(K)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ce=ae.port2;ae.port1.onmessage=K,ne=function(){ce.postMessage(null)}}else ne=function(){w(K,0)};function me(U,X){P=w(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(U){switch(b){case 1:case 2:case 3:var X=3;break;default:X=b}var de=b;b=X;try{return U()}finally{b=de}},i.unstable_requestPaint=function(){_=!0},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var de=b;b=U;try{return X()}finally{b=de}},i.unstable_scheduleCallback=function(U,X,de){var te=i.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?te+de:te):de=te,U){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=de+L,U={id:g++,callback:X,priorityLevel:U,startTime:de,expirationTime:L,sortIndex:-1},de>te?(U.sortIndex=de,e(d,U),t(f)===null&&U===t(d)&&(A?(N(P),P=-1):A=!0,me(R,de-te))):(U.sortIndex=L,e(f,U),E||C||(E=!0,I||(I=!0,ne()))),U},i.unstable_shouldYield=$,i.unstable_wrapCallback=function(U){var X=b;return function(){var de=b;b=X;try{return U.apply(this,arguments)}finally{b=de}}}}(pf)),pf}var T0;function l_(){return T0||(T0=1,hf.exports=a_()),hf.exports}var mf={exports:{}},Wt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w0;function c_(){if(w0)return Wt;w0=1;var i=Bh();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(f,d,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:f,containerInfo:d,implementation:g}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Wt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Wt.createPortal=function(f,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return r(f,d,null,g)},Wt.flushSync=function(f){var d=l.T,g=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=g,n.d.f()}},Wt.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Wt.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Wt.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var g=d.as,v=c(g,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,C=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:C}):g==="script"&&n.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:C,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Wt.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=c(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Wt.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,v=c(g,d.crossOrigin);n.d.L(f,g,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Wt.preloadModule=function(f,d){if(typeof f=="string")if(d){var g=c(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Wt.requestFormReset=function(f){n.d.r(f)},Wt.unstable_batchedUpdates=function(f,d){return f(d)},Wt.useFormState=function(f,d,g){return l.H.useFormState(f,d,g)},Wt.useFormStatus=function(){return l.H.useHostTransitionStatus()},Wt.version="19.1.0",Wt}var M0;function u_(){if(M0)return mf.exports;M0=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),mf.exports=c_(),mf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N0;function d_(){if(N0)return na;N0=1;var i=l_(),e=Bh(),t=u_();function n(o){var a="https://react.dev/errors/"+o;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function r(o){var a=o,u=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(u=a.return),o=a.return;while(o)}return a.tag===3?u:null}function l(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function c(o){if(r(o)!==o)throw Error(n(188))}function f(o){var a=o.alternate;if(!a){if(a=r(o),a===null)throw Error(n(188));return a!==o?null:o}for(var u=o,m=a;;){var x=u.return;if(x===null)break;var S=x.alternate;if(S===null){if(m=x.return,m!==null){u=m;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===u)return c(x),o;if(S===m)return c(x),a;S=S.sibling}throw Error(n(188))}if(u.return!==m.return)u=x,m=S;else{for(var T=!1,D=x.child;D;){if(D===u){T=!0,u=x,m=S;break}if(D===m){T=!0,m=x,u=S;break}D=D.sibling}if(!T){for(D=S.child;D;){if(D===u){T=!0,u=S,m=x;break}if(D===m){T=!0,m=S,u=x;break}D=D.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==m)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?o:a}function d(o){var a=o.tag;if(a===5||a===26||a===27||a===6)return o;for(o=o.child;o!==null;){if(a=d(o),a!==null)return a;o=o.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),M=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ne(o){return o===null||typeof o!="object"?null:(o=K&&o[K]||o["@@iterator"],typeof o=="function"?o:null)}var ae=Symbol.for("react.client.reference");function ce(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ae?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case E:return"Fragment";case _:return"Profiler";case A:return"StrictMode";case R:return"Suspense";case I:return"SuspenseList";case F:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case C:return"Portal";case M:return(o.displayName||"Context")+".Provider";case N:return(o._context.displayName||"Context")+".Consumer";case k:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case P:return a=o.displayName||null,a!==null?a:ce(o.type)||"Memo";case q:a=o._payload,o=o._init;try{return ce(o(a))}catch{}}return null}var me=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},te=[],L=-1;function V(o){return{current:o}}function W(o){0>L||(o.current=te[L],te[L]=null,L--)}function z(o,a){L++,te[L]=o.current,o.current=a}var le=V(null),xe=V(null),he=V(null),Ee=V(null);function Ne(o,a){switch(z(he,a),z(xe,o),z(le,null),a.nodeType){case 9:case 11:o=(o=a.documentElement)&&(o=o.namespaceURI)?Yy(o):0;break;default:if(o=a.tagName,a=a.namespaceURI)a=Yy(a),o=Wy(a,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}W(le),z(le,o)}function Te(){W(le),W(xe),W(he)}function ke(o){o.memoizedState!==null&&z(Ee,o);var a=le.current,u=Wy(a,o.type);a!==u&&(z(xe,o),z(le,u))}function $e(o){xe.current===o&&(W(le),W(xe)),Ee.current===o&&(W(Ee),Xr._currentValue=de)}var ht=Object.prototype.hasOwnProperty,xt=i.unstable_scheduleCallback,Dt=i.unstable_cancelCallback,sr=i.unstable_shouldYield,ps=i.unstable_requestPaint,an=i.unstable_now,Np=i.unstable_getCurrentPriorityLevel,or=i.unstable_ImmediatePriority,G=i.unstable_UserBlockingPriority,Q=i.unstable_NormalPriority,se=i.unstable_LowPriority,ge=i.unstable_IdlePriority,fe=i.log,ue=i.unstable_setDisableYieldValue,Se=null,Fe=null;function je(o){if(typeof fe=="function"&&ue(o),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(Se,o)}catch{}}var st=Math.clz32?Math.clz32:Xc,Ks=Math.log,$n=Math.LN2;function Xc(o){return o>>>=0,o===0?32:31-(Ks(o)/$n|0)|0}var Pi=256,Fi=4194304;function ci(o){var a=o&42;if(a!==0)return a;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function ms(o,a,u){var m=o.pendingLanes;if(m===0)return 0;var x=0,S=o.suspendedLanes,T=o.pingedLanes;o=o.warmLanes;var D=m&134217727;return D!==0?(m=D&~S,m!==0?x=ci(m):(T&=D,T!==0?x=ci(T):u||(u=D&~o,u!==0&&(x=ci(u))))):(D=m&~S,D!==0?x=ci(D):T!==0?x=ci(T):u||(u=m&~o,u!==0&&(x=ci(u)))),x===0?0:a!==0&&a!==x&&(a&S)===0&&(S=x&-x,u=a&-a,S>=u||S===32&&(u&4194048)!==0)?a:x}function gs(o,a){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&a)===0}function Ba(o,a){switch(o){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rp(){var o=Pi;return Pi<<=1,(Pi&4194048)===0&&(Pi=256),o}function Ip(){var o=Fi;return Fi<<=1,(Fi&62914560)===0&&(Fi=4194304),o}function Jc(o){for(var a=[],u=0;31>u;u++)a.push(o);return a}function rr(o,a){o.pendingLanes|=a,a!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function zC(o,a,u,m,x,S){var T=o.pendingLanes;o.pendingLanes=u,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=u,o.entangledLanes&=u,o.errorRecoveryDisabledLanes&=u,o.shellSuspendCounter=0;var D=o.entanglements,B=o.expirationTimes,J=o.hiddenUpdates;for(u=T&~u;0<u;){var ie=31-st(u),re=1<<ie;D[ie]=0,B[ie]=-1;var Z=J[ie];if(Z!==null)for(J[ie]=null,ie=0;ie<Z.length;ie++){var ee=Z[ie];ee!==null&&(ee.lane&=-536870913)}u&=~re}m!==0&&Dp(o,m,0),S!==0&&x===0&&o.tag!==0&&(o.suspendedLanes|=S&~(T&~a))}function Dp(o,a,u){o.pendingLanes|=a,o.suspendedLanes&=~a;var m=31-st(a);o.entangledLanes|=a,o.entanglements[m]=o.entanglements[m]|1073741824|u&4194090}function kp(o,a){var u=o.entangledLanes|=a;for(o=o.entanglements;u;){var m=31-st(u),x=1<<m;x&a|o[m]&a&&(o[m]|=a),u&=~x}}function Qc(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Zc(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Lp(){var o=X.p;return o!==0?o:(o=window.event,o===void 0?32:h0(o.type))}function $C(o,a){var u=X.p;try{return X.p=o,a()}finally{X.p=u}}var Oi=Math.random().toString(36).slice(2),$t="__reactFiber$"+Oi,ln="__reactProps$"+Oi,Xs="__reactContainer$"+Oi,eu="__reactEvents$"+Oi,YC="__reactListeners$"+Oi,WC="__reactHandles$"+Oi,Pp="__reactResources$"+Oi,ar="__reactMarker$"+Oi;function tu(o){delete o[$t],delete o[ln],delete o[eu],delete o[YC],delete o[WC]}function Js(o){var a=o[$t];if(a)return a;for(var u=o.parentNode;u;){if(a=u[Xs]||u[$t]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(o=Qy(o);o!==null;){if(u=o[$t])return u;o=Qy(o)}return a}o=u,u=o.parentNode}return null}function Qs(o){if(o=o[$t]||o[Xs]){var a=o.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return o}return null}function lr(o){var a=o.tag;if(a===5||a===26||a===27||a===6)return o.stateNode;throw Error(n(33))}function Zs(o){var a=o[Pp];return a||(a=o[Pp]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ft(o){o[ar]=!0}var Fp=new Set,Op={};function ys(o,a){eo(o,a),eo(o+"Capture",a)}function eo(o,a){for(Op[o]=a,o=0;o<a.length;o++)Fp.add(a[o])}var KC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Up={},Bp={};function XC(o){return ht.call(Bp,o)?!0:ht.call(Up,o)?!1:KC.test(o)?Bp[o]=!0:(Up[o]=!0,!1)}function Va(o,a,u){if(XC(a))if(u===null)o.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":o.removeAttribute(a);return;case"boolean":var m=a.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){o.removeAttribute(a);return}}o.setAttribute(a,""+u)}}function Ga(o,a,u){if(u===null)o.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(a);return}o.setAttribute(a,""+u)}}function ui(o,a,u,m){if(m===null)o.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttributeNS(a,u,""+m)}}var nu,Vp;function to(o){if(nu===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);nu=a&&a[1]||"",Vp=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nu+o+Vp}var iu=!1;function su(o,a){if(!o||iu)return"";iu=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(a){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(ee){var Z=ee}Reflect.construct(o,[],re)}else{try{re.call()}catch(ee){Z=ee}o.call(re.prototype)}}else{try{throw Error()}catch(ee){Z=ee}(re=o())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(ee){if(ee&&Z&&typeof ee.stack=="string")return[ee.stack,Z.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=m.DetermineComponentFrameRoot(),T=S[0],D=S[1];if(T&&D){var B=T.split(`
`),J=D.split(`
`);for(x=m=0;m<B.length&&!B[m].includes("DetermineComponentFrameRoot");)m++;for(;x<J.length&&!J[x].includes("DetermineComponentFrameRoot");)x++;if(m===B.length||x===J.length)for(m=B.length-1,x=J.length-1;1<=m&&0<=x&&B[m]!==J[x];)x--;for(;1<=m&&0<=x;m--,x--)if(B[m]!==J[x]){if(m!==1||x!==1)do if(m--,x--,0>x||B[m]!==J[x]){var ie=`
`+B[m].replace(" at new "," at ");return o.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",o.displayName)),ie}while(1<=m&&0<=x);break}}}finally{iu=!1,Error.prepareStackTrace=u}return(u=o?o.displayName||o.name:"")?to(u):""}function JC(o){switch(o.tag){case 26:case 27:case 5:return to(o.type);case 16:return to("Lazy");case 13:return to("Suspense");case 19:return to("SuspenseList");case 0:case 15:return su(o.type,!1);case 11:return su(o.type.render,!1);case 1:return su(o.type,!0);case 31:return to("Activity");default:return""}}function Gp(o){try{var a="";do a+=JC(o),o=o.return;while(o);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Tn(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function qp(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function QC(o){var a=qp(o)?"checked":"value",u=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),m=""+o[a];if(!o.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var x=u.get,S=u.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return x.call(this)},set:function(T){m=""+T,S.call(this,T)}}),Object.defineProperty(o,a,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(T){m=""+T},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function qa(o){o._valueTracker||(o._valueTracker=QC(o))}function Hp(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var u=a.getValue(),m="";return o&&(m=qp(o)?o.checked?"true":"false":o.value),o=m,o!==u?(a.setValue(o),!0):!1}function Ha(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var ZC=/[\n"\\]/g;function wn(o){return o.replace(ZC,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ou(o,a,u,m,x,S,T,D){o.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?o.type=T:o.removeAttribute("type"),a!=null?T==="number"?(a===0&&o.value===""||o.value!=a)&&(o.value=""+Tn(a)):o.value!==""+Tn(a)&&(o.value=""+Tn(a)):T!=="submit"&&T!=="reset"||o.removeAttribute("value"),a!=null?ru(o,T,Tn(a)):u!=null?ru(o,T,Tn(u)):m!=null&&o.removeAttribute("value"),x==null&&S!=null&&(o.defaultChecked=!!S),x!=null&&(o.checked=x&&typeof x!="function"&&typeof x!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?o.name=""+Tn(D):o.removeAttribute("name")}function jp(o,a,u,m,x,S,T,D){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(o.type=S),a!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||a!=null))return;u=u!=null?""+Tn(u):"",a=a!=null?""+Tn(a):u,D||a===o.value||(o.value=a),o.defaultValue=a}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,o.checked=D?o.checked:!!m,o.defaultChecked=!!m,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.name=T)}function ru(o,a,u){a==="number"&&Ha(o.ownerDocument)===o||o.defaultValue===""+u||(o.defaultValue=""+u)}function no(o,a,u,m){if(o=o.options,a){a={};for(var x=0;x<u.length;x++)a["$"+u[x]]=!0;for(u=0;u<o.length;u++)x=a.hasOwnProperty("$"+o[u].value),o[u].selected!==x&&(o[u].selected=x),x&&m&&(o[u].defaultSelected=!0)}else{for(u=""+Tn(u),a=null,x=0;x<o.length;x++){if(o[x].value===u){o[x].selected=!0,m&&(o[x].defaultSelected=!0);return}a!==null||o[x].disabled||(a=o[x])}a!==null&&(a.selected=!0)}}function zp(o,a,u){if(a!=null&&(a=""+Tn(a),a!==o.value&&(o.value=a),u==null)){o.defaultValue!==a&&(o.defaultValue=a);return}o.defaultValue=u!=null?""+Tn(u):""}function $p(o,a,u,m){if(a==null){if(m!=null){if(u!=null)throw Error(n(92));if(me(m)){if(1<m.length)throw Error(n(93));m=m[0]}u=m}u==null&&(u=""),a=u}u=Tn(a),o.defaultValue=u,m=o.textContent,m===u&&m!==""&&m!==null&&(o.value=m)}function io(o,a){if(a){var u=o.firstChild;if(u&&u===o.lastChild&&u.nodeType===3){u.nodeValue=a;return}}o.textContent=a}var eA=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yp(o,a,u){var m=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?m?o.setProperty(a,""):a==="float"?o.cssFloat="":o[a]="":m?o.setProperty(a,u):typeof u!="number"||u===0||eA.has(a)?a==="float"?o.cssFloat=u:o[a]=(""+u).trim():o[a]=u+"px"}function Wp(o,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(o=o.style,u!=null){for(var m in u)!u.hasOwnProperty(m)||a!=null&&a.hasOwnProperty(m)||(m.indexOf("--")===0?o.setProperty(m,""):m==="float"?o.cssFloat="":o[m]="");for(var x in a)m=a[x],a.hasOwnProperty(x)&&u[x]!==m&&Yp(o,x,m)}else for(var S in a)a.hasOwnProperty(S)&&Yp(o,S,a[S])}function au(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ja(o){return nA.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var lu=null;function cu(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var so=null,oo=null;function Kp(o){var a=Qs(o);if(a&&(o=a.stateNode)){var u=o[ln]||null;e:switch(o=a.stateNode,a.type){case"input":if(ou(o,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=o;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+wn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var m=u[a];if(m!==o&&m.form===o.form){var x=m[ln]||null;if(!x)throw Error(n(90));ou(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(a=0;a<u.length;a++)m=u[a],m.form===o.form&&Hp(m)}break e;case"textarea":zp(o,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&no(o,!!u.multiple,a,!1)}}}var uu=!1;function Xp(o,a,u){if(uu)return o(a,u);uu=!0;try{var m=o(a);return m}finally{if(uu=!1,(so!==null||oo!==null)&&(Nl(),so&&(a=so,o=oo,oo=so=null,Kp(a),o)))for(a=0;a<o.length;a++)Kp(o[a])}}function cr(o,a){var u=o.stateNode;if(u===null)return null;var m=u[ln]||null;if(m===null)return null;u=m[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(o=o.type,m=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!m;break e;default:o=!1}if(o)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),du=!1;if(di)try{var ur={};Object.defineProperty(ur,"passive",{get:function(){du=!0}}),window.addEventListener("test",ur,ur),window.removeEventListener("test",ur,ur)}catch{du=!1}var Ui=null,fu=null,za=null;function Jp(){if(za)return za;var o,a=fu,u=a.length,m,x="value"in Ui?Ui.value:Ui.textContent,S=x.length;for(o=0;o<u&&a[o]===x[o];o++);var T=u-o;for(m=1;m<=T&&a[u-m]===x[S-m];m++);return za=x.slice(o,1<m?1-m:void 0)}function $a(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function Ya(){return!0}function Qp(){return!1}function cn(o){function a(u,m,x,S,T){this._reactName=u,this._targetInst=x,this.type=m,this.nativeEvent=S,this.target=T,this.currentTarget=null;for(var D in o)o.hasOwnProperty(D)&&(u=o[D],this[D]=u?u(S):S[D]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Ya:Qp,this.isPropagationStopped=Qp,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ya)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ya)},persist:function(){},isPersistent:Ya}),a}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wa=cn(vs),dr=g({},vs,{view:0,detail:0}),iA=cn(dr),hu,pu,fr,Ka=g({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gu,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==fr&&(fr&&o.type==="mousemove"?(hu=o.screenX-fr.screenX,pu=o.screenY-fr.screenY):pu=hu=0,fr=o),hu)},movementY:function(o){return"movementY"in o?o.movementY:pu}}),Zp=cn(Ka),sA=g({},Ka,{dataTransfer:0}),oA=cn(sA),rA=g({},dr,{relatedTarget:0}),mu=cn(rA),aA=g({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),lA=cn(aA),cA=g({},vs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),uA=cn(cA),dA=g({},vs,{data:0}),em=cn(dA),fA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mA(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=pA[o])?!!a[o]:!1}function gu(){return mA}var gA=g({},dr,{key:function(o){if(o.key){var a=fA[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=$a(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?hA[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gu,charCode:function(o){return o.type==="keypress"?$a(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?$a(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),yA=cn(gA),vA=g({},Ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tm=cn(vA),xA=g({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gu}),bA=cn(xA),SA=g({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),CA=cn(SA),AA=g({},Ka,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),EA=cn(AA),_A=g({},vs,{newState:0,oldState:0}),TA=cn(_A),wA=[9,13,27,32],yu=di&&"CompositionEvent"in window,hr=null;di&&"documentMode"in document&&(hr=document.documentMode);var MA=di&&"TextEvent"in window&&!hr,nm=di&&(!yu||hr&&8<hr&&11>=hr),im=" ",sm=!1;function om(o,a){switch(o){case"keyup":return wA.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rm(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ro=!1;function NA(o,a){switch(o){case"compositionend":return rm(a);case"keypress":return a.which!==32?null:(sm=!0,im);case"textInput":return o=a.data,o===im&&sm?null:o;default:return null}}function RA(o,a){if(ro)return o==="compositionend"||!yu&&om(o,a)?(o=Jp(),za=fu=Ui=null,ro=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return nm&&a.locale!=="ko"?null:a.data;default:return null}}var IA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function am(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!IA[o.type]:a==="textarea"}function lm(o,a,u,m){so?oo?oo.push(m):oo=[m]:so=m,a=Pl(a,"onChange"),0<a.length&&(u=new Wa("onChange","change",null,u,m),o.push({event:u,listeners:a}))}var pr=null,mr=null;function DA(o){qy(o,0)}function Xa(o){var a=lr(o);if(Hp(a))return o}function cm(o,a){if(o==="change")return a}var um=!1;if(di){var vu;if(di){var xu="oninput"in document;if(!xu){var dm=document.createElement("div");dm.setAttribute("oninput","return;"),xu=typeof dm.oninput=="function"}vu=xu}else vu=!1;um=vu&&(!document.documentMode||9<document.documentMode)}function fm(){pr&&(pr.detachEvent("onpropertychange",hm),mr=pr=null)}function hm(o){if(o.propertyName==="value"&&Xa(mr)){var a=[];lm(a,mr,o,cu(o)),Xp(DA,a)}}function kA(o,a,u){o==="focusin"?(fm(),pr=a,mr=u,pr.attachEvent("onpropertychange",hm)):o==="focusout"&&fm()}function LA(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Xa(mr)}function PA(o,a){if(o==="click")return Xa(a)}function FA(o,a){if(o==="input"||o==="change")return Xa(a)}function OA(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var yn=typeof Object.is=="function"?Object.is:OA;function gr(o,a){if(yn(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var u=Object.keys(o),m=Object.keys(a);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var x=u[m];if(!ht.call(a,x)||!yn(o[x],a[x]))return!1}return!0}function pm(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function mm(o,a){var u=pm(o);o=0;for(var m;u;){if(u.nodeType===3){if(m=o+u.textContent.length,o<=a&&m>=a)return{node:u,offset:a-o};o=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=pm(u)}}function gm(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?gm(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function ym(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var a=Ha(o.document);a instanceof o.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)o=a.contentWindow;else break;a=Ha(o.document)}return a}function bu(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}var UA=di&&"documentMode"in document&&11>=document.documentMode,ao=null,Su=null,yr=null,Cu=!1;function vm(o,a,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Cu||ao==null||ao!==Ha(m)||(m=ao,"selectionStart"in m&&bu(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),yr&&gr(yr,m)||(yr=m,m=Pl(Su,"onSelect"),0<m.length&&(a=new Wa("onSelect","select",null,a,u),o.push({event:a,listeners:m}),a.target=ao)))}function xs(o,a){var u={};return u[o.toLowerCase()]=a.toLowerCase(),u["Webkit"+o]="webkit"+a,u["Moz"+o]="moz"+a,u}var lo={animationend:xs("Animation","AnimationEnd"),animationiteration:xs("Animation","AnimationIteration"),animationstart:xs("Animation","AnimationStart"),transitionrun:xs("Transition","TransitionRun"),transitionstart:xs("Transition","TransitionStart"),transitioncancel:xs("Transition","TransitionCancel"),transitionend:xs("Transition","TransitionEnd")},Au={},xm={};di&&(xm=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function bs(o){if(Au[o])return Au[o];if(!lo[o])return o;var a=lo[o],u;for(u in a)if(a.hasOwnProperty(u)&&u in xm)return Au[o]=a[u];return o}var bm=bs("animationend"),Sm=bs("animationiteration"),Cm=bs("animationstart"),BA=bs("transitionrun"),VA=bs("transitionstart"),GA=bs("transitioncancel"),Am=bs("transitionend"),Em=new Map,Eu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Eu.push("scrollEnd");function Vn(o,a){Em.set(o,a),ys(a,[o])}var _m=new WeakMap;function Mn(o,a){if(typeof o=="object"&&o!==null){var u=_m.get(o);return u!==void 0?u:(a={value:o,source:a,stack:Gp(a)},_m.set(o,a),a)}return{value:o,source:a,stack:Gp(a)}}var Nn=[],co=0,_u=0;function Ja(){for(var o=co,a=_u=co=0;a<o;){var u=Nn[a];Nn[a++]=null;var m=Nn[a];Nn[a++]=null;var x=Nn[a];Nn[a++]=null;var S=Nn[a];if(Nn[a++]=null,m!==null&&x!==null){var T=m.pending;T===null?x.next=x:(x.next=T.next,T.next=x),m.pending=x}S!==0&&Tm(u,x,S)}}function Qa(o,a,u,m){Nn[co++]=o,Nn[co++]=a,Nn[co++]=u,Nn[co++]=m,_u|=m,o.lanes|=m,o=o.alternate,o!==null&&(o.lanes|=m)}function Tu(o,a,u,m){return Qa(o,a,u,m),Za(o)}function uo(o,a){return Qa(o,null,null,a),Za(o)}function Tm(o,a,u){o.lanes|=u;var m=o.alternate;m!==null&&(m.lanes|=u);for(var x=!1,S=o.return;S!==null;)S.childLanes|=u,m=S.alternate,m!==null&&(m.childLanes|=u),S.tag===22&&(o=S.stateNode,o===null||o._visibility&1||(x=!0)),o=S,S=S.return;return o.tag===3?(S=o.stateNode,x&&a!==null&&(x=31-st(u),o=S.hiddenUpdates,m=o[x],m===null?o[x]=[a]:m.push(a),a.lane=u|536870912),S):null}function Za(o){if(50<qr)throw qr=0,Dd=null,Error(n(185));for(var a=o.return;a!==null;)o=a,a=o.return;return o.tag===3?o.stateNode:null}var fo={};function qA(o,a,u,m){this.tag=o,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(o,a,u,m){return new qA(o,a,u,m)}function wu(o){return o=o.prototype,!(!o||!o.isReactComponent)}function fi(o,a){var u=o.alternate;return u===null?(u=vn(o.tag,a,o.key,o.mode),u.elementType=o.elementType,u.type=o.type,u.stateNode=o.stateNode,u.alternate=o,o.alternate=u):(u.pendingProps=a,u.type=o.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=o.flags&65011712,u.childLanes=o.childLanes,u.lanes=o.lanes,u.child=o.child,u.memoizedProps=o.memoizedProps,u.memoizedState=o.memoizedState,u.updateQueue=o.updateQueue,a=o.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=o.sibling,u.index=o.index,u.ref=o.ref,u.refCleanup=o.refCleanup,u}function wm(o,a){o.flags&=65011714;var u=o.alternate;return u===null?(o.childLanes=0,o.lanes=a,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,a=u.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),o}function el(o,a,u,m,x,S){var T=0;if(m=o,typeof o=="function")wu(o)&&(T=1);else if(typeof o=="string")T=jE(o,u,le.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case F:return o=vn(31,u,a,x),o.elementType=F,o.lanes=S,o;case E:return Ss(u.children,x,S,a);case A:T=8,x|=24;break;case _:return o=vn(12,u,a,x|2),o.elementType=_,o.lanes=S,o;case R:return o=vn(13,u,a,x),o.elementType=R,o.lanes=S,o;case I:return o=vn(19,u,a,x),o.elementType=I,o.lanes=S,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case w:case M:T=10;break e;case N:T=9;break e;case k:T=11;break e;case P:T=14;break e;case q:T=16,m=null;break e}T=29,u=Error(n(130,o===null?"null":typeof o,"")),m=null}return a=vn(T,u,a,x),a.elementType=o,a.type=m,a.lanes=S,a}function Ss(o,a,u,m){return o=vn(7,o,m,a),o.lanes=u,o}function Mu(o,a,u){return o=vn(6,o,null,a),o.lanes=u,o}function Nu(o,a,u){return a=vn(4,o.children!==null?o.children:[],o.key,a),a.lanes=u,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}var ho=[],po=0,tl=null,nl=0,Rn=[],In=0,Cs=null,hi=1,pi="";function As(o,a){ho[po++]=nl,ho[po++]=tl,tl=o,nl=a}function Mm(o,a,u){Rn[In++]=hi,Rn[In++]=pi,Rn[In++]=Cs,Cs=o;var m=hi;o=pi;var x=32-st(m)-1;m&=~(1<<x),u+=1;var S=32-st(a)+x;if(30<S){var T=x-x%5;S=(m&(1<<T)-1).toString(32),m>>=T,x-=T,hi=1<<32-st(a)+x|u<<x|m,pi=S+o}else hi=1<<S|u<<x|m,pi=o}function Ru(o){o.return!==null&&(As(o,1),Mm(o,1,0))}function Iu(o){for(;o===tl;)tl=ho[--po],ho[po]=null,nl=ho[--po],ho[po]=null;for(;o===Cs;)Cs=Rn[--In],Rn[In]=null,pi=Rn[--In],Rn[In]=null,hi=Rn[--In],Rn[In]=null}var Qt=null,yt=null,Ke=!1,Es=null,Yn=!1,Du=Error(n(519));function _s(o){var a=Error(n(418,""));throw br(Mn(a,o)),Du}function Nm(o){var a=o.stateNode,u=o.type,m=o.memoizedProps;switch(a[$t]=o,a[ln]=m,u){case"dialog":He("cancel",a),He("close",a);break;case"iframe":case"object":case"embed":He("load",a);break;case"video":case"audio":for(u=0;u<jr.length;u++)He(jr[u],a);break;case"source":He("error",a);break;case"img":case"image":case"link":He("error",a),He("load",a);break;case"details":He("toggle",a);break;case"input":He("invalid",a),jp(a,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),qa(a);break;case"select":He("invalid",a);break;case"textarea":He("invalid",a),$p(a,m.value,m.defaultValue,m.children),qa(a)}u=m.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||m.suppressHydrationWarning===!0||$y(a.textContent,u)?(m.popover!=null&&(He("beforetoggle",a),He("toggle",a)),m.onScroll!=null&&He("scroll",a),m.onScrollEnd!=null&&He("scrollend",a),m.onClick!=null&&(a.onclick=Fl),a=!0):a=!1,a||_s(o)}function Rm(o){for(Qt=o.return;Qt;)switch(Qt.tag){case 5:case 13:Yn=!1;return;case 27:case 3:Yn=!0;return;default:Qt=Qt.return}}function vr(o){if(o!==Qt)return!1;if(!Ke)return Rm(o),Ke=!0,!1;var a=o.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=o.type,u=!(u!=="form"&&u!=="button")||Wd(o.type,o.memoizedProps)),u=!u),u&&yt&&_s(o),Rm(o),a===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8)if(u=o.data,u==="/$"){if(a===0){yt=qn(o.nextSibling);break e}a--}else u!=="$"&&u!=="$!"&&u!=="$?"||a++;o=o.nextSibling}yt=null}}else a===27?(a=yt,es(o.type)?(o=Qd,Qd=null,yt=o):yt=a):yt=Qt?qn(o.stateNode.nextSibling):null;return!0}function xr(){yt=Qt=null,Ke=!1}function Im(){var o=Es;return o!==null&&(fn===null?fn=o:fn.push.apply(fn,o),Es=null),o}function br(o){Es===null?Es=[o]:Es.push(o)}var ku=V(null),Ts=null,mi=null;function Bi(o,a,u){z(ku,a._currentValue),a._currentValue=u}function gi(o){o._currentValue=ku.current,W(ku)}function Lu(o,a,u){for(;o!==null;){var m=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),o===u)break;o=o.return}}function Pu(o,a,u,m){var x=o.child;for(x!==null&&(x.return=o);x!==null;){var S=x.dependencies;if(S!==null){var T=x.child;S=S.firstContext;e:for(;S!==null;){var D=S;S=x;for(var B=0;B<a.length;B++)if(D.context===a[B]){S.lanes|=u,D=S.alternate,D!==null&&(D.lanes|=u),Lu(S.return,u,o),m||(T=null);break e}S=D.next}}else if(x.tag===18){if(T=x.return,T===null)throw Error(n(341));T.lanes|=u,S=T.alternate,S!==null&&(S.lanes|=u),Lu(T,u,o),T=null}else T=x.child;if(T!==null)T.return=x;else for(T=x;T!==null;){if(T===o){T=null;break}if(x=T.sibling,x!==null){x.return=T.return,T=x;break}T=T.return}x=T}}function Sr(o,a,u,m){o=null;for(var x=a,S=!1;x!==null;){if(!S){if((x.flags&524288)!==0)S=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var T=x.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var D=x.type;yn(x.pendingProps.value,T.value)||(o!==null?o.push(D):o=[D])}}else if(x===Ee.current){if(T=x.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(o!==null?o.push(Xr):o=[Xr])}x=x.return}o!==null&&Pu(a,o,u,m),a.flags|=262144}function il(o){for(o=o.firstContext;o!==null;){if(!yn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function ws(o){Ts=o,mi=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Yt(o){return Dm(Ts,o)}function sl(o,a){return Ts===null&&ws(o),Dm(o,a)}function Dm(o,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},mi===null){if(o===null)throw Error(n(308));mi=a,o.dependencies={lanes:0,firstContext:a},o.flags|=524288}else mi=mi.next=a;return u}var HA=typeof AbortController<"u"?AbortController:function(){var o=[],a=this.signal={aborted:!1,addEventListener:function(u,m){o.push(m)}};this.abort=function(){a.aborted=!0,o.forEach(function(u){return u()})}},jA=i.unstable_scheduleCallback,zA=i.unstable_NormalPriority,kt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fu(){return{controller:new HA,data:new Map,refCount:0}}function Cr(o){o.refCount--,o.refCount===0&&jA(zA,function(){o.controller.abort()})}var Ar=null,Ou=0,mo=0,go=null;function $A(o,a){if(Ar===null){var u=Ar=[];Ou=0,mo=Bd(),go={status:"pending",value:void 0,then:function(m){u.push(m)}}}return Ou++,a.then(km,km),a}function km(){if(--Ou===0&&Ar!==null){go!==null&&(go.status="fulfilled");var o=Ar;Ar=null,mo=0,go=null;for(var a=0;a<o.length;a++)(0,o[a])()}}function YA(o,a){var u=[],m={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return o.then(function(){m.status="fulfilled",m.value=a;for(var x=0;x<u.length;x++)(0,u[x])(a)},function(x){for(m.status="rejected",m.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),m}var Lm=U.S;U.S=function(o,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&$A(o,a),Lm!==null&&Lm(o,a)};var Ms=V(null);function Uu(){var o=Ms.current;return o!==null?o:ot.pooledCache}function ol(o,a){a===null?z(Ms,Ms.current):z(Ms,a.pool)}function Pm(){var o=Uu();return o===null?null:{parent:kt._currentValue,pool:o}}var Er=Error(n(460)),Fm=Error(n(474)),rl=Error(n(542)),Bu={then:function(){}};function Om(o){return o=o.status,o==="fulfilled"||o==="rejected"}function al(){}function Um(o,a,u){switch(u=o[u],u===void 0?o.push(a):u!==a&&(a.then(al,al),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw o=a.reason,Vm(o),o;default:if(typeof a.status=="string")a.then(al,al);else{if(o=ot,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=a,o.status="pending",o.then(function(m){if(a.status==="pending"){var x=a;x.status="fulfilled",x.value=m}},function(m){if(a.status==="pending"){var x=a;x.status="rejected",x.reason=m}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw o=a.reason,Vm(o),o}throw _r=a,Er}}var _r=null;function Bm(){if(_r===null)throw Error(n(459));var o=_r;return _r=null,o}function Vm(o){if(o===Er||o===rl)throw Error(n(483))}var Vi=!1;function Vu(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gu(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Gi(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function qi(o,a,u){var m=o.updateQueue;if(m===null)return null;if(m=m.shared,(Xe&2)!==0){var x=m.pending;return x===null?a.next=a:(a.next=x.next,x.next=a),m.pending=a,a=Za(o),Tm(o,null,u),a}return Qa(o,m,a,u),Za(o)}function Tr(o,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var m=a.lanes;m&=o.pendingLanes,u|=m,a.lanes=u,kp(o,u)}}function qu(o,a){var u=o.updateQueue,m=o.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var x=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?x=S=T:S=S.next=T,u=u.next}while(u!==null);S===null?x=S=a:S=S.next=a}else x=S=a;u={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:m.shared,callbacks:m.callbacks},o.updateQueue=u;return}o=u.lastBaseUpdate,o===null?u.firstBaseUpdate=a:o.next=a,u.lastBaseUpdate=a}var Hu=!1;function wr(){if(Hu){var o=go;if(o!==null)throw o}}function Mr(o,a,u,m){Hu=!1;var x=o.updateQueue;Vi=!1;var S=x.firstBaseUpdate,T=x.lastBaseUpdate,D=x.shared.pending;if(D!==null){x.shared.pending=null;var B=D,J=B.next;B.next=null,T===null?S=J:T.next=J,T=B;var ie=o.alternate;ie!==null&&(ie=ie.updateQueue,D=ie.lastBaseUpdate,D!==T&&(D===null?ie.firstBaseUpdate=J:D.next=J,ie.lastBaseUpdate=B))}if(S!==null){var re=x.baseState;T=0,ie=J=B=null,D=S;do{var Z=D.lane&-536870913,ee=Z!==D.lane;if(ee?(Ye&Z)===Z:(m&Z)===Z){Z!==0&&Z===mo&&(Hu=!0),ie!==null&&(ie=ie.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var De=o,Me=D;Z=a;var tt=u;switch(Me.tag){case 1:if(De=Me.payload,typeof De=="function"){re=De.call(tt,re,Z);break e}re=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Me.payload,Z=typeof De=="function"?De.call(tt,re,Z):De,Z==null)break e;re=g({},re,Z);break e;case 2:Vi=!0}}Z=D.callback,Z!==null&&(o.flags|=64,ee&&(o.flags|=8192),ee=x.callbacks,ee===null?x.callbacks=[Z]:ee.push(Z))}else ee={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ie===null?(J=ie=ee,B=re):ie=ie.next=ee,T|=Z;if(D=D.next,D===null){if(D=x.shared.pending,D===null)break;ee=D,D=ee.next,ee.next=null,x.lastBaseUpdate=ee,x.shared.pending=null}}while(!0);ie===null&&(B=re),x.baseState=B,x.firstBaseUpdate=J,x.lastBaseUpdate=ie,S===null&&(x.shared.lanes=0),Xi|=T,o.lanes=T,o.memoizedState=re}}function Gm(o,a){if(typeof o!="function")throw Error(n(191,o));o.call(a)}function qm(o,a){var u=o.callbacks;if(u!==null)for(o.callbacks=null,o=0;o<u.length;o++)Gm(u[o],a)}var yo=V(null),ll=V(0);function Hm(o,a){o=Ai,z(ll,o),z(yo,a),Ai=o|a.baseLanes}function ju(){z(ll,Ai),z(yo,yo.current)}function zu(){Ai=ll.current,W(yo),W(ll)}var Hi=0,Ue=null,Ze=null,Tt=null,cl=!1,vo=!1,Ns=!1,ul=0,Nr=0,xo=null,WA=0;function bt(){throw Error(n(321))}function $u(o,a){if(a===null)return!1;for(var u=0;u<a.length&&u<o.length;u++)if(!yn(o[u],a[u]))return!1;return!0}function Yu(o,a,u,m,x,S){return Hi=S,Ue=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,U.H=o===null||o.memoizedState===null?Tg:wg,Ns=!1,S=u(m,x),Ns=!1,vo&&(S=zm(a,u,m,x)),jm(o),S}function jm(o){U.H=gl;var a=Ze!==null&&Ze.next!==null;if(Hi=0,Tt=Ze=Ue=null,cl=!1,Nr=0,xo=null,a)throw Error(n(300));o===null||Ot||(o=o.dependencies,o!==null&&il(o)&&(Ot=!0))}function zm(o,a,u,m){Ue=o;var x=0;do{if(vo&&(xo=null),Nr=0,vo=!1,25<=x)throw Error(n(301));if(x+=1,Tt=Ze=null,o.updateQueue!=null){var S=o.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}U.H=tE,S=a(u,m)}while(vo);return S}function KA(){var o=U.H,a=o.useState()[0];return a=typeof a.then=="function"?Rr(a):a,o=o.useState()[0],(Ze!==null?Ze.memoizedState:null)!==o&&(Ue.flags|=1024),a}function Wu(){var o=ul!==0;return ul=0,o}function Ku(o,a,u){a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~u}function Xu(o){if(cl){for(o=o.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}cl=!1}Hi=0,Tt=Ze=Ue=null,vo=!1,Nr=ul=0,xo=null}function un(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?Ue.memoizedState=Tt=o:Tt=Tt.next=o,Tt}function wt(){if(Ze===null){var o=Ue.alternate;o=o!==null?o.memoizedState:null}else o=Ze.next;var a=Tt===null?Ue.memoizedState:Tt.next;if(a!==null)Tt=a,Ze=o;else{if(o===null)throw Ue.alternate===null?Error(n(467)):Error(n(310));Ze=o,o={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},Tt===null?Ue.memoizedState=Tt=o:Tt=Tt.next=o}return Tt}function Ju(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rr(o){var a=Nr;return Nr+=1,xo===null&&(xo=[]),o=Um(xo,o,a),a=Ue,(Tt===null?a.memoizedState:Tt.next)===null&&(a=a.alternate,U.H=a===null||a.memoizedState===null?Tg:wg),o}function dl(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Rr(o);if(o.$$typeof===M)return Yt(o)}throw Error(n(438,String(o)))}function Qu(o){var a=null,u=Ue.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var m=Ue.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(a={data:m.data.map(function(x){return x.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=Ju(),Ue.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(o),m=0;m<o;m++)u[m]=$;return a.index++,u}function yi(o,a){return typeof a=="function"?a(o):a}function fl(o){var a=wt();return Zu(a,Ze,o)}function Zu(o,a,u){var m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=u;var x=o.baseQueue,S=m.pending;if(S!==null){if(x!==null){var T=x.next;x.next=S.next,S.next=T}a.baseQueue=x=S,m.pending=null}if(S=o.baseState,x===null)o.memoizedState=S;else{a=x.next;var D=T=null,B=null,J=a,ie=!1;do{var re=J.lane&-536870913;if(re!==J.lane?(Ye&re)===re:(Hi&re)===re){var Z=J.revertLane;if(Z===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),re===mo&&(ie=!0);else if((Hi&Z)===Z){J=J.next,Z===mo&&(ie=!0);continue}else re={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},B===null?(D=B=re,T=S):B=B.next=re,Ue.lanes|=Z,Xi|=Z;re=J.action,Ns&&u(S,re),S=J.hasEagerState?J.eagerState:u(S,re)}else Z={lane:re,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},B===null?(D=B=Z,T=S):B=B.next=Z,Ue.lanes|=re,Xi|=re;J=J.next}while(J!==null&&J!==a);if(B===null?T=S:B.next=D,!yn(S,o.memoizedState)&&(Ot=!0,ie&&(u=go,u!==null)))throw u;o.memoizedState=S,o.baseState=T,o.baseQueue=B,m.lastRenderedState=S}return x===null&&(m.lanes=0),[o.memoizedState,m.dispatch]}function ed(o){var a=wt(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=o;var m=u.dispatch,x=u.pending,S=a.memoizedState;if(x!==null){u.pending=null;var T=x=x.next;do S=o(S,T.action),T=T.next;while(T!==x);yn(S,a.memoizedState)||(Ot=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),u.lastRenderedState=S}return[S,m]}function $m(o,a,u){var m=Ue,x=wt(),S=Ke;if(S){if(u===void 0)throw Error(n(407));u=u()}else u=a();var T=!yn((Ze||x).memoizedState,u);T&&(x.memoizedState=u,Ot=!0),x=x.queue;var D=Km.bind(null,m,x,o);if(Ir(2048,8,D,[o]),x.getSnapshot!==a||T||Tt!==null&&Tt.memoizedState.tag&1){if(m.flags|=2048,bo(9,hl(),Wm.bind(null,m,x,u,a),null),ot===null)throw Error(n(349));S||(Hi&124)!==0||Ym(m,a,u)}return u}function Ym(o,a,u){o.flags|=16384,o={getSnapshot:a,value:u},a=Ue.updateQueue,a===null?(a=Ju(),Ue.updateQueue=a,a.stores=[o]):(u=a.stores,u===null?a.stores=[o]:u.push(o))}function Wm(o,a,u,m){a.value=u,a.getSnapshot=m,Xm(a)&&Jm(o)}function Km(o,a,u){return u(function(){Xm(a)&&Jm(o)})}function Xm(o){var a=o.getSnapshot;o=o.value;try{var u=a();return!yn(o,u)}catch{return!0}}function Jm(o){var a=uo(o,2);a!==null&&An(a,o,2)}function td(o){var a=un();if(typeof o=="function"){var u=o;if(o=u(),Ns){je(!0);try{u()}finally{je(!1)}}}return a.memoizedState=a.baseState=o,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:o},a}function Qm(o,a,u,m){return o.baseState=u,Zu(o,Ze,typeof m=="function"?m:yi)}function XA(o,a,u,m,x){if(ml(o))throw Error(n(485));if(o=a.action,o!==null){var S={payload:x,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){S.listeners.push(T)}};U.T!==null?u(!0):S.isTransition=!1,m(S),u=a.pending,u===null?(S.next=a.pending=S,Zm(a,S)):(S.next=u.next,a.pending=u.next=S)}}function Zm(o,a){var u=a.action,m=a.payload,x=o.state;if(a.isTransition){var S=U.T,T={};U.T=T;try{var D=u(x,m),B=U.S;B!==null&&B(T,D),eg(o,a,D)}catch(J){nd(o,a,J)}finally{U.T=S}}else try{S=u(x,m),eg(o,a,S)}catch(J){nd(o,a,J)}}function eg(o,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(m){tg(o,a,m)},function(m){return nd(o,a,m)}):tg(o,a,u)}function tg(o,a,u){a.status="fulfilled",a.value=u,ng(a),o.state=u,a=o.pending,a!==null&&(u=a.next,u===a?o.pending=null:(u=u.next,a.next=u,Zm(o,u)))}function nd(o,a,u){var m=o.pending;if(o.pending=null,m!==null){m=m.next;do a.status="rejected",a.reason=u,ng(a),a=a.next;while(a!==m)}o.action=null}function ng(o){o=o.listeners;for(var a=0;a<o.length;a++)(0,o[a])()}function ig(o,a){return a}function sg(o,a){if(Ke){var u=ot.formState;if(u!==null){e:{var m=Ue;if(Ke){if(yt){t:{for(var x=yt,S=Yn;x.nodeType!==8;){if(!S){x=null;break t}if(x=qn(x.nextSibling),x===null){x=null;break t}}S=x.data,x=S==="F!"||S==="F"?x:null}if(x){yt=qn(x.nextSibling),m=x.data==="F!";break e}}_s(m)}m=!1}m&&(a=u[0])}}return u=un(),u.memoizedState=u.baseState=a,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ig,lastRenderedState:a},u.queue=m,u=Ag.bind(null,Ue,m),m.dispatch=u,m=td(!1),S=ad.bind(null,Ue,!1,m.queue),m=un(),x={state:a,dispatch:null,action:o,pending:null},m.queue=x,u=XA.bind(null,Ue,x,S,u),x.dispatch=u,m.memoizedState=o,[a,u,!1]}function og(o){var a=wt();return rg(a,Ze,o)}function rg(o,a,u){if(a=Zu(o,a,ig)[0],o=fl(yi)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var m=Rr(a)}catch(T){throw T===Er?rl:T}else m=a;a=wt();var x=a.queue,S=x.dispatch;return u!==a.memoizedState&&(Ue.flags|=2048,bo(9,hl(),JA.bind(null,x,u),null)),[m,S,o]}function JA(o,a){o.action=a}function ag(o){var a=wt(),u=Ze;if(u!==null)return rg(a,u,o);wt(),a=a.memoizedState,u=wt();var m=u.queue.dispatch;return u.memoizedState=o,[a,m,!1]}function bo(o,a,u,m){return o={tag:o,create:u,deps:m,inst:a,next:null},a=Ue.updateQueue,a===null&&(a=Ju(),Ue.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=o.next=o:(m=u.next,u.next=o,o.next=m,a.lastEffect=o),o}function hl(){return{destroy:void 0,resource:void 0}}function lg(){return wt().memoizedState}function pl(o,a,u,m){var x=un();m=m===void 0?null:m,Ue.flags|=o,x.memoizedState=bo(1|a,hl(),u,m)}function Ir(o,a,u,m){var x=wt();m=m===void 0?null:m;var S=x.memoizedState.inst;Ze!==null&&m!==null&&$u(m,Ze.memoizedState.deps)?x.memoizedState=bo(a,S,u,m):(Ue.flags|=o,x.memoizedState=bo(1|a,S,u,m))}function cg(o,a){pl(8390656,8,o,a)}function ug(o,a){Ir(2048,8,o,a)}function dg(o,a){return Ir(4,2,o,a)}function fg(o,a){return Ir(4,4,o,a)}function hg(o,a){if(typeof a=="function"){o=o();var u=a(o);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function pg(o,a,u){u=u!=null?u.concat([o]):null,Ir(4,4,hg.bind(null,a,o),u)}function id(){}function mg(o,a){var u=wt();a=a===void 0?null:a;var m=u.memoizedState;return a!==null&&$u(a,m[1])?m[0]:(u.memoizedState=[o,a],o)}function gg(o,a){var u=wt();a=a===void 0?null:a;var m=u.memoizedState;if(a!==null&&$u(a,m[1]))return m[0];if(m=o(),Ns){je(!0);try{o()}finally{je(!1)}}return u.memoizedState=[m,a],m}function sd(o,a,u){return u===void 0||(Hi&1073741824)!==0?o.memoizedState=a:(o.memoizedState=u,o=xy(),Ue.lanes|=o,Xi|=o,u)}function yg(o,a,u,m){return yn(u,a)?u:yo.current!==null?(o=sd(o,u,m),yn(o,a)||(Ot=!0),o):(Hi&42)===0?(Ot=!0,o.memoizedState=u):(o=xy(),Ue.lanes|=o,Xi|=o,a)}function vg(o,a,u,m,x){var S=X.p;X.p=S!==0&&8>S?S:8;var T=U.T,D={};U.T=D,ad(o,!1,a,u);try{var B=x(),J=U.S;if(J!==null&&J(D,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ie=YA(B,m);Dr(o,a,ie,Cn(o))}else Dr(o,a,m,Cn(o))}catch(re){Dr(o,a,{then:function(){},status:"rejected",reason:re},Cn())}finally{X.p=S,U.T=T}}function QA(){}function od(o,a,u,m){if(o.tag!==5)throw Error(n(476));var x=xg(o).queue;vg(o,x,a,de,u===null?QA:function(){return bg(o),u(m)})}function xg(o){var a=o.memoizedState;if(a!==null)return a;a={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:de},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:u},next:null},o.memoizedState=a,o=o.alternate,o!==null&&(o.memoizedState=a),a}function bg(o){var a=xg(o).next.queue;Dr(o,a,{},Cn())}function rd(){return Yt(Xr)}function Sg(){return wt().memoizedState}function Cg(){return wt().memoizedState}function ZA(o){for(var a=o.return;a!==null;){switch(a.tag){case 24:case 3:var u=Cn();o=Gi(u);var m=qi(a,o,u);m!==null&&(An(m,a,u),Tr(m,a,u)),a={cache:Fu()},o.payload=a;return}a=a.return}}function eE(o,a,u){var m=Cn();u={lane:m,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},ml(o)?Eg(a,u):(u=Tu(o,a,u,m),u!==null&&(An(u,o,m),_g(u,a,m)))}function Ag(o,a,u){var m=Cn();Dr(o,a,u,m)}function Dr(o,a,u,m){var x={lane:m,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(ml(o))Eg(a,x);else{var S=o.alternate;if(o.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var T=a.lastRenderedState,D=S(T,u);if(x.hasEagerState=!0,x.eagerState=D,yn(D,T))return Qa(o,a,x,0),ot===null&&Ja(),!1}catch{}finally{}if(u=Tu(o,a,x,m),u!==null)return An(u,o,m),_g(u,a,m),!0}return!1}function ad(o,a,u,m){if(m={lane:2,revertLane:Bd(),action:m,hasEagerState:!1,eagerState:null,next:null},ml(o)){if(a)throw Error(n(479))}else a=Tu(o,u,m,2),a!==null&&An(a,o,2)}function ml(o){var a=o.alternate;return o===Ue||a!==null&&a===Ue}function Eg(o,a){vo=cl=!0;var u=o.pending;u===null?a.next=a:(a.next=u.next,u.next=a),o.pending=a}function _g(o,a,u){if((u&4194048)!==0){var m=a.lanes;m&=o.pendingLanes,u|=m,a.lanes=u,kp(o,u)}}var gl={readContext:Yt,use:dl,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useLayoutEffect:bt,useInsertionEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useSyncExternalStore:bt,useId:bt,useHostTransitionStatus:bt,useFormState:bt,useActionState:bt,useOptimistic:bt,useMemoCache:bt,useCacheRefresh:bt},Tg={readContext:Yt,use:dl,useCallback:function(o,a){return un().memoizedState=[o,a===void 0?null:a],o},useContext:Yt,useEffect:cg,useImperativeHandle:function(o,a,u){u=u!=null?u.concat([o]):null,pl(4194308,4,hg.bind(null,a,o),u)},useLayoutEffect:function(o,a){return pl(4194308,4,o,a)},useInsertionEffect:function(o,a){pl(4,2,o,a)},useMemo:function(o,a){var u=un();a=a===void 0?null:a;var m=o();if(Ns){je(!0);try{o()}finally{je(!1)}}return u.memoizedState=[m,a],m},useReducer:function(o,a,u){var m=un();if(u!==void 0){var x=u(a);if(Ns){je(!0);try{u(a)}finally{je(!1)}}}else x=a;return m.memoizedState=m.baseState=x,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:x},m.queue=o,o=o.dispatch=eE.bind(null,Ue,o),[m.memoizedState,o]},useRef:function(o){var a=un();return o={current:o},a.memoizedState=o},useState:function(o){o=td(o);var a=o.queue,u=Ag.bind(null,Ue,a);return a.dispatch=u,[o.memoizedState,u]},useDebugValue:id,useDeferredValue:function(o,a){var u=un();return sd(u,o,a)},useTransition:function(){var o=td(!1);return o=vg.bind(null,Ue,o.queue,!0,!1),un().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,a,u){var m=Ue,x=un();if(Ke){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),ot===null)throw Error(n(349));(Ye&124)!==0||Ym(m,a,u)}x.memoizedState=u;var S={value:u,getSnapshot:a};return x.queue=S,cg(Km.bind(null,m,S,o),[o]),m.flags|=2048,bo(9,hl(),Wm.bind(null,m,S,u,a),null),u},useId:function(){var o=un(),a=ot.identifierPrefix;if(Ke){var u=pi,m=hi;u=(m&~(1<<32-st(m)-1)).toString(32)+u,a="«"+a+"R"+u,u=ul++,0<u&&(a+="H"+u.toString(32)),a+="»"}else u=WA++,a="«"+a+"r"+u.toString(32)+"»";return o.memoizedState=a},useHostTransitionStatus:rd,useFormState:sg,useActionState:sg,useOptimistic:function(o){var a=un();a.memoizedState=a.baseState=o;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=ad.bind(null,Ue,!0,u),u.dispatch=a,[o,a]},useMemoCache:Qu,useCacheRefresh:function(){return un().memoizedState=ZA.bind(null,Ue)}},wg={readContext:Yt,use:dl,useCallback:mg,useContext:Yt,useEffect:ug,useImperativeHandle:pg,useInsertionEffect:dg,useLayoutEffect:fg,useMemo:gg,useReducer:fl,useRef:lg,useState:function(){return fl(yi)},useDebugValue:id,useDeferredValue:function(o,a){var u=wt();return yg(u,Ze.memoizedState,o,a)},useTransition:function(){var o=fl(yi)[0],a=wt().memoizedState;return[typeof o=="boolean"?o:Rr(o),a]},useSyncExternalStore:$m,useId:Sg,useHostTransitionStatus:rd,useFormState:og,useActionState:og,useOptimistic:function(o,a){var u=wt();return Qm(u,Ze,o,a)},useMemoCache:Qu,useCacheRefresh:Cg},tE={readContext:Yt,use:dl,useCallback:mg,useContext:Yt,useEffect:ug,useImperativeHandle:pg,useInsertionEffect:dg,useLayoutEffect:fg,useMemo:gg,useReducer:ed,useRef:lg,useState:function(){return ed(yi)},useDebugValue:id,useDeferredValue:function(o,a){var u=wt();return Ze===null?sd(u,o,a):yg(u,Ze.memoizedState,o,a)},useTransition:function(){var o=ed(yi)[0],a=wt().memoizedState;return[typeof o=="boolean"?o:Rr(o),a]},useSyncExternalStore:$m,useId:Sg,useHostTransitionStatus:rd,useFormState:ag,useActionState:ag,useOptimistic:function(o,a){var u=wt();return Ze!==null?Qm(u,Ze,o,a):(u.baseState=o,[o,u.queue.dispatch])},useMemoCache:Qu,useCacheRefresh:Cg},So=null,kr=0;function yl(o){var a=kr;return kr+=1,So===null&&(So=[]),Um(So,o,a)}function Lr(o,a){a=a.props.ref,o.ref=a!==void 0?a:null}function vl(o,a){throw a.$$typeof===v?Error(n(525)):(o=Object.prototype.toString.call(a),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o)))}function Mg(o){var a=o._init;return a(o._payload)}function Ng(o){function a(j,H){if(o){var Y=j.deletions;Y===null?(j.deletions=[H],j.flags|=16):Y.push(H)}}function u(j,H){if(!o)return null;for(;H!==null;)a(j,H),H=H.sibling;return null}function m(j){for(var H=new Map;j!==null;)j.key!==null?H.set(j.key,j):H.set(j.index,j),j=j.sibling;return H}function x(j,H){return j=fi(j,H),j.index=0,j.sibling=null,j}function S(j,H,Y){return j.index=Y,o?(Y=j.alternate,Y!==null?(Y=Y.index,Y<H?(j.flags|=67108866,H):Y):(j.flags|=67108866,H)):(j.flags|=1048576,H)}function T(j){return o&&j.alternate===null&&(j.flags|=67108866),j}function D(j,H,Y,oe){return H===null||H.tag!==6?(H=Mu(Y,j.mode,oe),H.return=j,H):(H=x(H,Y),H.return=j,H)}function B(j,H,Y,oe){var be=Y.type;return be===E?ie(j,H,Y.props.children,oe,Y.key):H!==null&&(H.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===q&&Mg(be)===H.type)?(H=x(H,Y.props),Lr(H,Y),H.return=j,H):(H=el(Y.type,Y.key,Y.props,null,j.mode,oe),Lr(H,Y),H.return=j,H)}function J(j,H,Y,oe){return H===null||H.tag!==4||H.stateNode.containerInfo!==Y.containerInfo||H.stateNode.implementation!==Y.implementation?(H=Nu(Y,j.mode,oe),H.return=j,H):(H=x(H,Y.children||[]),H.return=j,H)}function ie(j,H,Y,oe,be){return H===null||H.tag!==7?(H=Ss(Y,j.mode,oe,be),H.return=j,H):(H=x(H,Y),H.return=j,H)}function re(j,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Mu(""+H,j.mode,Y),H.return=j,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case b:return Y=el(H.type,H.key,H.props,null,j.mode,Y),Lr(Y,H),Y.return=j,Y;case C:return H=Nu(H,j.mode,Y),H.return=j,H;case q:var oe=H._init;return H=oe(H._payload),re(j,H,Y)}if(me(H)||ne(H))return H=Ss(H,j.mode,Y,null),H.return=j,H;if(typeof H.then=="function")return re(j,yl(H),Y);if(H.$$typeof===M)return re(j,sl(j,H),Y);vl(j,H)}return null}function Z(j,H,Y,oe){var be=H!==null?H.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return be!==null?null:D(j,H,""+Y,oe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case b:return Y.key===be?B(j,H,Y,oe):null;case C:return Y.key===be?J(j,H,Y,oe):null;case q:return be=Y._init,Y=be(Y._payload),Z(j,H,Y,oe)}if(me(Y)||ne(Y))return be!==null?null:ie(j,H,Y,oe,null);if(typeof Y.then=="function")return Z(j,H,yl(Y),oe);if(Y.$$typeof===M)return Z(j,H,sl(j,Y),oe);vl(j,Y)}return null}function ee(j,H,Y,oe,be){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return j=j.get(Y)||null,D(H,j,""+oe,be);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:return j=j.get(oe.key===null?Y:oe.key)||null,B(H,j,oe,be);case C:return j=j.get(oe.key===null?Y:oe.key)||null,J(H,j,oe,be);case q:var Be=oe._init;return oe=Be(oe._payload),ee(j,H,Y,oe,be)}if(me(oe)||ne(oe))return j=j.get(Y)||null,ie(H,j,oe,be,null);if(typeof oe.then=="function")return ee(j,H,Y,yl(oe),be);if(oe.$$typeof===M)return ee(j,H,Y,sl(H,oe),be);vl(H,oe)}return null}function De(j,H,Y,oe){for(var be=null,Be=null,Ae=H,Re=H=0,Bt=null;Ae!==null&&Re<Y.length;Re++){Ae.index>Re?(Bt=Ae,Ae=null):Bt=Ae.sibling;var We=Z(j,Ae,Y[Re],oe);if(We===null){Ae===null&&(Ae=Bt);break}o&&Ae&&We.alternate===null&&a(j,Ae),H=S(We,H,Re),Be===null?be=We:Be.sibling=We,Be=We,Ae=Bt}if(Re===Y.length)return u(j,Ae),Ke&&As(j,Re),be;if(Ae===null){for(;Re<Y.length;Re++)Ae=re(j,Y[Re],oe),Ae!==null&&(H=S(Ae,H,Re),Be===null?be=Ae:Be.sibling=Ae,Be=Ae);return Ke&&As(j,Re),be}for(Ae=m(Ae);Re<Y.length;Re++)Bt=ee(Ae,j,Re,Y[Re],oe),Bt!==null&&(o&&Bt.alternate!==null&&Ae.delete(Bt.key===null?Re:Bt.key),H=S(Bt,H,Re),Be===null?be=Bt:Be.sibling=Bt,Be=Bt);return o&&Ae.forEach(function(os){return a(j,os)}),Ke&&As(j,Re),be}function Me(j,H,Y,oe){if(Y==null)throw Error(n(151));for(var be=null,Be=null,Ae=H,Re=H=0,Bt=null,We=Y.next();Ae!==null&&!We.done;Re++,We=Y.next()){Ae.index>Re?(Bt=Ae,Ae=null):Bt=Ae.sibling;var os=Z(j,Ae,We.value,oe);if(os===null){Ae===null&&(Ae=Bt);break}o&&Ae&&os.alternate===null&&a(j,Ae),H=S(os,H,Re),Be===null?be=os:Be.sibling=os,Be=os,Ae=Bt}if(We.done)return u(j,Ae),Ke&&As(j,Re),be;if(Ae===null){for(;!We.done;Re++,We=Y.next())We=re(j,We.value,oe),We!==null&&(H=S(We,H,Re),Be===null?be=We:Be.sibling=We,Be=We);return Ke&&As(j,Re),be}for(Ae=m(Ae);!We.done;Re++,We=Y.next())We=ee(Ae,j,Re,We.value,oe),We!==null&&(o&&We.alternate!==null&&Ae.delete(We.key===null?Re:We.key),H=S(We,H,Re),Be===null?be=We:Be.sibling=We,Be=We);return o&&Ae.forEach(function(n_){return a(j,n_)}),Ke&&As(j,Re),be}function tt(j,H,Y,oe){if(typeof Y=="object"&&Y!==null&&Y.type===E&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case b:e:{for(var be=Y.key;H!==null;){if(H.key===be){if(be=Y.type,be===E){if(H.tag===7){u(j,H.sibling),oe=x(H,Y.props.children),oe.return=j,j=oe;break e}}else if(H.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===q&&Mg(be)===H.type){u(j,H.sibling),oe=x(H,Y.props),Lr(oe,Y),oe.return=j,j=oe;break e}u(j,H);break}else a(j,H);H=H.sibling}Y.type===E?(oe=Ss(Y.props.children,j.mode,oe,Y.key),oe.return=j,j=oe):(oe=el(Y.type,Y.key,Y.props,null,j.mode,oe),Lr(oe,Y),oe.return=j,j=oe)}return T(j);case C:e:{for(be=Y.key;H!==null;){if(H.key===be)if(H.tag===4&&H.stateNode.containerInfo===Y.containerInfo&&H.stateNode.implementation===Y.implementation){u(j,H.sibling),oe=x(H,Y.children||[]),oe.return=j,j=oe;break e}else{u(j,H);break}else a(j,H);H=H.sibling}oe=Nu(Y,j.mode,oe),oe.return=j,j=oe}return T(j);case q:return be=Y._init,Y=be(Y._payload),tt(j,H,Y,oe)}if(me(Y))return De(j,H,Y,oe);if(ne(Y)){if(be=ne(Y),typeof be!="function")throw Error(n(150));return Y=be.call(Y),Me(j,H,Y,oe)}if(typeof Y.then=="function")return tt(j,H,yl(Y),oe);if(Y.$$typeof===M)return tt(j,H,sl(j,Y),oe);vl(j,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,H!==null&&H.tag===6?(u(j,H.sibling),oe=x(H,Y),oe.return=j,j=oe):(u(j,H),oe=Mu(Y,j.mode,oe),oe.return=j,j=oe),T(j)):u(j,H)}return function(j,H,Y,oe){try{kr=0;var be=tt(j,H,Y,oe);return So=null,be}catch(Ae){if(Ae===Er||Ae===rl)throw Ae;var Be=vn(29,Ae,null,j.mode);return Be.lanes=oe,Be.return=j,Be}finally{}}}var Co=Ng(!0),Rg=Ng(!1),Dn=V(null),Wn=null;function ji(o){var a=o.alternate;z(Lt,Lt.current&1),z(Dn,o),Wn===null&&(a===null||yo.current!==null||a.memoizedState!==null)&&(Wn=o)}function Ig(o){if(o.tag===22){if(z(Lt,Lt.current),z(Dn,o),Wn===null){var a=o.alternate;a!==null&&a.memoizedState!==null&&(Wn=o)}}else zi()}function zi(){z(Lt,Lt.current),z(Dn,Dn.current)}function vi(o){W(Dn),Wn===o&&(Wn=null),W(Lt)}var Lt=V(0);function xl(o){for(var a=o;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Jd(u)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function ld(o,a,u,m){a=o.memoizedState,u=u(m,a),u=u==null?a:g({},a,u),o.memoizedState=u,o.lanes===0&&(o.updateQueue.baseState=u)}var cd={enqueueSetState:function(o,a,u){o=o._reactInternals;var m=Cn(),x=Gi(m);x.payload=a,u!=null&&(x.callback=u),a=qi(o,x,m),a!==null&&(An(a,o,m),Tr(a,o,m))},enqueueReplaceState:function(o,a,u){o=o._reactInternals;var m=Cn(),x=Gi(m);x.tag=1,x.payload=a,u!=null&&(x.callback=u),a=qi(o,x,m),a!==null&&(An(a,o,m),Tr(a,o,m))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var u=Cn(),m=Gi(u);m.tag=2,a!=null&&(m.callback=a),a=qi(o,m,u),a!==null&&(An(a,o,u),Tr(a,o,u))}};function Dg(o,a,u,m,x,S,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(m,S,T):a.prototype&&a.prototype.isPureReactComponent?!gr(u,m)||!gr(x,S):!0}function kg(o,a,u,m){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,m),a.state!==o&&cd.enqueueReplaceState(a,a.state,null)}function Rs(o,a){var u=a;if("ref"in a){u={};for(var m in a)m!=="ref"&&(u[m]=a[m])}if(o=o.defaultProps){u===a&&(u=g({},u));for(var x in o)u[x]===void 0&&(u[x]=o[x])}return u}var bl=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Lg(o){bl(o)}function Pg(o){console.error(o)}function Fg(o){bl(o)}function Sl(o,a){try{var u=o.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(m){setTimeout(function(){throw m})}}function Og(o,a,u){try{var m=o.onCaughtError;m(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function ud(o,a,u){return u=Gi(u),u.tag=3,u.payload={element:null},u.callback=function(){Sl(o,a)},u}function Ug(o){return o=Gi(o),o.tag=3,o}function Bg(o,a,u,m){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var S=m.value;o.payload=function(){return x(S)},o.callback=function(){Og(a,u,m)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(o.callback=function(){Og(a,u,m),typeof x!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var D=m.stack;this.componentDidCatch(m.value,{componentStack:D!==null?D:""})})}function nE(o,a,u,m,x){if(u.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(a=u.alternate,a!==null&&Sr(a,u,x,!0),u=Dn.current,u!==null){switch(u.tag){case 13:return Wn===null?Ld():u.alternate===null&&vt===0&&(vt=3),u.flags&=-257,u.flags|=65536,u.lanes=x,m===Bu?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([m]):a.add(m),Fd(o,m,x)),!1;case 22:return u.flags|=65536,m===Bu?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([m])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([m]):u.add(m)),Fd(o,m,x)),!1}throw Error(n(435,u.tag))}return Fd(o,m,x),Ld(),!1}if(Ke)return a=Dn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=x,m!==Du&&(o=Error(n(422),{cause:m}),br(Mn(o,u)))):(m!==Du&&(a=Error(n(423),{cause:m}),br(Mn(a,u))),o=o.current.alternate,o.flags|=65536,x&=-x,o.lanes|=x,m=Mn(m,u),x=ud(o.stateNode,m,x),qu(o,x),vt!==4&&(vt=2)),!1;var S=Error(n(520),{cause:m});if(S=Mn(S,u),Gr===null?Gr=[S]:Gr.push(S),vt!==4&&(vt=2),a===null)return!0;m=Mn(m,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,o=x&-x,u.lanes|=o,o=ud(u.stateNode,m,o),qu(u,o),!1;case 1:if(a=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ji===null||!Ji.has(S))))return u.flags|=65536,x&=-x,u.lanes|=x,x=Ug(x),Bg(x,o,u,m),qu(u,x),!1}u=u.return}while(u!==null);return!1}var Vg=Error(n(461)),Ot=!1;function Vt(o,a,u,m){a.child=o===null?Rg(a,null,u,m):Co(a,o.child,u,m)}function Gg(o,a,u,m,x){u=u.render;var S=a.ref;if("ref"in m){var T={};for(var D in m)D!=="ref"&&(T[D]=m[D])}else T=m;return ws(a),m=Yu(o,a,u,T,S,x),D=Wu(),o!==null&&!Ot?(Ku(o,a,x),xi(o,a,x)):(Ke&&D&&Ru(a),a.flags|=1,Vt(o,a,m,x),a.child)}function qg(o,a,u,m,x){if(o===null){var S=u.type;return typeof S=="function"&&!wu(S)&&S.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=S,Hg(o,a,S,m,x)):(o=el(u.type,null,m,a,a.mode,x),o.ref=a.ref,o.return=a,a.child=o)}if(S=o.child,!vd(o,x)){var T=S.memoizedProps;if(u=u.compare,u=u!==null?u:gr,u(T,m)&&o.ref===a.ref)return xi(o,a,x)}return a.flags|=1,o=fi(S,m),o.ref=a.ref,o.return=a,a.child=o}function Hg(o,a,u,m,x){if(o!==null){var S=o.memoizedProps;if(gr(S,m)&&o.ref===a.ref)if(Ot=!1,a.pendingProps=m=S,vd(o,x))(o.flags&131072)!==0&&(Ot=!0);else return a.lanes=o.lanes,xi(o,a,x)}return dd(o,a,u,m,x)}function jg(o,a,u){var m=a.pendingProps,x=m.children,S=o!==null?o.memoizedState:null;if(m.mode==="hidden"){if((a.flags&128)!==0){if(m=S!==null?S.baseLanes|u:u,o!==null){for(x=a.child=o.child,S=0;x!==null;)S=S|x.lanes|x.childLanes,x=x.sibling;a.childLanes=S&~m}else a.childLanes=0,a.child=null;return zg(o,a,m,u)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},o!==null&&ol(a,S!==null?S.cachePool:null),S!==null?Hm(a,S):ju(),Ig(a);else return a.lanes=a.childLanes=536870912,zg(o,a,S!==null?S.baseLanes|u:u,u)}else S!==null?(ol(a,S.cachePool),Hm(a,S),zi(),a.memoizedState=null):(o!==null&&ol(a,null),ju(),zi());return Vt(o,a,x,u),a.child}function zg(o,a,u,m){var x=Uu();return x=x===null?null:{parent:kt._currentValue,pool:x},a.memoizedState={baseLanes:u,cachePool:x},o!==null&&ol(a,null),ju(),Ig(a),o!==null&&Sr(o,a,m,!0),null}function Cl(o,a){var u=a.ref;if(u===null)o!==null&&o.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(o===null||o.ref!==u)&&(a.flags|=4194816)}}function dd(o,a,u,m,x){return ws(a),u=Yu(o,a,u,m,void 0,x),m=Wu(),o!==null&&!Ot?(Ku(o,a,x),xi(o,a,x)):(Ke&&m&&Ru(a),a.flags|=1,Vt(o,a,u,x),a.child)}function $g(o,a,u,m,x,S){return ws(a),a.updateQueue=null,u=zm(a,m,u,x),jm(o),m=Wu(),o!==null&&!Ot?(Ku(o,a,S),xi(o,a,S)):(Ke&&m&&Ru(a),a.flags|=1,Vt(o,a,u,S),a.child)}function Yg(o,a,u,m,x){if(ws(a),a.stateNode===null){var S=fo,T=u.contextType;typeof T=="object"&&T!==null&&(S=Yt(T)),S=new u(m,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=cd,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=m,S.state=a.memoizedState,S.refs={},Vu(a),T=u.contextType,S.context=typeof T=="object"&&T!==null?Yt(T):fo,S.state=a.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(ld(a,u,T,m),S.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(T=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),T!==S.state&&cd.enqueueReplaceState(S,S.state,null),Mr(a,m,S,x),wr(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!0}else if(o===null){S=a.stateNode;var D=a.memoizedProps,B=Rs(u,D);S.props=B;var J=S.context,ie=u.contextType;T=fo,typeof ie=="object"&&ie!==null&&(T=Yt(ie));var re=u.getDerivedStateFromProps;ie=typeof re=="function"||typeof S.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,ie||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D||J!==T)&&kg(a,S,m,T),Vi=!1;var Z=a.memoizedState;S.state=Z,Mr(a,m,S,x),wr(),J=a.memoizedState,D||Z!==J||Vi?(typeof re=="function"&&(ld(a,u,re,m),J=a.memoizedState),(B=Vi||Dg(a,u,B,m,Z,J,T))?(ie||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=J),S.props=m,S.state=J,S.context=T,m=B):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{S=a.stateNode,Gu(o,a),T=a.memoizedProps,ie=Rs(u,T),S.props=ie,re=a.pendingProps,Z=S.context,J=u.contextType,B=fo,typeof J=="object"&&J!==null&&(B=Yt(J)),D=u.getDerivedStateFromProps,(J=typeof D=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(T!==re||Z!==B)&&kg(a,S,m,B),Vi=!1,Z=a.memoizedState,S.state=Z,Mr(a,m,S,x),wr();var ee=a.memoizedState;T!==re||Z!==ee||Vi||o!==null&&o.dependencies!==null&&il(o.dependencies)?(typeof D=="function"&&(ld(a,u,D,m),ee=a.memoizedState),(ie=Vi||Dg(a,u,ie,m,Z,ee,B)||o!==null&&o.dependencies!==null&&il(o.dependencies))?(J||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,ee,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,ee,B)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=ee),S.props=m,S.state=ee,S.context=B,m=ie):(typeof S.componentDidUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===o.memoizedProps&&Z===o.memoizedState||(a.flags|=1024),m=!1)}return S=m,Cl(o,a),m=(a.flags&128)!==0,S||m?(S=a.stateNode,u=m&&typeof u.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,o!==null&&m?(a.child=Co(a,o.child,null,x),a.child=Co(a,null,u,x)):Vt(o,a,u,x),a.memoizedState=S.state,o=a.child):o=xi(o,a,x),o}function Wg(o,a,u,m){return xr(),a.flags|=256,Vt(o,a,u,m),a.child}var fd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hd(o){return{baseLanes:o,cachePool:Pm()}}function pd(o,a,u){return o=o!==null?o.childLanes&~u:0,a&&(o|=kn),o}function Kg(o,a,u){var m=a.pendingProps,x=!1,S=(a.flags&128)!==0,T;if((T=S)||(T=o!==null&&o.memoizedState===null?!1:(Lt.current&2)!==0),T&&(x=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,o===null){if(Ke){if(x?ji(a):zi(),Ke){var D=yt,B;if(B=D){e:{for(B=D,D=Yn;B.nodeType!==8;){if(!D){D=null;break e}if(B=qn(B.nextSibling),B===null){D=null;break e}}D=B}D!==null?(a.memoizedState={dehydrated:D,treeContext:Cs!==null?{id:hi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},B=vn(18,null,null,0),B.stateNode=D,B.return=a,a.child=B,Qt=a,yt=null,B=!0):B=!1}B||_s(a)}if(D=a.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return Jd(D)?a.lanes=32:a.lanes=536870912,null;vi(a)}return D=m.children,m=m.fallback,x?(zi(),x=a.mode,D=Al({mode:"hidden",children:D},x),m=Ss(m,x,u,null),D.return=a,m.return=a,D.sibling=m,a.child=D,x=a.child,x.memoizedState=hd(u),x.childLanes=pd(o,T,u),a.memoizedState=fd,m):(ji(a),md(a,D))}if(B=o.memoizedState,B!==null&&(D=B.dehydrated,D!==null)){if(S)a.flags&256?(ji(a),a.flags&=-257,a=gd(o,a,u)):a.memoizedState!==null?(zi(),a.child=o.child,a.flags|=128,a=null):(zi(),x=m.fallback,D=a.mode,m=Al({mode:"visible",children:m.children},D),x=Ss(x,D,u,null),x.flags|=2,m.return=a,x.return=a,m.sibling=x,a.child=m,Co(a,o.child,null,u),m=a.child,m.memoizedState=hd(u),m.childLanes=pd(o,T,u),a.memoizedState=fd,a=x);else if(ji(a),Jd(D)){if(T=D.nextSibling&&D.nextSibling.dataset,T)var J=T.dgst;T=J,m=Error(n(419)),m.stack="",m.digest=T,br({value:m,source:null,stack:null}),a=gd(o,a,u)}else if(Ot||Sr(o,a,u,!1),T=(u&o.childLanes)!==0,Ot||T){if(T=ot,T!==null&&(m=u&-u,m=(m&42)!==0?1:Qc(m),m=(m&(T.suspendedLanes|u))!==0?0:m,m!==0&&m!==B.retryLane))throw B.retryLane=m,uo(o,m),An(T,o,m),Vg;D.data==="$?"||Ld(),a=gd(o,a,u)}else D.data==="$?"?(a.flags|=192,a.child=o.child,a=null):(o=B.treeContext,yt=qn(D.nextSibling),Qt=a,Ke=!0,Es=null,Yn=!1,o!==null&&(Rn[In++]=hi,Rn[In++]=pi,Rn[In++]=Cs,hi=o.id,pi=o.overflow,Cs=a),a=md(a,m.children),a.flags|=4096);return a}return x?(zi(),x=m.fallback,D=a.mode,B=o.child,J=B.sibling,m=fi(B,{mode:"hidden",children:m.children}),m.subtreeFlags=B.subtreeFlags&65011712,J!==null?x=fi(J,x):(x=Ss(x,D,u,null),x.flags|=2),x.return=a,m.return=a,m.sibling=x,a.child=m,m=x,x=a.child,D=o.child.memoizedState,D===null?D=hd(u):(B=D.cachePool,B!==null?(J=kt._currentValue,B=B.parent!==J?{parent:J,pool:J}:B):B=Pm(),D={baseLanes:D.baseLanes|u,cachePool:B}),x.memoizedState=D,x.childLanes=pd(o,T,u),a.memoizedState=fd,m):(ji(a),u=o.child,o=u.sibling,u=fi(u,{mode:"visible",children:m.children}),u.return=a,u.sibling=null,o!==null&&(T=a.deletions,T===null?(a.deletions=[o],a.flags|=16):T.push(o)),a.child=u,a.memoizedState=null,u)}function md(o,a){return a=Al({mode:"visible",children:a},o.mode),a.return=o,o.child=a}function Al(o,a){return o=vn(22,o,null,a),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function gd(o,a,u){return Co(a,o.child,null,u),o=md(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Xg(o,a,u){o.lanes|=a;var m=o.alternate;m!==null&&(m.lanes|=a),Lu(o.return,a,u)}function yd(o,a,u,m,x){var S=o.memoizedState;S===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:x}:(S.isBackwards=a,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=u,S.tailMode=x)}function Jg(o,a,u){var m=a.pendingProps,x=m.revealOrder,S=m.tail;if(Vt(o,a,m.children,u),m=Lt.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Xg(o,u,a);else if(o.tag===19)Xg(o,u,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}m&=1}switch(z(Lt,m),x){case"forwards":for(u=a.child,x=null;u!==null;)o=u.alternate,o!==null&&xl(o)===null&&(x=u),u=u.sibling;u=x,u===null?(x=a.child,a.child=null):(x=u.sibling,u.sibling=null),yd(a,!1,x,u,S);break;case"backwards":for(u=null,x=a.child,a.child=null;x!==null;){if(o=x.alternate,o!==null&&xl(o)===null){a.child=x;break}o=x.sibling,x.sibling=u,u=x,x=o}yd(a,!0,u,null,S);break;case"together":yd(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function xi(o,a,u){if(o!==null&&(a.dependencies=o.dependencies),Xi|=a.lanes,(u&a.childLanes)===0)if(o!==null){if(Sr(o,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(o!==null&&a.child!==o.child)throw Error(n(153));if(a.child!==null){for(o=a.child,u=fi(o,o.pendingProps),a.child=u,u.return=a;o.sibling!==null;)o=o.sibling,u=u.sibling=fi(o,o.pendingProps),u.return=a;u.sibling=null}return a.child}function vd(o,a){return(o.lanes&a)!==0?!0:(o=o.dependencies,!!(o!==null&&il(o)))}function iE(o,a,u){switch(a.tag){case 3:Ne(a,a.stateNode.containerInfo),Bi(a,kt,o.memoizedState.cache),xr();break;case 27:case 5:ke(a);break;case 4:Ne(a,a.stateNode.containerInfo);break;case 10:Bi(a,a.type,a.memoizedProps.value);break;case 13:var m=a.memoizedState;if(m!==null)return m.dehydrated!==null?(ji(a),a.flags|=128,null):(u&a.child.childLanes)!==0?Kg(o,a,u):(ji(a),o=xi(o,a,u),o!==null?o.sibling:null);ji(a);break;case 19:var x=(o.flags&128)!==0;if(m=(u&a.childLanes)!==0,m||(Sr(o,a,u,!1),m=(u&a.childLanes)!==0),x){if(m)return Jg(o,a,u);a.flags|=128}if(x=a.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),z(Lt,Lt.current),m)break;return null;case 22:case 23:return a.lanes=0,jg(o,a,u);case 24:Bi(a,kt,o.memoizedState.cache)}return xi(o,a,u)}function Qg(o,a,u){if(o!==null)if(o.memoizedProps!==a.pendingProps)Ot=!0;else{if(!vd(o,u)&&(a.flags&128)===0)return Ot=!1,iE(o,a,u);Ot=(o.flags&131072)!==0}else Ot=!1,Ke&&(a.flags&1048576)!==0&&Mm(a,nl,a.index);switch(a.lanes=0,a.tag){case 16:e:{o=a.pendingProps;var m=a.elementType,x=m._init;if(m=x(m._payload),a.type=m,typeof m=="function")wu(m)?(o=Rs(m,o),a.tag=1,a=Yg(null,a,m,o,u)):(a.tag=0,a=dd(null,a,m,o,u));else{if(m!=null){if(x=m.$$typeof,x===k){a.tag=11,a=Gg(null,a,m,o,u);break e}else if(x===P){a.tag=14,a=qg(null,a,m,o,u);break e}}throw a=ce(m)||m,Error(n(306,a,""))}}return a;case 0:return dd(o,a,a.type,a.pendingProps,u);case 1:return m=a.type,x=Rs(m,a.pendingProps),Yg(o,a,m,x,u);case 3:e:{if(Ne(a,a.stateNode.containerInfo),o===null)throw Error(n(387));m=a.pendingProps;var S=a.memoizedState;x=S.element,Gu(o,a),Mr(a,m,null,u);var T=a.memoizedState;if(m=T.cache,Bi(a,kt,m),m!==S.cache&&Pu(a,[kt],u,!0),wr(),m=T.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=Wg(o,a,m,u);break e}else if(m!==x){x=Mn(Error(n(424)),a),br(x),a=Wg(o,a,m,u);break e}else{switch(o=a.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(yt=qn(o.firstChild),Qt=a,Ke=!0,Es=null,Yn=!0,u=Rg(a,null,m,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(xr(),m===x){a=xi(o,a,u);break e}Vt(o,a,m,u)}a=a.child}return a;case 26:return Cl(o,a),o===null?(u=n0(a.type,null,a.pendingProps,null))?a.memoizedState=u:Ke||(u=a.type,o=a.pendingProps,m=Ol(he.current).createElement(u),m[$t]=a,m[ln]=o,qt(m,u,o),Ft(m),a.stateNode=m):a.memoizedState=n0(a.type,o.memoizedProps,a.pendingProps,o.memoizedState),null;case 27:return ke(a),o===null&&Ke&&(m=a.stateNode=Zy(a.type,a.pendingProps,he.current),Qt=a,Yn=!0,x=yt,es(a.type)?(Qd=x,yt=qn(m.firstChild)):yt=x),Vt(o,a,a.pendingProps.children,u),Cl(o,a),o===null&&(a.flags|=4194304),a.child;case 5:return o===null&&Ke&&((x=m=yt)&&(m=IE(m,a.type,a.pendingProps,Yn),m!==null?(a.stateNode=m,Qt=a,yt=qn(m.firstChild),Yn=!1,x=!0):x=!1),x||_s(a)),ke(a),x=a.type,S=a.pendingProps,T=o!==null?o.memoizedProps:null,m=S.children,Wd(x,S)?m=null:T!==null&&Wd(x,T)&&(a.flags|=32),a.memoizedState!==null&&(x=Yu(o,a,KA,null,null,u),Xr._currentValue=x),Cl(o,a),Vt(o,a,m,u),a.child;case 6:return o===null&&Ke&&((o=u=yt)&&(u=DE(u,a.pendingProps,Yn),u!==null?(a.stateNode=u,Qt=a,yt=null,o=!0):o=!1),o||_s(a)),null;case 13:return Kg(o,a,u);case 4:return Ne(a,a.stateNode.containerInfo),m=a.pendingProps,o===null?a.child=Co(a,null,m,u):Vt(o,a,m,u),a.child;case 11:return Gg(o,a,a.type,a.pendingProps,u);case 7:return Vt(o,a,a.pendingProps,u),a.child;case 8:return Vt(o,a,a.pendingProps.children,u),a.child;case 12:return Vt(o,a,a.pendingProps.children,u),a.child;case 10:return m=a.pendingProps,Bi(a,a.type,m.value),Vt(o,a,m.children,u),a.child;case 9:return x=a.type._context,m=a.pendingProps.children,ws(a),x=Yt(x),m=m(x),a.flags|=1,Vt(o,a,m,u),a.child;case 14:return qg(o,a,a.type,a.pendingProps,u);case 15:return Hg(o,a,a.type,a.pendingProps,u);case 19:return Jg(o,a,u);case 31:return m=a.pendingProps,u=a.mode,m={mode:m.mode,children:m.children},o===null?(u=Al(m,u),u.ref=a.ref,a.child=u,u.return=a,a=u):(u=fi(o.child,m),u.ref=a.ref,a.child=u,u.return=a,a=u),a;case 22:return jg(o,a,u);case 24:return ws(a),m=Yt(kt),o===null?(x=Uu(),x===null&&(x=ot,S=Fu(),x.pooledCache=S,S.refCount++,S!==null&&(x.pooledCacheLanes|=u),x=S),a.memoizedState={parent:m,cache:x},Vu(a),Bi(a,kt,x)):((o.lanes&u)!==0&&(Gu(o,a),Mr(a,null,null,u),wr()),x=o.memoizedState,S=a.memoizedState,x.parent!==m?(x={parent:m,cache:m},a.memoizedState=x,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=x),Bi(a,kt,m)):(m=S.cache,Bi(a,kt,m),m!==x.cache&&Pu(a,[kt],u,!0))),Vt(o,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function bi(o){o.flags|=4}function Zg(o,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!a0(a)){if(a=Dn.current,a!==null&&((Ye&4194048)===Ye?Wn!==null:(Ye&62914560)!==Ye&&(Ye&536870912)===0||a!==Wn))throw _r=Bu,Fm;o.flags|=8192}}function El(o,a){a!==null&&(o.flags|=4),o.flags&16384&&(a=o.tag!==22?Ip():536870912,o.lanes|=a,To|=a)}function Pr(o,a){if(!Ke)switch(o.tailMode){case"hidden":a=o.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?o.tail=null:u.sibling=null;break;case"collapsed":u=o.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:m.sibling=null}}function pt(o){var a=o.alternate!==null&&o.alternate.child===o.child,u=0,m=0;if(a)for(var x=o.child;x!==null;)u|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=o,x=x.sibling;else for(x=o.child;x!==null;)u|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=o,x=x.sibling;return o.subtreeFlags|=m,o.childLanes=u,a}function sE(o,a,u){var m=a.pendingProps;switch(Iu(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(a),null;case 1:return pt(a),null;case 3:return u=a.stateNode,m=null,o!==null&&(m=o.memoizedState.cache),a.memoizedState.cache!==m&&(a.flags|=2048),gi(kt),Te(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(o===null||o.child===null)&&(vr(a)?bi(a):o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Im())),pt(a),null;case 26:return u=a.memoizedState,o===null?(bi(a),u!==null?(pt(a),Zg(a,u)):(pt(a),a.flags&=-16777217)):u?u!==o.memoizedState?(bi(a),pt(a),Zg(a,u)):(pt(a),a.flags&=-16777217):(o.memoizedProps!==m&&bi(a),pt(a),a.flags&=-16777217),null;case 27:$e(a),u=he.current;var x=a.type;if(o!==null&&a.stateNode!=null)o.memoizedProps!==m&&bi(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return pt(a),null}o=le.current,vr(a)?Nm(a):(o=Zy(x,m,u),a.stateNode=o,bi(a))}return pt(a),null;case 5:if($e(a),u=a.type,o!==null&&a.stateNode!=null)o.memoizedProps!==m&&bi(a);else{if(!m){if(a.stateNode===null)throw Error(n(166));return pt(a),null}if(o=le.current,vr(a))Nm(a);else{switch(x=Ol(he.current),o){case 1:o=x.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:o=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":o=x.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":o=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":o=x.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?o.multiple=!0:m.size&&(o.size=m.size);break;default:o=typeof m.is=="string"?x.createElement(u,{is:m.is}):x.createElement(u)}}o[$t]=a,o[ln]=m;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)o.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=o;e:switch(qt(o,u,m),u){case"button":case"input":case"select":case"textarea":o=!!m.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&bi(a)}}return pt(a),a.flags&=-16777217,null;case 6:if(o&&a.stateNode!=null)o.memoizedProps!==m&&bi(a);else{if(typeof m!="string"&&a.stateNode===null)throw Error(n(166));if(o=he.current,vr(a)){if(o=a.stateNode,u=a.memoizedProps,m=null,x=Qt,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}o[$t]=a,o=!!(o.nodeValue===u||m!==null&&m.suppressHydrationWarning===!0||$y(o.nodeValue,u)),o||_s(a)}else o=Ol(o).createTextNode(m),o[$t]=a,a.stateNode=o}return pt(a),null;case 13:if(m=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(x=vr(a),m!==null&&m.dehydrated!==null){if(o===null){if(!x)throw Error(n(318));if(x=a.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[$t]=a}else xr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;pt(a),x=!1}else x=Im(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=x),x=!0;if(!x)return a.flags&256?(vi(a),a):(vi(a),null)}if(vi(a),(a.flags&128)!==0)return a.lanes=u,a;if(u=m!==null,o=o!==null&&o.memoizedState!==null,u){m=a.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var S=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),S!==x&&(m.flags|=2048)}return u!==o&&u&&(a.child.flags|=8192),El(a,a.updateQueue),pt(a),null;case 4:return Te(),o===null&&Hd(a.stateNode.containerInfo),pt(a),null;case 10:return gi(a.type),pt(a),null;case 19:if(W(Lt),x=a.memoizedState,x===null)return pt(a),null;if(m=(a.flags&128)!==0,S=x.rendering,S===null)if(m)Pr(x,!1);else{if(vt!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(S=xl(o),S!==null){for(a.flags|=128,Pr(x,!1),o=S.updateQueue,a.updateQueue=o,El(a,o),a.subtreeFlags=0,o=u,u=a.child;u!==null;)wm(u,o),u=u.sibling;return z(Lt,Lt.current&1|2),a.child}o=o.sibling}x.tail!==null&&an()>wl&&(a.flags|=128,m=!0,Pr(x,!1),a.lanes=4194304)}else{if(!m)if(o=xl(S),o!==null){if(a.flags|=128,m=!0,o=o.updateQueue,a.updateQueue=o,El(a,o),Pr(x,!0),x.tail===null&&x.tailMode==="hidden"&&!S.alternate&&!Ke)return pt(a),null}else 2*an()-x.renderingStartTime>wl&&u!==536870912&&(a.flags|=128,m=!0,Pr(x,!1),a.lanes=4194304);x.isBackwards?(S.sibling=a.child,a.child=S):(o=x.last,o!==null?o.sibling=S:a.child=S,x.last=S)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=an(),a.sibling=null,o=Lt.current,z(Lt,m?o&1|2:o&1),a):(pt(a),null);case 22:case 23:return vi(a),zu(),m=a.memoizedState!==null,o!==null?o.memoizedState!==null!==m&&(a.flags|=8192):m&&(a.flags|=8192),m?(u&536870912)!==0&&(a.flags&128)===0&&(pt(a),a.subtreeFlags&6&&(a.flags|=8192)):pt(a),u=a.updateQueue,u!==null&&El(a,u.retryQueue),u=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),m=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),m!==u&&(a.flags|=2048),o!==null&&W(Ms),null;case 24:return u=null,o!==null&&(u=o.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),gi(kt),pt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function oE(o,a){switch(Iu(a),a.tag){case 1:return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return gi(kt),Te(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 26:case 27:case 5:return $e(a),null;case 13:if(vi(a),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(n(340));xr()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return W(Lt),null;case 4:return Te(),null;case 10:return gi(a.type),null;case 22:case 23:return vi(a),zu(),o!==null&&W(Ms),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 24:return gi(kt),null;case 25:return null;default:return null}}function ey(o,a){switch(Iu(a),a.tag){case 3:gi(kt),Te();break;case 26:case 27:case 5:$e(a);break;case 4:Te();break;case 13:vi(a);break;case 19:W(Lt);break;case 10:gi(a.type);break;case 22:case 23:vi(a),zu(),o!==null&&W(Ms);break;case 24:gi(kt)}}function Fr(o,a){try{var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var x=m.next;u=x;do{if((u.tag&o)===o){m=void 0;var S=u.create,T=u.inst;m=S(),T.destroy=m}u=u.next}while(u!==x)}}catch(D){it(a,a.return,D)}}function $i(o,a,u){try{var m=a.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var S=x.next;m=S;do{if((m.tag&o)===o){var T=m.inst,D=T.destroy;if(D!==void 0){T.destroy=void 0,x=a;var B=u,J=D;try{J()}catch(ie){it(x,B,ie)}}}m=m.next}while(m!==S)}}catch(ie){it(a,a.return,ie)}}function ty(o){var a=o.updateQueue;if(a!==null){var u=o.stateNode;try{qm(a,u)}catch(m){it(o,o.return,m)}}}function ny(o,a,u){u.props=Rs(o.type,o.memoizedProps),u.state=o.memoizedState;try{u.componentWillUnmount()}catch(m){it(o,a,m)}}function Or(o,a){try{var u=o.ref;if(u!==null){switch(o.tag){case 26:case 27:case 5:var m=o.stateNode;break;case 30:m=o.stateNode;break;default:m=o.stateNode}typeof u=="function"?o.refCleanup=u(m):u.current=m}}catch(x){it(o,a,x)}}function Kn(o,a){var u=o.ref,m=o.refCleanup;if(u!==null)if(typeof m=="function")try{m()}catch(x){it(o,a,x)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){it(o,a,x)}else u.current=null}function iy(o){var a=o.type,u=o.memoizedProps,m=o.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&m.focus();break e;case"img":u.src?m.src=u.src:u.srcSet&&(m.srcset=u.srcSet)}}catch(x){it(o,o.return,x)}}function xd(o,a,u){try{var m=o.stateNode;TE(m,o.type,u,a),m[ln]=a}catch(x){it(o,o.return,x)}}function sy(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&es(o.type)||o.tag===4}function bd(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||sy(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&es(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Sd(o,a,u){var m=o.tag;if(m===5||m===6)o=o.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(o,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(o),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=Fl));else if(m!==4&&(m===27&&es(o.type)&&(u=o.stateNode,a=null),o=o.child,o!==null))for(Sd(o,a,u),o=o.sibling;o!==null;)Sd(o,a,u),o=o.sibling}function _l(o,a,u){var m=o.tag;if(m===5||m===6)o=o.stateNode,a?u.insertBefore(o,a):u.appendChild(o);else if(m!==4&&(m===27&&es(o.type)&&(u=o.stateNode),o=o.child,o!==null))for(_l(o,a,u),o=o.sibling;o!==null;)_l(o,a,u),o=o.sibling}function oy(o){var a=o.stateNode,u=o.memoizedProps;try{for(var m=o.type,x=a.attributes;x.length;)a.removeAttributeNode(x[0]);qt(a,m,u),a[$t]=o,a[ln]=u}catch(S){it(o,o.return,S)}}var Si=!1,St=!1,Cd=!1,ry=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function rE(o,a){if(o=o.containerInfo,$d=Hl,o=ym(o),bu(o)){if("selectionStart"in o)var u={start:o.selectionStart,end:o.selectionEnd};else e:{u=(u=o.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var x=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var T=0,D=-1,B=-1,J=0,ie=0,re=o,Z=null;t:for(;;){for(var ee;re!==u||x!==0&&re.nodeType!==3||(D=T+x),re!==S||m!==0&&re.nodeType!==3||(B=T+m),re.nodeType===3&&(T+=re.nodeValue.length),(ee=re.firstChild)!==null;)Z=re,re=ee;for(;;){if(re===o)break t;if(Z===u&&++J===x&&(D=T),Z===S&&++ie===m&&(B=T),(ee=re.nextSibling)!==null)break;re=Z,Z=re.parentNode}re=ee}u=D===-1||B===-1?null:{start:D,end:B}}else u=null}u=u||{start:0,end:0}}else u=null;for(Yd={focusedElem:o,selectionRange:u},Hl=!1,Ut=a;Ut!==null;)if(a=Ut,o=a.child,(a.subtreeFlags&1024)!==0&&o!==null)o.return=a,Ut=o;else for(;Ut!==null;){switch(a=Ut,S=a.alternate,o=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&S!==null){o=void 0,u=a,x=S.memoizedProps,S=S.memoizedState,m=u.stateNode;try{var De=Rs(u.type,x,u.elementType===u.type);o=m.getSnapshotBeforeUpdate(De,S),m.__reactInternalSnapshotBeforeUpdate=o}catch(Me){it(u,u.return,Me)}}break;case 3:if((o&1024)!==0){if(o=a.stateNode.containerInfo,u=o.nodeType,u===9)Xd(o);else if(u===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Xd(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=a.sibling,o!==null){o.return=a.return,Ut=o;break}Ut=a.return}}function ay(o,a,u){var m=u.flags;switch(u.tag){case 0:case 11:case 15:Yi(o,u),m&4&&Fr(5,u);break;case 1:if(Yi(o,u),m&4)if(o=u.stateNode,a===null)try{o.componentDidMount()}catch(T){it(u,u.return,T)}else{var x=Rs(u.type,a.memoizedProps);a=a.memoizedState;try{o.componentDidUpdate(x,a,o.__reactInternalSnapshotBeforeUpdate)}catch(T){it(u,u.return,T)}}m&64&&ty(u),m&512&&Or(u,u.return);break;case 3:if(Yi(o,u),m&64&&(o=u.updateQueue,o!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{qm(o,a)}catch(T){it(u,u.return,T)}}break;case 27:a===null&&m&4&&oy(u);case 26:case 5:Yi(o,u),a===null&&m&4&&iy(u),m&512&&Or(u,u.return);break;case 12:Yi(o,u);break;case 13:Yi(o,u),m&4&&uy(o,u),m&64&&(o=u.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(u=mE.bind(null,u),kE(o,u))));break;case 22:if(m=u.memoizedState!==null||Si,!m){a=a!==null&&a.memoizedState!==null||St,x=Si;var S=St;Si=m,(St=a)&&!S?Wi(o,u,(u.subtreeFlags&8772)!==0):Yi(o,u),Si=x,St=S}break;case 30:break;default:Yi(o,u)}}function ly(o){var a=o.alternate;a!==null&&(o.alternate=null,ly(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&tu(a)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var lt=null,dn=!1;function Ci(o,a,u){for(u=u.child;u!==null;)cy(o,a,u),u=u.sibling}function cy(o,a,u){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(Se,u)}catch{}switch(u.tag){case 26:St||Kn(u,a),Ci(o,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:St||Kn(u,a);var m=lt,x=dn;es(u.type)&&(lt=u.stateNode,dn=!1),Ci(o,a,u),$r(u.stateNode),lt=m,dn=x;break;case 5:St||Kn(u,a);case 6:if(m=lt,x=dn,lt=null,Ci(o,a,u),lt=m,dn=x,lt!==null)if(dn)try{(lt.nodeType===9?lt.body:lt.nodeName==="HTML"?lt.ownerDocument.body:lt).removeChild(u.stateNode)}catch(S){it(u,a,S)}else try{lt.removeChild(u.stateNode)}catch(S){it(u,a,S)}break;case 18:lt!==null&&(dn?(o=lt,Jy(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,u.stateNode),ea(o)):Jy(lt,u.stateNode));break;case 4:m=lt,x=dn,lt=u.stateNode.containerInfo,dn=!0,Ci(o,a,u),lt=m,dn=x;break;case 0:case 11:case 14:case 15:St||$i(2,u,a),St||$i(4,u,a),Ci(o,a,u);break;case 1:St||(Kn(u,a),m=u.stateNode,typeof m.componentWillUnmount=="function"&&ny(u,a,m)),Ci(o,a,u);break;case 21:Ci(o,a,u);break;case 22:St=(m=St)||u.memoizedState!==null,Ci(o,a,u),St=m;break;default:Ci(o,a,u)}}function uy(o,a){if(a.memoizedState===null&&(o=a.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{ea(o)}catch(u){it(a,a.return,u)}}function aE(o){switch(o.tag){case 13:case 19:var a=o.stateNode;return a===null&&(a=o.stateNode=new ry),a;case 22:return o=o.stateNode,a=o._retryCache,a===null&&(a=o._retryCache=new ry),a;default:throw Error(n(435,o.tag))}}function Ad(o,a){var u=aE(o);a.forEach(function(m){var x=gE.bind(null,o,m);u.has(m)||(u.add(m),m.then(x,x))})}function xn(o,a){var u=a.deletions;if(u!==null)for(var m=0;m<u.length;m++){var x=u[m],S=o,T=a,D=T;e:for(;D!==null;){switch(D.tag){case 27:if(es(D.type)){lt=D.stateNode,dn=!1;break e}break;case 5:lt=D.stateNode,dn=!1;break e;case 3:case 4:lt=D.stateNode.containerInfo,dn=!0;break e}D=D.return}if(lt===null)throw Error(n(160));cy(S,T,x),lt=null,dn=!1,S=x.alternate,S!==null&&(S.return=null),x.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)dy(a,o),a=a.sibling}var Gn=null;function dy(o,a){var u=o.alternate,m=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:xn(a,o),bn(o),m&4&&($i(3,o,o.return),Fr(3,o),$i(5,o,o.return));break;case 1:xn(a,o),bn(o),m&512&&(St||u===null||Kn(u,u.return)),m&64&&Si&&(o=o.updateQueue,o!==null&&(m=o.callbacks,m!==null&&(u=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=u===null?m:u.concat(m))));break;case 26:var x=Gn;if(xn(a,o),bn(o),m&512&&(St||u===null||Kn(u,u.return)),m&4){var S=u!==null?u.memoizedState:null;if(m=o.memoizedState,u===null)if(m===null)if(o.stateNode===null){e:{m=o.type,u=o.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":S=x.getElementsByTagName("title")[0],(!S||S[ar]||S[$t]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=x.createElement(m),x.head.insertBefore(S,x.querySelector("head > title"))),qt(S,m,u),S[$t]=o,Ft(S),m=S;break e;case"link":var T=o0("link","href",x).get(m+(u.href||""));if(T){for(var D=0;D<T.length;D++)if(S=T[D],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(D,1);break t}}S=x.createElement(m),qt(S,m,u),x.head.appendChild(S);break;case"meta":if(T=o0("meta","content",x).get(m+(u.content||""))){for(D=0;D<T.length;D++)if(S=T[D],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(D,1);break t}}S=x.createElement(m),qt(S,m,u),x.head.appendChild(S);break;default:throw Error(n(468,m))}S[$t]=o,Ft(S),m=S}o.stateNode=m}else r0(x,o.type,o.stateNode);else o.stateNode=s0(x,m,o.memoizedProps);else S!==m?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,m===null?r0(x,o.type,o.stateNode):s0(x,m,o.memoizedProps)):m===null&&o.stateNode!==null&&xd(o,o.memoizedProps,u.memoizedProps)}break;case 27:xn(a,o),bn(o),m&512&&(St||u===null||Kn(u,u.return)),u!==null&&m&4&&xd(o,o.memoizedProps,u.memoizedProps);break;case 5:if(xn(a,o),bn(o),m&512&&(St||u===null||Kn(u,u.return)),o.flags&32){x=o.stateNode;try{io(x,"")}catch(ee){it(o,o.return,ee)}}m&4&&o.stateNode!=null&&(x=o.memoizedProps,xd(o,x,u!==null?u.memoizedProps:x)),m&1024&&(Cd=!0);break;case 6:if(xn(a,o),bn(o),m&4){if(o.stateNode===null)throw Error(n(162));m=o.memoizedProps,u=o.stateNode;try{u.nodeValue=m}catch(ee){it(o,o.return,ee)}}break;case 3:if(Vl=null,x=Gn,Gn=Ul(a.containerInfo),xn(a,o),Gn=x,bn(o),m&4&&u!==null&&u.memoizedState.isDehydrated)try{ea(a.containerInfo)}catch(ee){it(o,o.return,ee)}Cd&&(Cd=!1,fy(o));break;case 4:m=Gn,Gn=Ul(o.stateNode.containerInfo),xn(a,o),bn(o),Gn=m;break;case 12:xn(a,o),bn(o);break;case 13:xn(a,o),bn(o),o.child.flags&8192&&o.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Nd=an()),m&4&&(m=o.updateQueue,m!==null&&(o.updateQueue=null,Ad(o,m)));break;case 22:x=o.memoizedState!==null;var B=u!==null&&u.memoizedState!==null,J=Si,ie=St;if(Si=J||x,St=ie||B,xn(a,o),St=ie,Si=J,bn(o),m&8192)e:for(a=o.stateNode,a._visibility=x?a._visibility&-2:a._visibility|1,x&&(u===null||B||Si||St||Is(o)),u=null,a=o;;){if(a.tag===5||a.tag===26){if(u===null){B=u=a;try{if(S=B.stateNode,x)T=S.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{D=B.stateNode;var re=B.memoizedProps.style,Z=re!=null&&re.hasOwnProperty("display")?re.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(ee){it(B,B.return,ee)}}}else if(a.tag===6){if(u===null){B=a;try{B.stateNode.nodeValue=x?"":B.memoizedProps}catch(ee){it(B,B.return,ee)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===o)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}m&4&&(m=o.updateQueue,m!==null&&(u=m.retryQueue,u!==null&&(m.retryQueue=null,Ad(o,u))));break;case 19:xn(a,o),bn(o),m&4&&(m=o.updateQueue,m!==null&&(o.updateQueue=null,Ad(o,m)));break;case 30:break;case 21:break;default:xn(a,o),bn(o)}}function bn(o){var a=o.flags;if(a&2){try{for(var u,m=o.return;m!==null;){if(sy(m)){u=m;break}m=m.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var x=u.stateNode,S=bd(o);_l(o,S,x);break;case 5:var T=u.stateNode;u.flags&32&&(io(T,""),u.flags&=-33);var D=bd(o);_l(o,D,T);break;case 3:case 4:var B=u.stateNode.containerInfo,J=bd(o);Sd(o,J,B);break;default:throw Error(n(161))}}catch(ie){it(o,o.return,ie)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function fy(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var a=o;fy(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),o=o.sibling}}function Yi(o,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)ay(o,a.alternate,a),a=a.sibling}function Is(o){for(o=o.child;o!==null;){var a=o;switch(a.tag){case 0:case 11:case 14:case 15:$i(4,a,a.return),Is(a);break;case 1:Kn(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&ny(a,a.return,u),Is(a);break;case 27:$r(a.stateNode);case 26:case 5:Kn(a,a.return),Is(a);break;case 22:a.memoizedState===null&&Is(a);break;case 30:Is(a);break;default:Is(a)}o=o.sibling}}function Wi(o,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var m=a.alternate,x=o,S=a,T=S.flags;switch(S.tag){case 0:case 11:case 15:Wi(x,S,u),Fr(4,S);break;case 1:if(Wi(x,S,u),m=S,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(J){it(m,m.return,J)}if(m=S,x=m.updateQueue,x!==null){var D=m.stateNode;try{var B=x.shared.hiddenCallbacks;if(B!==null)for(x.shared.hiddenCallbacks=null,x=0;x<B.length;x++)Gm(B[x],D)}catch(J){it(m,m.return,J)}}u&&T&64&&ty(S),Or(S,S.return);break;case 27:oy(S);case 26:case 5:Wi(x,S,u),u&&m===null&&T&4&&iy(S),Or(S,S.return);break;case 12:Wi(x,S,u);break;case 13:Wi(x,S,u),u&&T&4&&uy(x,S);break;case 22:S.memoizedState===null&&Wi(x,S,u),Or(S,S.return);break;case 30:break;default:Wi(x,S,u)}a=a.sibling}}function Ed(o,a){var u=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),o=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),o!==u&&(o!=null&&o.refCount++,u!=null&&Cr(u))}function _d(o,a){o=null,a.alternate!==null&&(o=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==o&&(a.refCount++,o!=null&&Cr(o))}function Xn(o,a,u,m){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)hy(o,a,u,m),a=a.sibling}function hy(o,a,u,m){var x=a.flags;switch(a.tag){case 0:case 11:case 15:Xn(o,a,u,m),x&2048&&Fr(9,a);break;case 1:Xn(o,a,u,m);break;case 3:Xn(o,a,u,m),x&2048&&(o=null,a.alternate!==null&&(o=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==o&&(a.refCount++,o!=null&&Cr(o)));break;case 12:if(x&2048){Xn(o,a,u,m),o=a.stateNode;try{var S=a.memoizedProps,T=S.id,D=S.onPostCommit;typeof D=="function"&&D(T,a.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(B){it(a,a.return,B)}}else Xn(o,a,u,m);break;case 13:Xn(o,a,u,m);break;case 23:break;case 22:S=a.stateNode,T=a.alternate,a.memoizedState!==null?S._visibility&2?Xn(o,a,u,m):Ur(o,a):S._visibility&2?Xn(o,a,u,m):(S._visibility|=2,Ao(o,a,u,m,(a.subtreeFlags&10256)!==0)),x&2048&&Ed(T,a);break;case 24:Xn(o,a,u,m),x&2048&&_d(a.alternate,a);break;default:Xn(o,a,u,m)}}function Ao(o,a,u,m,x){for(x=x&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var S=o,T=a,D=u,B=m,J=T.flags;switch(T.tag){case 0:case 11:case 15:Ao(S,T,D,B,x),Fr(8,T);break;case 23:break;case 22:var ie=T.stateNode;T.memoizedState!==null?ie._visibility&2?Ao(S,T,D,B,x):Ur(S,T):(ie._visibility|=2,Ao(S,T,D,B,x)),x&&J&2048&&Ed(T.alternate,T);break;case 24:Ao(S,T,D,B,x),x&&J&2048&&_d(T.alternate,T);break;default:Ao(S,T,D,B,x)}a=a.sibling}}function Ur(o,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=o,m=a,x=m.flags;switch(m.tag){case 22:Ur(u,m),x&2048&&Ed(m.alternate,m);break;case 24:Ur(u,m),x&2048&&_d(m.alternate,m);break;default:Ur(u,m)}a=a.sibling}}var Br=8192;function Eo(o){if(o.subtreeFlags&Br)for(o=o.child;o!==null;)py(o),o=o.sibling}function py(o){switch(o.tag){case 26:Eo(o),o.flags&Br&&o.memoizedState!==null&&$E(Gn,o.memoizedState,o.memoizedProps);break;case 5:Eo(o);break;case 3:case 4:var a=Gn;Gn=Ul(o.stateNode.containerInfo),Eo(o),Gn=a;break;case 22:o.memoizedState===null&&(a=o.alternate,a!==null&&a.memoizedState!==null?(a=Br,Br=16777216,Eo(o),Br=a):Eo(o));break;default:Eo(o)}}function my(o){var a=o.alternate;if(a!==null&&(o=a.child,o!==null)){a.child=null;do a=o.sibling,o.sibling=null,o=a;while(o!==null)}}function Vr(o){var a=o.deletions;if((o.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var m=a[u];Ut=m,yy(m,o)}my(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)gy(o),o=o.sibling}function gy(o){switch(o.tag){case 0:case 11:case 15:Vr(o),o.flags&2048&&$i(9,o,o.return);break;case 3:Vr(o);break;case 12:Vr(o);break;case 22:var a=o.stateNode;o.memoizedState!==null&&a._visibility&2&&(o.return===null||o.return.tag!==13)?(a._visibility&=-3,Tl(o)):Vr(o);break;default:Vr(o)}}function Tl(o){var a=o.deletions;if((o.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var m=a[u];Ut=m,yy(m,o)}my(o)}for(o=o.child;o!==null;){switch(a=o,a.tag){case 0:case 11:case 15:$i(8,a,a.return),Tl(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,Tl(a));break;default:Tl(a)}o=o.sibling}}function yy(o,a){for(;Ut!==null;){var u=Ut;switch(u.tag){case 0:case 11:case 15:$i(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var m=u.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Cr(u.memoizedState.cache)}if(m=u.child,m!==null)m.return=u,Ut=m;else e:for(u=o;Ut!==null;){m=Ut;var x=m.sibling,S=m.return;if(ly(m),m===u){Ut=null;break e}if(x!==null){x.return=S,Ut=x;break e}Ut=S}}}var lE={getCacheForType:function(o){var a=Yt(kt),u=a.data.get(o);return u===void 0&&(u=o(),a.data.set(o,u)),u}},cE=typeof WeakMap=="function"?WeakMap:Map,Xe=0,ot=null,qe=null,Ye=0,Je=0,Sn=null,Ki=!1,_o=!1,Td=!1,Ai=0,vt=0,Xi=0,Ds=0,wd=0,kn=0,To=0,Gr=null,fn=null,Md=!1,Nd=0,wl=1/0,Ml=null,Ji=null,Gt=0,Qi=null,wo=null,Mo=0,Rd=0,Id=null,vy=null,qr=0,Dd=null;function Cn(){if((Xe&2)!==0&&Ye!==0)return Ye&-Ye;if(U.T!==null){var o=mo;return o!==0?o:Bd()}return Lp()}function xy(){kn===0&&(kn=(Ye&536870912)===0||Ke?Rp():536870912);var o=Dn.current;return o!==null&&(o.flags|=32),kn}function An(o,a,u){(o===ot&&(Je===2||Je===9)||o.cancelPendingCommit!==null)&&(No(o,0),Zi(o,Ye,kn,!1)),rr(o,u),((Xe&2)===0||o!==ot)&&(o===ot&&((Xe&2)===0&&(Ds|=u),vt===4&&Zi(o,Ye,kn,!1)),Jn(o))}function by(o,a,u){if((Xe&6)!==0)throw Error(n(327));var m=!u&&(a&124)===0&&(a&o.expiredLanes)===0||gs(o,a),x=m?fE(o,a):Pd(o,a,!0),S=m;do{if(x===0){_o&&!m&&Zi(o,a,0,!1);break}else{if(u=o.current.alternate,S&&!uE(u)){x=Pd(o,a,!1),S=!1;continue}if(x===2){if(S=a,o.errorRecoveryDisabledLanes&S)var T=0;else T=o.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var D=o;x=Gr;var B=D.current.memoizedState.isDehydrated;if(B&&(No(D,T).flags|=256),T=Pd(D,T,!1),T!==2){if(Td&&!B){D.errorRecoveryDisabledLanes|=S,Ds|=S,x=4;break e}S=fn,fn=x,S!==null&&(fn===null?fn=S:fn.push.apply(fn,S))}x=T}if(S=!1,x!==2)continue}}if(x===1){No(o,0),Zi(o,a,0,!0);break}e:{switch(m=o,S=x,S){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Zi(m,a,kn,!Ki);break e;case 2:fn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(x=Nd+300-an(),10<x)){if(Zi(m,a,kn,!Ki),ms(m,0,!0)!==0)break e;m.timeoutHandle=Ky(Sy.bind(null,m,u,fn,Ml,Md,a,kn,Ds,To,Ki,S,2,-0,0),x);break e}Sy(m,u,fn,Ml,Md,a,kn,Ds,To,Ki,S,0,-0,0)}}break}while(!0);Jn(o)}function Sy(o,a,u,m,x,S,T,D,B,J,ie,re,Z,ee){if(o.timeoutHandle=-1,re=a.subtreeFlags,(re&8192||(re&16785408)===16785408)&&(Kr={stylesheets:null,count:0,unsuspend:zE},py(a),re=YE(),re!==null)){o.cancelPendingCommit=re(My.bind(null,o,a,S,u,m,x,T,D,B,ie,1,Z,ee)),Zi(o,S,T,!J);return}My(o,a,S,u,m,x,T,D,B)}function uE(o){for(var a=o;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var m=0;m<u.length;m++){var x=u[m],S=x.getSnapshot;x=x.value;try{if(!yn(S(),x))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Zi(o,a,u,m){a&=~wd,a&=~Ds,o.suspendedLanes|=a,o.pingedLanes&=~a,m&&(o.warmLanes|=a),m=o.expirationTimes;for(var x=a;0<x;){var S=31-st(x),T=1<<S;m[S]=-1,x&=~T}u!==0&&Dp(o,u,a)}function Nl(){return(Xe&6)===0?(Hr(0),!1):!0}function kd(){if(qe!==null){if(Je===0)var o=qe.return;else o=qe,mi=Ts=null,Xu(o),So=null,kr=0,o=qe;for(;o!==null;)ey(o.alternate,o),o=o.return;qe=null}}function No(o,a){var u=o.timeoutHandle;u!==-1&&(o.timeoutHandle=-1,ME(u)),u=o.cancelPendingCommit,u!==null&&(o.cancelPendingCommit=null,u()),kd(),ot=o,qe=u=fi(o.current,null),Ye=a,Je=0,Sn=null,Ki=!1,_o=gs(o,a),Td=!1,To=kn=wd=Ds=Xi=vt=0,fn=Gr=null,Md=!1,(a&8)!==0&&(a|=a&32);var m=o.entangledLanes;if(m!==0)for(o=o.entanglements,m&=a;0<m;){var x=31-st(m),S=1<<x;a|=o[x],m&=~S}return Ai=a,Ja(),u}function Cy(o,a){Ue=null,U.H=gl,a===Er||a===rl?(a=Bm(),Je=3):a===Fm?(a=Bm(),Je=4):Je=a===Vg?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Sn=a,qe===null&&(vt=1,Sl(o,Mn(a,o.current)))}function Ay(){var o=U.H;return U.H=gl,o===null?gl:o}function Ey(){var o=U.A;return U.A=lE,o}function Ld(){vt=4,Ki||(Ye&4194048)!==Ye&&Dn.current!==null||(_o=!0),(Xi&134217727)===0&&(Ds&134217727)===0||ot===null||Zi(ot,Ye,kn,!1)}function Pd(o,a,u){var m=Xe;Xe|=2;var x=Ay(),S=Ey();(ot!==o||Ye!==a)&&(Ml=null,No(o,a)),a=!1;var T=vt;e:do try{if(Je!==0&&qe!==null){var D=qe,B=Sn;switch(Je){case 8:kd(),T=6;break e;case 3:case 2:case 9:case 6:Dn.current===null&&(a=!0);var J=Je;if(Je=0,Sn=null,Ro(o,D,B,J),u&&_o){T=0;break e}break;default:J=Je,Je=0,Sn=null,Ro(o,D,B,J)}}dE(),T=vt;break}catch(ie){Cy(o,ie)}while(!0);return a&&o.shellSuspendCounter++,mi=Ts=null,Xe=m,U.H=x,U.A=S,qe===null&&(ot=null,Ye=0,Ja()),T}function dE(){for(;qe!==null;)_y(qe)}function fE(o,a){var u=Xe;Xe|=2;var m=Ay(),x=Ey();ot!==o||Ye!==a?(Ml=null,wl=an()+500,No(o,a)):_o=gs(o,a);e:do try{if(Je!==0&&qe!==null){a=qe;var S=Sn;t:switch(Je){case 1:Je=0,Sn=null,Ro(o,a,S,1);break;case 2:case 9:if(Om(S)){Je=0,Sn=null,Ty(a);break}a=function(){Je!==2&&Je!==9||ot!==o||(Je=7),Jn(o)},S.then(a,a);break e;case 3:Je=7;break e;case 4:Je=5;break e;case 7:Om(S)?(Je=0,Sn=null,Ty(a)):(Je=0,Sn=null,Ro(o,a,S,7));break;case 5:var T=null;switch(qe.tag){case 26:T=qe.memoizedState;case 5:case 27:var D=qe;if(!T||a0(T)){Je=0,Sn=null;var B=D.sibling;if(B!==null)qe=B;else{var J=D.return;J!==null?(qe=J,Rl(J)):qe=null}break t}}Je=0,Sn=null,Ro(o,a,S,5);break;case 6:Je=0,Sn=null,Ro(o,a,S,6);break;case 8:kd(),vt=6;break e;default:throw Error(n(462))}}hE();break}catch(ie){Cy(o,ie)}while(!0);return mi=Ts=null,U.H=m,U.A=x,Xe=u,qe!==null?0:(ot=null,Ye=0,Ja(),vt)}function hE(){for(;qe!==null&&!sr();)_y(qe)}function _y(o){var a=Qg(o.alternate,o,Ai);o.memoizedProps=o.pendingProps,a===null?Rl(o):qe=a}function Ty(o){var a=o,u=a.alternate;switch(a.tag){case 15:case 0:a=$g(u,a,a.pendingProps,a.type,void 0,Ye);break;case 11:a=$g(u,a,a.pendingProps,a.type.render,a.ref,Ye);break;case 5:Xu(a);default:ey(u,a),a=qe=wm(a,Ai),a=Qg(u,a,Ai)}o.memoizedProps=o.pendingProps,a===null?Rl(o):qe=a}function Ro(o,a,u,m){mi=Ts=null,Xu(a),So=null,kr=0;var x=a.return;try{if(nE(o,x,a,u,Ye)){vt=1,Sl(o,Mn(u,o.current)),qe=null;return}}catch(S){if(x!==null)throw qe=x,S;vt=1,Sl(o,Mn(u,o.current)),qe=null;return}a.flags&32768?(Ke||m===1?o=!0:_o||(Ye&536870912)!==0?o=!1:(Ki=o=!0,(m===2||m===9||m===3||m===6)&&(m=Dn.current,m!==null&&m.tag===13&&(m.flags|=16384))),wy(a,o)):Rl(a)}function Rl(o){var a=o;do{if((a.flags&32768)!==0){wy(a,Ki);return}o=a.return;var u=sE(a.alternate,a,Ai);if(u!==null){qe=u;return}if(a=a.sibling,a!==null){qe=a;return}qe=a=o}while(a!==null);vt===0&&(vt=5)}function wy(o,a){do{var u=oE(o.alternate,o);if(u!==null){u.flags&=32767,qe=u;return}if(u=o.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(o=o.sibling,o!==null)){qe=o;return}qe=o=u}while(o!==null);vt=6,qe=null}function My(o,a,u,m,x,S,T,D,B){o.cancelPendingCommit=null;do Il();while(Gt!==0);if((Xe&6)!==0)throw Error(n(327));if(a!==null){if(a===o.current)throw Error(n(177));if(S=a.lanes|a.childLanes,S|=_u,zC(o,u,S,T,D,B),o===ot&&(qe=ot=null,Ye=0),wo=a,Qi=o,Mo=u,Rd=S,Id=x,vy=m,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,yE(Q,function(){return ky(),null})):(o.callbackNode=null,o.callbackPriority=0),m=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||m){m=U.T,U.T=null,x=X.p,X.p=2,T=Xe,Xe|=4;try{rE(o,a,u)}finally{Xe=T,X.p=x,U.T=m}}Gt=1,Ny(),Ry(),Iy()}}function Ny(){if(Gt===1){Gt=0;var o=Qi,a=wo,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=U.T,U.T=null;var m=X.p;X.p=2;var x=Xe;Xe|=4;try{dy(a,o);var S=Yd,T=ym(o.containerInfo),D=S.focusedElem,B=S.selectionRange;if(T!==D&&D&&D.ownerDocument&&gm(D.ownerDocument.documentElement,D)){if(B!==null&&bu(D)){var J=B.start,ie=B.end;if(ie===void 0&&(ie=J),"selectionStart"in D)D.selectionStart=J,D.selectionEnd=Math.min(ie,D.value.length);else{var re=D.ownerDocument||document,Z=re&&re.defaultView||window;if(Z.getSelection){var ee=Z.getSelection(),De=D.textContent.length,Me=Math.min(B.start,De),tt=B.end===void 0?Me:Math.min(B.end,De);!ee.extend&&Me>tt&&(T=tt,tt=Me,Me=T);var j=mm(D,Me),H=mm(D,tt);if(j&&H&&(ee.rangeCount!==1||ee.anchorNode!==j.node||ee.anchorOffset!==j.offset||ee.focusNode!==H.node||ee.focusOffset!==H.offset)){var Y=re.createRange();Y.setStart(j.node,j.offset),ee.removeAllRanges(),Me>tt?(ee.addRange(Y),ee.extend(H.node,H.offset)):(Y.setEnd(H.node,H.offset),ee.addRange(Y))}}}}for(re=[],ee=D;ee=ee.parentNode;)ee.nodeType===1&&re.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<re.length;D++){var oe=re[D];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}Hl=!!$d,Yd=$d=null}finally{Xe=x,X.p=m,U.T=u}}o.current=a,Gt=2}}function Ry(){if(Gt===2){Gt=0;var o=Qi,a=wo,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=U.T,U.T=null;var m=X.p;X.p=2;var x=Xe;Xe|=4;try{ay(o,a.alternate,a)}finally{Xe=x,X.p=m,U.T=u}}Gt=3}}function Iy(){if(Gt===4||Gt===3){Gt=0,ps();var o=Qi,a=wo,u=Mo,m=vy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Gt=5:(Gt=0,wo=Qi=null,Dy(o,o.pendingLanes));var x=o.pendingLanes;if(x===0&&(Ji=null),Zc(u),a=a.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(Se,a,void 0,(a.current.flags&128)===128)}catch{}if(m!==null){a=U.T,x=X.p,X.p=2,U.T=null;try{for(var S=o.onRecoverableError,T=0;T<m.length;T++){var D=m[T];S(D.value,{componentStack:D.stack})}}finally{U.T=a,X.p=x}}(Mo&3)!==0&&Il(),Jn(o),x=o.pendingLanes,(u&4194090)!==0&&(x&42)!==0?o===Dd?qr++:(qr=0,Dd=o):qr=0,Hr(0)}}function Dy(o,a){(o.pooledCacheLanes&=a)===0&&(a=o.pooledCache,a!=null&&(o.pooledCache=null,Cr(a)))}function Il(o){return Ny(),Ry(),Iy(),ky()}function ky(){if(Gt!==5)return!1;var o=Qi,a=Rd;Rd=0;var u=Zc(Mo),m=U.T,x=X.p;try{X.p=32>u?32:u,U.T=null,u=Id,Id=null;var S=Qi,T=Mo;if(Gt=0,wo=Qi=null,Mo=0,(Xe&6)!==0)throw Error(n(331));var D=Xe;if(Xe|=4,gy(S.current),hy(S,S.current,T,u),Xe=D,Hr(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(Se,S)}catch{}return!0}finally{X.p=x,U.T=m,Dy(o,a)}}function Ly(o,a,u){a=Mn(u,a),a=ud(o.stateNode,a,2),o=qi(o,a,2),o!==null&&(rr(o,2),Jn(o))}function it(o,a,u){if(o.tag===3)Ly(o,o,u);else for(;a!==null;){if(a.tag===3){Ly(a,o,u);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ji===null||!Ji.has(m))){o=Mn(u,o),u=Ug(2),m=qi(a,u,2),m!==null&&(Bg(u,m,a,o),rr(m,2),Jn(m));break}}a=a.return}}function Fd(o,a,u){var m=o.pingCache;if(m===null){m=o.pingCache=new cE;var x=new Set;m.set(a,x)}else x=m.get(a),x===void 0&&(x=new Set,m.set(a,x));x.has(u)||(Td=!0,x.add(u),o=pE.bind(null,o,a,u),a.then(o,o))}function pE(o,a,u){var m=o.pingCache;m!==null&&m.delete(a),o.pingedLanes|=o.suspendedLanes&u,o.warmLanes&=~u,ot===o&&(Ye&u)===u&&(vt===4||vt===3&&(Ye&62914560)===Ye&&300>an()-Nd?(Xe&2)===0&&No(o,0):wd|=u,To===Ye&&(To=0)),Jn(o)}function Py(o,a){a===0&&(a=Ip()),o=uo(o,a),o!==null&&(rr(o,a),Jn(o))}function mE(o){var a=o.memoizedState,u=0;a!==null&&(u=a.retryLane),Py(o,u)}function gE(o,a){var u=0;switch(o.tag){case 13:var m=o.stateNode,x=o.memoizedState;x!==null&&(u=x.retryLane);break;case 19:m=o.stateNode;break;case 22:m=o.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(a),Py(o,u)}function yE(o,a){return xt(o,a)}var Dl=null,Io=null,Od=!1,kl=!1,Ud=!1,ks=0;function Jn(o){o!==Io&&o.next===null&&(Io===null?Dl=Io=o:Io=Io.next=o),kl=!0,Od||(Od=!0,xE())}function Hr(o,a){if(!Ud&&kl){Ud=!0;do for(var u=!1,m=Dl;m!==null;){if(o!==0){var x=m.pendingLanes;if(x===0)var S=0;else{var T=m.suspendedLanes,D=m.pingedLanes;S=(1<<31-st(42|o)+1)-1,S&=x&~(T&~D),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,By(m,S))}else S=Ye,S=ms(m,m===ot?S:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(S&3)===0||gs(m,S)||(u=!0,By(m,S));m=m.next}while(u);Ud=!1}}function vE(){Fy()}function Fy(){kl=Od=!1;var o=0;ks!==0&&(wE()&&(o=ks),ks=0);for(var a=an(),u=null,m=Dl;m!==null;){var x=m.next,S=Oy(m,a);S===0?(m.next=null,u===null?Dl=x:u.next=x,x===null&&(Io=u)):(u=m,(o!==0||(S&3)!==0)&&(kl=!0)),m=x}Hr(o)}function Oy(o,a){for(var u=o.suspendedLanes,m=o.pingedLanes,x=o.expirationTimes,S=o.pendingLanes&-62914561;0<S;){var T=31-st(S),D=1<<T,B=x[T];B===-1?((D&u)===0||(D&m)!==0)&&(x[T]=Ba(D,a)):B<=a&&(o.expiredLanes|=D),S&=~D}if(a=ot,u=Ye,u=ms(o,o===a?u:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),m=o.callbackNode,u===0||o===a&&(Je===2||Je===9)||o.cancelPendingCommit!==null)return m!==null&&m!==null&&Dt(m),o.callbackNode=null,o.callbackPriority=0;if((u&3)===0||gs(o,u)){if(a=u&-u,a===o.callbackPriority)return a;switch(m!==null&&Dt(m),Zc(u)){case 2:case 8:u=G;break;case 32:u=Q;break;case 268435456:u=ge;break;default:u=Q}return m=Uy.bind(null,o),u=xt(u,m),o.callbackPriority=a,o.callbackNode=u,a}return m!==null&&m!==null&&Dt(m),o.callbackPriority=2,o.callbackNode=null,2}function Uy(o,a){if(Gt!==0&&Gt!==5)return o.callbackNode=null,o.callbackPriority=0,null;var u=o.callbackNode;if(Il()&&o.callbackNode!==u)return null;var m=Ye;return m=ms(o,o===ot?m:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),m===0?null:(by(o,m,a),Oy(o,an()),o.callbackNode!=null&&o.callbackNode===u?Uy.bind(null,o):null)}function By(o,a){if(Il())return null;by(o,a,!0)}function xE(){NE(function(){(Xe&6)!==0?xt(or,vE):Fy()})}function Bd(){return ks===0&&(ks=Rp()),ks}function Vy(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:ja(""+o)}function Gy(o,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,o.id&&u.setAttribute("form",o.id),a.parentNode.insertBefore(u,a),o=new FormData(o),u.parentNode.removeChild(u),o}function bE(o,a,u,m,x){if(a==="submit"&&u&&u.stateNode===x){var S=Vy((x[ln]||null).action),T=m.submitter;T&&(a=(a=T[ln]||null)?Vy(a.formAction):T.getAttribute("formAction"),a!==null&&(S=a,T=null));var D=new Wa("action","action",null,m,x);o.push({event:D,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(ks!==0){var B=T?Gy(x,T):new FormData(x);od(u,{pending:!0,data:B,method:x.method,action:S},null,B)}}else typeof S=="function"&&(D.preventDefault(),B=T?Gy(x,T):new FormData(x),od(u,{pending:!0,data:B,method:x.method,action:S},S,B))},currentTarget:x}]})}}for(var Vd=0;Vd<Eu.length;Vd++){var Gd=Eu[Vd],SE=Gd.toLowerCase(),CE=Gd[0].toUpperCase()+Gd.slice(1);Vn(SE,"on"+CE)}Vn(bm,"onAnimationEnd"),Vn(Sm,"onAnimationIteration"),Vn(Cm,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(BA,"onTransitionRun"),Vn(VA,"onTransitionStart"),Vn(GA,"onTransitionCancel"),Vn(Am,"onTransitionEnd"),eo("onMouseEnter",["mouseout","mouseover"]),eo("onMouseLeave",["mouseout","mouseover"]),eo("onPointerEnter",["pointerout","pointerover"]),eo("onPointerLeave",["pointerout","pointerover"]),ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jr));function qy(o,a){a=(a&4)!==0;for(var u=0;u<o.length;u++){var m=o[u],x=m.event;m=m.listeners;e:{var S=void 0;if(a)for(var T=m.length-1;0<=T;T--){var D=m[T],B=D.instance,J=D.currentTarget;if(D=D.listener,B!==S&&x.isPropagationStopped())break e;S=D,x.currentTarget=J;try{S(x)}catch(ie){bl(ie)}x.currentTarget=null,S=B}else for(T=0;T<m.length;T++){if(D=m[T],B=D.instance,J=D.currentTarget,D=D.listener,B!==S&&x.isPropagationStopped())break e;S=D,x.currentTarget=J;try{S(x)}catch(ie){bl(ie)}x.currentTarget=null,S=B}}}}function He(o,a){var u=a[eu];u===void 0&&(u=a[eu]=new Set);var m=o+"__bubble";u.has(m)||(Hy(a,o,2,!1),u.add(m))}function qd(o,a,u){var m=0;a&&(m|=4),Hy(u,o,m,a)}var Ll="_reactListening"+Math.random().toString(36).slice(2);function Hd(o){if(!o[Ll]){o[Ll]=!0,Fp.forEach(function(u){u!=="selectionchange"&&(AE.has(u)||qd(u,!1,o),qd(u,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[Ll]||(a[Ll]=!0,qd("selectionchange",!1,a))}}function Hy(o,a,u,m){switch(h0(a)){case 2:var x=XE;break;case 8:x=JE;break;default:x=sf}u=x.bind(null,a,u,o),x=void 0,!du||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(x=!0),m?x!==void 0?o.addEventListener(a,u,{capture:!0,passive:x}):o.addEventListener(a,u,!0):x!==void 0?o.addEventListener(a,u,{passive:x}):o.addEventListener(a,u,!1)}function jd(o,a,u,m,x){var S=m;if((a&1)===0&&(a&2)===0&&m!==null)e:for(;;){if(m===null)return;var T=m.tag;if(T===3||T===4){var D=m.stateNode.containerInfo;if(D===x)break;if(T===4)for(T=m.return;T!==null;){var B=T.tag;if((B===3||B===4)&&T.stateNode.containerInfo===x)return;T=T.return}for(;D!==null;){if(T=Js(D),T===null)return;if(B=T.tag,B===5||B===6||B===26||B===27){m=S=T;continue e}D=D.parentNode}}m=m.return}Xp(function(){var J=S,ie=cu(u),re=[];e:{var Z=Em.get(o);if(Z!==void 0){var ee=Wa,De=o;switch(o){case"keypress":if($a(u)===0)break e;case"keydown":case"keyup":ee=yA;break;case"focusin":De="focus",ee=mu;break;case"focusout":De="blur",ee=mu;break;case"beforeblur":case"afterblur":ee=mu;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Zp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=oA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=bA;break;case bm:case Sm:case Cm:ee=lA;break;case Am:ee=CA;break;case"scroll":case"scrollend":ee=iA;break;case"wheel":ee=EA;break;case"copy":case"cut":case"paste":ee=uA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=tm;break;case"toggle":case"beforetoggle":ee=TA}var Me=(a&4)!==0,tt=!Me&&(o==="scroll"||o==="scrollend"),j=Me?Z!==null?Z+"Capture":null:Z;Me=[];for(var H=J,Y;H!==null;){var oe=H;if(Y=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||Y===null||j===null||(oe=cr(H,j),oe!=null&&Me.push(zr(H,oe,Y))),tt)break;H=H.return}0<Me.length&&(Z=new ee(Z,De,null,u,ie),re.push({event:Z,listeners:Me}))}}if((a&7)===0){e:{if(Z=o==="mouseover"||o==="pointerover",ee=o==="mouseout"||o==="pointerout",Z&&u!==lu&&(De=u.relatedTarget||u.fromElement)&&(Js(De)||De[Xs]))break e;if((ee||Z)&&(Z=ie.window===ie?ie:(Z=ie.ownerDocument)?Z.defaultView||Z.parentWindow:window,ee?(De=u.relatedTarget||u.toElement,ee=J,De=De?Js(De):null,De!==null&&(tt=r(De),Me=De.tag,De!==tt||Me!==5&&Me!==27&&Me!==6)&&(De=null)):(ee=null,De=J),ee!==De)){if(Me=Zp,oe="onMouseLeave",j="onMouseEnter",H="mouse",(o==="pointerout"||o==="pointerover")&&(Me=tm,oe="onPointerLeave",j="onPointerEnter",H="pointer"),tt=ee==null?Z:lr(ee),Y=De==null?Z:lr(De),Z=new Me(oe,H+"leave",ee,u,ie),Z.target=tt,Z.relatedTarget=Y,oe=null,Js(ie)===J&&(Me=new Me(j,H+"enter",De,u,ie),Me.target=Y,Me.relatedTarget=tt,oe=Me),tt=oe,ee&&De)t:{for(Me=ee,j=De,H=0,Y=Me;Y;Y=Do(Y))H++;for(Y=0,oe=j;oe;oe=Do(oe))Y++;for(;0<H-Y;)Me=Do(Me),H--;for(;0<Y-H;)j=Do(j),Y--;for(;H--;){if(Me===j||j!==null&&Me===j.alternate)break t;Me=Do(Me),j=Do(j)}Me=null}else Me=null;ee!==null&&jy(re,Z,ee,Me,!1),De!==null&&tt!==null&&jy(re,tt,De,Me,!0)}}e:{if(Z=J?lr(J):window,ee=Z.nodeName&&Z.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Z.type==="file")var be=cm;else if(am(Z))if(um)be=FA;else{be=LA;var Be=kA}else ee=Z.nodeName,!ee||ee.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?J&&au(J.elementType)&&(be=cm):be=PA;if(be&&(be=be(o,J))){lm(re,be,u,ie);break e}Be&&Be(o,Z,J),o==="focusout"&&J&&Z.type==="number"&&J.memoizedProps.value!=null&&ru(Z,"number",Z.value)}switch(Be=J?lr(J):window,o){case"focusin":(am(Be)||Be.contentEditable==="true")&&(ao=Be,Su=J,yr=null);break;case"focusout":yr=Su=ao=null;break;case"mousedown":Cu=!0;break;case"contextmenu":case"mouseup":case"dragend":Cu=!1,vm(re,u,ie);break;case"selectionchange":if(UA)break;case"keydown":case"keyup":vm(re,u,ie)}var Ae;if(yu)e:{switch(o){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else ro?om(o,u)&&(Re="onCompositionEnd"):o==="keydown"&&u.keyCode===229&&(Re="onCompositionStart");Re&&(nm&&u.locale!=="ko"&&(ro||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&ro&&(Ae=Jp()):(Ui=ie,fu="value"in Ui?Ui.value:Ui.textContent,ro=!0)),Be=Pl(J,Re),0<Be.length&&(Re=new em(Re,o,null,u,ie),re.push({event:Re,listeners:Be}),Ae?Re.data=Ae:(Ae=rm(u),Ae!==null&&(Re.data=Ae)))),(Ae=MA?NA(o,u):RA(o,u))&&(Re=Pl(J,"onBeforeInput"),0<Re.length&&(Be=new em("onBeforeInput","beforeinput",null,u,ie),re.push({event:Be,listeners:Re}),Be.data=Ae)),bE(re,o,J,u,ie)}qy(re,a)})}function zr(o,a,u){return{instance:o,listener:a,currentTarget:u}}function Pl(o,a){for(var u=a+"Capture",m=[];o!==null;){var x=o,S=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||S===null||(x=cr(o,u),x!=null&&m.unshift(zr(o,x,S)),x=cr(o,a),x!=null&&m.push(zr(o,x,S))),o.tag===3)return m;o=o.return}return[]}function Do(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function jy(o,a,u,m,x){for(var S=a._reactName,T=[];u!==null&&u!==m;){var D=u,B=D.alternate,J=D.stateNode;if(D=D.tag,B!==null&&B===m)break;D!==5&&D!==26&&D!==27||J===null||(B=J,x?(J=cr(u,S),J!=null&&T.unshift(zr(u,J,B))):x||(J=cr(u,S),J!=null&&T.push(zr(u,J,B)))),u=u.return}T.length!==0&&o.push({event:a,listeners:T})}var EE=/\r\n?/g,_E=/\u0000|\uFFFD/g;function zy(o){return(typeof o=="string"?o:""+o).replace(EE,`
`).replace(_E,"")}function $y(o,a){return a=zy(a),zy(o)===a}function Fl(){}function et(o,a,u,m,x,S){switch(u){case"children":typeof m=="string"?a==="body"||a==="textarea"&&m===""||io(o,m):(typeof m=="number"||typeof m=="bigint")&&a!=="body"&&io(o,""+m);break;case"className":Ga(o,"class",m);break;case"tabIndex":Ga(o,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Ga(o,u,m);break;case"style":Wp(o,m,S);break;case"data":if(a!=="object"){Ga(o,"data",m);break}case"src":case"href":if(m===""&&(a!=="a"||u!=="href")){o.removeAttribute(u);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){o.removeAttribute(u);break}m=ja(""+m),o.setAttribute(u,m);break;case"action":case"formAction":if(typeof m=="function"){o.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(a!=="input"&&et(o,a,"name",x.name,x,null),et(o,a,"formEncType",x.formEncType,x,null),et(o,a,"formMethod",x.formMethod,x,null),et(o,a,"formTarget",x.formTarget,x,null)):(et(o,a,"encType",x.encType,x,null),et(o,a,"method",x.method,x,null),et(o,a,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){o.removeAttribute(u);break}m=ja(""+m),o.setAttribute(u,m);break;case"onClick":m!=null&&(o.onclick=Fl);break;case"onScroll":m!=null&&He("scroll",o);break;case"onScrollEnd":m!=null&&He("scrollend",o);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(u=m.__html,u!=null){if(x.children!=null)throw Error(n(60));o.innerHTML=u}}break;case"multiple":o.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":o.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){o.removeAttribute("xlink:href");break}u=ja(""+m),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(u,""+m):o.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(u,""):o.removeAttribute(u);break;case"capture":case"download":m===!0?o.setAttribute(u,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(u,m):o.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?o.setAttribute(u,m):o.removeAttribute(u);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?o.removeAttribute(u):o.setAttribute(u,m);break;case"popover":He("beforetoggle",o),He("toggle",o),Va(o,"popover",m);break;case"xlinkActuate":ui(o,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ui(o,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ui(o,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ui(o,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ui(o,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ui(o,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ui(o,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ui(o,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ui(o,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Va(o,"is",m);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=tA.get(u)||u,Va(o,u,m))}}function zd(o,a,u,m,x,S){switch(u){case"style":Wp(o,m,S);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(u=m.__html,u!=null){if(x.children!=null)throw Error(n(60));o.innerHTML=u}}break;case"children":typeof m=="string"?io(o,m):(typeof m=="number"||typeof m=="bigint")&&io(o,""+m);break;case"onScroll":m!=null&&He("scroll",o);break;case"onScrollEnd":m!=null&&He("scrollend",o);break;case"onClick":m!=null&&(o.onclick=Fl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Op.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),a=u.slice(2,x?u.length-7:void 0),S=o[ln]||null,S=S!=null?S[u]:null,typeof S=="function"&&o.removeEventListener(a,S,x),typeof m=="function")){typeof S!="function"&&S!==null&&(u in o?o[u]=null:o.hasAttribute(u)&&o.removeAttribute(u)),o.addEventListener(a,m,x);break e}u in o?o[u]=m:m===!0?o.setAttribute(u,""):Va(o,u,m)}}}function qt(o,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",o),He("load",o);var m=!1,x=!1,S;for(S in u)if(u.hasOwnProperty(S)){var T=u[S];if(T!=null)switch(S){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:et(o,a,S,T,u,null)}}x&&et(o,a,"srcSet",u.srcSet,u,null),m&&et(o,a,"src",u.src,u,null);return;case"input":He("invalid",o);var D=S=T=x=null,B=null,J=null;for(m in u)if(u.hasOwnProperty(m)){var ie=u[m];if(ie!=null)switch(m){case"name":x=ie;break;case"type":T=ie;break;case"checked":B=ie;break;case"defaultChecked":J=ie;break;case"value":S=ie;break;case"defaultValue":D=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,a));break;default:et(o,a,m,ie,u,null)}}jp(o,S,D,B,J,T,x,!1),qa(o);return;case"select":He("invalid",o),m=T=S=null;for(x in u)if(u.hasOwnProperty(x)&&(D=u[x],D!=null))switch(x){case"value":S=D;break;case"defaultValue":T=D;break;case"multiple":m=D;default:et(o,a,x,D,u,null)}a=S,u=T,o.multiple=!!m,a!=null?no(o,!!m,a,!1):u!=null&&no(o,!!m,u,!0);return;case"textarea":He("invalid",o),S=x=m=null;for(T in u)if(u.hasOwnProperty(T)&&(D=u[T],D!=null))switch(T){case"value":m=D;break;case"defaultValue":x=D;break;case"children":S=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:et(o,a,T,D,u,null)}$p(o,m,x,S),qa(o);return;case"option":for(B in u)if(u.hasOwnProperty(B)&&(m=u[B],m!=null))switch(B){case"selected":o.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:et(o,a,B,m,u,null)}return;case"dialog":He("beforetoggle",o),He("toggle",o),He("cancel",o),He("close",o);break;case"iframe":case"object":He("load",o);break;case"video":case"audio":for(m=0;m<jr.length;m++)He(jr[m],o);break;case"image":He("error",o),He("load",o);break;case"details":He("toggle",o);break;case"embed":case"source":case"link":He("error",o),He("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in u)if(u.hasOwnProperty(J)&&(m=u[J],m!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:et(o,a,J,m,u,null)}return;default:if(au(a)){for(ie in u)u.hasOwnProperty(ie)&&(m=u[ie],m!==void 0&&zd(o,a,ie,m,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(m=u[D],m!=null&&et(o,a,D,m,u,null))}function TE(o,a,u,m){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,S=null,T=null,D=null,B=null,J=null,ie=null;for(ee in u){var re=u[ee];if(u.hasOwnProperty(ee)&&re!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":B=re;default:m.hasOwnProperty(ee)||et(o,a,ee,null,m,re)}}for(var Z in m){var ee=m[Z];if(re=u[Z],m.hasOwnProperty(Z)&&(ee!=null||re!=null))switch(Z){case"type":S=ee;break;case"name":x=ee;break;case"checked":J=ee;break;case"defaultChecked":ie=ee;break;case"value":T=ee;break;case"defaultValue":D=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(137,a));break;default:ee!==re&&et(o,a,Z,ee,m,re)}}ou(o,T,D,B,J,ie,S,x);return;case"select":ee=T=D=Z=null;for(S in u)if(B=u[S],u.hasOwnProperty(S)&&B!=null)switch(S){case"value":break;case"multiple":ee=B;default:m.hasOwnProperty(S)||et(o,a,S,null,m,B)}for(x in m)if(S=m[x],B=u[x],m.hasOwnProperty(x)&&(S!=null||B!=null))switch(x){case"value":Z=S;break;case"defaultValue":D=S;break;case"multiple":T=S;default:S!==B&&et(o,a,x,S,m,B)}a=D,u=T,m=ee,Z!=null?no(o,!!u,Z,!1):!!m!=!!u&&(a!=null?no(o,!!u,a,!0):no(o,!!u,u?[]:"",!1));return;case"textarea":ee=Z=null;for(D in u)if(x=u[D],u.hasOwnProperty(D)&&x!=null&&!m.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:et(o,a,D,null,m,x)}for(T in m)if(x=m[T],S=u[T],m.hasOwnProperty(T)&&(x!=null||S!=null))switch(T){case"value":Z=x;break;case"defaultValue":ee=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==S&&et(o,a,T,x,m,S)}zp(o,Z,ee);return;case"option":for(var De in u)if(Z=u[De],u.hasOwnProperty(De)&&Z!=null&&!m.hasOwnProperty(De))switch(De){case"selected":o.selected=!1;break;default:et(o,a,De,null,m,Z)}for(B in m)if(Z=m[B],ee=u[B],m.hasOwnProperty(B)&&Z!==ee&&(Z!=null||ee!=null))switch(B){case"selected":o.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:et(o,a,B,Z,m,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in u)Z=u[Me],u.hasOwnProperty(Me)&&Z!=null&&!m.hasOwnProperty(Me)&&et(o,a,Me,null,m,Z);for(J in m)if(Z=m[J],ee=u[J],m.hasOwnProperty(J)&&Z!==ee&&(Z!=null||ee!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,a));break;default:et(o,a,J,Z,m,ee)}return;default:if(au(a)){for(var tt in u)Z=u[tt],u.hasOwnProperty(tt)&&Z!==void 0&&!m.hasOwnProperty(tt)&&zd(o,a,tt,void 0,m,Z);for(ie in m)Z=m[ie],ee=u[ie],!m.hasOwnProperty(ie)||Z===ee||Z===void 0&&ee===void 0||zd(o,a,ie,Z,m,ee);return}}for(var j in u)Z=u[j],u.hasOwnProperty(j)&&Z!=null&&!m.hasOwnProperty(j)&&et(o,a,j,null,m,Z);for(re in m)Z=m[re],ee=u[re],!m.hasOwnProperty(re)||Z===ee||Z==null&&ee==null||et(o,a,re,Z,m,ee)}var $d=null,Yd=null;function Ol(o){return o.nodeType===9?o:o.ownerDocument}function Yy(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Wy(o,a){if(o===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&a==="foreignObject"?0:o}function Wd(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Kd=null;function wE(){var o=window.event;return o&&o.type==="popstate"?o===Kd?!1:(Kd=o,!0):(Kd=null,!1)}var Ky=typeof setTimeout=="function"?setTimeout:void 0,ME=typeof clearTimeout=="function"?clearTimeout:void 0,Xy=typeof Promise=="function"?Promise:void 0,NE=typeof queueMicrotask=="function"?queueMicrotask:typeof Xy<"u"?function(o){return Xy.resolve(null).then(o).catch(RE)}:Ky;function RE(o){setTimeout(function(){throw o})}function es(o){return o==="head"}function Jy(o,a){var u=a,m=0,x=0;do{var S=u.nextSibling;if(o.removeChild(u),S&&S.nodeType===8)if(u=S.data,u==="/$"){if(0<m&&8>m){u=m;var T=o.ownerDocument;if(u&1&&$r(T.documentElement),u&2&&$r(T.body),u&4)for(u=T.head,$r(u),T=u.firstChild;T;){var D=T.nextSibling,B=T.nodeName;T[ar]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&T.rel.toLowerCase()==="stylesheet"||u.removeChild(T),T=D}}if(x===0){o.removeChild(S),ea(a);return}x--}else u==="$"||u==="$?"||u==="$!"?x++:m=u.charCodeAt(0)-48;else m=0;u=S}while(u);ea(a)}function Xd(o){var a=o.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Xd(u),tu(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}o.removeChild(u)}}function IE(o,a,u,m){for(;o.nodeType===1;){var x=u;if(o.nodeName.toLowerCase()!==a.toLowerCase()){if(!m&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(m){if(!o[ar])switch(a){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(S=o.getAttribute("rel"),S==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(S!==x.rel||o.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||o.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||o.getAttribute("title")!==(x.title==null?null:x.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(S=o.getAttribute("src"),(S!==(x.src==null?null:x.src)||o.getAttribute("type")!==(x.type==null?null:x.type)||o.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&S&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(a==="input"&&o.type==="hidden"){var S=x.name==null?null:""+x.name;if(x.type==="hidden"&&o.getAttribute("name")===S)return o}else return o;if(o=qn(o.nextSibling),o===null)break}return null}function DE(o,a,u){if(a==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!u||(o=qn(o.nextSibling),o===null))return null;return o}function Jd(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function kE(o,a){var u=o.ownerDocument;if(o.data!=="$?"||u.readyState==="complete")a();else{var m=function(){a(),u.removeEventListener("DOMContentLoaded",m)};u.addEventListener("DOMContentLoaded",m),o._reactRetry=m}}function qn(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return o}var Qd=null;function Qy(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var u=o.data;if(u==="$"||u==="$!"||u==="$?"){if(a===0)return o;a--}else u==="/$"&&a++}o=o.previousSibling}return null}function Zy(o,a,u){switch(a=Ol(u),o){case"html":if(o=a.documentElement,!o)throw Error(n(452));return o;case"head":if(o=a.head,!o)throw Error(n(453));return o;case"body":if(o=a.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function $r(o){for(var a=o.attributes;a.length;)o.removeAttributeNode(a[0]);tu(o)}var Ln=new Map,e0=new Set;function Ul(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Ei=X.d;X.d={f:LE,r:PE,D:FE,C:OE,L:UE,m:BE,X:GE,S:VE,M:qE};function LE(){var o=Ei.f(),a=Nl();return o||a}function PE(o){var a=Qs(o);a!==null&&a.tag===5&&a.type==="form"?bg(a):Ei.r(o)}var ko=typeof document>"u"?null:document;function t0(o,a,u){var m=ko;if(m&&typeof a=="string"&&a){var x=wn(a);x='link[rel="'+o+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),e0.has(x)||(e0.add(x),o={rel:o,crossOrigin:u,href:a},m.querySelector(x)===null&&(a=m.createElement("link"),qt(a,"link",o),Ft(a),m.head.appendChild(a)))}}function FE(o){Ei.D(o),t0("dns-prefetch",o,null)}function OE(o,a){Ei.C(o,a),t0("preconnect",o,a)}function UE(o,a,u){Ei.L(o,a,u);var m=ko;if(m&&o&&a){var x='link[rel="preload"][as="'+wn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+wn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+wn(u.imageSizes)+'"]')):x+='[href="'+wn(o)+'"]';var S=x;switch(a){case"style":S=Lo(o);break;case"script":S=Po(o)}Ln.has(S)||(o=g({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:o,as:a},u),Ln.set(S,o),m.querySelector(x)!==null||a==="style"&&m.querySelector(Yr(S))||a==="script"&&m.querySelector(Wr(S))||(a=m.createElement("link"),qt(a,"link",o),Ft(a),m.head.appendChild(a)))}}function BE(o,a){Ei.m(o,a);var u=ko;if(u&&o){var m=a&&typeof a.as=="string"?a.as:"script",x='link[rel="modulepreload"][as="'+wn(m)+'"][href="'+wn(o)+'"]',S=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Po(o)}if(!Ln.has(S)&&(o=g({rel:"modulepreload",href:o},a),Ln.set(S,o),u.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Wr(S)))return}m=u.createElement("link"),qt(m,"link",o),Ft(m),u.head.appendChild(m)}}}function VE(o,a,u){Ei.S(o,a,u);var m=ko;if(m&&o){var x=Zs(m).hoistableStyles,S=Lo(o);a=a||"default";var T=x.get(S);if(!T){var D={loading:0,preload:null};if(T=m.querySelector(Yr(S)))D.loading=5;else{o=g({rel:"stylesheet",href:o,"data-precedence":a},u),(u=Ln.get(S))&&Zd(o,u);var B=T=m.createElement("link");Ft(B),qt(B,"link",o),B._p=new Promise(function(J,ie){B.onload=J,B.onerror=ie}),B.addEventListener("load",function(){D.loading|=1}),B.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Bl(T,a,m)}T={type:"stylesheet",instance:T,count:1,state:D},x.set(S,T)}}}function GE(o,a){Ei.X(o,a);var u=ko;if(u&&o){var m=Zs(u).hoistableScripts,x=Po(o),S=m.get(x);S||(S=u.querySelector(Wr(x)),S||(o=g({src:o,async:!0},a),(a=Ln.get(x))&&ef(o,a),S=u.createElement("script"),Ft(S),qt(S,"link",o),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(x,S))}}function qE(o,a){Ei.M(o,a);var u=ko;if(u&&o){var m=Zs(u).hoistableScripts,x=Po(o),S=m.get(x);S||(S=u.querySelector(Wr(x)),S||(o=g({src:o,async:!0,type:"module"},a),(a=Ln.get(x))&&ef(o,a),S=u.createElement("script"),Ft(S),qt(S,"link",o),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(x,S))}}function n0(o,a,u,m){var x=(x=he.current)?Ul(x):null;if(!x)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=Lo(u.href),u=Zs(x).hoistableStyles,m=u.get(a),m||(m={type:"style",instance:null,count:0,state:null},u.set(a,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){o=Lo(u.href);var S=Zs(x).hoistableStyles,T=S.get(o);if(T||(x=x.ownerDocument||x,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(o,T),(S=x.querySelector(Yr(o)))&&!S._p&&(T.instance=S,T.state.loading=5),Ln.has(o)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ln.set(o,u),S||HE(x,o,u,T.state))),a&&m===null)throw Error(n(528,""));return T}if(a&&m!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Po(u),u=Zs(x).hoistableScripts,m=u.get(a),m||(m={type:"script",instance:null,count:0,state:null},u.set(a,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Lo(o){return'href="'+wn(o)+'"'}function Yr(o){return'link[rel="stylesheet"]['+o+"]"}function i0(o){return g({},o,{"data-precedence":o.precedence,precedence:null})}function HE(o,a,u,m){o.querySelector('link[rel="preload"][as="style"]['+a+"]")?m.loading=1:(a=o.createElement("link"),m.preload=a,a.addEventListener("load",function(){return m.loading|=1}),a.addEventListener("error",function(){return m.loading|=2}),qt(a,"link",u),Ft(a),o.head.appendChild(a))}function Po(o){return'[src="'+wn(o)+'"]'}function Wr(o){return"script[async]"+o}function s0(o,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var m=o.querySelector('style[data-href~="'+wn(u.href)+'"]');if(m)return a.instance=m,Ft(m),m;var x=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return m=(o.ownerDocument||o).createElement("style"),Ft(m),qt(m,"style",x),Bl(m,u.precedence,o),a.instance=m;case"stylesheet":x=Lo(u.href);var S=o.querySelector(Yr(x));if(S)return a.state.loading|=4,a.instance=S,Ft(S),S;m=i0(u),(x=Ln.get(x))&&Zd(m,x),S=(o.ownerDocument||o).createElement("link"),Ft(S);var T=S;return T._p=new Promise(function(D,B){T.onload=D,T.onerror=B}),qt(S,"link",m),a.state.loading|=4,Bl(S,u.precedence,o),a.instance=S;case"script":return S=Po(u.src),(x=o.querySelector(Wr(S)))?(a.instance=x,Ft(x),x):(m=u,(x=Ln.get(S))&&(m=g({},u),ef(m,x)),o=o.ownerDocument||o,x=o.createElement("script"),Ft(x),qt(x,"link",m),o.head.appendChild(x),a.instance=x);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(m=a.instance,a.state.loading|=4,Bl(m,u.precedence,o));return a.instance}function Bl(o,a,u){for(var m=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,S=x,T=0;T<m.length;T++){var D=m[T];if(D.dataset.precedence===a)S=D;else if(S!==x)break}S?S.parentNode.insertBefore(o,S.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(o,a.firstChild))}function Zd(o,a){o.crossOrigin==null&&(o.crossOrigin=a.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=a.referrerPolicy),o.title==null&&(o.title=a.title)}function ef(o,a){o.crossOrigin==null&&(o.crossOrigin=a.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=a.referrerPolicy),o.integrity==null&&(o.integrity=a.integrity)}var Vl=null;function o0(o,a,u){if(Vl===null){var m=new Map,x=Vl=new Map;x.set(u,m)}else x=Vl,m=x.get(u),m||(m=new Map,x.set(u,m));if(m.has(o))return m;for(m.set(o,null),u=u.getElementsByTagName(o),x=0;x<u.length;x++){var S=u[x];if(!(S[ar]||S[$t]||o==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var T=S.getAttribute(a)||"";T=o+T;var D=m.get(T);D?D.push(S):m.set(T,[S])}}return m}function r0(o,a,u){o=o.ownerDocument||o,o.head.insertBefore(u,a==="title"?o.querySelector("head > title"):null)}function jE(o,a,u){if(u===1||a.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return o=a.disabled,typeof a.precedence=="string"&&o==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function a0(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Kr=null;function zE(){}function $E(o,a,u){if(Kr===null)throw Error(n(475));var m=Kr;if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var x=Lo(u.href),S=o.querySelector(Yr(x));if(S){o=S._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(m.count++,m=Gl.bind(m),o.then(m,m)),a.state.loading|=4,a.instance=S,Ft(S);return}S=o.ownerDocument||o,u=i0(u),(x=Ln.get(x))&&Zd(u,x),S=S.createElement("link"),Ft(S);var T=S;T._p=new Promise(function(D,B){T.onload=D,T.onerror=B}),qt(S,"link",u),a.instance=S}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(a,o),(o=a.state.preload)&&(a.state.loading&3)===0&&(m.count++,a=Gl.bind(m),o.addEventListener("load",a),o.addEventListener("error",a))}}function YE(){if(Kr===null)throw Error(n(475));var o=Kr;return o.stylesheets&&o.count===0&&tf(o,o.stylesheets),0<o.count?function(a){var u=setTimeout(function(){if(o.stylesheets&&tf(o,o.stylesheets),o.unsuspend){var m=o.unsuspend;o.unsuspend=null,m()}},6e4);return o.unsuspend=a,function(){o.unsuspend=null,clearTimeout(u)}}:null}function Gl(){if(this.count--,this.count===0){if(this.stylesheets)tf(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var ql=null;function tf(o,a){o.stylesheets=null,o.unsuspend!==null&&(o.count++,ql=new Map,a.forEach(WE,o),ql=null,Gl.call(o))}function WE(o,a){if(!(a.state.loading&4)){var u=ql.get(o);if(u)var m=u.get(null);else{u=new Map,ql.set(o,u);for(var x=o.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<x.length;S++){var T=x[S];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),m=T)}m&&u.set(null,m)}x=a.instance,T=x.getAttribute("data-precedence"),S=u.get(T)||m,S===m&&u.set(null,x),u.set(T,x),this.count++,m=Gl.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),S?S.parentNode.insertBefore(x,S.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(x,o.firstChild)),a.state.loading|=4}}var Xr={$$typeof:M,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function KE(o,a,u,m,x,S,T,D){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jc(0),this.hiddenUpdates=Jc(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=S,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function l0(o,a,u,m,x,S,T,D,B,J,ie,re){return o=new KE(o,a,u,T,D,B,J,re),a=1,S===!0&&(a|=24),S=vn(3,null,null,a),o.current=S,S.stateNode=o,a=Fu(),a.refCount++,o.pooledCache=a,a.refCount++,S.memoizedState={element:m,isDehydrated:u,cache:a},Vu(S),o}function c0(o){return o?(o=fo,o):fo}function u0(o,a,u,m,x,S){x=c0(x),m.context===null?m.context=x:m.pendingContext=x,m=Gi(a),m.payload={element:u},S=S===void 0?null:S,S!==null&&(m.callback=S),u=qi(o,m,a),u!==null&&(An(u,o,a),Tr(u,o,a))}function d0(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var u=o.retryLane;o.retryLane=u!==0&&u<a?u:a}}function nf(o,a){d0(o,a),(o=o.alternate)&&d0(o,a)}function f0(o){if(o.tag===13){var a=uo(o,67108864);a!==null&&An(a,o,67108864),nf(o,67108864)}}var Hl=!0;function XE(o,a,u,m){var x=U.T;U.T=null;var S=X.p;try{X.p=2,sf(o,a,u,m)}finally{X.p=S,U.T=x}}function JE(o,a,u,m){var x=U.T;U.T=null;var S=X.p;try{X.p=8,sf(o,a,u,m)}finally{X.p=S,U.T=x}}function sf(o,a,u,m){if(Hl){var x=of(m);if(x===null)jd(o,a,m,jl,u),p0(o,m);else if(ZE(x,o,a,u,m))m.stopPropagation();else if(p0(o,m),a&4&&-1<QE.indexOf(o)){for(;x!==null;){var S=Qs(x);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var T=ci(S.pendingLanes);if(T!==0){var D=S;for(D.pendingLanes|=2,D.entangledLanes|=2;T;){var B=1<<31-st(T);D.entanglements[1]|=B,T&=~B}Jn(S),(Xe&6)===0&&(wl=an()+500,Hr(0))}}break;case 13:D=uo(S,2),D!==null&&An(D,S,2),Nl(),nf(S,2)}if(S=of(m),S===null&&jd(o,a,m,jl,u),S===x)break;x=S}x!==null&&m.stopPropagation()}else jd(o,a,m,null,u)}}function of(o){return o=cu(o),rf(o)}var jl=null;function rf(o){if(jl=null,o=Js(o),o!==null){var a=r(o);if(a===null)o=null;else{var u=a.tag;if(u===13){if(o=l(a),o!==null)return o;o=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null)}}return jl=o,null}function h0(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Np()){case or:return 2;case G:return 8;case Q:case se:return 32;case ge:return 268435456;default:return 32}default:return 32}}var af=!1,ts=null,ns=null,is=null,Jr=new Map,Qr=new Map,ss=[],QE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p0(o,a){switch(o){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":ns=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":Jr.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qr.delete(a.pointerId)}}function Zr(o,a,u,m,x,S){return o===null||o.nativeEvent!==S?(o={blockedOn:a,domEventName:u,eventSystemFlags:m,nativeEvent:S,targetContainers:[x]},a!==null&&(a=Qs(a),a!==null&&f0(a)),o):(o.eventSystemFlags|=m,a=o.targetContainers,x!==null&&a.indexOf(x)===-1&&a.push(x),o)}function ZE(o,a,u,m,x){switch(a){case"focusin":return ts=Zr(ts,o,a,u,m,x),!0;case"dragenter":return ns=Zr(ns,o,a,u,m,x),!0;case"mouseover":return is=Zr(is,o,a,u,m,x),!0;case"pointerover":var S=x.pointerId;return Jr.set(S,Zr(Jr.get(S)||null,o,a,u,m,x)),!0;case"gotpointercapture":return S=x.pointerId,Qr.set(S,Zr(Qr.get(S)||null,o,a,u,m,x)),!0}return!1}function m0(o){var a=Js(o.target);if(a!==null){var u=r(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){o.blockedOn=a,$C(o.priority,function(){if(u.tag===13){var m=Cn();m=Qc(m);var x=uo(u,m);x!==null&&An(x,u,m),nf(u,m)}});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){o.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}o.blockedOn=null}function zl(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var u=of(o.nativeEvent);if(u===null){u=o.nativeEvent;var m=new u.constructor(u.type,u);lu=m,u.target.dispatchEvent(m),lu=null}else return a=Qs(u),a!==null&&f0(a),o.blockedOn=u,!1;a.shift()}return!0}function g0(o,a,u){zl(o)&&u.delete(a)}function e_(){af=!1,ts!==null&&zl(ts)&&(ts=null),ns!==null&&zl(ns)&&(ns=null),is!==null&&zl(is)&&(is=null),Jr.forEach(g0),Qr.forEach(g0)}function $l(o,a){o.blockedOn===a&&(o.blockedOn=null,af||(af=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,e_)))}var Yl=null;function y0(o){Yl!==o&&(Yl=o,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Yl===o&&(Yl=null);for(var a=0;a<o.length;a+=3){var u=o[a],m=o[a+1],x=o[a+2];if(typeof m!="function"){if(rf(m||u)===null)continue;break}var S=Qs(u);S!==null&&(o.splice(a,3),a-=3,od(S,{pending:!0,data:x,method:u.method,action:m},m,x))}}))}function ea(o){function a(B){return $l(B,o)}ts!==null&&$l(ts,o),ns!==null&&$l(ns,o),is!==null&&$l(is,o),Jr.forEach(a),Qr.forEach(a);for(var u=0;u<ss.length;u++){var m=ss[u];m.blockedOn===o&&(m.blockedOn=null)}for(;0<ss.length&&(u=ss[0],u.blockedOn===null);)m0(u),u.blockedOn===null&&ss.shift();if(u=(o.ownerDocument||o).$$reactFormReplay,u!=null)for(m=0;m<u.length;m+=3){var x=u[m],S=u[m+1],T=x[ln]||null;if(typeof S=="function")T||y0(u);else if(T){var D=null;if(S&&S.hasAttribute("formAction")){if(x=S,T=S[ln]||null)D=T.formAction;else if(rf(x)!==null)continue}else D=T.action;typeof D=="function"?u[m+1]=D:(u.splice(m,3),m-=3),y0(u)}}}function lf(o){this._internalRoot=o}Wl.prototype.render=lf.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,m=Cn();u0(u,m,o,a,null,null)},Wl.prototype.unmount=lf.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;u0(o.current,2,null,o,null,null),Nl(),a[Xs]=null}};function Wl(o){this._internalRoot=o}Wl.prototype.unstable_scheduleHydration=function(o){if(o){var a=Lp();o={blockedOn:null,target:o,priority:a};for(var u=0;u<ss.length&&a!==0&&a<ss[u].priority;u++);ss.splice(u,0,o),u===0&&m0(o)}};var v0=e.version;if(v0!=="19.1.0")throw Error(n(527,v0,"19.1.0"));X.findDOMNode=function(o){var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=f(a),o=o!==null?d(o):null,o=o===null?null:o.stateNode,o};var t_={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kl.isDisabled&&Kl.supportsFiber)try{Se=Kl.inject(t_),Fe=Kl}catch{}}return na.createRoot=function(o,a){if(!s(o))throw Error(n(299));var u=!1,m="",x=Lg,S=Pg,T=Fg,D=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(x=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(D=a.unstable_transitionCallbacks)),a=l0(o,1,!1,null,null,u,m,x,S,T,D,null),o[Xs]=a.current,Hd(o),new lf(a)},na.hydrateRoot=function(o,a,u){if(!s(o))throw Error(n(299));var m=!1,x="",S=Lg,T=Pg,D=Fg,B=null,J=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(B=u.unstable_transitionCallbacks),u.formState!==void 0&&(J=u.formState)),a=l0(o,1,!0,a,u??null,m,x,S,T,D,B,J),a.context=c0(null),u=a.current,m=Cn(),m=Qc(m),x=Gi(m),x.callback=null,qi(u,x,m),u=m,a.current.lanes=u,rr(a,u),Jn(a),o[Xs]=a.current,Hd(o),new Wl(a)},na.version="19.1.0",na}var R0;function f_(){if(R0)return ff.exports;R0=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),ff.exports=d_(),ff.exports}var h_=f_();/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var I0="popstate";function p_(i={}){function e(n,s){let{pathname:r,search:l,hash:c}=n.location;return sh("",{pathname:r,search:l,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:xa(s)}return g_(e,t,null,i)}function gt(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function ri(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function m_(){return Math.random().toString(36).substring(2,10)}function D0(i,e){return{usr:i.state,key:i.key,idx:e}}function sh(i,e,t=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Qo(e):e,state:t,key:e&&e.key||n||m_()}}function xa({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Qo(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function g_(i,e,t,n={}){let{window:s=document.defaultView,v5Compat:r=!1}=n,l=s.history,c="POP",f=null,d=g();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function g(){return(l.state||{idx:null}).idx}function v(){c="POP";let _=g(),w=_==null?null:_-d;d=_,f&&f({action:c,location:A.location,delta:w})}function b(_,w){c="PUSH";let N=sh(A.location,_,w);d=g()+1;let M=D0(N,d),k=A.createHref(N);try{l.pushState(M,"",k)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(k)}r&&f&&f({action:c,location:A.location,delta:1})}function C(_,w){c="REPLACE";let N=sh(A.location,_,w);d=g();let M=D0(N,d),k=A.createHref(N);l.replaceState(M,"",k),r&&f&&f({action:c,location:A.location,delta:0})}function E(_){return y_(_)}let A={get action(){return c},get location(){return i(s,l)},listen(_){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(I0,v),f=_,()=>{s.removeEventListener(I0,v),f=null}},createHref(_){return e(s,_)},createURL:E,encodeLocation(_){let w=E(_);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:b,replace:C,go(_){return l.go(_)}};return A}function y_(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),gt(t,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:xa(i);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function kb(i,e,t="/"){return v_(i,e,t,!1)}function v_(i,e,t,n){let s=typeof e=="string"?Qo(e):e,r=Ii(s.pathname||"/",t);if(r==null)return null;let l=Lb(i);x_(l);let c=null;for(let f=0;c==null&&f<l.length;++f){let d=R_(r);c=M_(l[f],d,n)}return c}function Lb(i,e=[],t=[],n=""){let s=(r,l,c)=>{let f={relativePath:c===void 0?r.path||"":c,caseSensitive:r.caseSensitive===!0,childrenIndex:l,route:r};f.relativePath.startsWith("/")&&(gt(f.relativePath.startsWith(n),`Absolute route path "${f.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(n.length));let d=Ri([n,f.relativePath]),g=t.concat(f);r.children&&r.children.length>0&&(gt(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Lb(r.children,e,g,d)),!(r.path==null&&!r.index)&&e.push({path:d,score:T_(d,r.index),routesMeta:g})};return i.forEach((r,l)=>{if(r.path===""||!r.path?.includes("?"))s(r,l);else for(let c of Pb(r.path))s(r,l,c)}),e}function Pb(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(n.length===0)return s?[r,""]:[r];let l=Pb(n.join("/")),c=[];return c.push(...l.map(f=>f===""?r:[r,f].join("/"))),s&&c.push(...l),c.map(f=>i.startsWith("/")&&f===""?"/":f)}function x_(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:w_(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var b_=/^:[\w-]+$/,S_=3,C_=2,A_=1,E_=10,__=-2,k0=i=>i==="*";function T_(i,e){let t=i.split("/"),n=t.length;return t.some(k0)&&(n+=__),e&&(n+=C_),t.filter(s=>!k0(s)).reduce((s,r)=>s+(b_.test(r)?S_:r===""?A_:E_),n)}function w_(i,e){return i.length===e.length&&i.slice(0,-1).every((n,s)=>n===e[s])?i[i.length-1]-e[e.length-1]:0}function M_(i,e,t=!1){let{routesMeta:n}=i,s={},r="/",l=[];for(let c=0;c<n.length;++c){let f=n[c],d=c===n.length-1,g=r==="/"?e:e.slice(r.length)||"/",v=xc({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},g),b=f.route;if(!v&&d&&t&&!n[n.length-1].route.index&&(v=xc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!v)return null;Object.assign(s,v.params),l.push({params:s,pathname:Ri([r,v.pathname]),pathnameBase:L_(Ri([r,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(r=Ri([r,v.pathnameBase]))}return l}function xc(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=N_(i.path,i.caseSensitive,i.end),s=e.match(t);if(!s)return null;let r=s[0],l=r.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((d,{paramName:g,isOptional:v},b)=>{if(g==="*"){let E=c[b]||"";l=r.slice(0,r.length-E.length).replace(/(.)\/+$/,"$1")}const C=c[b];return v&&!C?d[g]=void 0:d[g]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:r,pathnameBase:l,pattern:i}}function N_(i,e=!1,t=!0){ri(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,f)=>(n.push({paramName:c,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function R_(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ri(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Ii(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}function I_(i,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof i=="string"?Qo(i):i;return{pathname:t?t.startsWith("/")?t:D_(t,e):e,search:P_(n),hash:F_(s)}}function D_(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function gf(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function k_(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Fb(i){let e=k_(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Ob(i,e,t,n=!1){let s;typeof i=="string"?s=Qo(i):(s={...i},gt(!s.pathname||!s.pathname.includes("?"),gf("?","pathname","search",s)),gt(!s.pathname||!s.pathname.includes("#"),gf("#","pathname","hash",s)),gt(!s.search||!s.search.includes("#"),gf("#","search","hash",s)));let r=i===""||s.pathname==="",l=r?"/":s.pathname,c;if(l==null)c=t;else{let v=e.length-1;if(!n&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),v-=1;s.pathname=b.join("/")}c=v>=0?e[v]:"/"}let f=I_(s,c),d=l&&l!=="/"&&l.endsWith("/"),g=(r||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(d||g)&&(f.pathname+="/"),f}var Ri=i=>i.join("/").replace(/\/\/+/g,"/"),L_=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),P_=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,F_=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function O_(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var Ub=["POST","PUT","PATCH","DELETE"];new Set(Ub);var U_=["GET",...Ub];new Set(U_);var Zo=O.createContext(null);Zo.displayName="DataRouter";var kc=O.createContext(null);kc.displayName="DataRouterState";O.createContext(!1);var Bb=O.createContext({isTransitioning:!1});Bb.displayName="ViewTransition";var B_=O.createContext(new Map);B_.displayName="Fetchers";var V_=O.createContext(null);V_.displayName="Await";var li=O.createContext(null);li.displayName="Navigation";var _a=O.createContext(null);_a.displayName="Location";var Di=O.createContext({outlet:null,matches:[],isDataRoute:!1});Di.displayName="Route";var Vh=O.createContext(null);Vh.displayName="RouteError";function G_(i,{relative:e}={}){gt(Ta(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=O.useContext(li),{hash:s,pathname:r,search:l}=wa(i,{relative:e}),c=r;return t!=="/"&&(c=r==="/"?t:Ri([t,r])),n.createHref({pathname:c,search:l,hash:s})}function Ta(){return O.useContext(_a)!=null}function ki(){return gt(Ta(),"useLocation() may be used only in the context of a <Router> component."),O.useContext(_a).location}var Vb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Gb(i){O.useContext(li).static||O.useLayoutEffect(i)}function js(){let{isDataRoute:i}=O.useContext(Di);return i?eT():q_()}function q_(){gt(Ta(),"useNavigate() may be used only in the context of a <Router> component.");let i=O.useContext(Zo),{basename:e,navigator:t}=O.useContext(li),{matches:n}=O.useContext(Di),{pathname:s}=ki(),r=JSON.stringify(Fb(n)),l=O.useRef(!1);return Gb(()=>{l.current=!0}),O.useCallback((f,d={})=>{if(ri(l.current,Vb),!l.current)return;if(typeof f=="number"){t.go(f);return}let g=Ob(f,JSON.parse(r),s,d.relative==="path");i==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Ri([e,g.pathname])),(d.replace?t.replace:t.push)(g,d.state,d)},[e,t,r,s,i])}O.createContext(null);function wa(i,{relative:e}={}){let{matches:t}=O.useContext(Di),{pathname:n}=ki(),s=JSON.stringify(Fb(t));return O.useMemo(()=>Ob(i,JSON.parse(s),n,e==="path"),[i,s,n,e])}function H_(i,e){return qb(i,e)}function qb(i,e,t,n){gt(Ta(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=O.useContext(li),{matches:r}=O.useContext(Di),l=r[r.length-1],c=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",g=l&&l.route;{let w=g&&g.path||"";Hb(f,!g||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let v=ki(),b;if(e){let w=typeof e=="string"?Qo(e):e;gt(d==="/"||w.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),b=w}else b=v;let C=b.pathname||"/",E=C;if(d!=="/"){let w=d.replace(/^\//,"").split("/");E="/"+C.replace(/^\//,"").split("/").slice(w.length).join("/")}let A=kb(i,{pathname:E});ri(g||A!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),ri(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=W_(A&&A.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:Ri([d,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Ri([d,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),r,t,n);return e&&_?O.createElement(_a.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},_):_}function j_(){let i=Z_(),e=O_(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},r={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",i),l=O.createElement(O.Fragment,null,O.createElement("p",null,"💿 Hey developer 👋"),O.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",O.createElement("code",{style:r},"ErrorBoundary")," or"," ",O.createElement("code",{style:r},"errorElement")," prop on your route.")),O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),t?O.createElement("pre",{style:s},t):null,l)}var z_=O.createElement(j_,null),$_=class extends O.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?O.createElement(Di.Provider,{value:this.props.routeContext},O.createElement(Vh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Y_({routeContext:i,match:e,children:t}){let n=O.useContext(Zo);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),O.createElement(Di.Provider,{value:i},t)}function W_(i,e=[],t=null,n=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let s=i,r=t?.errors;if(r!=null){let f=s.findIndex(d=>d.route.id&&r?.[d.route.id]!==void 0);gt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let l=!1,c=-1;if(t)for(let f=0;f<s.length;f++){let d=s[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:g,errors:v}=t,b=d.route.loader&&!g.hasOwnProperty(d.route.id)&&(!v||v[d.route.id]===void 0);if(d.route.lazy||b){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((f,d,g)=>{let v,b=!1,C=null,E=null;t&&(v=r&&d.route.id?r[d.route.id]:void 0,C=d.route.errorElement||z_,l&&(c<0&&g===0?(Hb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,E=null):c===g&&(b=!0,E=d.route.hydrateFallbackElement||null)));let A=e.concat(s.slice(0,g+1)),_=()=>{let w;return v?w=C:b?w=E:d.route.Component?w=O.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=f,O.createElement(Y_,{match:d,routeContext:{outlet:f,matches:A,isDataRoute:t!=null},children:w})};return t&&(d.route.ErrorBoundary||d.route.errorElement||g===0)?O.createElement($_,{location:t.location,revalidation:t.revalidation,component:C,error:v,children:_(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):_()},null)}function Gh(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function K_(i){let e=O.useContext(Zo);return gt(e,Gh(i)),e}function X_(i){let e=O.useContext(kc);return gt(e,Gh(i)),e}function J_(i){let e=O.useContext(Di);return gt(e,Gh(i)),e}function qh(i){let e=J_(i),t=e.matches[e.matches.length-1];return gt(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function Q_(){return qh("useRouteId")}function Z_(){let i=O.useContext(Vh),e=X_("useRouteError"),t=qh("useRouteError");return i!==void 0?i:e.errors?.[t]}function eT(){let{router:i}=K_("useNavigate"),e=qh("useNavigate"),t=O.useRef(!1);return Gb(()=>{t.current=!0}),O.useCallback(async(s,r={})=>{ri(t.current,Vb),t.current&&(typeof s=="number"?i.navigate(s):await i.navigate(s,{fromRouteId:e,...r}))},[i,e])}var L0={};function Hb(i,e,t){!e&&!L0[i]&&(L0[i]=!0,ri(!1,t))}O.memo(tT);function tT({routes:i,future:e,state:t}){return qb(i,void 0,t,e)}function Zt(i){gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nT({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:r=!1}){gt(!Ta(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=i.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:s,static:r,future:{}}),[l,s,r]);typeof t=="string"&&(t=Qo(t));let{pathname:f="/",search:d="",hash:g="",state:v=null,key:b="default"}=t,C=O.useMemo(()=>{let E=Ii(f,l);return E==null?null:{location:{pathname:E,search:d,hash:g,state:v,key:b},navigationType:n}},[l,f,d,g,v,b,n]);return ri(C!=null,`<Router basename="${l}"> is not able to match the URL "${f}${d}${g}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:O.createElement(li.Provider,{value:c},O.createElement(_a.Provider,{children:e,value:C}))}function iT({children:i,location:e}){return H_(oh(i),e)}function oh(i,e=[]){let t=[];return O.Children.forEach(i,(n,s)=>{if(!O.isValidElement(n))return;let r=[...e,s];if(n.type===O.Fragment){t.push.apply(t,oh(n.props.children,r));return}gt(n.type===Zt,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=oh(n.props.children,r)),t.push(l)}),t}var cc="get",uc="application/x-www-form-urlencoded";function Lc(i){return i!=null&&typeof i.tagName=="string"}function sT(i){return Lc(i)&&i.tagName.toLowerCase()==="button"}function oT(i){return Lc(i)&&i.tagName.toLowerCase()==="form"}function rT(i){return Lc(i)&&i.tagName.toLowerCase()==="input"}function aT(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function lT(i,e){return i.button===0&&(!e||e==="_self")&&!aT(i)}var Jl=null;function cT(){if(Jl===null)try{new FormData(document.createElement("form"),0),Jl=!1}catch{Jl=!0}return Jl}var uT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yf(i){return i!=null&&!uT.has(i)?(ri(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uc}"`),null):i}function dT(i,e){let t,n,s,r,l;if(oT(i)){let c=i.getAttribute("action");n=c?Ii(c,e):null,t=i.getAttribute("method")||cc,s=yf(i.getAttribute("enctype"))||uc,r=new FormData(i)}else if(sT(i)||rT(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=i.getAttribute("formaction")||c.getAttribute("action");if(n=f?Ii(f,e):null,t=i.getAttribute("formmethod")||c.getAttribute("method")||cc,s=yf(i.getAttribute("formenctype"))||yf(c.getAttribute("enctype"))||uc,r=new FormData(c,i),!cT()){let{name:d,type:g,value:v}=i;if(g==="image"){let b=d?`${d}.`:"";r.append(`${b}x`,"0"),r.append(`${b}y`,"0")}else d&&r.append(d,v)}}else{if(Lc(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=cc,n=null,s=uc,l=i}return r&&s==="text/plain"&&(l=r,r=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:r,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hh(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function fT(i,e,t){let n=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&Ii(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function hT(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function pT(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function mT(i,e,t){let n=await Promise.all(i.map(async s=>{let r=e.routes[s.route.id];if(r){let l=await hT(r,t);return l.links?l.links():[]}return[]}));return xT(n.flat(1).filter(pT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function P0(i,e,t,n,s,r){let l=(f,d)=>t[d]?f.route.id!==t[d].route.id:!0,c=(f,d)=>t[d].pathname!==f.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==f.params["*"];return r==="assets"?e.filter((f,d)=>l(f,d)||c(f,d)):r==="data"?e.filter((f,d)=>{let g=n.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(l(f,d)||c(f,d))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function gT(i,e,{includeHydrateFallback:t}={}){return yT(i.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let r=[s.module];return s.clientActionModule&&(r=r.concat(s.clientActionModule)),s.clientLoaderModule&&(r=r.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(r=r.concat(s.hydrateFallbackModule)),s.imports&&(r=r.concat(s.imports)),r}).flat(1))}function yT(i){return[...new Set(i)]}function vT(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function xT(i,e){let t=new Set;return new Set(e),i.reduce((n,s)=>{let r=JSON.stringify(vT(s));return t.has(r)||(t.add(r),n.push({key:r,link:s})),n},[])}function jb(){let i=O.useContext(Zo);return Hh(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function bT(){let i=O.useContext(kc);return Hh(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var jh=O.createContext(void 0);jh.displayName="FrameworkContext";function zb(){let i=O.useContext(jh);return Hh(i,"You must render this element inside a <HydratedRouter> element"),i}function ST(i,e){let t=O.useContext(jh),[n,s]=O.useState(!1),[r,l]=O.useState(!1),{onFocus:c,onBlur:f,onMouseEnter:d,onMouseLeave:g,onTouchStart:v}=e,b=O.useRef(null);O.useEffect(()=>{if(i==="render"&&l(!0),i==="viewport"){let A=w=>{w.forEach(N=>{l(N.isIntersecting)})},_=new IntersectionObserver(A,{threshold:.5});return b.current&&_.observe(b.current),()=>{_.disconnect()}}},[i]),O.useEffect(()=>{if(n){let A=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(A)}}},[n]);let C=()=>{s(!0)},E=()=>{s(!1),l(!1)};return t?i!=="intent"?[r,b,{}]:[r,b,{onFocus:ia(c,C),onBlur:ia(f,E),onMouseEnter:ia(d,C),onMouseLeave:ia(g,E),onTouchStart:ia(v,C)}]:[!1,b,{}]}function ia(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function CT({page:i,...e}){let{router:t}=jb(),n=O.useMemo(()=>kb(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?O.createElement(ET,{page:i,matches:n,...e}):null}function AT(i){let{manifest:e,routeModules:t}=zb(),[n,s]=O.useState([]);return O.useEffect(()=>{let r=!1;return mT(i,e,t).then(l=>{r||s(l)}),()=>{r=!0}},[i,e,t]),n}function ET({page:i,matches:e,...t}){let n=ki(),{manifest:s,routeModules:r}=zb(),{basename:l}=jb(),{loaderData:c,matches:f}=bT(),d=O.useMemo(()=>P0(i,e,f,s,n,"data"),[i,e,f,s,n]),g=O.useMemo(()=>P0(i,e,f,s,n,"assets"),[i,e,f,s,n]),v=O.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let E=new Set,A=!1;if(e.forEach(w=>{let N=s.routes[w.route.id];!N||!N.hasLoader||(!d.some(M=>M.route.id===w.route.id)&&w.route.id in c&&r[w.route.id]?.shouldRevalidate||N.hasClientLoader?A=!0:E.add(w.route.id))}),E.size===0)return[];let _=fT(i,l,"data");return A&&E.size>0&&_.searchParams.set("_routes",e.filter(w=>E.has(w.route.id)).map(w=>w.route.id).join(",")),[_.pathname+_.search]},[l,c,n,s,d,e,i,r]),b=O.useMemo(()=>gT(g,s),[g,s]),C=AT(g);return O.createElement(O.Fragment,null,v.map(E=>O.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...t})),b.map(E=>O.createElement("link",{key:E,rel:"modulepreload",href:E,...t})),C.map(({key:E,link:A})=>O.createElement("link",{key:E,...A})))}function _T(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var $b=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$b&&(window.__reactRouterVersion="7.7.1")}catch{}function TT({basename:i,children:e,window:t}){let n=O.useRef();n.current==null&&(n.current=p_({window:t,v5Compat:!0}));let s=n.current,[r,l]=O.useState({action:s.action,location:s.location}),c=O.useCallback(f=>{O.startTransition(()=>l(f))},[l]);return O.useLayoutEffect(()=>s.listen(c),[s,c]),O.createElement(nT,{basename:i,children:e,location:r.location,navigationType:r.action,navigator:s})}var Yb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ma=O.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:r,replace:l,state:c,target:f,to:d,preventScrollReset:g,viewTransition:v,...b},C){let{basename:E}=O.useContext(li),A=typeof d=="string"&&Yb.test(d),_,w=!1;if(typeof d=="string"&&A&&(_=d,$b))try{let F=new URL(window.location.href),$=d.startsWith("//")?new URL(F.protocol+d):new URL(d),K=Ii($.pathname,E);$.origin===F.origin&&K!=null?d=K+$.search+$.hash:w=!0}catch{ri(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=G_(d,{relative:s}),[M,k,R]=ST(n,b),I=RT(d,{replace:l,state:c,target:f,preventScrollReset:g,relative:s,viewTransition:v});function P(F){e&&e(F),F.defaultPrevented||I(F)}let q=O.createElement("a",{...b,...R,href:_||N,onClick:w||r?e:P,ref:_T(C,k),target:f,"data-discover":!A&&t==="render"?"true":void 0});return M&&!A?O.createElement(O.Fragment,null,q,O.createElement(CT,{page:N})):q});Ma.displayName="Link";var wT=O.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:r,to:l,viewTransition:c,children:f,...d},g){let v=wa(l,{relative:d.relative}),b=ki(),C=O.useContext(kc),{navigator:E,basename:A}=O.useContext(li),_=C!=null&&PT(v)&&c===!0,w=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,N=b.pathname,M=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;t||(N=N.toLowerCase(),M=M?M.toLowerCase():null,w=w.toLowerCase()),M&&A&&(M=Ii(M,A)||M);const k=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let R=N===w||!s&&N.startsWith(w)&&N.charAt(k)==="/",I=M!=null&&(M===w||!s&&M.startsWith(w)&&M.charAt(w.length)==="/"),P={isActive:R,isPending:I,isTransitioning:_},q=R?e:void 0,F;typeof n=="function"?F=n(P):F=[n,R?"active":null,I?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let $=typeof r=="function"?r(P):r;return O.createElement(Ma,{...d,"aria-current":q,className:F,ref:g,style:$,to:l,viewTransition:c},typeof f=="function"?f(P):f)});wT.displayName="NavLink";var MT=O.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:r,method:l=cc,action:c,onSubmit:f,relative:d,preventScrollReset:g,viewTransition:v,...b},C)=>{let E=kT(),A=LT(c,{relative:d}),_=l.toLowerCase()==="get"?"get":"post",w=typeof c=="string"&&Yb.test(c),N=M=>{if(f&&f(M),M.defaultPrevented)return;M.preventDefault();let k=M.nativeEvent.submitter,R=k?.getAttribute("formmethod")||l;E(k||M.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:s,state:r,relative:d,preventScrollReset:g,viewTransition:v})};return O.createElement("form",{ref:C,method:_,action:A,onSubmit:n?f:N,...b,"data-discover":!w&&i==="render"?"true":void 0})});MT.displayName="Form";function NT(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wb(i){let e=O.useContext(Zo);return gt(e,NT(i)),e}function RT(i,{target:e,replace:t,state:n,preventScrollReset:s,relative:r,viewTransition:l}={}){let c=js(),f=ki(),d=wa(i,{relative:r});return O.useCallback(g=>{if(lT(g,e)){g.preventDefault();let v=t!==void 0?t:xa(f)===xa(d);c(i,{replace:v,state:n,preventScrollReset:s,relative:r,viewTransition:l})}},[f,c,d,t,n,e,i,s,r,l])}var IT=0,DT=()=>`__${String(++IT)}__`;function kT(){let{router:i}=Wb("useSubmit"),{basename:e}=O.useContext(li),t=Q_();return O.useCallback(async(n,s={})=>{let{action:r,method:l,encType:c,formData:f,body:d}=dT(n,e);if(s.navigate===!1){let g=s.fetcherKey||DT();await i.fetch(g,t,s.action||r,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||l,formEncType:s.encType||c,flushSync:s.flushSync})}else await i.navigate(s.action||r,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||l,formEncType:s.encType||c,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[i,e,t])}function LT(i,{relative:e}={}){let{basename:t}=O.useContext(li),n=O.useContext(Di);gt(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),r={...wa(i||".",{relative:e})},l=ki();if(i==null){r.search=l.search;let c=new URLSearchParams(r.search),f=c.getAll("index");if(f.some(g=>g==="")){c.delete("index"),f.filter(v=>v).forEach(v=>c.append("index",v));let g=c.toString();r.search=g?`?${g}`:""}}return(!i||i===".")&&s.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:Ri([t,r.pathname])),xa(r)}function PT(i,{relative:e}={}){let t=O.useContext(Bb);gt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Wb("useViewTransitionState"),s=wa(i,{relative:e});if(!t.isTransitioning)return!1;let r=Ii(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=Ii(t.nextLocation.pathname,n)||t.nextLocation.pathname;return xc(s.pathname,l)!=null||xc(s.pathname,r)!=null}const FT=()=>y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:"mr-4",children:y.jsx("img",{src:"/icons/study-lab-azul-nocturno-optimized.svg",alt:"Study Lab",className:"w-12 h-12 drop-shadow-sm"})}),y.jsx("div",{className:"ml-2",children:y.jsx("h1",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:"Study Lab"})})]}),F0=({items:i})=>{const e=ki();return y.jsx("nav",{className:"flex items-center gap-8",children:i.map(t=>{const n=t.path==="/study-lab/study"?e.pathname.startsWith("/study-lab/study"):e.pathname===t.path;return y.jsxs(Ma,{to:t.path,className:`relative py-2 text-sm font-medium transition-all duration-200 group focus:outline-none focus:ring-0 ${n?"text-blue-600":"text-gray-700 hover:text-blue-600"}`,children:[t.label,y.jsx("span",{className:`absolute bottom-0 left-0 h-0.5 bg-blue-600 transition-all duration-200 ${n?"w-full":"w-0 group-hover:w-full"}`})]},t.path)})})},OT=({items:i,questions:e})=>{const t=ki(),n=i.some(s=>t.pathname===s.path);return y.jsxs("div",{className:"relative group",children:[y.jsxs("div",{className:"relative",children:[y.jsxs("div",{className:`relative py-2 text-sm font-medium transition-all duration-200 cursor-pointer flex items-center group-hover:text-blue-600 ${n?"text-blue-600":"text-gray-700"}`,children:["Gestor de Preguntas",e.length>0&&y.jsx("div",{className:"bg-blue-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-semibold ml-2 min-w-[20px]",children:e.length}),y.jsx("svg",{className:"w-4 h-4 ml-2 transform transition-transform group-hover:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y.jsx("span",{className:`absolute bottom-0 left-0 h-0.5 bg-blue-600 transition-all duration-200 ${n?"w-full":"w-0 group-hover:w-full"}`})]}),y.jsx("div",{className:"absolute right-0 mt-2 w-52 bg-white rounded-lg shadow-xl border border-gray-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 overflow-hidden",children:y.jsx("div",{className:"py-2",children:i.map(s=>{const r=t.pathname===s.path,l=s.path==="/study-lab/questions";return y.jsxs("div",{className:"relative",children:[y.jsxs(Ma,{to:s.path,className:`block px-4 py-3 text-sm transition-colors relative focus:outline-none focus:ring-0 ${r?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.label,l&&e.length>0&&y.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-blue-500 text-white text-xs rounded-full h-6 w-6 flex items-center justify-center font-medium px-1 min-w-[24px]",children:e.length})]}),r&&y.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-600"})]},s.path)})})})]})},UT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),BT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),VT=({className:i=""})=>{const[e,t]=O.useState(!1),n=()=>{t(!e),console.log("Theme toggle clicked:",e?"light":"dark")};return y.jsx("button",{onClick:n,className:`
        relative p-2 rounded-lg transition-all duration-200 
        hover:bg-gray-100 hover:scale-105 
        focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
        group ${i}
      `,"aria-label":e?"Cambiar a modo claro":"Cambiar a modo oscuro",title:e?"Cambiar a modo claro":"Cambiar a modo oscuro",children:y.jsxs("div",{className:"relative w-5 h-5",children:[y.jsx(UT,{className:`
            absolute inset-0 w-5 h-5 transition-all duration-300 text-amber-500
            ${e?"opacity-0 rotate-90 scale-75":"opacity-100 rotate-0 scale-100"}
          `}),y.jsx(BT,{className:`
            absolute inset-0 w-5 h-5 transition-all duration-300 text-slate-600
            ${e?"opacity-100 rotate-0 scale-100":"opacity-0 -rotate-90 scale-75"}
          `})]})})},GT=({questions:i})=>{const e=[{path:"/study-lab/create",label:"Crear Preguntas"},{path:"/study-lab/questions",label:"Ver Preguntas"},{path:"/study-lab/import",label:"Importar PDF"}],t=[{path:"/study-lab/",label:"Inicio"},{path:"/study-lab/study",label:"Estudiar"}],n={path:"/study-lab/api-test",label:"Test API"};return y.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50",children:[y.jsx("div",{className:"absolute inset-0 bg-gray-50/90 backdrop-blur-md border-b border-gray-300/60"}),y.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx(FT,{}),y.jsxs("div",{className:"flex items-center gap-12",children:[y.jsx(F0,{items:t}),y.jsx(OT,{items:e,questions:i}),y.jsx(F0,{items:[n]}),y.jsx(VT,{})]})]})})]})},qT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),zh=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Kb=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Xb=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),rh=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),HT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}),Jb=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),O0=({className:i})=>y.jsxs("svg",{className:i,fill:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#22c55e"}),y.jsx("path",{fill:"white",d:"M9 12l2 2 4-4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),jT=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12.9 2.7l8.4 8.4a1 1 0 010 1.4l-8.4 8.4a1 1 0 01-1.4 0l-8.4-8.4a1 1 0 010-1.4l8.4-8.4a1 1 0 011.4 0zM7.5 7.5l9 9"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16.5 21H3"})]}),$h=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),Qb=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})}),Zb=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),ah=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),zT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),$T=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),YT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})}),WT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})}),KT=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 4l10 8-10 8V4z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 5v14"})]}),XT=({content:i,children:e,position:t="top",delay:n=300,className:s=""})=>{const[r,l]=O.useState(!1),[c,f]=O.useState(t),[d,g]=O.useState(!1),v=O.useRef(null),b=O.useRef(null),C=O.useRef(null);O.useEffect(()=>{const k=()=>{g("ontouchstart"in window||navigator.maxTouchPoints>0)};return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]);const E=()=>{const k=d?0:n;v.current=window.setTimeout(()=>{l(!0)},k)},A=()=>{v.current&&clearTimeout(v.current),l(!1)},_=()=>{d&&(r?A():E())};O.useEffect(()=>{if(d&&r){const k=R=>{C.current&&!C.current.contains(R.target)&&b.current&&!b.current.contains(R.target)&&A()};return document.addEventListener("touchstart",k),document.addEventListener("click",k),()=>{document.removeEventListener("touchstart",k),document.removeEventListener("click",k)}}},[d,r]),O.useEffect(()=>{if(r&&b.current&&C.current){const k=b.current,I=C.current.getBoundingClientRect(),P=k.getBoundingClientRect(),q={width:window.innerWidth,height:window.innerHeight};let F=t;t==="top"&&I.top-P.height<20?F="bottom":t==="bottom"&&I.bottom+P.height>q.height-20?F="top":t==="left"&&I.left-P.width<20?F="right":t==="right"&&I.right+P.width>q.width-20&&(F="left"),F==="top"&&I.top-P.height<20?F=I.bottom+P.height<q.height-20?"bottom":"top":F==="bottom"&&I.bottom+P.height>q.height-20&&(F=I.top-P.height>20?"top":"bottom"),f(F)}},[r,t]);const w=()=>`
      absolute z-50 px-4 py-3 text-sm text-gray-800 bg-white rounded-lg shadow-xl border border-gray-200
      w-max max-w-xs sm:max-w-sm md:max-w-md text-left pointer-events-none leading-relaxed
      transition-all duration-200 backdrop-blur-sm
     ${{top:"bottom-full left-1/2 transform -translate-x-1/2 mb-3",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-3",left:"right-full top-1/2 transform -translate-y-1/2 mr-3",right:"left-full top-1/2 transform -translate-y-1/2 ml-3"}[c]} ${s}`,N=()=>`absolute w-0 h-0 ${{top:"top-full left-1/2 transform -translate-x-1/2 border-l-8 border-r-8 border-t-8 border-transparent border-t-white z-10",bottom:"bottom-full left-1/2 transform -translate-x-1/2 border-l-8 border-r-8 border-b-8 border-transparent border-b-white z-10",left:"left-full top-1/2 transform -translate-y-1/2 border-t-8 border-b-8 border-l-8 border-transparent border-l-white z-10",right:"right-full top-1/2 transform -translate-y-1/2 border-t-8 border-b-8 border-r-8 border-transparent border-r-white z-10"}[c]}`,M=()=>`absolute w-0 h-0 ${{top:"top-full left-1/2 transform -translate-x-1/2 translate-y-px border-l-[9px] border-r-[9px] border-t-[9px] border-transparent border-t-gray-200",bottom:"bottom-full left-1/2 transform -translate-x-1/2 -translate-y-px border-l-[9px] border-r-[9px] border-b-[9px] border-transparent border-b-gray-200",left:"left-full top-1/2 transform -translate-y-1/2 translate-x-px border-t-[9px] border-b-[9px] border-l-[9px] border-transparent border-l-gray-200",right:"right-full top-1/2 transform -translate-y-1/2 -translate-x-px border-t-[9px] border-b-[9px] border-r-[9px] border-transparent border-r-gray-200"}[c]}`;return y.jsxs("div",{ref:C,className:"relative inline-block",onMouseEnter:d?void 0:E,onMouseLeave:d?void 0:A,onFocus:d?void 0:E,onBlur:d?void 0:A,onClick:d?_:void 0,onTouchStart:d?_:void 0,children:[e,r&&i&&y.jsxs("div",{ref:b,className:w(),role:"tooltip","aria-label":i,children:[i,y.jsx("div",{className:N()}),y.jsx("div",{className:M()})]})]})},bc=({className:i="",size:e="md",variant:t="outline",tooltip:n})=>{const r=`${{sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[e]} ${i}`,l=t==="filled"?y.jsx("svg",{className:r,fill:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.671-1.34l.041-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})}):y.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});return n?y.jsx(XT,{content:n,children:l}):l},lh=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M21 19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Sc=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),y.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),y.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),Yh=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2a10 10 0 100 20 10 10 0 000-20zm0 6a4 4 0 100 8 4 4 0 000-8zm0 2a2 2 0 100 4 2 2 0 000-4z"})}),JT=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("rect",{x:"6",y:"10",width:"12",height:"8",rx:"2",strokeWidth:"2"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v2"}),y.jsx("circle",{cx:"9",cy:"13",r:"1",fill:"currentColor"}),y.jsx("circle",{cx:"15",cy:"13",r:"1",fill:"currentColor"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 16h6"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 14h1m12 0h1"})]}),Wh=({className:i})=>y.jsxs("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 19V9a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14 11V9a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v2"})]}),QT=({className:i})=>y.jsxs("svg",{className:`${i} animate-spin`,fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ZT=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 11V7a4 4 0 1 1 8 0m-4 8v2m-6 4h12a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2z"})}),eS=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),ew=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),ch=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),tw=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),tS=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C20.168 18.477 18.582 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),nS=({className:i})=>y.jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),nw=i=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...i,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),Kh=i=>y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...i,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),iw=()=>{const i=[{id:"create",title:"Crear Preguntas",description:"Diseña preguntas efectivas para tus exámenes con opciones múltiples, explicaciones y referencias educativas.",icon:y.jsx(zh,{className:"w-8 h-8"}),link:"/study-lab/create",color:"bg-blue-50 text-blue-600",borderColor:"border-blue-200 hover:border-blue-300",features:["Formulario intuitivo con validación","Opciones de respuesta dinámicas","Campos de explicación y referencia","Numeración automática de preguntas"]},{id:"questions",title:"Gestión de Preguntas",description:"Organiza y gestiona tu biblioteca de preguntas de manera eficiente. Edita, elimina y descarga tu contenido.",icon:y.jsx(bc,{className:"w-8 h-8"}),link:"/study-lab/questions",color:"bg-green-50 text-green-600",borderColor:"border-green-200 hover:border-green-300",features:["Vista completa de todas las preguntas","Edición in-situ de contenido","Eliminación individual o masiva","Exportación a JSON"]},{id:"import",title:"Importar desde PDF",description:"Sube archivos PDF para extraer preguntas automáticamente usando inteligencia artificial.",icon:y.jsx(ch,{className:"w-8 h-8"}),link:"/study-lab/import",color:"bg-purple-50 text-purple-600",borderColor:"border-purple-200 hover:border-purple-300",features:["Procesamiento automático de PDF","Extracción inteligente con IA","Configuración de parámetros de generación","Validación antes de importar"]},{id:"study",title:"Sistema de Estudio",description:"Practica con tus preguntas usando diferentes modalidades: flashcards interactivas o exámenes simulados.",icon:y.jsx(tS,{className:"w-8 h-8"}),link:"/study-lab/study",color:"bg-orange-50 text-orange-600",borderColor:"border-orange-200 hover:border-orange-300",features:["Modo Flashcards: estudio interactivo","Modo Examen: simulacros con tiempo","Selección de alcance (todas, rango, aleatorias)","Configuración de límite de tiempo"]},{id:"results",title:"Resultados y Análisis",description:"Revisa tu desempeño en sesiones completadas con estadísticas detalladas y análisis de progreso.",icon:y.jsx(Wh,{className:"w-8 h-8"}),link:"/study-lab/study/session-results",color:"bg-indigo-50 text-indigo-600",borderColor:"border-indigo-200 hover:border-indigo-300",features:["Estadísticas detalladas de rendimiento","Análisis de respuestas incorrectas","Historial de sesiones de estudio","Opción de repetir configuraciones"]},{id:"api-test",title:"Test de API",description:"Prueba la conexión y configuración de la API de Google AI Studio para asegurar el correcto funcionamiento.",icon:y.jsx(Kh,{className:"w-8 h-8"}),link:"/study-lab/api-test",color:"bg-red-50 text-red-600",borderColor:"border-red-200 hover:border-red-300",features:["Verificación de conectividad","Validación de API key","Test de generación de contenido","Diagnóstico de problemas"]}];return y.jsx("div",{className:"min-h-screen bg-gray-50 w-full",children:y.jsxs("div",{className:"container mx-auto px-4 py-16",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-4",children:"Bienvenido a Study Lab"}),y.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Una plataforma completa para crear, gestionar y estudiar preguntas de examen. Utiliza inteligencia artificial para optimizar tu proceso de aprendizaje."})]}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:i.map(e=>y.jsxs(Ma,{to:e.link,className:`block bg-white rounded-xl border-2 ${e.borderColor} p-6 transition-all duration-200 hover:shadow-lg hover:scale-105 group`,children:[y.jsxs("div",{className:"mb-4",children:[y.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-lg ${e.color} mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.icon}),y.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.title}),y.jsx("p",{className:"text-gray-600 mb-4",children:e.description})]}),y.jsx("ul",{className:"space-y-2",children:e.features.map((t,n)=>y.jsxs("li",{className:"flex items-start text-sm text-gray-500",children:[y.jsx("svg",{className:"w-4 h-4 mt-0.5 mr-2 flex-shrink-0 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:y.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),t]},n))})]},e.id))}),y.jsxs("div",{className:"mt-16 bg-white rounded-xl p-8 border border-gray-200",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"🚀 Primeros pasos recomendados"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[y.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[y.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:"1"}),y.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Configura la API"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Realiza el test de API para asegurar la conectividad con Google AI Studio"})]}),y.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[y.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"2"}),y.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Crea o Importa"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Añade preguntas manualmente o importa desde archivos PDF"})]}),y.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[y.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:"3"}),y.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Comienza a Estudiar"}),y.jsx("p",{className:"text-sm text-gray-600",children:"Utiliza flashcards o exámenes simulados para practicar"})]})]})]})]})})};var Na=i=>i.type==="checkbox",Ls=i=>i instanceof Date,on=i=>i==null;const iS=i=>typeof i=="object";var Et=i=>!on(i)&&!Array.isArray(i)&&iS(i)&&!Ls(i),sw=i=>Et(i)&&i.target?Na(i.target)?i.target.checked:i.target.value:i,ow=i=>i.substring(0,i.search(/\.\d+(\.|$)/))||i,rw=(i,e)=>i.has(ow(e)),aw=i=>{const e=i.constructor&&i.constructor.prototype;return Et(e)&&e.hasOwnProperty("isPrototypeOf")},Xh=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function dt(i){let e;const t=Array.isArray(i),n=typeof FileList<"u"?i instanceof FileList:!1;if(i instanceof Date)e=new Date(i);else if(!(Xh&&(i instanceof Blob||n))&&(t||Et(i)))if(e=t?[]:{},!t&&!aw(i))e=i;else for(const s in i)i.hasOwnProperty(s)&&(e[s]=dt(i[s]));else return i;return e}var Pc=i=>/^\w*$/.test(i),ft=i=>i===void 0,Fc=i=>Array.isArray(i)?i.filter(Boolean):[],Jh=i=>Fc(i.replace(/["|']|\]/g,"").split(/\.|\[/)),ye=(i,e,t)=>{if(!e||!Et(i))return t;const n=(Pc(e)?[e]:Jh(e)).reduce((s,r)=>on(s)?s:s[r],i);return ft(n)||n===i?ft(i[e])?t:i[e]:n},ii=i=>typeof i=="boolean",rt=(i,e,t)=>{let n=-1;const s=Pc(e)?[e]:Jh(e),r=s.length,l=r-1;for(;++n<r;){const c=s[n];let f=t;if(n!==l){const d=i[c];f=Et(d)||Array.isArray(d)?d:isNaN(+s[n+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;i[c]=f,i=i[c]}};const U0={BLUR:"blur",FOCUS_OUT:"focusout"},On={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},_i={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},sS=Ve.createContext(null);sS.displayName="HookFormContext";const oS=()=>Ve.useContext(sS);var lw=(i,e,t,n=!0)=>{const s={defaultValues:e._defaultValues};for(const r in i)Object.defineProperty(s,r,{get:()=>{const l=r;return e._proxyFormState[l]!==On.all&&(e._proxyFormState[l]=!n||On.all),i[l]}});return s};const Qh=typeof window<"u"?Ve.useLayoutEffect:Ve.useEffect;var oi=i=>typeof i=="string",rS=(i,e,t,n,s)=>oi(i)?(n&&e.watch.add(i),ye(t,i,s)):Array.isArray(i)?i.map(r=>(n&&e.watch.add(r),ye(t,r))):(n&&(e.watchAll=!0),t),uh=i=>on(i)||!iS(i);function Ni(i,e,t=new WeakSet){if(uh(i)||uh(e))return i===e;if(Ls(i)&&Ls(e))return i.getTime()===e.getTime();const n=Object.keys(i),s=Object.keys(e);if(n.length!==s.length)return!1;if(t.has(i)||t.has(e))return!0;t.add(i),t.add(e);for(const r of n){const l=i[r];if(!s.includes(r))return!1;if(r!=="ref"){const c=e[r];if(Ls(l)&&Ls(c)||Et(l)&&Et(c)||Array.isArray(l)&&Array.isArray(c)?!Ni(l,c,t):l!==c)return!1}}return!0}function B0(i){const e=oS(),{control:t=e.control,name:n,defaultValue:s,disabled:r,exact:l,compute:c}=i||{},f=Ve.useRef(s),d=Ve.useRef(c),g=Ve.useRef(void 0);d.current=c;const v=Ve.useMemo(()=>t._getWatch(n,f.current),[t,n]),[b,C]=Ve.useState(d.current?d.current(v):v);return Qh(()=>t._subscribe({name:n,formState:{values:!0},exact:l,callback:E=>{if(!r){const A=rS(n,t._names,E.values||t._formValues,!1,f.current);if(d.current){const _=d.current(A);Ni(_,g.current)||(C(_),g.current=_)}else C(A)}}}),[t,r,n,l]),Ve.useEffect(()=>t._removeUnmounted()),b}var cw=(i,e,t,n,s)=>e?{...t[i],types:{...t[i]&&t[i].types?t[i].types:{},[n]:s||!0}}:{},gn=i=>Array.isArray(i)?i:[i],V0=()=>{let i=[];return{get observers(){return i},next:s=>{for(const r of i)r.next&&r.next(s)},subscribe:s=>(i.push(s),{unsubscribe:()=>{i=i.filter(r=>r!==s)}}),unsubscribe:()=>{i=[]}}},tn=i=>Et(i)&&!Object.keys(i).length,Zh=i=>i.type==="file",jn=i=>typeof i=="function",Cc=i=>{if(!Xh)return!1;const e=i?i.ownerDocument:0;return i instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},aS=i=>i.type==="select-multiple",ep=i=>i.type==="radio",uw=i=>ep(i)||Na(i),vf=i=>Cc(i)&&i.isConnected;function dw(i,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)i=ft(i)?n++:i[e[n++]];return i}function fw(i){for(const e in i)if(i.hasOwnProperty(e)&&!ft(i[e]))return!1;return!0}function Ct(i,e){const t=Array.isArray(e)?e:Pc(e)?[e]:Jh(e),n=t.length===1?i:dw(i,t),s=t.length-1,r=t[s];return n&&delete n[r],s!==0&&(Et(n)&&tn(n)||Array.isArray(n)&&fw(n))&&Ct(i,t.slice(0,-1)),i}var lS=i=>{for(const e in i)if(jn(i[e]))return!0;return!1};function Ac(i,e={}){const t=Array.isArray(i);if(Et(i)||t)for(const n in i)Array.isArray(i[n])||Et(i[n])&&!lS(i[n])?(e[n]=Array.isArray(i[n])?[]:{},Ac(i[n],e[n])):on(i[n])||(e[n]=!0);return e}function cS(i,e,t){const n=Array.isArray(i);if(Et(i)||n)for(const s in i)Array.isArray(i[s])||Et(i[s])&&!lS(i[s])?ft(e)||uh(t[s])?t[s]=Array.isArray(i[s])?Ac(i[s],[]):{...Ac(i[s])}:cS(i[s],on(e)?{}:e[s],t[s]):t[s]=!Ni(i[s],e[s]);return t}var sa=(i,e)=>cS(i,e,Ac(e));const G0={value:!1,isValid:!1},q0={value:!0,isValid:!0};var uS=i=>{if(Array.isArray(i)){if(i.length>1){const e=i.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return i[0].checked&&!i[0].disabled?i[0].attributes&&!ft(i[0].attributes.value)?ft(i[0].value)||i[0].value===""?q0:{value:i[0].value,isValid:!0}:q0:G0}return G0},dS=(i,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>ft(i)?i:e?i===""?NaN:i&&+i:t&&oi(i)?new Date(i):n?n(i):i;const H0={isValid:!1,value:null};var fS=i=>Array.isArray(i)?i.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,H0):H0;function j0(i){const e=i.ref;return Zh(e)?e.files:ep(e)?fS(i.refs).value:aS(e)?[...e.selectedOptions].map(({value:t})=>t):Na(e)?uS(i.refs).value:dS(ft(e.value)?i.ref.value:e.value,i)}var hw=(i,e,t,n)=>{const s={};for(const r of i){const l=ye(e,r);l&&rt(s,r,l._f)}return{criteriaMode:t,names:[...i],fields:s,shouldUseNativeValidation:n}},Ec=i=>i instanceof RegExp,oa=i=>ft(i)?i:Ec(i)?i.source:Et(i)?Ec(i.value)?i.value.source:i.value:i,Go=i=>({isOnSubmit:!i||i===On.onSubmit,isOnBlur:i===On.onBlur,isOnChange:i===On.onChange,isOnAll:i===On.all,isOnTouch:i===On.onTouched});const z0="AsyncFunction";var pw=i=>!!i&&!!i.validate&&!!(jn(i.validate)&&i.validate.constructor.name===z0||Et(i.validate)&&Object.values(i.validate).find(e=>e.constructor.name===z0)),mw=i=>i.mount&&(i.required||i.min||i.max||i.maxLength||i.minLength||i.pattern||i.validate),dh=(i,e,t)=>!t&&(e.watchAll||e.watch.has(i)||[...e.watch].some(n=>i.startsWith(n)&&/^\.\w+/.test(i.slice(n.length))));const zo=(i,e,t,n)=>{for(const s of t||Object.keys(i)){const r=ye(i,s);if(r){const{_f:l,...c}=r;if(l){if(l.refs&&l.refs[0]&&e(l.refs[0],s)&&!n)return!0;if(l.ref&&e(l.ref,l.name)&&!n)return!0;if(zo(c,e))break}else if(Et(c)&&zo(c,e))break}}};function $0(i,e,t){const n=ye(i,t);if(n||Pc(t))return{error:n,name:t};const s=t.split(".");for(;s.length;){const r=s.join("."),l=ye(e,r),c=ye(i,r);if(l&&!Array.isArray(l)&&t!==r)return{name:t};if(c&&c.type)return{name:r,error:c};if(c&&c.root&&c.root.type)return{name:`${r}.root`,error:c.root};s.pop()}return{name:t}}var gw=(i,e,t,n)=>{t(i);const{name:s,...r}=i;return tn(r)||Object.keys(r).length>=Object.keys(e).length||Object.keys(r).find(l=>e[l]===(!n||On.all))},yw=(i,e,t)=>!i||!e||i===e||gn(i).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),vw=(i,e,t,n,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||i):(t?n.isOnBlur:s.isOnBlur)?!i:(t?n.isOnChange:s.isOnChange)?i:!0,xw=(i,e)=>!Fc(ye(i,e)).length&&Ct(i,e),hS=(i,e,t)=>{const n=gn(ye(i,t));return rt(n,"root",e[t]),rt(i,t,n),i},dc=i=>oi(i);function Y0(i,e,t="validate"){if(dc(i)||Array.isArray(i)&&i.every(dc)||ii(i)&&!i)return{type:t,message:dc(i)?i:"",ref:e}}var Fo=i=>Et(i)&&!Ec(i)?i:{value:i,message:""},fh=async(i,e,t,n,s,r)=>{const{ref:l,refs:c,required:f,maxLength:d,minLength:g,min:v,max:b,pattern:C,validate:E,name:A,valueAsNumber:_,mount:w}=i._f,N=ye(t,A);if(!w||e.has(A))return{};const M=c?c[0]:l,k=ne=>{s&&M.reportValidity&&(M.setCustomValidity(ii(ne)?"":ne||""),M.reportValidity())},R={},I=ep(l),P=Na(l),q=I||P,F=(_||Zh(l))&&ft(l.value)&&ft(N)||Cc(l)&&l.value===""||N===""||Array.isArray(N)&&!N.length,$=cw.bind(null,A,n,R),K=(ne,ae,ce,me=_i.maxLength,U=_i.minLength)=>{const X=ne?ae:ce;R[A]={type:ne?me:U,message:X,ref:l,...$(ne?me:U,X)}};if(r?!Array.isArray(N)||!N.length:f&&(!q&&(F||on(N))||ii(N)&&!N||P&&!uS(c).isValid||I&&!fS(c).isValid)){const{value:ne,message:ae}=dc(f)?{value:!!f,message:f}:Fo(f);if(ne&&(R[A]={type:_i.required,message:ae,ref:M,...$(_i.required,ae)},!n))return k(ae),R}if(!F&&(!on(v)||!on(b))){let ne,ae;const ce=Fo(b),me=Fo(v);if(!on(N)&&!isNaN(N)){const U=l.valueAsNumber||N&&+N;on(ce.value)||(ne=U>ce.value),on(me.value)||(ae=U<me.value)}else{const U=l.valueAsDate||new Date(N),X=L=>new Date(new Date().toDateString()+" "+L),de=l.type=="time",te=l.type=="week";oi(ce.value)&&N&&(ne=de?X(N)>X(ce.value):te?N>ce.value:U>new Date(ce.value)),oi(me.value)&&N&&(ae=de?X(N)<X(me.value):te?N<me.value:U<new Date(me.value))}if((ne||ae)&&(K(!!ne,ce.message,me.message,_i.max,_i.min),!n))return k(R[A].message),R}if((d||g)&&!F&&(oi(N)||r&&Array.isArray(N))){const ne=Fo(d),ae=Fo(g),ce=!on(ne.value)&&N.length>+ne.value,me=!on(ae.value)&&N.length<+ae.value;if((ce||me)&&(K(ce,ne.message,ae.message),!n))return k(R[A].message),R}if(C&&!F&&oi(N)){const{value:ne,message:ae}=Fo(C);if(Ec(ne)&&!N.match(ne)&&(R[A]={type:_i.pattern,message:ae,ref:l,...$(_i.pattern,ae)},!n))return k(ae),R}if(E){if(jn(E)){const ne=await E(N,t),ae=Y0(ne,M);if(ae&&(R[A]={...ae,...$(_i.validate,ae.message)},!n))return k(ae.message),R}else if(Et(E)){let ne={};for(const ae in E){if(!tn(ne)&&!n)break;const ce=Y0(await E[ae](N,t),M,ae);ce&&(ne={...ce,...$(ae,ce.message)},k(ce.message),n&&(R[A]=ne))}if(!tn(ne)&&(R[A]={ref:M,...ne},!n))return R}}return k(!0),R};const bw={mode:On.onSubmit,reValidateMode:On.onChange,shouldFocusError:!0};function Sw(i={}){let e={...bw,...i},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:jn(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},s=Et(e.defaultValues)||Et(e.values)?dt(e.defaultValues||e.values)||{}:{},r=e.shouldUnregister?{}:dt(s),l={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,d=0;const g={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let v={...g};const b={array:V0(),state:V0()},C=e.criteriaMode===On.all,E=G=>Q=>{clearTimeout(d),d=setTimeout(G,Q)},A=async G=>{if(!e.disabled&&(g.isValid||v.isValid||G)){const Q=e.resolver?tn((await P()).errors):await F(n,!0);Q!==t.isValid&&b.state.next({isValid:Q})}},_=(G,Q)=>{!e.disabled&&(g.isValidating||g.validatingFields||v.isValidating||v.validatingFields)&&((G||Array.from(c.mount)).forEach(se=>{se&&(Q?rt(t.validatingFields,se,Q):Ct(t.validatingFields,se))}),b.state.next({validatingFields:t.validatingFields,isValidating:!tn(t.validatingFields)}))},w=(G,Q=[],se,ge,fe=!0,ue=!0)=>{if(ge&&se&&!e.disabled){if(l.action=!0,ue&&Array.isArray(ye(n,G))){const Se=se(ye(n,G),ge.argA,ge.argB);fe&&rt(n,G,Se)}if(ue&&Array.isArray(ye(t.errors,G))){const Se=se(ye(t.errors,G),ge.argA,ge.argB);fe&&rt(t.errors,G,Se),xw(t.errors,G)}if((g.touchedFields||v.touchedFields)&&ue&&Array.isArray(ye(t.touchedFields,G))){const Se=se(ye(t.touchedFields,G),ge.argA,ge.argB);fe&&rt(t.touchedFields,G,Se)}(g.dirtyFields||v.dirtyFields)&&(t.dirtyFields=sa(s,r)),b.state.next({name:G,isDirty:K(G,Q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else rt(r,G,Q)},N=(G,Q)=>{rt(t.errors,G,Q),b.state.next({errors:t.errors})},M=G=>{t.errors=G,b.state.next({errors:t.errors,isValid:!1})},k=(G,Q,se,ge)=>{const fe=ye(n,G);if(fe){const ue=ye(r,G,ft(se)?ye(s,G):se);ft(ue)||ge&&ge.defaultChecked||Q?rt(r,G,Q?ue:j0(fe._f)):ce(G,ue),l.mount&&A()}},R=(G,Q,se,ge,fe)=>{let ue=!1,Se=!1;const Fe={name:G};if(!e.disabled){if(!se||ge){(g.isDirty||v.isDirty)&&(Se=t.isDirty,t.isDirty=Fe.isDirty=K(),ue=Se!==Fe.isDirty);const je=Ni(ye(s,G),Q);Se=!!ye(t.dirtyFields,G),je?Ct(t.dirtyFields,G):rt(t.dirtyFields,G,!0),Fe.dirtyFields=t.dirtyFields,ue=ue||(g.dirtyFields||v.dirtyFields)&&Se!==!je}if(se){const je=ye(t.touchedFields,G);je||(rt(t.touchedFields,G,se),Fe.touchedFields=t.touchedFields,ue=ue||(g.touchedFields||v.touchedFields)&&je!==se)}ue&&fe&&b.state.next(Fe)}return ue?Fe:{}},I=(G,Q,se,ge)=>{const fe=ye(t.errors,G),ue=(g.isValid||v.isValid)&&ii(Q)&&t.isValid!==Q;if(e.delayError&&se?(f=E(()=>N(G,se)),f(e.delayError)):(clearTimeout(d),f=null,se?rt(t.errors,G,se):Ct(t.errors,G)),(se?!Ni(fe,se):fe)||!tn(ge)||ue){const Se={...ge,...ue&&ii(Q)?{isValid:Q}:{},errors:t.errors,name:G};t={...t,...Se},b.state.next(Se)}},P=async G=>{_(G,!0);const Q=await e.resolver(r,e.context,hw(G||c.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return _(G),Q},q=async G=>{const{errors:Q}=await P(G);if(G)for(const se of G){const ge=ye(Q,se);ge?rt(t.errors,se,ge):Ct(t.errors,se)}else t.errors=Q;return Q},F=async(G,Q,se={valid:!0})=>{for(const ge in G){const fe=G[ge];if(fe){const{_f:ue,...Se}=fe;if(ue){const Fe=c.array.has(ue.name),je=fe._f&&pw(fe._f);je&&g.validatingFields&&_([ge],!0);const st=await fh(fe,c.disabled,r,C,e.shouldUseNativeValidation&&!Q,Fe);if(je&&g.validatingFields&&_([ge]),st[ue.name]&&(se.valid=!1,Q))break;!Q&&(ye(st,ue.name)?Fe?hS(t.errors,st,ue.name):rt(t.errors,ue.name,st[ue.name]):Ct(t.errors,ue.name))}!tn(Se)&&await F(Se,Q,se)}}return se.valid},$=()=>{for(const G of c.unMount){const Q=ye(n,G);Q&&(Q._f.refs?Q._f.refs.every(se=>!vf(se)):!vf(Q._f.ref))&&Ee(G)}c.unMount=new Set},K=(G,Q)=>!e.disabled&&(G&&Q&&rt(r,G,Q),!Ni(L(),s)),ne=(G,Q,se)=>rS(G,c,{...l.mount?r:ft(Q)?s:oi(G)?{[G]:Q}:Q},se,Q),ae=G=>Fc(ye(l.mount?r:s,G,e.shouldUnregister?ye(s,G,[]):[])),ce=(G,Q,se={})=>{const ge=ye(n,G);let fe=Q;if(ge){const ue=ge._f;ue&&(!ue.disabled&&rt(r,G,dS(Q,ue)),fe=Cc(ue.ref)&&on(Q)?"":Q,aS(ue.ref)?[...ue.ref.options].forEach(Se=>Se.selected=fe.includes(Se.value)):ue.refs?Na(ue.ref)?ue.refs.forEach(Se=>{(!Se.defaultChecked||!Se.disabled)&&(Array.isArray(fe)?Se.checked=!!fe.find(Fe=>Fe===Se.value):Se.checked=fe===Se.value||!!fe)}):ue.refs.forEach(Se=>Se.checked=Se.value===fe):Zh(ue.ref)?ue.ref.value="":(ue.ref.value=fe,ue.ref.type||b.state.next({name:G,values:dt(r)})))}(se.shouldDirty||se.shouldTouch)&&R(G,fe,se.shouldTouch,se.shouldDirty,!0),se.shouldValidate&&te(G)},me=(G,Q,se)=>{for(const ge in Q){if(!Q.hasOwnProperty(ge))return;const fe=Q[ge],ue=G+"."+ge,Se=ye(n,ue);(c.array.has(G)||Et(fe)||Se&&!Se._f)&&!Ls(fe)?me(ue,fe,se):ce(ue,fe,se)}},U=(G,Q,se={})=>{const ge=ye(n,G),fe=c.array.has(G),ue=dt(Q);rt(r,G,ue),fe?(b.array.next({name:G,values:dt(r)}),(g.isDirty||g.dirtyFields||v.isDirty||v.dirtyFields)&&se.shouldDirty&&b.state.next({name:G,dirtyFields:sa(s,r),isDirty:K(G,ue)})):ge&&!ge._f&&!on(ue)?me(G,ue,se):ce(G,ue,se),dh(G,c)&&b.state.next({...t,name:G}),b.state.next({name:l.mount?G:void 0,values:dt(r)})},X=async G=>{l.mount=!0;const Q=G.target;let se=Q.name,ge=!0;const fe=ye(n,se),ue=je=>{ge=Number.isNaN(je)||Ls(je)&&isNaN(je.getTime())||Ni(je,ye(r,se,je))},Se=Go(e.mode),Fe=Go(e.reValidateMode);if(fe){let je,st;const Ks=Q.type?j0(fe._f):sw(G),$n=G.type===U0.BLUR||G.type===U0.FOCUS_OUT,Xc=!mw(fe._f)&&!e.resolver&&!ye(t.errors,se)&&!fe._f.deps||vw($n,ye(t.touchedFields,se),t.isSubmitted,Fe,Se),Pi=dh(se,c,$n);rt(r,se,Ks),$n?(fe._f.onBlur&&fe._f.onBlur(G),f&&f(0)):fe._f.onChange&&fe._f.onChange(G);const Fi=R(se,Ks,$n),ci=!tn(Fi)||Pi;if(!$n&&b.state.next({name:se,type:G.type,values:dt(r)}),Xc)return(g.isValid||v.isValid)&&(e.mode==="onBlur"?$n&&A():$n||A()),ci&&b.state.next({name:se,...Pi?{}:Fi});if(!$n&&Pi&&b.state.next({...t}),e.resolver){const{errors:ms}=await P([se]);if(ue(Ks),ge){const gs=$0(t.errors,n,se),Ba=$0(ms,n,gs.name||se);je=Ba.error,se=Ba.name,st=tn(ms)}}else _([se],!0),je=(await fh(fe,c.disabled,r,C,e.shouldUseNativeValidation))[se],_([se]),ue(Ks),ge&&(je?st=!1:(g.isValid||v.isValid)&&(st=await F(n,!0)));ge&&(fe._f.deps&&te(fe._f.deps),I(se,st,je,Fi))}},de=(G,Q)=>{if(ye(t.errors,Q)&&G.focus)return G.focus(),1},te=async(G,Q={})=>{let se,ge;const fe=gn(G);if(e.resolver){const ue=await q(ft(G)?G:fe);se=tn(ue),ge=G?!fe.some(Se=>ye(ue,Se)):se}else G?(ge=(await Promise.all(fe.map(async ue=>{const Se=ye(n,ue);return await F(Se&&Se._f?{[ue]:Se}:Se)}))).every(Boolean),!(!ge&&!t.isValid)&&A()):ge=se=await F(n);return b.state.next({...!oi(G)||(g.isValid||v.isValid)&&se!==t.isValid?{}:{name:G},...e.resolver||!G?{isValid:se}:{},errors:t.errors}),Q.shouldFocus&&!ge&&zo(n,de,G?fe:c.mount),ge},L=G=>{const Q={...l.mount?r:s};return ft(G)?Q:oi(G)?ye(Q,G):G.map(se=>ye(Q,se))},V=(G,Q)=>({invalid:!!ye((Q||t).errors,G),isDirty:!!ye((Q||t).dirtyFields,G),error:ye((Q||t).errors,G),isValidating:!!ye(t.validatingFields,G),isTouched:!!ye((Q||t).touchedFields,G)}),W=G=>{G&&gn(G).forEach(Q=>Ct(t.errors,Q)),b.state.next({errors:G?t.errors:{}})},z=(G,Q,se)=>{const ge=(ye(n,G,{_f:{}})._f||{}).ref,fe=ye(t.errors,G)||{},{ref:ue,message:Se,type:Fe,...je}=fe;rt(t.errors,G,{...je,...Q,ref:ge}),b.state.next({name:G,errors:t.errors,isValid:!1}),se&&se.shouldFocus&&ge&&ge.focus&&ge.focus()},le=(G,Q)=>jn(G)?b.state.subscribe({next:se=>"values"in se&&G(ne(void 0,Q),se)}):ne(G,Q,!0),xe=G=>b.state.subscribe({next:Q=>{yw(G.name,Q.name,G.exact)&&gw(Q,G.formState||g,an,G.reRenderRoot)&&G.callback({values:{...r},...t,...Q,defaultValues:s})}}).unsubscribe,he=G=>(l.mount=!0,v={...v,...G.formState},xe({...G,formState:v})),Ee=(G,Q={})=>{for(const se of G?gn(G):c.mount)c.mount.delete(se),c.array.delete(se),Q.keepValue||(Ct(n,se),Ct(r,se)),!Q.keepError&&Ct(t.errors,se),!Q.keepDirty&&Ct(t.dirtyFields,se),!Q.keepTouched&&Ct(t.touchedFields,se),!Q.keepIsValidating&&Ct(t.validatingFields,se),!e.shouldUnregister&&!Q.keepDefaultValue&&Ct(s,se);b.state.next({values:dt(r)}),b.state.next({...t,...Q.keepDirty?{isDirty:K()}:{}}),!Q.keepIsValid&&A()},Ne=({disabled:G,name:Q})=>{(ii(G)&&l.mount||G||c.disabled.has(Q))&&(G?c.disabled.add(Q):c.disabled.delete(Q))},Te=(G,Q={})=>{let se=ye(n,G);const ge=ii(Q.disabled)||ii(e.disabled);return rt(n,G,{...se||{},_f:{...se&&se._f?se._f:{ref:{name:G}},name:G,mount:!0,...Q}}),c.mount.add(G),se?Ne({disabled:ii(Q.disabled)?Q.disabled:e.disabled,name:G}):k(G,!0,Q.value),{...ge?{disabled:Q.disabled||e.disabled}:{},...e.progressive?{required:!!Q.required,min:oa(Q.min),max:oa(Q.max),minLength:oa(Q.minLength),maxLength:oa(Q.maxLength),pattern:oa(Q.pattern)}:{},name:G,onChange:X,onBlur:X,ref:fe=>{if(fe){Te(G,Q),se=ye(n,G);const ue=ft(fe.value)&&fe.querySelectorAll&&fe.querySelectorAll("input,select,textarea")[0]||fe,Se=uw(ue),Fe=se._f.refs||[];if(Se?Fe.find(je=>je===ue):ue===se._f.ref)return;rt(n,G,{_f:{...se._f,...Se?{refs:[...Fe.filter(vf),ue,...Array.isArray(ye(s,G))?[{}]:[]],ref:{type:ue.type,name:G}}:{ref:ue}}}),k(G,!1,void 0,ue)}else se=ye(n,G,{}),se._f&&(se._f.mount=!1),(e.shouldUnregister||Q.shouldUnregister)&&!(rw(c.array,G)&&l.action)&&c.unMount.add(G)}}},ke=()=>e.shouldFocusError&&zo(n,de,c.mount),$e=G=>{ii(G)&&(b.state.next({disabled:G}),zo(n,(Q,se)=>{const ge=ye(n,se);ge&&(Q.disabled=ge._f.disabled||G,Array.isArray(ge._f.refs)&&ge._f.refs.forEach(fe=>{fe.disabled=ge._f.disabled||G}))},0,!1))},ht=(G,Q)=>async se=>{let ge;se&&(se.preventDefault&&se.preventDefault(),se.persist&&se.persist());let fe=dt(r);if(b.state.next({isSubmitting:!0}),e.resolver){const{errors:ue,values:Se}=await P();t.errors=ue,fe=dt(Se)}else await F(n);if(c.disabled.size)for(const ue of c.disabled)Ct(fe,ue);if(Ct(t.errors,"root"),tn(t.errors)){b.state.next({errors:{}});try{await G(fe,se)}catch(ue){ge=ue}}else Q&&await Q({...t.errors},se),ke(),setTimeout(ke);if(b.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:tn(t.errors)&&!ge,submitCount:t.submitCount+1,errors:t.errors}),ge)throw ge},xt=(G,Q={})=>{ye(n,G)&&(ft(Q.defaultValue)?U(G,dt(ye(s,G))):(U(G,Q.defaultValue),rt(s,G,dt(Q.defaultValue))),Q.keepTouched||Ct(t.touchedFields,G),Q.keepDirty||(Ct(t.dirtyFields,G),t.isDirty=Q.defaultValue?K(G,dt(ye(s,G))):K()),Q.keepError||(Ct(t.errors,G),g.isValid&&A()),b.state.next({...t}))},Dt=(G,Q={})=>{const se=G?dt(G):s,ge=dt(se),fe=tn(G),ue=fe?s:ge;if(Q.keepDefaultValues||(s=se),!Q.keepValues){if(Q.keepDirtyValues){const Se=new Set([...c.mount,...Object.keys(sa(s,r))]);for(const Fe of Array.from(Se))ye(t.dirtyFields,Fe)?rt(ue,Fe,ye(r,Fe)):U(Fe,ye(ue,Fe))}else{if(Xh&&ft(G))for(const Se of c.mount){const Fe=ye(n,Se);if(Fe&&Fe._f){const je=Array.isArray(Fe._f.refs)?Fe._f.refs[0]:Fe._f.ref;if(Cc(je)){const st=je.closest("form");if(st){st.reset();break}}}}if(Q.keepFieldsRef)for(const Se of c.mount)U(Se,ye(ue,Se));else n={}}r=e.shouldUnregister?Q.keepDefaultValues?dt(s):{}:dt(ue),b.array.next({values:{...ue}}),b.state.next({values:{...ue}})}c={mount:Q.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!g.isValid||!!Q.keepIsValid||!!Q.keepDirtyValues,l.watch=!!e.shouldUnregister,b.state.next({submitCount:Q.keepSubmitCount?t.submitCount:0,isDirty:fe?!1:Q.keepDirty?t.isDirty:!!(Q.keepDefaultValues&&!Ni(G,s)),isSubmitted:Q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:fe?{}:Q.keepDirtyValues?Q.keepDefaultValues&&r?sa(s,r):t.dirtyFields:Q.keepDefaultValues&&G?sa(s,G):Q.keepDirty?t.dirtyFields:{},touchedFields:Q.keepTouched?t.touchedFields:{},errors:Q.keepErrors?t.errors:{},isSubmitSuccessful:Q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},sr=(G,Q)=>Dt(jn(G)?G(r):G,Q),ps=(G,Q={})=>{const se=ye(n,G),ge=se&&se._f;if(ge){const fe=ge.refs?ge.refs[0]:ge.ref;fe.focus&&(fe.focus(),Q.shouldSelect&&jn(fe.select)&&fe.select())}},an=G=>{t={...t,...G}},or={control:{register:Te,unregister:Ee,getFieldState:V,handleSubmit:ht,setError:z,_subscribe:xe,_runSchema:P,_focusError:ke,_getWatch:ne,_getDirty:K,_setValid:A,_setFieldArray:w,_setDisabledField:Ne,_setErrors:M,_getFieldArray:ae,_reset:Dt,_resetDefaultValues:()=>jn(e.defaultValues)&&e.defaultValues().then(G=>{sr(G,e.resetOptions),b.state.next({isLoading:!1})}),_removeUnmounted:$,_disableForm:$e,_subjects:b,_proxyFormState:g,get _fields(){return n},get _formValues(){return r},get _state(){return l},set _state(G){l=G},get _defaultValues(){return s},get _names(){return c},set _names(G){c=G},get _formState(){return t},get _options(){return e},set _options(G){e={...e,...G}}},subscribe:he,trigger:te,register:Te,handleSubmit:ht,watch:le,setValue:U,getValues:L,reset:sr,resetField:xt,clearErrors:W,unregister:Ee,setError:z,setFocus:ps,getFieldState:V};return{...or,formControl:or}}var rs=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const i=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+i)%16|0;return(e=="x"?t:t&3|8).toString(16)})},xf=(i,e,t={})=>t.shouldFocus||ft(t.shouldFocus)?t.focusName||`${i}.${ft(t.focusIndex)?e:t.focusIndex}.`:"",bf=(i,e)=>[...i,...gn(e)],Sf=i=>Array.isArray(i)?i.map(()=>{}):void 0;function Cf(i,e,t){return[...i.slice(0,e),...gn(t),...i.slice(e)]}var Af=(i,e,t)=>Array.isArray(i)?(ft(i[t])&&(i[t]=void 0),i.splice(t,0,i.splice(e,1)[0]),i):[],Ef=(i,e)=>[...gn(e),...gn(i)];function Cw(i,e){let t=0;const n=[...i];for(const s of e)n.splice(s-t,1),t++;return Fc(n).length?n:[]}var _f=(i,e)=>ft(e)?[]:Cw(i,gn(e).sort((t,n)=>t-n)),Tf=(i,e,t)=>{[i[e],i[t]]=[i[t],i[e]]},W0=(i,e,t)=>(i[e]=t,i);function Aw(i){const e=oS(),{control:t=e.control,name:n,keyName:s="id",shouldUnregister:r,rules:l}=i,[c,f]=Ve.useState(t._getFieldArray(n)),d=Ve.useRef(t._getFieldArray(n).map(rs)),g=Ve.useRef(c),v=Ve.useRef(!1);g.current=c,t._names.array.add(n),Ve.useMemo(()=>l&&t.register(n,l),[t,l,n]),Qh(()=>t._subjects.array.subscribe({next:({values:R,name:I})=>{if(I===n||!I){const P=ye(R,n);Array.isArray(P)&&(f(P),d.current=P.map(rs))}}}).unsubscribe,[t,n]);const b=Ve.useCallback(R=>{v.current=!0,t._setFieldArray(n,R)},[t,n]),C=(R,I)=>{const P=gn(dt(R)),q=bf(t._getFieldArray(n),P);t._names.focus=xf(n,q.length-1,I),d.current=bf(d.current,P.map(rs)),b(q),f(q),t._setFieldArray(n,q,bf,{argA:Sf(R)})},E=(R,I)=>{const P=gn(dt(R)),q=Ef(t._getFieldArray(n),P);t._names.focus=xf(n,0,I),d.current=Ef(d.current,P.map(rs)),b(q),f(q),t._setFieldArray(n,q,Ef,{argA:Sf(R)})},A=R=>{const I=_f(t._getFieldArray(n),R);d.current=_f(d.current,R),b(I),f(I),!Array.isArray(ye(t._fields,n))&&rt(t._fields,n,void 0),t._setFieldArray(n,I,_f,{argA:R})},_=(R,I,P)=>{const q=gn(dt(I)),F=Cf(t._getFieldArray(n),R,q);t._names.focus=xf(n,R,P),d.current=Cf(d.current,R,q.map(rs)),b(F),f(F),t._setFieldArray(n,F,Cf,{argA:R,argB:Sf(I)})},w=(R,I)=>{const P=t._getFieldArray(n);Tf(P,R,I),Tf(d.current,R,I),b(P),f(P),t._setFieldArray(n,P,Tf,{argA:R,argB:I},!1)},N=(R,I)=>{const P=t._getFieldArray(n);Af(P,R,I),Af(d.current,R,I),b(P),f(P),t._setFieldArray(n,P,Af,{argA:R,argB:I},!1)},M=(R,I)=>{const P=dt(I),q=W0(t._getFieldArray(n),R,P);d.current=[...q].map((F,$)=>!F||$===R?rs():d.current[$]),b(q),f([...q]),t._setFieldArray(n,q,W0,{argA:R,argB:P},!0,!1)},k=R=>{const I=gn(dt(R));d.current=I.map(rs),b([...I]),f([...I]),t._setFieldArray(n,[...I],P=>P,{},!0,!1)};return Ve.useEffect(()=>{if(t._state.action=!1,dh(n,t._names)&&t._subjects.state.next({...t._formState}),v.current&&(!Go(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!Go(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([n]).then(R=>{const I=ye(R.errors,n),P=ye(t._formState.errors,n);(P?!I&&P.type||I&&(P.type!==I.type||P.message!==I.message):I&&I.type)&&(I?rt(t._formState.errors,n,I):Ct(t._formState.errors,n),t._subjects.state.next({errors:t._formState.errors}))});else{const R=ye(t._fields,n);R&&R._f&&!(Go(t._options.reValidateMode).isOnSubmit&&Go(t._options.mode).isOnSubmit)&&fh(R,t._names.disabled,t._formValues,t._options.criteriaMode===On.all,t._options.shouldUseNativeValidation,!0).then(I=>!tn(I)&&t._subjects.state.next({errors:hS(t._formState.errors,I,n)}))}t._subjects.state.next({name:n,values:dt(t._formValues)}),t._names.focus&&zo(t._fields,(R,I)=>{if(t._names.focus&&I.startsWith(t._names.focus)&&R.focus)return R.focus(),1}),t._names.focus="",t._setValid(),v.current=!1},[c,n,t]),Ve.useEffect(()=>(!ye(t._formValues,n)&&t._setFieldArray(n),()=>{const R=(I,P)=>{const q=ye(t._fields,I);q&&q._f&&(q._f.mount=P)};t._options.shouldUnregister||r?t.unregister(n):R(n,!1)}),[n,t,s,r]),{swap:Ve.useCallback(w,[b,n,t]),move:Ve.useCallback(N,[b,n,t]),prepend:Ve.useCallback(E,[b,n,t]),append:Ve.useCallback(C,[b,n,t]),remove:Ve.useCallback(A,[b,n,t]),insert:Ve.useCallback(_,[b,n,t]),update:Ve.useCallback(M,[b,n,t]),replace:Ve.useCallback(k,[b,n,t]),fields:Ve.useMemo(()=>c.map((R,I)=>({...R,[s]:d.current[I]||rs()})),[c,s])}}function Ew(i={}){const e=Ve.useRef(void 0),t=Ve.useRef(void 0),[n,s]=Ve.useState({isDirty:!1,isValidating:!1,isLoading:jn(i.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:i.errors||{},disabled:i.disabled||!1,isReady:!1,defaultValues:jn(i.defaultValues)?void 0:i.defaultValues});if(!e.current)if(i.formControl)e.current={...i.formControl,formState:n},i.defaultValues&&!jn(i.defaultValues)&&i.formControl.reset(i.defaultValues,i.resetOptions);else{const{formControl:l,...c}=Sw(i);e.current={...c,formState:n}}const r=e.current.control;return r._options=i,Qh(()=>{const l=r._subscribe({formState:r._proxyFormState,callback:()=>s({...r._formState}),reRenderRoot:!0});return s(c=>({...c,isReady:!0})),r._formState.isReady=!0,l},[r]),Ve.useEffect(()=>r._disableForm(i.disabled),[r,i.disabled]),Ve.useEffect(()=>{i.mode&&(r._options.mode=i.mode),i.reValidateMode&&(r._options.reValidateMode=i.reValidateMode)},[r,i.mode,i.reValidateMode]),Ve.useEffect(()=>{i.errors&&(r._setErrors(i.errors),r._focusError())},[r,i.errors]),Ve.useEffect(()=>{i.shouldUnregister&&r._subjects.state.next({values:r._getWatch()})},[r,i.shouldUnregister]),Ve.useEffect(()=>{if(r._proxyFormState.isDirty){const l=r._getDirty();l!==n.isDirty&&r._subjects.state.next({isDirty:l})}},[r,n.isDirty]),Ve.useEffect(()=>{i.values&&!Ni(i.values,t.current)?(r._reset(i.values,{keepFieldsRef:!0,...r._options.resetOptions}),t.current=i.values,s(l=>({...l}))):r._resetDefaultValues()},[r,i.values]),Ve.useEffect(()=>{r._state.mount||(r._setValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()}),e.current.formState=lw(n,r),e.current}const pe=({children:i,variant:e="primary",size:t="md",buttonType:n="solid",icon:s,iconPosition:r="left",isLoading:l=!1,fullWidth:c=!1,rounded:f="lg",className:d="",disabled:g,type:v="button",...b})=>{const C={primary:{solid:{background:"#2563eb",border:"#2563eb",color:"#ffffff",hoverBackground:"#1d4ed8",hoverBorder:"#1d4ed8",hoverColor:"#ffffff",focusRing:"focus:ring-blue-300",shadow:"0 4px 12px rgba(37, 99, 235, 0.3)"},outline:{background:"transparent",border:"#2563eb",color:"#2563eb",hoverBackground:"#2563eb",hoverBorder:"#2563eb",hoverColor:"#ffffff",focusRing:"focus:ring-blue-300",shadow:"0 4px 12px rgba(37, 99, 235, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#2563eb",hoverBackground:"#eff6ff",hoverBorder:"transparent",hoverColor:"#2563eb",focusRing:"focus:ring-blue-300",shadow:"none"}},secondary:{solid:{background:"#6b7280",border:"#6b7280",color:"#ffffff",hoverBackground:"#4b5563",hoverBorder:"#4b5563",hoverColor:"#ffffff",focusRing:"focus:ring-gray-300",shadow:"0 4px 12px rgba(107, 114, 128, 0.3)"},outline:{background:"transparent",border:"#6b7280",color:"#6b7280",hoverBackground:"#6b7280",hoverBorder:"#6b7280",hoverColor:"#ffffff",focusRing:"focus:ring-gray-300",shadow:"0 4px 12px rgba(107, 114, 128, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#6b7280",hoverBackground:"#f9fafb",hoverBorder:"transparent",hoverColor:"#6b7280",focusRing:"focus:ring-gray-300",shadow:"none"}},danger:{solid:{background:"#ef4444",border:"#ef4444",color:"#ffffff",hoverBackground:"#dc2626",hoverBorder:"#dc2626",hoverColor:"#ffffff",focusRing:"focus:ring-red-300",shadow:"0 4px 12px rgba(239, 68, 68, 0.3)"},outline:{background:"transparent",border:"#ef4444",color:"#ef4444",hoverBackground:"#ef4444",hoverBorder:"#ef4444",hoverColor:"#ffffff",focusRing:"focus:ring-red-300",shadow:"0 4px 12px rgba(239, 68, 68, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#ef4444",hoverBackground:"#fef2f2",hoverBorder:"transparent",hoverColor:"#ef4444",focusRing:"focus:ring-red-300",shadow:"none"}},success:{solid:{background:"#10b981",border:"#10b981",color:"#ffffff",hoverBackground:"#059669",hoverBorder:"#059669",hoverColor:"#ffffff",focusRing:"focus:ring-green-300",shadow:"0 4px 12px rgba(16, 185, 129, 0.3)"},outline:{background:"transparent",border:"#10b981",color:"#10b981",hoverBackground:"#10b981",hoverBorder:"#10b981",hoverColor:"#ffffff",focusRing:"focus:ring-green-300",shadow:"0 4px 12px rgba(16, 185, 129, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#10b981",hoverBackground:"#f0fdf4",hoverBorder:"transparent",hoverColor:"#10b981",focusRing:"focus:ring-green-300",shadow:"none"}},warning:{solid:{background:"#f59e0b",border:"#f59e0b",color:"#ffffff",hoverBackground:"#d97706",hoverBorder:"#d97706",hoverColor:"#ffffff",focusRing:"focus:ring-yellow-300",shadow:"0 4px 12px rgba(245, 158, 11, 0.3)"},outline:{background:"transparent",border:"#f59e0b",color:"#f59e0b",hoverBackground:"#f59e0b",hoverBorder:"#f59e0b",hoverColor:"#ffffff",focusRing:"focus:ring-yellow-300",shadow:"0 4px 12px rgba(245, 158, 11, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#f59e0b",hoverBackground:"#fffbeb",hoverBorder:"transparent",hoverColor:"#f59e0b",focusRing:"focus:ring-yellow-300",shadow:"none"}},info:{solid:{background:"#3b82f6",border:"#3b82f6",color:"#ffffff",hoverBackground:"#2563eb",hoverBorder:"#2563eb",hoverColor:"#ffffff",focusRing:"focus:ring-blue-300",shadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},outline:{background:"transparent",border:"#3b82f6",color:"#3b82f6",hoverBackground:"#3b82f6",hoverBorder:"#3b82f6",hoverColor:"#ffffff",focusRing:"focus:ring-blue-300",shadow:"0 4px 12px rgba(59, 130, 246, 0.2)"},ghost:{background:"transparent",border:"transparent",color:"#3b82f6",hoverBackground:"#eff6ff",hoverBorder:"transparent",hoverColor:"#3b82f6",focusRing:"focus:ring-blue-300",shadow:"none"}}},E={sm:{padding:"px-3 py-1.5",fontSize:"text-sm",iconSize:"w-4 h-4",gap:"gap-1.5"},md:{padding:"px-4 py-2",fontSize:"text-sm",iconSize:"w-4 h-4",gap:"gap-2"},lg:{padding:"px-6 py-3",fontSize:"text-base",iconSize:"w-5 h-5",gap:"gap-2"},xl:{padding:"px-8 py-4",fontSize:"text-lg",iconSize:"w-6 h-6",gap:"gap-3"}},A={sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"},_=C[e][n],w=E[t],N=A[f],M=["inline-flex","items-center","justify-center","font-semibold","transition-all","duration-200","focus:outline-none","focus:ring-2","focus:ring-offset-2",_.focusRing,w.padding,w.fontSize,w.gap,N,c?"w-full":"",g||l?"opacity-50 cursor-not-allowed":"cursor-pointer",d].filter(Boolean).join(" "),k={backgroundColor:_.background,color:_.color,border:`1px solid ${_.border}`,boxShadow:n==="solid"?"0 1px 3px 0 rgba(0, 0, 0, 0.1)":"none"},R=F=>{g||l||(F.currentTarget.style.backgroundColor=_.hoverBackground,F.currentTarget.style.borderColor=_.hoverBorder,F.currentTarget.style.color=_.hoverColor||_.color,_.shadow!=="none"&&n==="solid"&&(F.currentTarget.style.boxShadow=_.shadow,F.currentTarget.style.transform="translateY(-1px)"))},I=F=>{g||l||(F.currentTarget.style.backgroundColor=_.background,F.currentTarget.style.borderColor=_.border,F.currentTarget.style.color=_.color,F.currentTarget.style.boxShadow=n==="solid"?"0 1px 3px 0 rgba(0, 0, 0, 0.1)":"none",F.currentTarget.style.transform="translateY(0)")},P=()=>y.jsxs("svg",{className:`animate-spin ${w.iconSize}`,fill:"none",viewBox:"0 0 24 24",children:[y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),q=()=>l?y.jsx(P,{}):s?typeof s=="string"?y.jsx("span",{className:"text-current",children:s}):y.jsx("div",{className:w.iconSize,children:s}):null;return y.jsxs("button",{type:v,className:M,style:k,onMouseEnter:R,onMouseLeave:I,disabled:g||l,...b,children:[r==="left"&&q(),l?"Cargando...":i,r==="right"&&!l&&q()]})},pS=({onSubmit:i,nextQuestionNumber:e,onClearForm:t,initialData:n,isEditing:s=!1,onCancel:r})=>{const l=()=>n||{question_text:"",options:[{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1}],requires_multiple_answers:!1,explanation:"",link:""},{register:c,control:f,handleSubmit:d,reset:g,setValue:v,formState:{errors:b}}=Ew({defaultValues:l()});O.useEffect(()=>{n&&g(n)},[n,g]);const{fields:C,append:E,remove:A}=Aw({control:f,name:"options"}),_=B0({control:f,name:"requires_multiple_answers"}),w=B0({control:f,name:"options"}),N=()=>{C.length<5&&E({option_text:"",is_correct:!1})},M=(q,F)=>{!_&&F&&w.map((K,ne)=>({...K,is_correct:ne===q})).forEach((K,ne)=>{v(`options.${ne}.is_correct`,K.is_correct)})},[k,R]=Ve.useState(!1),I=q=>{if(!q.options.some(K=>K.is_correct)){R(!0);return}R(!1);const $=q.options.map((K,ne)=>({...K,option_letter:String.fromCharCode(65+ne)}));i({...q,options:$}),g()},P=()=>{g(),t&&t()};return O.useEffect(()=>{w.some(q=>q.is_correct)&&R(!1)},[w]),y.jsxs("div",{className:"question-card container",children:[y.jsx("div",{className:"mb-6",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("div",{children:!s&&y.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Nueva pregunta ",e.toString().padStart(4,"0")]})}),!s&&y.jsx(pe,{type:"button",onClick:P,variant:"secondary",size:"md",icon:y.jsx(jT,{}),children:"Limpiar formulario"})]})}),y.jsxs("form",{onSubmit:d(I),className:"space-y-6",children:[y.jsxs("div",{children:[y.jsxs("label",{className:"block text-md font-medium text-gray-700 mb-2",children:[y.jsx("span",{className:"text-sm font-bold text-black mb-2",children:"Texto de la pregunta"})," ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsx("textarea",{...c("question_text",{required:"El texto de la pregunta es obligatorio"}),rows:4,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition resize-y bg-white text-gray-900",placeholder:"Escribe el texto de la pregunta aquí..."}),b.question_text&&y.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.question_text.message})]}),y.jsxs("div",{className:"flex items-center",children:[y.jsx("input",{type:"checkbox",...c("requires_multiple_answers"),className:"form-checkbox mr-2"}),y.jsx("label",{className:"text-sm text-gray-700",children:"Esta pregunta permite varias respuestas correctas"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center justify-between mb-4",children:[y.jsxs("label",{className:"block text-md font-medium text-gray-700",children:[y.jsx("span",{className:"text-sm font-bold text-black mb-2",children:"Opciones de respuesta"})," ",y.jsx("span",{className:"text-red-500",children:"*"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(pe,{type:"button",onClick:N,disabled:C.length>=5,variant:"primary",size:"sm",icon:y.jsx(rh,{}),children:"Agregar"}),y.jsx(pe,{type:"button",onClick:()=>A(C.length-1),disabled:C.length<=2,variant:"warning",size:"sm",icon:y.jsx(HT,{}),children:"Quitar"})]})]}),y.jsx("div",{className:"space-y-3",children:C.map((q,F)=>y.jsxs("div",{className:"option-item flex gap-2 items-center min-h-[56px]",children:[y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx("div",{className:"option-letter flex items-center justify-center text-base font-semibold text-gray-500 bg-gray-100 rounded-full min-w-[32px] min-h-[32px]",children:String.fromCharCode(65+F)}),y.jsx("div",{className:"min-h-[20px] w-full mt-1 flex items-center justify-center",children:b.options?.[F]?.option_text&&y.jsx("span",{className:"text-xs text-red-500 text-center w-full"})})]}),y.jsxs("div",{className:"flex-1 flex flex-col",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("textarea",{...c(`options.${F}.option_text`,{required:"El texto de la opción es obligatorio"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition resize-y bg-white text-gray-900 min-h-[56px]",placeholder:`Texto de opción ${String.fromCharCode(65+F)}`,rows:2}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("input",{type:"checkbox",...c(`options.${F}.is_correct`),className:"form-checkbox",disabled:!_&&w?.some(($,K)=>K!==F&&$.is_correct),onChange:$=>{const K=$.target.checked;M(F,K),v(`options.${F}.is_correct`,K)}}),y.jsx("label",{className:"text-sm text-gray-700",children:"Correcta"})]})]}),b.options?.[F]?.option_text&&y.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.options[F]?.option_text?.message})]})]},q.id))})]}),k&&y.jsx("div",{className:"w-full flex justify-end",children:y.jsx("span",{className:"text-red-500 text-sm text-right",children:_?"Debes marcar las opciones correctas.":"Debes marcar la opción correcta."})}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y.jsx("span",{className:"text-sm font-bold text-black mb-2",children:"Enlace de referencia"})}),y.jsx("input",{type:"url",...c("link",{pattern:{value:/^https?:\/\/.+/,message:"Debe ser una URL válida (http:// o https://)"}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition bg-white text-gray-900",placeholder:"https://ejemplo.com/fuente-informacion"}),b.link&&y.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.link.message})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:y.jsx("span",{className:"text-sm font-bold text-black mb-2",children:"Explicación"})}),y.jsx("textarea",{...c("explanation"),rows:4,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition resize-y bg-white text-gray-900",placeholder:"Agrega una explicación detallada de por qué las respuestas son correctas..."}),b.explanation&&y.jsx("p",{className:"text-sm text-red-600 mt-1",children:b.explanation.message})]}),y.jsxs("div",{className:s?"flex gap-2":"flex justify-start",children:[y.jsx(pe,{type:"submit",variant:"success",size:"md",icon:y.jsx(qT,{}),iconPosition:"left",children:s?"Guardar cambios":"Guardar pregunta"}),s&&r&&y.jsx(pe,{type:"button",onClick:r,variant:"secondary",size:"md",icon:y.jsx(Xb,{}),iconPosition:"left",children:"Cancelar"})]})]})]})},Oc=({title:i,description:e,className:t})=>y.jsxs("div",{className:`mb-12 text-left ${t||""}`,children:[y.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:i}),e&&y.jsx("p",{className:"text-lg text-gray-600 max-w-3xl",children:e})]}),_w=({onSubmit:i,nextQuestionNumber:e})=>y.jsx("div",{className:"py-16",children:y.jsxs("div",{className:"max-w-4xl mx-auto px-4 space-y-6",children:[y.jsx(Oc,{title:"Crear Nueva Pregunta",description:"Diseña preguntas efectivas para tus exámenes con opciones múltiples, explicaciones y referencias educativas"}),y.jsx(pS,{onSubmit:i,nextQuestionNumber:e})]})});var fc={exports:{}},Tw=fc.exports,K0;function ww(){return K0||(K0=1,function(i,e){(function(t,n){n()})(Tw,function(){function t(d,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\uFEFF",d],{type:d.type}):d}function n(d,g,v){var b=new XMLHttpRequest;b.open("GET",d),b.responseType="blob",b.onload=function(){f(b.response,g,v)},b.onerror=function(){console.error("could not download file")},b.send()}function s(d){var g=new XMLHttpRequest;g.open("HEAD",d,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function r(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(g)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Xl=="object"&&Xl.global===Xl?Xl:void 0,c=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(d,g,v){var b=l.URL||l.webkitURL,C=document.createElement("a");g=g||d.name||"download",C.download=g,C.rel="noopener",typeof d=="string"?(C.href=d,C.origin===location.origin?r(C):s(C.href)?n(d,g,v):r(C,C.target="_blank")):(C.href=b.createObjectURL(d),setTimeout(function(){b.revokeObjectURL(C.href)},4e4),setTimeout(function(){r(C)},0))}:"msSaveOrOpenBlob"in navigator?function(d,g,v){if(g=g||d.name||"download",typeof d!="string")navigator.msSaveOrOpenBlob(t(d,v),g);else if(s(d))n(d,g,v);else{var b=document.createElement("a");b.href=d,b.target="_blank",setTimeout(function(){r(b)})}}:function(d,g,v,b){if(b=b||open("","_blank"),b&&(b.document.title=b.document.body.innerText="downloading..."),typeof d=="string")return n(d,g,v);var C=d.type==="application/octet-stream",E=/constructor/i.test(l.HTMLElement)||l.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||C&&E||c)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var M=_.result;M=A?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),b?b.location.href=M:location=M,b=null},_.readAsDataURL(d)}else{var w=l.URL||l.webkitURL,N=w.createObjectURL(d);b?b.location=N:location.href=N,b=null,setTimeout(function(){w.revokeObjectURL(N)},4e4)}});l.saveAs=f.saveAs=f,i.exports=f})}(fc)),fc.exports}var Mw=ww();const Nw=i=>{const e=i.map(l=>({...l,question_number:l.question_number.toString().padStart(4,"0")})),t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json;charset=utf-8"}),r=`questions-${new Date().toISOString().split("T")[0]}.json`;Mw.saveAs(n,r)},hh=i=>i.toString().padStart(4,"0"),mS=({isOpen:i,onClose:e,title:t,children:n,type:s="info",showCloseButton:r=!0})=>{if(O.useEffect(()=>{const f=d=>{d.key==="Escape"&&r&&e()};return i&&(document.addEventListener("keydown",f),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",f),document.body.style.overflow="unset"}},[i,e,r]),!i)return null;const c=(()=>{switch(s){case"success":return{icon:y.jsx(Jb,{className:"w-6 h-6 text-green-500"}),borderColor:"border-green-500",iconColor:"text-green-500",bgColor:"bg-green-50"};case"warning":return{icon:y.jsx(lh,{className:"w-6 h-6 text-yellow-500"}),borderColor:"border-yellow-500",iconColor:"text-yellow-500",bgColor:"bg-yellow-50"};case"error":return{icon:y.jsx(Sc,{className:"w-6 h-6 text-red-500"}),borderColor:"border-red-500",iconColor:"text-red-500",bgColor:"bg-red-50"};default:return{icon:y.jsx(bc,{className:"w-6 h-6 text-blue-500"}),borderColor:"border-blue-500",iconColor:"text-blue-500",bgColor:"bg-blue-50"}}})();return y.jsxs("div",{className:"fixed inset-0 z-[999999] flex items-end justify-center",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999999,display:"flex",alignItems:"flex-end",justifyContent:"center"},children:[y.jsx("div",{className:"absolute inset-0 transition-opacity duration-200",onClick:r?e:void 0,style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999998}}),y.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl w-full max-h-[90vh] overflow-hidden animate-in fade-in zoom-in duration-200",style:{zIndex:999999,marginLeft:"3rem",marginRight:"3rem",marginBottom:"2rem",maxWidth:"600px"},children:[(t||r)&&y.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${c.bgColor} ${c.borderColor} border-t-4`,children:[y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("span",{className:"text-2xl flex items-center",children:c.icon}),t&&y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t})]}),r&&y.jsx("button",{onClick:e,className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300","aria-label":"Cerrar modal",style:{backgroundColor:"#f3f4f6",color:"#6b7280",border:"1px solid #d1d5db",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},onMouseEnter:f=>{f.currentTarget.style.backgroundColor="#e5e7eb",f.currentTarget.style.borderColor="#9ca3af",f.currentTarget.style.boxShadow="0 4px 12px rgba(107, 114, 128, 0.2)",f.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:f=>{f.currentTarget.style.backgroundColor="#f3f4f6",f.currentTarget.style.borderColor="#d1d5db",f.currentTarget.style.boxShadow="0 1px 3px 0 rgba(0, 0, 0, 0.1)",f.currentTarget.style.transform="translateY(0)"},children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-8rem)]",children:n})]})]})},gS=({isOpen:i,onConfirm:e,onCancel:t,title:n,message:s,confirmText:r="Confirmar",cancelText:l="Cancelar",type:c="warning"})=>{const f=()=>{e(),t()},d=(v,b)=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),b==="confirm"?f():t())},g=()=>{const v=r.toLowerCase().includes("descargar"),b=r.toLowerCase().includes("procesar");return v||b?"primary":"danger"};return y.jsx(mS,{isOpen:i,onClose:t,title:n,type:c,showCloseButton:!1,children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"text-gray-700 whitespace-pre-wrap text-sm leading-relaxed",children:s}),y.jsxs("div",{className:"flex justify-center space-x-3 pt-2",children:[y.jsx(pe,{onClick:t,onKeyDown:v=>d(v,"cancel"),variant:"secondary",size:"lg",children:l}),y.jsx(pe,{onClick:f,onKeyDown:v=>d(v,"confirm"),autoFocus:!0,variant:g(),size:"lg",children:r})]})]})})},Rw=({explanation:i})=>!i||i.trim()===""?y.jsxs("div",{className:"mb-6",children:[y.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Explicación:"}),y.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:y.jsx("p",{className:"text-gray-500 italic",children:"No se proporcionó explicación para esta pregunta."})})]}):y.jsxs("div",{className:"mb-6",children:[y.jsx("h4",{className:"text-sm font-bold text-black mb-2",children:"Explicación:"}),y.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:y.jsx("p",{className:"text-gray-900 leading-relaxed",children:i})})]}),Iw=({link:i})=>{if(!i||i.trim()==="")return y.jsx("div",{className:"border-t pt-4",children:y.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[y.jsx(ah,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),y.jsx("span",{className:"text-gray-400 italic",children:"No se proporcionó fuente para esta pregunta"})]})});const e=t=>{try{return new URL(t),!0}catch{return!1}};return y.jsx("div",{className:"border-t pt-4",children:y.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[y.jsx(ah,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e(i)?y.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors truncate flex-1 hover:underline",children:i}):y.jsx("span",{className:"text-gray-700 truncate flex-1",children:i})]})})},Dw=({question:i,onEdit:e,onDelete:t})=>y.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-all duration-200 overflow-hidden",children:[y.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-16 h-10 bg-blue-200 rounded-xl flex items-center justify-center mx-2 my-0.5",children:y.jsx("span",{className:"text-black font-semibold text-lg tracking-wide select-none",children:hh(i.question_number)})}),y.jsx("div",{children:y.jsx("div",{className:"flex items-center gap-3 mt-1",children:i.requires_multiple_answers&&y.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Múltiples respuestas"})})})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsxs(pe,{variant:"primary",size:"sm",onClick:()=>e(i),children:[y.jsx(zh,{className:"w-4 h-4"}),"Editar"]}),y.jsxs(pe,{variant:"danger",size:"sm",onClick:()=>t(i.question_number),children:[y.jsx(Kb,{className:"w-4 h-4"}),"Eliminar"]})]})]})}),y.jsxs("div",{className:"p-6",children:[y.jsxs("div",{className:"mb-6",children:[y.jsx("h4",{className:"text-sm font-bold text-black mb-2",children:"Pregunta:"}),y.jsx("p",{className:"text-gray-900 leading-relaxed text-base",children:i.question_text})]}),y.jsxs("div",{className:"mb-6",children:[y.jsx("h4",{className:"text-sm font-bold text-black mb-3",children:"Opciones de respuesta:"}),y.jsx("div",{className:"grid gap-3",children:i.options.map((n,s)=>y.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-colors ${n.is_correct?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[y.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${n.is_correct?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:n.option_letter}),y.jsx("span",{className:"flex-1 text-gray-900",children:n.option_text}),y.jsx("div",{className:"flex items-center",children:n.is_correct?y.jsx(Jb,{className:"w-5 h-5 text-green-600"}):y.jsx(Xb,{className:"w-5 h-5 text-gray-400"})})]},`${i.question_number}-${n.option_letter}-${s}`))})]}),y.jsx(Rw,{explanation:i.explanation}),y.jsx("h4",{className:"text-sm font-bold text-black mb-2",children:"Fuente:"}),y.jsx(Iw,{link:i.link})]})]}),kw=({currentPage:i,totalPages:e,questionsPerPage:t,totalQuestions:n,onPageChange:s,onQuestionsPerPageChange:r})=>{const[l,c]=O.useState(""),f=(i-1)*t,d=Math.min(f+t,n),g=()=>{const b=parseInt(l);b>=1&&b<=e&&(s(b),c(""))},v=()=>{const C=Math.max(1,i-2),E=Math.min(e,i+2),A=[];for(let _=C;_<=E;_++)A.push(_);return A};return e<=1?null:y.jsx("div",{className:"mt-8 pt-8 border-t border-gray-200",children:y.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mb-6",children:[y.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",y.jsx("span",{className:"font-medium",children:f+1})," a"," ",y.jsx("span",{className:"font-medium",children:d})," de"," ",y.jsx("span",{className:"font-medium",children:n})," preguntas"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-sm text-gray-600",children:"Mostrar:"}),y.jsxs("select",{value:t,onChange:b=>r(Number(b.target.value)),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[y.jsx("option",{value:5,children:"5"}),y.jsx("option",{value:10,children:"10"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]}),y.jsx("span",{className:"text-sm text-gray-600",children:"por página"})]})]}),y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(pe,{variant:"secondary",size:"sm",onClick:()=>s(1),disabled:i===1,title:"Primera página",children:y.jsx(YT,{className:"w-4 h-4"})}),y.jsx(pe,{variant:"secondary",size:"sm",onClick:()=>s(i-1),disabled:i===1,children:y.jsx(zT,{className:"w-4 h-4"})}),y.jsx("div",{className:"flex items-center gap-1 mx-2",children:v().map(b=>y.jsx("button",{onClick:()=>s(b),className:`w-10 h-10 rounded-lg text-sm font-medium transition-all duration-200 ${i===b?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:b},b))}),y.jsx(pe,{variant:"secondary",size:"sm",onClick:()=>s(i+1),disabled:i===e,children:y.jsx($T,{className:"w-4 h-4"})}),y.jsx(pe,{variant:"secondary",size:"sm",onClick:()=>s(e),disabled:i===e,title:"Última página",children:y.jsx(WT,{className:"w-4 h-4"})})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-sm text-gray-600",children:"Ir a:"}),y.jsx("input",{type:"number",min:"1",max:e,value:l,onChange:b=>c(b.target.value),onKeyPress:b=>b.key==="Enter"&&g(),placeholder:"Página",className:"w-20 px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),y.jsx(pe,{variant:"primary",size:"sm",onClick:g,disabled:!l||parseInt(l)<1||parseInt(l)>e,children:"Ir"})]})]})]})})},X0=({icon:i,title:e,description:t,buttonText:n,buttonIcon:s,onClick:r,variant:l="primary"})=>y.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 flex flex-col items-center text-center",children:[y.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center mb-4 bg-blue-500",children:i}),y.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:e}),y.jsx("p",{className:"text-gray-600 mb-6",children:t}),y.jsxs("button",{"aria-label":n,className:`inline-flex items-center gap-2 px-5 py-2 rounded-lg font-semibold text-white ${l==="primary"?"bg-blue-700 hover:bg-blue-800":"bg-gray-500 hover:bg-gray-600"} transition-colors`,onClick:r,children:[s,n]})]}),yS=({onCreate:i,onImport:e})=>y.jsx("div",{className:"bg-white",children:y.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsxs("div",{className:"max-w-3xl mx-auto mb-16",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Tu biblioteca está vacía"}),y.jsx("p",{className:"text-lg text-gray-600 leading-relaxed",children:"Comienza creando tu primera pregunta o importa contenido desde un archivo PDF para construir tu colección de estudio."})]}),y.jsx("div",{className:"mb-16",children:y.jsx("h3",{className:"text-lg font-bold text-blue-700",children:"¡Selecciona una opción para comenzar ahora!"})})]}),y.jsx("div",{className:"max-w-4xl mx-auto",children:y.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[y.jsx(X0,{icon:y.jsx(rh,{className:"w-12 h-12 text-white"}),title:"Crear Primera Pregunta",description:"Diseña preguntas personalizadas usando nuestro formulario intuitivo",buttonText:"Empezar a Crear",buttonIcon:y.jsx(rh,{className:"w-5 h-5"}),onClick:i,variant:"primary"}),y.jsx(X0,{icon:y.jsx(ch,{className:"w-12 h-12 text-white"}),title:"Importar desde PDF",description:"Deja que la IA extraiga preguntas automáticamente de tus documentos",buttonText:"Subir Documento",buttonIcon:y.jsx(ch,{className:"w-5 h-5"}),onClick:e,variant:"primary"})]})})]})}),vS=()=>{const[i,e]=O.useState(!1),[t,n]=O.useState(""),[s,r]=O.useState({}),[l,c]=O.useState(null),f=O.useCallback((g,v,b={})=>{n(g),r(b),c(()=>v),e(!0)},[]),d=O.useCallback(()=>{e(!1),n(""),r({}),c(null)},[]);return{isConfirmOpen:i,confirmMessage:t,confirmOptions:s,confirmCallback:l,showConfirm:f,hideConfirm:d}},Lw=({questions:i,onRemoveQuestion:e,onUpdateQuestion:t,onClearAll:n,showAlert:s,showConfirmModal:r})=>{const l=js(),[c,f]=O.useState(null),[d,g]=O.useState(1),[v,b]=O.useState(5),{isConfirmOpen:C,confirmMessage:E,confirmOptions:A,confirmCallback:_,showConfirm:w,hideConfirm:N}=vS(),M=Math.ceil(i.length/v),k=(d-1)*v,R=k+v,I=i.slice(k,R),P=U=>{g(U),window.scrollTo({top:0,behavior:"smooth"})},q=U=>{b(U),g(1)},F=U=>{const X=hh(U);w(`¿Estás seguro de que quieres eliminar la Pregunta #${X}?`,()=>e(U),{title:"Eliminar Pregunta",confirmText:"Sí, Eliminar",cancelText:"Cancelar"})},$=()=>{if(i.length===0){s("No hay preguntas para descargar",{title:"Lista vacía",type:"warning"});return}const U=i.length;r(`¿Estás seguro de que quieres descargar ${U} ${U===1?"pregunta":"preguntas"} en formato JSON?`,()=>Nw(i),{title:"Descargar Preguntas",confirmText:"Sí, Descargar",cancelText:"Cancelar"})},K=()=>{if(i.length===0){s("No hay preguntas para eliminar",{title:"Lista vacía",type:"warning"});return}r(`¿Estás seguro de que quieres eliminar todas las ${i.length} preguntas? Esta acción no se puede deshacer.`,n,{title:"Confirmar eliminación",confirmText:"Sí, eliminar todo",cancelText:"Cancelar"})},ne=U=>{f(U)},ae=()=>{f(null)},ce=U=>{if(!c)return;const X=U.options.map((de,te)=>({option_letter:String.fromCharCode(65+te),option_text:de.option_text,is_correct:de.is_correct}));t(c.question_number,{question_text:U.question_text,options:X,requires_multiple_answers:U.requires_multiple_answers,explanation:U.explanation,link:U.link}),f(null)},me=U=>({question_text:U.question_text,options:U.options.map(X=>({option_text:X.option_text,is_correct:X.is_correct})),requires_multiple_answers:U.requires_multiple_answers,explanation:U.explanation,link:U.link});return i.length===0?y.jsx(yS,{onCreate:()=>l("/study-lab/create"),onImport:()=>l("/study-lab/import")}):c?y.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:y.jsxs("div",{className:"mb-8",children:[y.jsxs(pe,{variant:"secondary",size:"sm",onClick:ae,className:"mb-4",children:[y.jsx($h,{className:"w-4 h-4"}),"Volver a la lista"]}),y.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[y.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:y.jsx(zh,{className:"w-5 h-5 text-blue-600"})}),y.jsxs("div",{children:[y.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Editando Pregunta ",hh(c.question_number)]}),y.jsx("p",{className:"text-gray-600",children:"Modifica los campos necesarios y guarda los cambios"})]})]}),y.jsx(pS,{onSubmit:ce,nextQuestionNumber:c.question_number,initialData:me(c),isEditing:!0,onCancel:ae})]})]})}):y.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[y.jsxs("div",{className:"mb-8",children:[y.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:y.jsx(Zb,{className:"w-5 h-5 text-blue-600"})}),y.jsxs("div",{children:[y.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Biblioteca de Preguntas"}),y.jsxs("p",{className:"text-sm text-gray-600",children:[i.length," ",i.length===1?"pregunta guardada":"preguntas guardadas"]})]})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs(pe,{variant:"success",size:"md",onClick:$,disabled:i.length===0,children:[y.jsx(tw,{className:"w-4 h-4"}),"Descargar JSON"]}),y.jsxs(pe,{variant:"warning",size:"md",onClick:K,disabled:i.length===0,children:[y.jsx(Kb,{className:"w-4 h-4"}),"Eliminar Todo"]})]})]})}),y.jsx("div",{className:"text-center mb-8",children:y.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 text-sm text-gray-600",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),y.jsxs("span",{children:["Total: ",i.length," preguntas"]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),y.jsxs("span",{children:["Página ",d," de ",M]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),y.jsxs("span",{children:["Mostrando ",Math.min(v,i.length-k)," elementos"]})]})]})})]}),y.jsx("div",{className:"space-y-6",children:I.map((U,X)=>y.jsx(Dw,{question:U,onEdit:ne,onDelete:F},`${U.question_number}-${X}`))}),y.jsx(kw,{currentPage:d,totalPages:M,questionsPerPage:v,totalQuestions:i.length,onPageChange:P,onQuestionsPerPageChange:q}),y.jsx(gS,{isOpen:C,onConfirm:_||(()=>{}),onCancel:N,title:A.title,message:E,confirmText:A.confirmText,cancelText:A.cancelText,type:A.type})]})},Pw=({questions:i,onRemoveQuestion:e,onUpdateQuestion:t,onClearAll:n,showAlert:s,showConfirmModal:r})=>y.jsx("div",{className:"py-16",children:y.jsxs("div",{className:"max-w-4xl mx-auto px-4 space-y-6",children:[y.jsx(Oc,{title:"Gestión de Preguntas",description:"Organiza y gestiona tu biblioteca de preguntas de manera eficiente. Edita, elimina y descarga tu contenido cuando lo necesites."}),y.jsx(Lw,{questions:i,onRemoveQuestion:e,onUpdateQuestion:t,onClearAll:n,showAlert:s,showConfirmModal:r})]})}),nn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ph=[.001,0,0,.001,0,0],wf=1.35,En={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ls={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},xS="pdfjs_internal_editor_",Le={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},ze={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Fw={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hc={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Uo={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Uc={ERRORS:0,WARNINGS:1,INFOS:5},_c={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ql={moveTo:0,lineTo:1,curveTo:2,closePath:3},Ow={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Bc=Uc.WARNINGS;function Uw(i){Number.isInteger(i)&&(Bc=i)}function Bw(){return Bc}function Vc(i){Bc>=Uc.INFOS&&console.log(`Info: ${i}`)}function Pe(i){Bc>=Uc.WARNINGS&&console.log(`Warning: ${i}`)}function nt(i){throw new Error(i)}function It(i,e){i||nt(e)}function Vw(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function bS(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=zw(i)}catch{}const n=e?URL.parse(i,e):URL.parse(i);return Vw(n)?n:null}function SS(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&bS(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ge(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const zs=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class J0 extends zs{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Mf extends zs{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class mh extends zs{constructor(e){super(e,"InvalidPDFException")}}class Tc extends zs{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class Gw extends zs{constructor(e){super(e,"FormatError")}}class fs extends zs{constructor(e){super(e,"AbortException")}}function CS(i){(typeof i!="object"||i?.length===void 0)&&nt("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),l=i.subarray(s,r);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function Ra(i){typeof i!="string"&&nt("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function qw(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function Hw(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function jw(){try{return new Function(""),!0}catch{return!1}}class zt{static get isLittleEndian(){return Ge(this,"isLittleEndian",Hw())}static get isEvalSupported(){return Ge(this,"isEvalSupported",jw())}static get isOffscreenCanvasSupported(){return Ge(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ge(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ge(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Ge(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Nf=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class _e{static makeHexColor(e,t,n){return`#${Nf[e]}${Nf[t]}${Nf[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,n=0){const s=e[n],r=e[n+1];e[n]=s*t[0]+r*t[2]+t[4],e[n+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],r=t[1],l=t[2],c=t[3],f=t[4],d=t[5];for(let g=0;g<6;g+=2){const v=e[n+g],b=e[n+g+1];e[n+g]=v*s+b*l+f,e[n+g+1]=v*r+b*c+d}}static applyInverseTransform(e,t){const n=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,n){const s=t[0],r=t[1],l=t[2],c=t[3],f=t[4],d=t[5],g=e[0],v=e[1],b=e[2],C=e[3];let E=s*g+f,A=E,_=s*b+f,w=_,N=c*v+d,M=N,k=c*C+d,R=k;if(r!==0||l!==0){const I=r*g,P=r*b,q=l*v,F=l*C;E+=q,w+=q,_+=F,A+=F,N+=I,R+=I,k+=P,M+=P}n[0]=Math.min(n[0],E,_,A,w),n[1]=Math.min(n[1],N,k,M,R),n[2]=Math.max(n[2],E,_,A,w),n[3]=Math.max(n[3],N,k,M,R)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],r=e[2],l=e[3],c=n**2+s**2,f=n*r+s*l,d=r**2+l**2,g=(c+d)/2,v=Math.sqrt(g**2-(c*d-f**2));t[0]=Math.sqrt(g+v||1),t[1]=Math.sqrt(g-v||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>l?null:[n,r,s,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,r){r[0]=Math.min(r[0],e,n),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,n),r[3]=Math.max(r[3],t,s)}static#e(e,t,n,s,r,l,c,f,d,g){if(d<=0||d>=1)return;const v=1-d,b=d*d,C=b*d,E=v*(v*(v*e+3*d*t)+3*b*n)+C*s,A=v*(v*(v*r+3*d*l)+3*b*c)+C*f;g[0]=Math.min(g[0],E),g[1]=Math.min(g[1],A),g[2]=Math.max(g[2],E),g[3]=Math.max(g[3],A)}static#t(e,t,n,s,r,l,c,f,d,g,v,b){if(Math.abs(d)<1e-12){Math.abs(g)>=1e-12&&this.#e(e,t,n,s,r,l,c,f,-v/g,b);return}const C=g**2-4*v*d;if(C<0)return;const E=Math.sqrt(C),A=2*d;this.#e(e,t,n,s,r,l,c,f,(-g+E)/A,b),this.#e(e,t,n,s,r,l,c,f,(-g-E)/A,b)}static bezierBoundingBox(e,t,n,s,r,l,c,f,d){d[0]=Math.min(d[0],e,c),d[1]=Math.min(d[1],t,f),d[2]=Math.max(d[2],e,c),d[3]=Math.max(d[3],t,f),this.#t(e,n,r,c,t,s,l,f,3*(-e+3*(n-r)+c),6*(e-2*n+r),3*(n-e),d),this.#t(e,n,r,c,t,s,l,f,3*(-t+3*(s-l)+f),6*(t-2*s+l),3*(s-t),d)}}function zw(i){return decodeURIComponent(escape(i))}let Rf=null,Q0=null;function $w(i){return Rf||(Rf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Q0=new Map([["ﬅ","ſt"]])),i.replaceAll(Rf,(e,t,n)=>t?t.normalize("NFKC"):Q0.get(n))}function AS(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),CS(i)}const tp="pdfjs_internal_id_";function Yw(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...r]=t;if(!i(n)&&!Number.isInteger(n)||!e(s))return!1;const l=r.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const f of r)if(!(typeof f=="number"||c&&f===null))return!1;return!0}function sn(i,e,t){return Math.min(Math.max(i,e),t)}function ES(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(CS(i))}function Ww(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):Ra(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});const Ti="http://www.w3.org/2000/svg";class Jo{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Ia(i,e="text"){if(ha(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Da{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:r=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=r,this.offsetY=l,n*=t;const f=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let g,v,b,C;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,v=0,b=0,C=1;break;case 90:g=0,v=1,b=1,C=0;break;case 270:g=0,v=-1,b=-1,C=0;break;case 0:g=1,v=0,b=0,C=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(b=-b,C=-C);let E,A,_,w;g===0?(E=Math.abs(d-e[1])*n+r,A=Math.abs(f-e[0])*n+l,_=(e[3]-e[1])*n,w=(e[2]-e[0])*n):(E=Math.abs(f-e[0])*n+r,A=Math.abs(d-e[1])*n+l,_=(e[2]-e[0])*n,w=(e[3]-e[1])*n),this.transform=[g*n,v*n,b*n,C*n,E-g*n*f-b*n*d,A-v*n*f-C*n*d],this.width=_,this.height=w}get rawDims(){const e=this.viewBox;return Ge(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Da({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const n=[e,t];return _e.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];_e.applyTransform(t,this.transform);const n=[e[2],e[3]];return _e.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return _e.applyInverseTransform(n,this.transform),n}}class np extends zs{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Gc(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function ip(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function Kw(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function Xw(i,e="document.pdf"){if(typeof i!="string")return e;if(Gc(i))return Pe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const s=c=>{try{let f=decodeURIComponent(c);return f.includes("/")?(f=f.split("/").at(-1),f.test(/^\.pdf$/i)?f:c):f}catch{return c}},r=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(r.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(r.test(d))return s(d);const f=Array.from(n.searchParams.keys()).reverse();for(const d of f)if(r.test(d))return s(d)}if(n.hash){const f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(f)return s(f[0])}return e}class Z0{started=Object.create(null);times=[];time(e){e in this.started&&Pe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Pe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:r}of this.times)e.push(`${n.padEnd(t)} ${r-s}ms
`);return e.join("")}}function ha(i,e){const t=e?URL.parse(i,e):URL.parse(i);return t?.protocol==="http:"||t?.protocol==="https:"}function Bn(i){i.preventDefault()}function Rt(i){i.preventDefault(),i.stopPropagation()}function Jw(i){console.log("Deprecated API usage: "+i)}class gh{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let f=parseInt(t[6],10);f=f>=0&&f<=59?f:0;const d=t[7]||"Z";let g=parseInt(t[8],10);g=g>=0&&g<=23?g:0;let v=parseInt(t[9],10)||0;return v=v>=0&&v<=59?v:0,d==="-"?(l+=g,c+=v):d==="+"&&(l-=g,c-=v),new Date(Date.UTC(n,s,r,l,c,f))}}function Qw(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,r=[0,0,parseInt(n),parseInt(s)];return new Da({viewBox:r,userUnit:1,scale:e,rotation:t})}function qc(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Pe(`Not a valid color format: "${i}"`),[0,0,0])}function Zw(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,qc(n))}e.remove()}function mt(i){const{a:e,b:t,c:n,d:s,e:r,f:l}=i.getTransform();return[e,t,n,s,r,l]}function ei(i){const{a:e,b:t,c:n,d:s,e:r,f:l}=i.getTransform().invertSelf();return[e,t,n,s,r,l]}function Vs(i,e,t=!1,n=!0){if(e instanceof Da){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:l}=i,c=zt.isCSSRoundSupported,f=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${r}px`,g=c?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,v=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(l.width=g,l.height=v):(l.width=v,l.height=g)}n&&i.setAttribute("data-main-rotation",e.rotation)}class ai{constructor(){const{pixelRatio:e}=ai;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,r=-1){let l=1/0,c=1/0,f=1/0;n=ai.capPixels(n,r),n>0&&(l=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,f=s/t);const d=Math.min(l,c,f);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const yh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ga{#e=null;#t=null;#n;#i=null;#o=null;#s=null;#r=null;static#a=null;constructor(e){this.#n=e,ga.#a||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Bn,{signal:t}),e.addEventListener("pointerdown",ga.#u,{signal:t});const n=this.#i=document.createElement("div");n.className="buttons",e.append(n);const s=this.#n.toolbarPosition;if(s){const{style:r}=e,l=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*l}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#u(e){e.stopPropagation()}#c(e){this.#n._focusEventsAllowed=!1,Rt(e)}#f(e){this.#n._focusEventsAllowed=!0,Rt(e)}#l(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#f.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Bn,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#o?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",ga.#a[e]),this.#l(n),n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#i.append(n)}get#p(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#l(t),this.#i.append(t,this.#p),this.#o=e}addComment(e){if(this.#s)return;const t=e.render();t&&(this.#l(t),this.#i.prepend(t,this.#p),this.#s=e,e.toolbar=this)}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#l(t),this.#i.append(t,this.#p)}async addEditSignatureButton(e){const t=this.#r=await e.renderEditButton(this.#n);this.#l(t),this.#i.append(t,this.#p)}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}updateEditSignatureButton(e){this.#r&&(this.#r.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class e1{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Bn,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#o(e,t){let n=0,s=0;for(const r of e){const l=r.y+r.height;if(l<n)continue;const c=r.x+(t?r.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,r]=this.#o(t,n),{style:l}=this.#t||=this.#i();e.append(this.#t),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#n._signal;e.addEventListener("contextmenu",Bn,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}}function _S(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}class t1{#e=0;get id(){return`${xS}${this.#e++}`}}class sp{#e=AS();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ge(this,"_isSVGFittingCanvas",r)}async#i(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await Ia(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=sp._isSVGFittingCanvas,l=new FileReader,c=new Image,f=new Promise((d,g)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},l.onload=async()=>{const v=n.svgUrl=l.result;c.src=await r?`${v}#svgView(preserveAspectRatio(none))`:v},c.onerror=l.onerror=g});l.readAsDataURL(s),await f}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Pe(s),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:r}=e;return this.#i(`${t}_${n}_${s}_${r}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromBlob(e,t){const n=await t;return this.#i(e,n)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class n1{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:s,type:r=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const f={cmd:e,undo:t,post:n,type:r};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(f);return}if(l&&this.#e[this.#i].type===r){c&&(f.undo=this.#e[this.#i].undo),this.#e[this.#i]=f;return}const d=this.#i+1;d===this.#n?this.#e.splice(0,1):(this.#i=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(f)}undo(){if(this.#i===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}cleanType(e){if(this.#i!==-1){for(let t=this.#i;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#i-t),this.#i=t;return}this.#e.length=0,this.#i=-1}}destroy(){this.#e=null}}class ka{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=zt.platform;for(const[n,s,r={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:r}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:r}),this.allKeys.add(l.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:r=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),r||Rt(t))}}class op{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Zw(e),Ge(this,"_colors",e)}convert(e){const t=qc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((r,l)=>r===t[l]))return op._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?_e.makeHexColor(...t):e}}class hs{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#o=null;#s=null;#r=null;#a=new n1;#u=null;#c=null;#f=null;#l=0;#p=new Set;#g=null;#h=null;#d=new Set;_editorUndoBar=null;#m=!1;#x=!1;#y=!1;#S=null;#C=null;#v=null;#E=null;#N=!1;#A=null;#R=new t1;#M=!1;#w=!1;#T=null;#D=null;#O=null;#k=null;#G=null;#_=Le.NONE;#b=new Set;#U=null;#B=null;#q=null;#z=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#L=null;#P=null;#j=null;#X=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=hs.prototype,t=l=>l.#P.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:f}=c;return f!=="text"&&f!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Ge(this,"_keyboardManager",new ka([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#P.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#P.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,n,s,r,l,c,f,d,g,v,b,C,E,A,_){const w=this._signal=this.#e.signal;this.#P=e,this.#j=t,this.#X=n,this.#o=s,this.#u=r,this.#B=l,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:w}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),c._on("setpreference",this.onSetPreference.bind(this),{signal:w}),c._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:w}),this.#oe(),this.#ce(),this.#Q(),this.#s=f.annotationStorage,this.#S=f.filterFactory,this.#q=d,this.#E=g||null,this.#m=v,this.#x=b,this.#y=C,this.#G=E||null,this.viewParameters={realScale:Jo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=_!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#n.clear(),this.#d.clear(),this.#k?.clear(),this.#t=null,this.#b.clear(),this.#a.destroy(),this.#o?.destroy(),this.#u?.destroy(),this.#B?.destroy(),this.#A?.hide(),this.#A=null,this.#O?.destroy(),this.#O=null,this.#C&&(clearTimeout(this.#C),this.#C=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#x}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Ge(this,"hcmFilter",this.#q?this.#S.addHCMFilter(this.#q.foreground,this.#q.background):"none")}get direction(){return Ge(this,"direction",getComputedStyle(this.#P).direction)}get _highlightColors(){return Ge(this,"_highlightColors",this.#E?new Map(this.#E.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ge(this,"highlightColors",null);const t=new Map,n=!!this.#q;for(const[s,r]of e){const l=s.endsWith("_HCM");if(n&&l){t.set(s.replace("_HCM",""),r);continue}!n&&!l&&t.set(s,r)}return Ge(this,"highlightColors",t)}get highlightColorNames(){return Ge(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#f=e}setMainHighlightColorPicker(e){this.#O=e}editAltText(e,t=!1){this.#o?.editAltText(this,e,t)}hasCommentManager(){return!!this.#u}editComment(e,t){this.#u?.open(this,e,t)}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#y=t;break}}onPageChanging({pageNumber:e}){this.#l=e-1}focusMainContainer(){this.#P.focus()}findParent(e,t){for(const n of this.#i.values()){const{x:s,y:r,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=r&&t<=r+c)return n}return null}disableUserSelect(e=!1){this.#j.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#d.add(e)}removeShouldRescale(e){this.#d.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Jo.PDF_TO_CSS_UNITS;for(const t of this.#d)t.onScaleChanging();this.#f?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#W({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#J(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#i.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:l}=t,c=t.toString(),d=this.#W(t).closest(".textLayer"),g=this.getSelectionBoxes(d);if(!g)return;t.empty();const v=this.#J(d),b=this.#_===Le.NONE,C=()=>{v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:g,anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:l,text:c}),b&&this.showAllEditors("highlight",!0,!0)};if(b){this.switchToMode(Le.HIGHLIGHT,C);return}C()}#ie(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#W(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#A||=new e1(this),this.#A.show(n,s,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#X;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#se(){const e=document.getSelection();if(!e||e.isCollapsed){this.#U&&(this.#A?.hide(),this.#U=null,this.#I({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#U)return;const s=this.#W(e).closest(".textLayer");if(!s){this.#U&&(this.#A?.hide(),this.#U=null,this.#I({hasSelectedText:!1}));return}if(this.#A?.hide(),this.#U=t,this.#I({hasSelectedText:!0}),!(this.#_!==Le.HIGHLIGHT&&this.#_!==Le.NONE)&&(this.#_===Le.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#N=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#_===Le.HIGHLIGHT?this.#J(s):null;r?.toggleDrawing();const l=new AbortController,c=this.combinedSignal(l),f=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),r?.toggleDrawing(!0),d.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}}#K(e=""){this.#_===Le.HIGHLIGHT?this.highlightSelection(e):this.#m&&this.#ie()}#oe(){document.addEventListener("selectionchange",this.#se.bind(this),{signal:this._signal})}#re(){if(this.#v)return;this.#v=new AbortController;const e=this.combinedSignal(this.#v);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ae(){this.#v?.abort(),this.#v=null}blur(){if(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#D=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#D)return;const[e,t]=this.#D;this.#D=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#Q(){if(this.#T)return;this.#T=new AbortController;const e=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#le(){this.#T?.abort(),this.#T=null}#Z(){if(this.#c)return;this.#c=new AbortController;const e=this.combinedSignal(this.#c);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ee(){this.#c?.abort(),this.#c=null}#ce(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#Q(),this.#Z()}removeEditListeners(){this.#le(),this.#ee()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#b){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const l of this.#h)if(l.isHandlingMimeForPasting(r.type)){l.paste(r,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(r){Pe(`paste: "${r.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const f of n){const d=await s.deserialize(f);if(!d)return;r.push(d)}const l=()=>{for(const f of r)this.#te(f);this.#ne(r)},c=()=>{for(const f of r)f.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(r){Pe(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==Le.NONE&&!this.isEditorHandlingKeyboard&&hs._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#I(e){Object.entries(e).some(([n,s])=>this.#$[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,e)}),this.#_===Le.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#V([[ze.HIGHLIGHT_FREE,!0]]))}#V(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#re(),this.#Z(),this.#I({isEditing:this.#_!==Le.NONE,isEmpty:this.#Y(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ae(),this.#ee(),this.#I({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#h){this.#h=e;for(const t of this.#h)this.#V(t.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#i.get(this.#l)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#l}addLayer(e){this.#i.set(e.pageIndex,e),this.#M?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,r=!1){if(this.#_!==e&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#f?.commitOrRemove(),this.#_=e,e===Le.NONE){this.setEditingState(!1),this.#de(),this._editorUndoBar?.hide(),this.#F.resolve();return}e===Le.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#ue(),this.unselectAll();for(const l of this.#i.values())l.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const l of this.#n.values())l.annotationElementId===t||l.id===t?(this.setSelected(l),r?l.editComment():s&&l.enterInEditMode()):l.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#h){switch(e){case ze.CREATE:this.currentLayer.addNewEditor(t);return;case ze.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#z||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#b)n.updateParams(e,t);else for(const n of this.#h)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const r of this.#n.values())r.editorType===e&&r.show(t);(this.#z?.get(ze.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#V([[ze.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#w!==e){this.#w=e;for(const t of this.#i.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ue(){if(!this.#M){this.#M=!0;const e=[];for(const t of this.#i.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#de(){if(this.unselectAll(),this.#M){this.#M=!1;for(const e of this.#i.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#n.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#C&&clearTimeout(this.#C),this.#C=setTimeout(()=>{this.focusMainContainer(),this.#C=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#k?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#p.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#p.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#p.has(e)}removeDeletedAnnotationElement(e){this.#p.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#te(e){const t=this.#i.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#V(e.propertiesToUpdate))}get#fe(){let e=null;for(e of this.#b);return e}updateUI(e){this.#fe===e&&this.#V(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#V(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#I({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#V(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#f?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#V(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#I({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#a.undo(),this.#I({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Y()}),this._editorUndoBar?.hide()}redo(){this.#a.redo(),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#Y()})}addCommands(e){this.#a.add(e),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Y()})}cleanUndoStack(e){this.#a.cleanType(e)}#Y(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const r of t)r.remove()},s=()=>{for(const r of t)this.#te(r)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ne(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#I({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#ne(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#_!==Le.NONE))&&!this.#f?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#I({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=e,this.#H[1]+=t;const[s,r]=this.#H,l=[...this.#b],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const f of l)this.#n.has(f.id)&&(f.translateInPage(s,r),f.translationDone())},undo:()=>{for(const f of l)this.#n.has(f.id)&&(f.translateInPage(-s,-r),f.translationDone())},mustExec:!1})},c);for(const f of l)f.translateInPage(e,t),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const e of this.#b)this.#g.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const e=this.#g;this.#g=null;let t=!1;for(const[{x:s,y:r,pageIndex:l},c]of e)c.newX=s,c.newY=r,c.newPageIndex=l,t||=s!==c.savedX||r!==c.savedY||l!==c.savedPageIndex;if(!t)return!1;const n=(s,r,l,c)=>{if(this.#n.has(s.id)){const f=this.#i.get(c);f?s._setParentAndPosition(f,r,l):(s.pageIndex=c,s.x=r,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:l,newPageIndex:c}]of e)n(s,r,l,c)},undo:()=>{for(const[s,{savedX:r,savedY:l,savedPageIndex:c}]of e)n(s,r,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#g)for(const n of this.#g.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#_}get imageManager(){return Ge(this,"imageManager",new sp)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,g=t.rangeCount;d<g;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:s,width:r,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(d,g,v,b)=>({x:(g-s)/l,y:1-(d+v-n)/r,width:b/l,height:v/r});break;case"180":c=(d,g,v,b)=>({x:1-(d+v-n)/r,y:1-(g+b-s)/l,width:v/r,height:b/l});break;case"270":c=(d,g,v,b)=>({x:1-(g+b-s)/l,y:(d-n)/r,width:b/l,height:v/r});break;default:c=(d,g,v,b)=>({x:(d-n)/r,y:(g-s)/l,width:v/r,height:b/l});break}const f=[];for(let d=0,g=t.rangeCount;d<g;d++){const v=t.getRangeAt(d);if(!v.collapsed)for(const{x:b,y:C,width:E,height:A}of v.getClientRects())E===0||A===0||f.push(c(b,C,E,A))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#r||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#r?.delete(e)}renderAnnotationElement(e){const t=this.#r?.get(e.data.id);if(!t)return;const n=this.#s.getRawValue(t);n&&(this.#_===Le.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#k?.get(e);s&&(s.setCanvas(t,n),this.#k.delete(e))}addMissingCanvas(e,t){(this.#k||=new Map).set(e,t)}}class si{#e=null;#t=!1;#n=null;#i=null;#o=null;#s=null;#r=!1;#a=null;#u=null;#c=null;#f=null;#l=!1;static#p=null;static _l10n=null;constructor(e){this.#u=e,this.#l=e._uiManager.useNewAltTextFlow,si.#p||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){si._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#i=document.createElement("span");e.append(t),this.#l?(e.classList.add("new"),e.setAttribute("data-l10n-id",si.#p.missing),t.setAttribute("data-l10n-id",si.#p["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#u._uiManager._signal;e.addEventListener("contextmenu",Bn,{signal:n}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:n});const s=r=>{r.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#l&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(this.#r=!0,s(r))},{signal:n}),await this.#h(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#l?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#l?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#f=await si._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#h())}toggleAltTextBadge(e=!1){if(!this.#l||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){const t=this.#a=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#a.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#f),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#f}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:r=!1}){n&&(this.#c=n,this.#f=s),!(this.#e===e&&this.#t===t)&&(r||(this.#e=e,this.#t=t),this.#h())}toggle(e=!1){this.#n&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#o=null,this.#a?.remove(),this.#a=null}async#h(){const e=this.#n;if(!e)return;if(this.#l){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",si.#p[this.#g]),this.#i?.setAttribute("data-l10n-id",si.#p[`${this.#g}-label`]),!this.#e){this.#o?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#o?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#o;if(!t){this.#o=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const s=100,r=this.#u._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#o.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:r}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#o?.classList.remove("show")},{signal:r})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Zl{#e=null;#t=!1;#n=null;#i=null;#o=null;#s=null;#r=!1;constructor(e){this.#n=e,this.toolbar=null}render(){if(!this.#n._uiManager.hasCommentManager())return null;const e=this.#e=document.createElement("button");e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Bn,{signal:t}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:t});const n=s=>{s.preventDefault(),this.edit()};return e.addEventListener("click",n,{capture:!0,signal:t}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(this.#t=!0,n(s))},{signal:t}),e}edit(){const{bottom:e,left:t,right:n}=this.#n.getClientDimensions(),s={top:e};this.#n._uiManager.direction==="ltr"?s.right=n:s.left=t,this.#n._uiManager.editComment(this.#n,s)}finish(){this.#e&&(this.#e.focus({focusVisible:this.#t}),this.#t=!1)}isDeleted(){return this.#r||this.#o===""}hasBeenEdited(){return this.isDeleted()||this.#o!==this.#i}serialize(){return this.data}get data(){return{text:this.#o,date:this.#s,deleted:this.#r}}set data(e){if(e===null){this.#o="",this.#r=!0;return}this.#o=e,this.#s=new Date,this.#r=!1}setInitialText(e){this.#i=e,this.data=e}toggle(e=!1){this.#e&&(this.#e.disabled=!e)}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#o="",this.#s=null,this.#n=null,this.#t=!1,this.#r=!1}}class Hc{#e;#t=!1;#n=null;#i;#o;#s;#r;#a=null;#u;#c=null;#f;#l=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:l=null,signal:c}){this.#e=e,this.#n=n,this.#i=t,this.#o=s,this.#s=r,this.#r=l,this.#f=new AbortController,this.#u=AbortSignal.any([c,this.#f.signal]),e.addEventListener("touchstart",this.#p.bind(this),{passive:!1,signal:this.#u})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ai.pixelRatio}#p(e){if(this.#i?.())return;if(e.touches.length===1){if(this.#a)return;const s=this.#a=new AbortController,r=AbortSignal.any([this.#u,s.signal]),l=this.#e,c={capture:!0,signal:r,passive:!1},f=d=>{d.pointerType==="touch"&&(this.#a?.abort(),this.#a=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Rt(d),f(d))},c),l.addEventListener("pointerup",f,c),l.addEventListener("pointercancel",f,c);return}if(!this.#l){this.#l=new AbortController;const s=AbortSignal.any([this.#u,this.#l.signal]),r=this.#e,l={signal:s,capture:!1,passive:!1};r.addEventListener("touchmove",this.#g.bind(this),l);const c=this.#h.bind(this);r.addEventListener("touchend",c,l),r.addEventListener("touchcancel",c,l),l.capture=!0,r.addEventListener("pointerdown",Rt,l),r.addEventListener("pointermove",Rt,l),r.addEventListener("pointercancel",Rt,l),r.addEventListener("pointerup",Rt,l),this.#o?.()}if(Rt(e),e.touches.length!==2||this.#n?.()){this.#c=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#c={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(e){if(!this.#c||e.touches.length!==2)return;Rt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:r}=t,{screenX:l,screenY:c}=n,f=this.#c,{touch0X:d,touch0Y:g,touch1X:v,touch1Y:b}=f,C=v-d,E=b-g,A=l-s,_=c-r,w=Math.hypot(A,_)||1,N=Math.hypot(C,E)||1;if(!this.#t&&Math.abs(N-w)<=Hc.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=s,f.touch0Y=r,f.touch1X=l,f.touch1Y=c,!this.#t){this.#t=!0;return}const M=[(s+l)/2,(r+c)/2];this.#s?.(M,N,w)}#h(e){e.touches.length>=2||(this.#l&&(this.#l.abort(),this.#l=null,this.#r?.()),this.#c&&(Rt(e),this.#c=null,this.#t=!1))}destroy(){this.#f?.abort(),this.#f=null,this.#a?.abort(),this.#a=null}}class we{#e=null;#t=null;#n=null;#i=null;#o=!1;#s=null;#r="";#a=!1;#u=null;#c=null;#f=null;#l=null;#p="";#g=!1;#h=null;#d=!1;#m=!1;#x=!1;#y=null;#S=0;#C=0;#v=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#N=!1;#A=we._zIndex++;static _borderLineWidth=-1;static _colorManager=new op;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=we.prototype._resizeWithKeyboard,t=hs.TRANSLATE_SMALL,n=hs.TRANSLATE_BIG;return Ge(this,"_resizerKeyboardManager",new ka([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],we.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:r,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[r,l];const[c,f]=this.parentDimensions;this.x=e.x/c,this.y=e.y/f,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ge(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new i1({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(we._l10n??=e,we._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),we._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);we._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){nt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#N}set _isDraggable(e){this.#N=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#A}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#j(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[r,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/r,this.y=(t+s)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#R([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#R(this.parentDimensions,e,t)}translateInPage(e,t){this.#h||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#h||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[f,d]=this.getBaseTranslation();l+=f,c+=d;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}get _hasBeenResized(){return!!this.#h&&(this.#h[2]!==this.width||this.#h[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=we,s=n/e,r=n/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:r,y:l,width:c,height:f}=this;if(c*=n,f*=s,r*=n,l*=s,this._mustFixPosition)switch(e){case 0:r=sn(r,0,n-c),l=sn(l,0,s-f);break;case 90:r=sn(r,0,n-f),l=sn(l,c,s);break;case 180:r=sn(r,c,n),l=sn(l,f,s);break;case 270:r=sn(r,f,n),l=sn(l,0,s-c);break}this.x=r/=n,this.y=l/=s;const[d,g]=this.getBaseTranslation();r+=d,l+=g,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return we.#M(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return we.#M(e,t,360-this.parentRotation)}#w(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/n).toFixed(2)}%`,this.#a||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,s=n.endsWith("%"),r=!this.#a&&t.endsWith("%");if(s&&r)return;const[l,c]=this.parentDimensions;s||(e.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!this.#a&&!r&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#u)return;this.#u=document.createElement("div"),this.#u.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#u.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#D.bind(this,n),{signal:t}),s.addEventListener("contextmenu",Bn,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#u)}#D(e,t){t.preventDefault();const{isMac:n}=zt.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#c=[t.screenX,t.screenY];const r=new AbortController,l=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#G.bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Rt,{passive:!1,signal:l}),window.addEventListener("contextmenu",Bn,{signal:l}),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=f,this.#k()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#O(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t;const[r,l]=this.parentDimensions;this.setDims(r*n,l*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#k(){if(!this.#f)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#f;this.#f=null;const r=this.x,l=this.y,c=this.width,f=this.height;r===e&&l===t&&c===n&&f===s||this.addCommands({cmd:this.#O.bind(this,r,l,c,f),undo:this.#O.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#G(e,t){const[n,s]=this.parentDimensions,r=this.x,l=this.y,c=this.width,f=this.height,d=we.MIN_SIZE/n,g=we.MIN_SIZE/s,v=this.#w(this.rotation),b=(U,X)=>[v[0]*U+v[2]*X,v[1]*U+v[3]*X],C=this.#w(360-this.rotation),E=(U,X)=>[C[0]*U+C[2]*X,C[1]*U+C[3]*X];let A,_,w=!1,N=!1;switch(e){case"topLeft":w=!0,A=(U,X)=>[0,0],_=(U,X)=>[U,X];break;case"topMiddle":A=(U,X)=>[U/2,0],_=(U,X)=>[U/2,X];break;case"topRight":w=!0,A=(U,X)=>[U,0],_=(U,X)=>[0,X];break;case"middleRight":N=!0,A=(U,X)=>[U,X/2],_=(U,X)=>[0,X/2];break;case"bottomRight":w=!0,A=(U,X)=>[U,X],_=(U,X)=>[0,0];break;case"bottomMiddle":A=(U,X)=>[U/2,X],_=(U,X)=>[U/2,0];break;case"bottomLeft":w=!0,A=(U,X)=>[0,X],_=(U,X)=>[U,0];break;case"middleLeft":N=!0,A=(U,X)=>[0,X/2],_=(U,X)=>[U,X/2];break}const M=A(c,f),k=_(c,f);let R=b(...k);const I=we._round(r+R[0]),P=we._round(l+R[1]);let q=1,F=1,$,K;if(t.fromKeyboard)({deltaX:$,deltaY:K}=t);else{const{screenX:U,screenY:X}=t,[de,te]=this.#c;[$,K]=this.screenToPageTranslation(U-de,X-te),this.#c[0]=U,this.#c[1]=X}if([$,K]=E($/n,K/s),w){const U=Math.hypot(c,f);q=F=Math.max(Math.min(Math.hypot(k[0]-M[0]-$,k[1]-M[1]-K)/U,1/c,1/f),d/c,g/f)}else N?q=sn(Math.abs(k[0]-M[0]-$),d,1)/c:F=sn(Math.abs(k[1]-M[1]-K),g,1)/f;const ne=we._round(c*q),ae=we._round(f*F);R=b(..._(ne,ae));const ce=I-R[0],me=P-R[1];this.#h||=[this.x,this.y,this.width,this.height],this.width=ne,this.height=ae,this.x=ce,this.y=me,this.setDims(n*ne,s*ae),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new ga(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(si.initialize(we._l10n),this.#n=new si(this),this.#e&&(this.#n.data=this.#e,this.#e=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}addCommentButton(){return this.#i?this.#i:this.#i=new Zl(this)}get commentColor(){return null}get comment(){const e=this.#i;return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){this.#i||(this.#i=new Zl(this)),this.#i.data=e}setCommentData(e){this.#i||(this.#i=new Zl(this)),this.#i.setInitialText(e)}get hasEditedComment(){return this.#i?.hasBeenEdited()}async editComment(){this.#i||(this.#i=new Zl(this)),this.#i.edit()}addComment(e){this.hasEditedComment&&(e.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#o?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#z();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),_S(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new Hc({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#_.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#U.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),e}#_(){this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(e,t,n){let r=.7*(n/t)+1-.7;if(r===1)return;const l=this.#w(this.rotation),c=(I,P)=>[l[0]*I+l[2]*P,l[1]*I+l[3]*P],[f,d]=this.parentDimensions,g=this.x,v=this.y,b=this.width,C=this.height,E=we.MIN_SIZE/f,A=we.MIN_SIZE/d;r=Math.max(Math.min(r,1/b,1/C),E/b,A/C);const _=we._round(b*r),w=we._round(C*r);if(_===b&&w===C)return;this.#h||=[g,v,b,C];const N=c(b/2,C/2),M=we._round(g+N[0]),k=we._round(v+N[1]),R=c(_/2,w/2);this.x=M-R[0],this.y=k-R[1],this.width=_,this.height=w,this.setDims(f*_,d*w),this.fixAndSetPosition(),this._onResizing()}#U(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#k()}pointerdown(e){const{isMac:t}=zt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#q(e);return}this.#B(e)}#B(e){const{isMac:t}=zt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#q(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:r},c=d=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#B(d),n&&this._onStopDragging()};t&&(this.#S=e.clientX,this.#C=e.clientY,this.#s=e.pointerId,this.#r=e.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._onStartDragging());const{clientX:g,clientY:v,pointerId:b}=d;if(b!==this.#s){Rt(d);return}const[C,E]=this.screenToPageTranslation(g-this.#S,v-this.#C);this.#S=g,this.#C=v,this._uiManager.dragSelectedEditors(C,E)},l),window.addEventListener("touchmove",Rt,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#r&&(this.#E||d.isPrimary)&&c(d),Rt(d)},l));const f=d=>{if(!this.#s||this.#s===d.pointerId){c(d);return}Rt(d)};window.addEventListener("pointerup",f,{signal:r}),window.addEventListener("blur",f,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[r,l]=this.pageDimensions,[c,f]=this.pageTranslation,d=e/s,g=t/s,v=this.x*r,b=this.y*l,C=this.width*r,E=this.height*l;switch(n){case 0:return[v+d+c,l-b-g-E+f,v+d+C+c,l-b-g+f];case 90:return[v+g+c,l-b+d+f,v+g+E+c,l-b+d+C+f];case 180:return[v-d-C+c,l-b+g+f,v-d+c,l-b+g+E+f];case 270:return[v-g-E+c,l-b-d-C+f,v-g+c,l-b-d+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,r,l]=e,c=r-n,f=l-s;switch(this.rotation){case 0:return[n,t-l,c,f];case 90:return[n,t-s,f,c];case 180:return[r,t-s,c,f];case 270:return[r,t-l,f,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#x}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:l}=window;return t<l&&s>0&&e<r&&n>0}#z(){if(this.#l||!this.div)return;this.#l=new AbortController;const e=this._uiManager.combinedSignal(this.#l);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#z()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){nt("An editor must be serializable")}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[r,l]=s.pageDimensions,[c,f,d,g]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/r,s.y=f/l,s.width=d/r,s.height=g/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#l?.abort(),this.#l=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#j(),this.removeEditToolbar(),this.#v){for(const e of this.#v.values())clearTimeout(e);this.#v=null}this.parent=null,this.#E?.destroy(),this.#E=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#u.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#u.children;if(!this.#t){this.#t=Array.from(t);const l=this.#$.bind(this),c=this.#H.bind(this),f=this._uiManager._signal;for(const d of this.#t){const g=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:f}),d.addEventListener("blur",c,{signal:f}),d.addEventListener("focus",this.#L.bind(this,g),{signal:f}),d.setAttribute("data-l10n-id",we._l10nResizer[g])}}const n=this.#t[0];let s=0;for(const l of t){if(l===n)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(r!==s){if(r<s)for(let c=0;c<s-r;c++)this.#u.append(this.#u.firstChild);else if(r>s)for(let c=0;c<r-s;c++)this.#u.firstChild.before(this.#u.lastChild);let l=0;for(const c of t){const d=this.#t[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",we._l10nResizer[d])}}this.#P(0),this.#x=!0,this.#u.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#$(e){we._resizerKeyboardManager.exec(this,e)}#H(e){this.#x&&e.relatedTarget?.parentNode!==this.#u&&this.#j()}#L(e){this.#p=this.#x?e:""}#P(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#x&&this.#G(this.#p,{deltaX:e,deltaY:t,fromKeyboard:!0})}#j(){this.#x=!1,this.#P(-1),this.#k()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#u?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#d}set isEditing(e){this.#d=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#a=!0;const n=e/t,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#v||=new Map;const{action:n}=e;let s=this.#v.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#v.delete(n),this.#v.size===0&&(this.#v=null)},we._telemetryTimeout),this.#v.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#o=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#o=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class i1 extends we{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ev=3285377520,Pn=4294901760,ti=65535;class TS{constructor(e){this.h1=e?e&4294967295:ev,this.h2=e?e&4294967295:ev}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let A=0,_=e.length;A<_;A++){const w=e.charCodeAt(A);w<=255?t[n++]=w:(t[n++]=w>>>8,t[n++]=w&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,r=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,f=0,d=this.h1,g=this.h2;const v=3432918353,b=461845907,C=v&ti,E=b&ti;for(let A=0;A<s;A++)A&1?(c=l[A],c=c*v&Pn|c*C&ti,c=c<<15|c>>>17,c=c*b&Pn|c*E&ti,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(f=l[A],f=f*v&Pn|f*C&ti,f=f<<15|f>>>17,f=f*b&Pn|f*E&ti,g^=f,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,r){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*v&Pn|c*C&ti,c=c<<15|c>>>17,c=c*b&Pn|c*E&ti,s&1?d^=c:g^=c}this.h1=d,this.h2=g}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Pn|e*36045&ti,t=t*4283543511&Pn|((t<<16|e>>>16)*2950163797&Pn)>>>16,e^=t>>>1,e=e*444984403&Pn|e*60499&ti,t=t*3301882366&Pn|((t<<16|e>>>16)*3120437893&Pn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const vh=Object.freeze({map:null,hash:"",transfer:void 0});class rp{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof we)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[r,l]of Object.entries(t))n[r]!==l&&(s=!0,n[r]=l);else s=!0,this.#n.set(e,t);s&&this.#i(),t instanceof we&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new wS(this)}get serializable(){if(this.#n.size===0)return vh;const e=new Map,t=new TS,n=[],s=Object.create(null);let r=!1;for(const[l,c]of this.#n){const f=c instanceof we?c.serialize(!1,s):c;f&&(e.set(l,f),t.update(`${l}:${JSON.stringify(f)}`),r||=!!f.bitmap)}if(r)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:vh}get editorStats(){let e=null;const t=new Map;for(const n of this.#n.values()){if(!(n instanceof we))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(n).constructor),e||=Object.create(null);const l=e[r]||=new Map;for(const[c,f]of Object.entries(s)){if(c==="type")continue;let d=l.get(c);d||(d=new Map,l.set(c,d));const g=d.get(f)??0;d.set(f,g+1)}}for(const[n,s]of t)e[n]=s.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof we)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class wS extends rp{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,r=structuredClone(t,s?{transfer:s}:null);this.#e={map:r,hash:n,transfer:s}}get print(){nt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Ge(this,"modifiedIds",{ids:new Set,hash:""})}}class s1{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(It(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:l}=e,c=new FontFace(s,r,l);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{Pe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}nt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Pe(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Ge(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ge(this,"isSyncFontLoadingSupported",nn||zt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(It(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const r=n.shift();setTimeout(r.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ge(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(k,R){return k.charCodeAt(R)<<24|k.charCodeAt(R+1)<<16|k.charCodeAt(R+2)<<8|k.charCodeAt(R+3)&255}function s(k,R,I,P){const q=k.substring(0,R),F=k.substring(R+I);return q+P+F}let r,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const f=c.getContext("2d");let d=0;function g(k,R){if(++d>30){Pe("Load test font never loaded."),R();return}if(f.font="30px "+k,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(g.bind(null,k,R))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=s(b,976,v.length,v);const E=16,A=1482184792;let _=n(b,E);for(r=0,l=v.length-3;r<l;r+=4)_=_-A+n(v,r)|0;r<v.length&&(_=_-A+n(v+"XXX",r)|0),b=s(b,E,4,qw(_));const w=`url(data:font/opentype;base64,${btoa(b)});`,N=`@font-face {font-family:"${v}";src:${w}}`;this.insertRule(N);const M=this._document.createElement("div");M.style.visibility="hidden",M.style.width=M.style.height="10px",M.style.position="absolute",M.style.top=M.style.left="0px";for(const k of[e.loadedName,v]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=k,M.append(R)}this._document.body.append(M),g(v,()=>{M.remove(),t.complete()})}}class o1{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${ES(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Pe(`getPathGenerator - ignoring character: "${l}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=r}}function r1(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(nn)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function a1(i){if(nn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Ra(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ec(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const xh=i=>typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0,l1=i=>typeof i=="object"&&typeof i?.name=="string",c1=Yw.bind(null,xh,l1);class u1{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:r}=n;if(r.aborted){Pe("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",l),r.addEventListener("abort",l)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const tc={DATA:1,ERROR:2},Mt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function tv(){}function pn(i){if(i instanceof fs||i instanceof mh||i instanceof J0||i instanceof Tc||i instanceof Mf)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||nt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new fs(i.message);case"InvalidPDFException":return new mh(i.message);case"PasswordException":return new J0(i.message,i.code);case"ResponseException":return new Tc(i.message,i.status,i.missing);case"UnknownErrorException":return new Mf(i.message,i.details)}return new Mf(i.message,i.toString())}class pa{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===tc.DATA)s.resolve(e.data);else if(e.callback===tc.ERROR)s.reject(pn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(l){r.postMessage({sourceName:n,targetName:s,callback:tc.DATA,callbackId:e.callbackId,data:l})},function(l){r.postMessage({sourceName:n,targetName:s,callback:tc.ERROR,callbackId:e.callbackId,reason:pn(l)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){r.reject(l)}return r.promise}sendWithStream(e,t,n,s){const r=this.streamId++,l=this.sourceName,c=this.targetName,f=this.comObj;return new ReadableStream({start:d=>{const g=Promise.withResolvers();return this.streamControllers[r]={controller:d,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:l,targetName:c,action:e,streamId:r,data:t,desiredSize:d.desiredSize},s),g.promise},pull:d=>{const g=Promise.withResolvers();return this.streamControllers[r].pullCall=g,f.postMessage({sourceName:l,targetName:c,stream:Mt.PULL,streamId:r,desiredSize:d.desiredSize}),g.promise},cancel:d=>{It(d instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[r].cancelCall=g,this.streamControllers[r].isClosed=!0,f.postMessage({sourceName:l,targetName:c,stream:Mt.CANCEL,streamId:r,reason:pn(d)}),g.promise}},n)}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,r=this.comObj,l=this,c=this.actionHandler[e.action],f={enqueue(d,g=1,v){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:s,stream:Mt.ENQUEUE,streamId:t,chunk:d},v)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:s,stream:Mt.CLOSE,streamId:t}),delete l.streamSinks[t])},error(d){It(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:s,stream:Mt.ERROR,streamId:t,reason:pn(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[t]=f,Promise.try(c,e.data,f).then(function(){r.postMessage({sourceName:n,targetName:s,stream:Mt.START_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:n,targetName:s,stream:Mt.START_COMPLETE,streamId:t,reason:pn(d)})})}#i(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,r=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case Mt.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(pn(e.reason));break;case Mt.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(pn(e.reason));break;case Mt.PULL:if(!c){r.postMessage({sourceName:n,targetName:s,stream:Mt.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||tv).then(function(){r.postMessage({sourceName:n,targetName:s,stream:Mt.PULL_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:n,targetName:s,stream:Mt.PULL_COMPLETE,streamId:t,reason:pn(d)})});break;case Mt.ENQUEUE:if(It(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case Mt.CLOSE:if(It(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#o(l,t);break;case Mt.ERROR:It(l,"error should have stream controller"),l.controller.error(pn(e.reason)),this.#o(l,t);break;case Mt.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(pn(e.reason)),this.#o(l,t);break;case Mt.CANCEL:if(!c)break;const f=pn(e.reason);Promise.try(c.onCancel||tv,f).then(function(){r.postMessage({sourceName:n,targetName:s,stream:Mt.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){r.postMessage({sourceName:n,targetName:s,stream:Mt.CANCEL_COMPLETE,streamId:t,reason:pn(d)})}),c.sinkCapability.reject(f),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#o(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class MS{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){nt("Abstract method `_createCanvas` called.")}}class d1 extends MS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class NS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){nt("Abstract method `_fetch` called.")}}class nv extends NS{async _fetch(e){const t=await Ia(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Ra(t)}}class RS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,r){return"none"}destroy(e=!1){}}class f1 extends RS{#e;#t;#n;#i;#o;#s;#r=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#o=t}get#a(){return this.#t||=new Map}get#u(){return this.#s||=new Map}get#c(){if(!this.#n){const e=this.#o.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#o.createElementNS(Ti,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#o.createElementNS(Ti,"defs"),e.append(n),n.append(this.#n),this.#o.body.append(e)}return this.#n}#f(e){if(e.length===1){const f=e[0],d=new Array(256);for(let v=0;v<256;v++)d[v]=f[v]/255;const g=d.join(",");return[g,g,g]}const[t,n,s]=e,r=new Array(256),l=new Array(256),c=new Array(256);for(let f=0;f<256;f++)r[f]=t[f]/255,l[f]=n[f]/255,c[f]=s[f]/255;return[r.join(","),l.join(","),c.join(",")]}#l(e){if(this.#e===void 0){this.#e="";const t=this.#o.URL;t!==this.#o.baseURI&&(Gc(t)?Pe('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=SS(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#a.get(e);if(t)return t;const[n,s,r]=this.#f(e),l=e.length===1?n:`${n}${s}${r}`;if(t=this.#a.get(l),t)return this.#a.set(e,t),t;const c=`g_${this.#i}_transfer_map_${this.#r++}`,f=this.#l(c);this.#a.set(e,f),this.#a.set(l,f);const d=this.#h(c);return this.#m(n,s,r,d),f}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let r=this.#u.get(s);if(r?.key===n||(r?(r.filter?.remove(),r.key=n,r.url="none",r.filter=null):(r={key:n,url:"none",filter:null},this.#u.set(s,r)),!e||!t))return r.url;const l=this.#y(e);e=_e.makeHexColor(...l);const c=this.#y(t);if(t=_e.makeHexColor(...c),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return r.url;const f=new Array(256);for(let C=0;C<=255;C++){const E=C/255;f[C]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=f.join(","),g=`g_${this.#i}_hcm_filter`,v=r.filter=this.#h(g);this.#m(d,d,d,v),this.#g(v);const b=(C,E)=>{const A=l[C]/255,_=c[C]/255,w=new Array(E+1);for(let N=0;N<=E;N++)w[N]=A+N/E*(_-A);return w.join(",")};return this.#m(b(0,5),b(1,5),b(2,5),v),r.url=this.#l(g),r.url}addAlphaFilter(e){let t=this.#a.get(e);if(t)return t;const[n]=this.#f([e]),s=`alpha_${n}`;if(t=this.#a.get(s),t)return this.#a.set(e,t),t;const r=`g_${this.#i}_alpha_map_${this.#r++}`,l=this.#l(r);this.#a.set(e,l),this.#a.set(s,l);const c=this.#h(r);return this.#x(n,c),l}addLuminosityFilter(e){let t=this.#a.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#f([e]),s=`luminosity_${n}`):s="luminosity",t=this.#a.get(s),t)return this.#a.set(e,t),t;const r=`g_${this.#i}_luminosity_map_${this.#r++}`,l=this.#l(r);this.#a.set(e,l),this.#a.set(s,l);const c=this.#h(r);return this.#p(c),e&&this.#x(n,c),l}addHighlightHCMFilter(e,t,n,s,r){const l=`${t}-${n}-${s}-${r}`;let c=this.#u.get(e);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#u.set(e,c)),!t||!n))return c.url;const[f,d]=[t,n].map(this.#y.bind(this));let g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),v=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[b,C]=[s,r].map(this.#y.bind(this));v<g&&([g,v,b,C]=[v,g,C,b]),this.#c.style.color="";const E=(w,N,M)=>{const k=new Array(256),R=(v-g)/M,I=w/255,P=(N-w)/(255*M);let q=0;for(let F=0;F<=M;F++){const $=Math.round(g+F*R),K=I+F*P;for(let ne=q;ne<=$;ne++)k[ne]=K;q=$+1}for(let F=q;F<256;F++)k[F]=k[q-1];return k.join(",")},A=`g_${this.#i}_hcm_${e}_filter`,_=c.filter=this.#h(A);return this.#g(_),this.#m(E(b[0],C[0],5),E(b[1],C[1],5),E(b[2],C[2],5),_),c.url=this.#l(A),c.url}destroy(e=!1){e&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#r=0)}#p(e){const t=this.#o.createElementNS(Ti,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#o.createElementNS(Ti,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#h(e){const t=this.#o.createElementNS(Ti,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#d(e,t,n){const s=this.#o.createElementNS(Ti,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#m(e,t,n,s){const r=this.#o.createElementNS(Ti,"feComponentTransfer");s.append(r),this.#d(r,"feFuncR",e),this.#d(r,"feFuncG",t),this.#d(r,"feFuncB",n)}#x(e,t){const n=this.#o.createElementNS(Ti,"feComponentTransfer");t.append(n),this.#d(n,"feFuncA",e)}#y(e){return this.#c.style.color=e,qc(getComputedStyle(this.#c).getPropertyValue("color"))}}class IS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){nt("Abstract method `_fetch` called.")}}class iv extends IS{async _fetch(e){const t=await Ia(e,"arraybuffer");return new Uint8Array(t)}}class DS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){nt("Abstract method `_fetch` called.")}}class sv extends DS{async _fetch(e){const t=await Ia(e,"arraybuffer");return new Uint8Array(t)}}nn&&Pe("Please use the `legacy` build in Node.js environments.");async function ap(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class h1 extends RS{}class p1 extends MS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class m1 extends NS{async _fetch(e){return ap(e)}}class g1 extends IS{async _fetch(e){return ap(e)}}class y1 extends DS{async _fetch(e){return ap(e)}}const jt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function bh(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class lp{isModifyingCurrentTransform(){return!1}getPattern(){nt("Abstract method `getPattern` called.")}}class v1 extends lp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let r;if(s===jt.STROKE||s===jt.FILL){const l=t.current.getClippedPathBoundingBox(s,mt(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,f=Math.ceil(l[3]-l[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,f),g=d.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=_e.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...t.baseTransform),this.matrix&&g.transform(...this.matrix),bh(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),r=e.createPattern(d.canvas,"no-repeat");const v=new DOMMatrix(n);r.setTransform(v)}else bh(e,this._bbox),r=this._createGradient(e);return r}}function If(i,e,t,n,s,r,l,c){const f=e.coords,d=e.colors,g=i.data,v=i.width*4;let b;f[t+1]>f[n+1]&&(b=t,t=n,n=b,b=r,r=l,l=b),f[n+1]>f[s+1]&&(b=n,n=s,s=b,b=l,l=c,c=b),f[t+1]>f[n+1]&&(b=t,t=n,n=b,b=r,r=l,l=b);const C=(f[t]+e.offsetX)*e.scaleX,E=(f[t+1]+e.offsetY)*e.scaleY,A=(f[n]+e.offsetX)*e.scaleX,_=(f[n+1]+e.offsetY)*e.scaleY,w=(f[s]+e.offsetX)*e.scaleX,N=(f[s+1]+e.offsetY)*e.scaleY;if(E>=N)return;const M=d[r],k=d[r+1],R=d[r+2],I=d[l],P=d[l+1],q=d[l+2],F=d[c],$=d[c+1],K=d[c+2],ne=Math.round(E),ae=Math.round(N);let ce,me,U,X,de,te,L,V;for(let W=ne;W<=ae;W++){if(W<_){const Ee=W<E?0:(E-W)/(E-_);ce=C-(C-A)*Ee,me=M-(M-I)*Ee,U=k-(k-P)*Ee,X=R-(R-q)*Ee}else{let Ee;W>N?Ee=1:_===N?Ee=0:Ee=(_-W)/(_-N),ce=A-(A-w)*Ee,me=I-(I-F)*Ee,U=P-(P-$)*Ee,X=q-(q-K)*Ee}let z;W<E?z=0:W>N?z=1:z=(E-W)/(E-N),de=C-(C-w)*z,te=M-(M-F)*z,L=k-(k-$)*z,V=R-(R-K)*z;const le=Math.round(Math.min(ce,de)),xe=Math.round(Math.max(ce,de));let he=v*W+le*4;for(let Ee=le;Ee<=xe;Ee++)z=(ce-Ee)/(ce-de),z<0?z=0:z>1&&(z=1),g[he++]=me-(me-te)*z|0,g[he++]=U-(U-L)*z|0,g[he++]=X-(X-V)*z|0,g[he++]=255}}function x1(i,e,t){const n=e.coords,s=e.colors;let r,l;switch(e.type){case"lattice":const c=e.verticesPerRow,f=Math.floor(n.length/c)-1,d=c-1;for(r=0;r<f;r++){let g=r*c;for(let v=0;v<d;v++,g++)If(i,t,n[g],n[g+1],n[g+c],s[g],s[g+1],s[g+c]),If(i,t,n[g+c+1],n[g+1],n[g+c],s[g+c+1],s[g+1],s[g+c])}break;case"triangles":for(r=0,l=n.length;r<l;r+=3)If(i,t,n[r],n[r+1],n[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class b1 extends lp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-f,v=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*e[1]*1.1)),3e3),C=d/v,E=g/b,A={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-f,scaleX:1/C,scaleY:1/E},_=v+4,w=b+4,N=n.getCanvas("mesh",_,w),M=N.context,k=M.createImageData(v,b);if(t){const I=k.data;for(let P=0,q=I.length;P<q;P+=4)I[P]=t[0],I[P+1]=t[1],I[P+2]=t[2],I[P+3]=255}for(const I of this._figures)x1(k,I,A);return M.putImageData(k,2,2),{canvas:N.canvas,offsetX:c-2*C,offsetY:f-2*E,scaleX:C,scaleY:E}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){bh(e,this._bbox);const r=new Float32Array(2);if(s===jt.SHADING)_e.singularValueDecompose2dScale(mt(e),r);else if(this.matrix){_e.singularValueDecompose2dScale(this.matrix,r);const[c,f]=r;_e.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=c,r[1]*=f}else _e.singularValueDecompose2dScale(t.baseTransform,r);const l=this._createMeshCanvas(r,s===jt.SHADING?null:this._background,t.cachedCanvases);return s!==jt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class S1 extends lp{getPattern(){return"hotpink"}}function C1(i){switch(i[0]){case"RadialAxial":return new v1(i);case"Mesh":return new b1(i);case"Dummy":return new S1}throw new Error(`Unknown IR type: ${i[0]}`)}const ov={COLORED:1,UNCOLORED:2};class cp{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:s,tilingType:r,color:l,canvasGraphicsFactory:c}=this;let{xstep:f,ystep:d}=this;f=Math.abs(f),d=Math.abs(d),Vc("TilingType: "+r);const g=t[0],v=t[1],b=t[2],C=t[3],E=b-g,A=C-v,_=new Float32Array(2);_e.singularValueDecompose2dScale(this.matrix,_);const[w,N]=_;_e.singularValueDecompose2dScale(this.baseTransform,_);const M=w*_[0],k=N*_[1];let R=E,I=A,P=!1,q=!1;const F=Math.ceil(f*M),$=Math.ceil(d*k),K=Math.ceil(E*M),ne=Math.ceil(A*k);F>=K?R=f:P=!0,$>=ne?I=d:q=!0;const ae=this.getSizeAndScale(R,this.ctx.canvas.width,M),ce=this.getSizeAndScale(I,this.ctx.canvas.height,k),me=e.cachedCanvases.getCanvas("pattern",ae.size,ce.size),U=me.context,X=c.createCanvasGraphics(U);if(X.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(X,s,l),U.translate(-ae.scale*g,-ce.scale*v),X.transform(ae.scale,0,0,ce.scale,0,0),U.save(),this.clipBbox(X,g,v,b,C),X.baseTransform=mt(X.ctx),X.executeOperatorList(n),X.endDrawing(),U.restore(),P||q){const de=me.canvas;P&&(R=f),q&&(I=d);const te=this.getSizeAndScale(R,this.ctx.canvas.width,M),L=this.getSizeAndScale(I,this.ctx.canvas.height,k),V=te.size,W=L.size,z=e.cachedCanvases.getCanvas("pattern-workaround",V,W),le=z.context,xe=P?Math.floor(E/f):0,he=q?Math.floor(A/d):0;for(let Ee=0;Ee<=xe;Ee++)for(let Ne=0;Ne<=he;Ne++)le.drawImage(de,V*Ee,W*Ne,V,W,0,0,V,W);return{canvas:z.canvas,scaleX:te.scale,scaleY:L.scale,offsetX:g,offsetY:v}}return{canvas:me.canvas,scaleX:ae.scale,scaleY:ce.scale,offsetX:g,offsetY:v}}getSizeAndScale(e,t,n){const s=Math.max(cp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*n);return r>=s?r=s:n=r/e,{scale:n,size:r}}clipBbox(e,t,n,s,r){const l=s-t,c=r-n;e.ctx.rect(t,n,l,c),_e.axialAlignedBoundingBox([t,n,s,r],mt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,r=e.current;switch(t){case ov.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=r.fillColor=l,s.strokeStyle=r.strokeColor=c;break;case ov.UNCOLORED:s.fillStyle=s.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new Gw(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s){let r=n;s!==jt.SHADING&&(r=_e.transform(r,t.baseTransform),this.matrix&&(r=_e.transform(r,this.matrix)));const l=this.createPatternCanvas(t);let c=new DOMMatrix(r);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const f=e.createPattern(l.canvas,"repeat");return f.setTransform(c),f}}function A1({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:r=4294967295,inverseDecode:l=!1}){const c=zt.isLittleEndian?4278190080:255,[f,d]=l?[r,c]:[c,r],g=n>>3,v=n&7,b=i.length;t=new Uint32Array(t.buffer);let C=0;for(let E=0;E<s;E++){for(const _=e+g;e<_;e++){const w=e<b?i[e]:255;t[C++]=w&128?d:f,t[C++]=w&64?d:f,t[C++]=w&32?d:f,t[C++]=w&16?d:f,t[C++]=w&8?d:f,t[C++]=w&4?d:f,t[C++]=w&2?d:f,t[C++]=w&1?d:f}if(v===0)continue;const A=e<b?i[e++]:255;for(let _=0;_<v;_++)t[C++]=A&1<<7-_?d:f}return{srcPos:e,destPos:C}}const rv=16,av=100,E1=15,lv=10,mn=16,Df=new DOMMatrix,_n=new Float32Array(2),qo=new Float32Array([1/0,1/0,-1/0,-1/0]);function _1(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,s,r,l,c){e.transform(t,n,s,r,l,c),this.__originalTransform(t,n,s,r,l,c)},i.setTransform=function(t,n,s,r,l,c){e.setTransform(t,n,s,r,l,c),this.__originalSetTransform(t,n,s,r,l,c)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,r,l,c){e.bezierCurveTo(t,n,s,r,l,c),this.__originalBezierCurveTo(t,n,s,r,l,c)},i.rect=function(t,n,s,r){e.rect(t,n,s,r),this.__originalRect(t,n,s,r)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class T1{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function nc(i,e,t,n,s,r,l,c,f,d){const[g,v,b,C,E,A]=mt(i);if(v===0&&b===0){const N=l*g+E,M=Math.round(N),k=c*C+A,R=Math.round(k),I=(l+f)*g+E,P=Math.abs(Math.round(I)-M)||1,q=(c+d)*C+A,F=Math.abs(Math.round(q)-R)||1;return i.setTransform(Math.sign(g),0,0,Math.sign(C),M,R),i.drawImage(e,t,n,s,r,0,0,P,F),i.setTransform(g,v,b,C,E,A),[P,F]}if(g===0&&C===0){const N=c*b+E,M=Math.round(N),k=l*v+A,R=Math.round(k),I=(c+d)*b+E,P=Math.abs(Math.round(I)-M)||1,q=(l+f)*v+A,F=Math.abs(Math.round(q)-R)||1;return i.setTransform(0,Math.sign(v),Math.sign(b),0,M,R),i.drawImage(e,t,n,s,r,0,0,F,P),i.setTransform(g,v,b,C,E,A),[F,P]}i.drawImage(e,t,n,s,r,l,c,f,d);const _=Math.hypot(g,v),w=Math.hypot(b,C);return[_*f,w*d]}class cv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=ph;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Kt.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t){this.clipBox=new Float32Array([0,0,e,t]),this.minMax=qo.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=jt.FILL,t=null){const n=this.minMax.slice();if(e===jt.STROKE){t||nt("Stroke bounding box must include transform."),_e.singularValueDecompose2dScale(t,_n);const s=_n[0]*this.lineWidth/2,r=_n[1]*this.lineWidth/2;n[0]-=s,n[1]-=r,n[2]+=s,n[3]+=r}return n}updateClipFromPath(){const e=_e.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(qo,0)}getClippedPathBoundingBox(e=jt.FILL,t=null){return _e.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function uv(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%mn,r=(t-s)/mn,l=s===0?r:r+1,c=i.createImageData(n,mn);let f=0,d;const g=e.data,v=c.data;let b,C,E,A;if(e.kind===hc.GRAYSCALE_1BPP){const _=g.byteLength,w=new Uint32Array(v.buffer,0,v.byteLength>>2),N=w.length,M=n+7>>3,k=4294967295,R=zt.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(E=b<r?mn:s,d=0,C=0;C<E;C++){const I=_-f;let P=0;const q=I>M?n:I*8-7,F=q&-8;let $=0,K=0;for(;P<F;P+=8)K=g[f++],w[d++]=K&128?k:R,w[d++]=K&64?k:R,w[d++]=K&32?k:R,w[d++]=K&16?k:R,w[d++]=K&8?k:R,w[d++]=K&4?k:R,w[d++]=K&2?k:R,w[d++]=K&1?k:R;for(;P<q;P++)$===0&&(K=g[f++],$=128),w[d++]=K&$?k:R,$>>=1}for(;d<N;)w[d++]=0;i.putImageData(c,0,b*mn)}}else if(e.kind===hc.RGBA_32BPP){for(C=0,A=n*mn*4,b=0;b<r;b++)v.set(g.subarray(f,f+A)),f+=A,i.putImageData(c,0,C),C+=mn;b<l&&(A=n*s*4,v.set(g.subarray(f,f+A)),i.putImageData(c,0,C))}else if(e.kind===hc.RGB_24BPP)for(E=mn,A=n*E,b=0;b<l;b++){for(b>=r&&(E=s,A=n*E),d=0,C=A;C--;)v[d++]=g[f++],v[d++]=g[f++],v[d++]=g[f++],v[d++]=255;i.putImageData(c,0,b*mn)}else throw new Error(`bad image kind: ${e.kind}`)}function dv(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%mn,r=(t-s)/mn,l=s===0?r:r+1,c=i.createImageData(n,mn);let f=0;const d=e.data,g=c.data;for(let v=0;v<l;v++){const b=v<r?mn:s;({srcPos:f}=A1({src:d,srcPos:f,dest:g,width:n,height:b,nonBlackColor:0})),i.putImageData(c,0,v*mn)}}function ra(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function ic(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function fv(i,e){if(e)return!0;_e.singularValueDecompose2dScale(i,_n);const t=Math.fround(ai.pixelRatio*Jo.PDF_TO_CSS_UNITS);return _n[0]<=t&&_n[1]<=t}const w1=["butt","round","square"],M1=["miter","round","bevel"],N1={},hv={};class $o{constructor(e,t,n,s,r,{optionalContentConfig:l,markedContentStack:c=null},f,d){this.ctx=e,this.current=new cv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new T1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const r=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,l),this.ctx.fillStyle=c,n){const f=this.cachedCanvases.getCanvas("transparent",r,l);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...mt(this.compositeCtx))}this.ctx.save(),ic(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=mt(this.ctx)}executeOperatorList(e,t,n,s){const r=e.argsArray,l=e.fnArray;let c=t||0;const f=r.length;if(f===c)return c;const d=f-c>lv&&typeof n=="function",g=d?Date.now()+E1:0;let v=0;const b=this.commonObjs,C=this.objs;let E;for(;;){if(s!==void 0&&c===s.nextBreakPoint)return s.breakIt(c,n),c;if(E=l[c],E!==_c.dependency)this[E].apply(this,r[c]);else for(const A of r[c]){const _=A.startsWith("g_")?b:C;if(!_.has(A))return _.get(A,n),c}if(c++,c===f)return c;if(d&&++v>lv){if(Date.now()>g)return n(),c;v=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,f=s,d="prescale1",g,v;for(;r>2&&c>1||l>2&&f>1;){let b=c,C=f;r>2&&c>1&&(b=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),r/=c/b),l>2&&f>1&&(C=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,l/=f/C),g=this.cachedCanvases.getCanvas(d,b,C),v=g.context,v.clearRect(0,0,b,C),v.drawImage(e,0,0,c,f,0,0,b,C),e=g.canvas,c=b,f=C,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:f}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,r=this.current.fillColor,l=this.current.patternFill,c=mt(t);let f,d,g,v;if((e.bitmap||e.data)&&e.count>1){const F=e.bitmap||e.data.buffer;d=JSON.stringify(l?c:[c.slice(0,4),r]),f=this._cachedBitmapsMap.get(F),f||(f=new Map,this._cachedBitmapsMap.set(F,f));const $=f.get(d);if($&&!l){const K=Math.round(Math.min(c[0],c[2])+c[4]),ne=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:$,offsetX:K,offsetY:ne}}g=$}g||(v=this.cachedCanvases.getCanvas("maskCanvas",n,s),dv(v.context,e));let b=_e.transform(c,[1/n,0,0,-1/s,0,0]);b=_e.transform(b,[1,0,0,1,0,-s]);const C=qo.slice();_e.axialAlignedBoundingBox([0,0,n,s],b,C);const[E,A,_,w]=C,N=Math.round(_-E)||1,M=Math.round(w-A)||1,k=this.cachedCanvases.getCanvas("fillCanvas",N,M),R=k.context,I=E,P=A;R.translate(-I,-P),R.transform(...b),g||(g=this._scaleImage(v.canvas,ei(R)),g=g.img,f&&l&&f.set(d,g)),R.imageSmoothingEnabled=fv(mt(R),e.interpolate),nc(R,g,0,0,g.width,g.height,0,0,n,s),R.globalCompositeOperation="source-in";const q=_e.transform(ei(R),[1,0,0,1,-I,-P]);return R.fillStyle=l?r.getPattern(t,this,q,jt.FILL):r,R.fillRect(0,0,n,s),f&&!l&&(this.cachedCanvases.delete("fillCanvas"),f.set(d,k.canvas)),{canvas:k.canvas,offsetX:Math.round(I),offsetY:Math.round(P)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=w1[e]}setLineJoin(e){this.ctx.lineJoin=M1[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),ra(this.suspendedCtx,r),_1(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ra(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const r=s[0],l=s[1],c=s[2]-r,f=s[3]-l;c===0||f===0||(this.genericComposeSMask(t.context,n,c,f,t.subtype,t.backdrop,t.transferMap,r,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,r,l,c,f,d,g,v){let b=e.canvas,C=f-g,E=d-v;if(l)if(C<0||E<0||C+n>b.width||E+s>b.height){const _=this.cachedCanvases.getCanvas("maskExtension",n,s),w=_.context;w.drawImage(b,-C,-E),w.globalCompositeOperation="destination-atop",w.fillStyle=l,w.fillRect(0,0,n,s),w.globalCompositeOperation="source-over",b=_.canvas,C=E=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(C,E,n,s),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(C,E,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const A=new Path2D;A.rect(f,d,n,s),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(b,C,E,n,s,f,d,n,s),t.restore()}save(){this.inSMaskMode&&ra(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ra(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,r,l){this.ctx.transform(e,t,n,s,r,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let[s]=t;if(!n){s||=t[0]=new Path2D,this[e](s);return}if(!(s instanceof Path2D)){const r=t[0]=new Path2D;for(let l=0,c=s.length;l<c;)switch(s[l++]){case Ql.moveTo:r.moveTo(s[l++],s[l++]);break;case Ql.lineTo:r.lineTo(s[l++],s[l++]);break;case Ql.curveTo:r.bezierCurveTo(s[l++],s[l++],s[l++],s[l++],s[l++],s[l++]);break;case Ql.closePath:r.closePath();break;default:Pe(`Unrecognized drawing path operator: ${s[l-1]}`);break}s=r}_e.axialAlignedBoundingBox(n,mt(this.ctx),this.current.minMax),this[e](s)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const n=this.ctx,s=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&s?.getPattern){const r=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=s.getPattern(n,this,ei(n),jt.STROKE),r){const l=new Path2D;l.addPath(e,n.getTransform().invertSelf().multiplySelf(r)),e=l}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(jt.STROKE,mt(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const n=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let l=!1;if(r){const f=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=s.getPattern(n,this,ei(n),jt.FILL),f){const d=new Path2D;d.addPath(e,n.getTransform().invertSelf().multiplySelf(f)),e=d}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),l&&n.restore(),t&&this.consumePath(e,c)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=N1}eoClip(){this.pendingClip=hv}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const n=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:l,y:c,fontSize:f,path:d}of e)d&&n.addPath(d,new DOMMatrix(r).preMultiplySelf(s).translate(l,c).scale(f,-f));t.clip(n),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||ph,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Pe("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const r=n.loadedName||"sans-serif",l=n.systemFontInfo?.css||`"${r}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const f=n.italic?"italic":"normal";let d=t;t<rv?d=rv:t>av&&(d=av),this.current.fontSizeScale=t/d,this.ctx.font=`${f} ${c} ${d}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,r){const l=this.ctx,c=this.current,f=c.font,d=c.textRenderingMode,g=c.fontSize/c.fontSizeScale,v=d&Kt.FILL_STROKE_MASK,b=!!(d&Kt.ADD_TO_PATH_FLAG),C=c.patternFill&&!f.missingFile,E=c.patternStroke&&!f.missingFile;let A;if((f.disableFontFace||b||C||E)&&!f.missingFile&&(A=f.getPathGenerator(this.commonObjs,e)),A&&(f.disableFontFace||C||E)){l.save(),l.translate(t,n),l.scale(g,-g);let _;if((v===Kt.FILL||v===Kt.FILL_STROKE)&&(s?(_=l.getTransform(),l.setTransform(...s),l.fill(this.#n(A,_,s))):l.fill(A)),v===Kt.STROKE||v===Kt.FILL_STROKE)if(r){_||=l.getTransform(),l.setTransform(...r);const{a:w,b:N,c:M,d:k}=_,R=_e.inverseTransform(r),I=_e.transform([w,N,M,k,0,0],R);_e.singularValueDecompose2dScale(I,_n),l.lineWidth*=Math.max(_n[0],_n[1])/g,l.stroke(this.#n(A,_,r))}else l.lineWidth/=g,l.stroke(A);l.restore()}else(v===Kt.FILL||v===Kt.FILL_STROKE)&&l.fillText(e,t,n),(v===Kt.STROKE||v===Kt.FILL_STROKE)&&l.strokeText(e,t,n);b&&(this.pendingTextPaths||=[]).push({transform:mt(l),x:t,y:n,fontSize:g,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ge(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,l=t.fontSizeScale,c=t.charSpacing,f=t.wordSpacing,d=t.fontDirection,g=t.textHScale*d,v=e.length,b=n.vertical,C=b?1:-1,E=n.defaultVMetrics,A=s*t.fontMatrix[0],_=t.textRenderingMode===Kt.FILL&&!n.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),d>0?r.scale(g,-1):r.scale(g,1);let w,N;if(t.patternFill){r.save();const P=t.fillColor.getPattern(r,this,ei(r),jt.FILL);w=mt(r),r.restore(),r.fillStyle=P}if(t.patternStroke){r.save();const P=t.strokeColor.getPattern(r,this,ei(r),jt.STROKE);N=mt(r),r.restore(),r.strokeStyle=P}let M=t.lineWidth;const k=t.textMatrixScale;if(k===0||M===0){const P=t.textRenderingMode&Kt.FILL_STROKE_MASK;(P===Kt.STROKE||P===Kt.FILL_STROKE)&&(M=this.getSinglePixelWidth())}else M/=k;if(l!==1&&(r.scale(l,l),M/=l),r.lineWidth=M,n.isInvalidPDFjsFont){const P=[];let q=0;for(const F of e)P.push(F.unicode),q+=F.width;r.fillText(P.join(""),0,0),t.x+=q*A*g,r.restore(),this.compose();return}let R=0,I;for(I=0;I<v;++I){const P=e[I];if(typeof P=="number"){R+=C*P*s/1e3;continue}let q=!1;const F=(P.isSpace?f:0)+c,$=P.fontChar,K=P.accent;let ne,ae,ce=P.width;if(b){const U=P.vmetric||E,X=-(P.vmetric?U[1]:ce*.5)*A,de=U[2]*A;ce=U?-U[0]:ce,ne=X/l,ae=(R+de)/l}else ne=R/l,ae=0;if(n.remeasure&&ce>0){const U=r.measureText($).width*1e3/s*l;if(ce<U&&this.isFontSubpixelAAEnabled){const X=ce/U;q=!0,r.save(),r.scale(X,1),ne/=X}else ce!==U&&(ne+=(ce-U)/2e3*s/l)}if(this.contentVisible&&(P.isInFont||n.missingFile)){if(_&&!K)r.fillText($,ne,ae);else if(this.paintChar($,ne,ae,w,N),K){const U=ne+s*K.offset.x/l,X=ae-s*K.offset.y/l;this.paintChar(K.fontChar,U,X,w,N)}}const me=b?ce*A-F*d:ce*A+F*d;R+=me,q&&r.restore()}b?t.y-=R:t.x+=R*g,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,s=n.font,r=n.fontSize,l=n.fontDirection,c=s.vertical?1:-1,f=n.charSpacing,d=n.wordSpacing,g=n.textHScale*l,v=n.fontMatrix||ph,b=e.length,C=n.textRenderingMode===Kt.INVISIBLE;let E,A,_,w;if(!(C||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),n.textMatrix&&t.transform(...n.textMatrix),t.translate(n.x,n.y+n.textRise),t.scale(g,l),E=0;E<b;++E){if(A=e[E],typeof A=="number"){w=c*A*r/1e3,this.ctx.translate(w,0),n.x+=w*g;continue}const N=(A.isSpace?d:0)+f,M=s.charProcOperatorList[A.operatorListId];M?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...v),this.executeOperatorList(M),this.restore()):Pe(`Type3 character "${A.operatorListId}" is not available.`);const k=[A.width,0];_e.applyTransform(k,v),_=k[0]*r+N,t.translate(_,0),n.x+=_*g}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,s,r,l){const c=new Path2D;c.rect(n,s,r-n,l-s),this.ctx.clip(c),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=this.baseTransform||mt(this.ctx),s={createCanvasGraphics:r=>new $o(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new cp(e,this.ctx,s,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=C1(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,ei(t),jt.SHADING);const s=ei(t);if(s){const{width:r,height:l}=t.canvas,c=qo.slice();_e.axialAlignedBoundingBox([0,0,r,l],s,c);const[f,d,g,v]=c;this.ctx.fillRect(f,d,g-f,v-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){nt("Should not call beginInlineImage")}beginImageData(){nt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=mt(this.ctx),t)){_e.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[n,s,r,l]=t,c=new Path2D;c.rect(n,s,r-n,l-s),this.ctx.clip(c),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Vc("TODO: Support non-isolated groups."),e.knockout&&Pe("Knockout groups not supported.");const n=mt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=qo.slice();_e.axialAlignedBoundingBox(e.bbox,mt(t),s);const r=[0,0,t.canvas.width,t.canvas.height];s=_e.intersect(s,r)||[0,0,0,0];const l=Math.floor(s[0]),c=Math.floor(s[1]),f=Math.max(Math.ceil(s[2])-l,1),d=Math.max(Math.ceil(s[3])-c,1);this.current.startNewPathAndClipBox([0,0,f,d]);let g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(g,f,d),b=v.context;b.translate(-l,-c),b.transform(...n);let C=new Path2D;const[E,A,_,w]=e.bbox;if(C.rect(E,A,_-E,w-A),e.matrix){const N=new Path2D;N.addPath(C,new DOMMatrix(e.matrix)),C=N}b.clip(C),e.smask?this.smaskStack.push({canvas:v.canvas,context:b,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.save()),ra(t,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=mt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=qo.slice();_e.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,n,s,r){if(this.#e(),ic(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],c=t[3]-t[1];if(r&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=c,_e.singularValueDecompose2dScale(mt(this.ctx),_n);const{viewportScale:f}=this,d=Math.ceil(l*this.outputScaleX*f),g=Math.ceil(c*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(d,g);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(_n[0],0,0,-_n[1],0,c*_n[1]),ic(this.ctx)}else{ic(this.ctx),this.endPath();const f=new Path2D;f.rect(t[0],t[1],l,c),this.ctx.clip(f)}}this.current=new cv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,s=this._createMaskCanvas(e),r=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,r,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const f=mt(c);c.transform(t,n,s,r,0,0);const d=this._createMaskCanvas(e);c.setTransform(1,0,0,1,d.offsetX-f[4],d.offsetY-f[5]);for(let g=0,v=l.length;g<v;g+=2){const b=_e.transform(f,[t,n,s,r,l[g],l[g+1]]);c.drawImage(d.canvas,b[4],b[5])}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:l,width:c,height:f,transform:d}=r,g=this.cachedCanvases.getCanvas("maskCanvas",c,f),v=g.context;v.save();const b=this.getObject(l,r);dv(v,b),v.globalCompositeOperation="source-in",v.fillStyle=s?n.getPattern(v,this,ei(t),jt.FILL):n,v.fillRect(0,0,c,f),v.restore(),t.save(),t.transform(...d),t.scale(1,-1),nc(t,g.canvas,0,0,c,f,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Pe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){Pe("Dependent image isn't ready yet");return}const l=r.width,c=r.height,f=[];for(let d=0,g=s.length;d<g;d+=2)f.push({transform:[t,0,0,n,s[d],s[d+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(r,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",n,s),l=r.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;this.save();const{filter:r}=s;r!=="none"&&r!==""&&(s.filter="none"),s.scale(1/t,-1/n);let l;if(e.bitmap)l=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)l=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",t,n).context;uv(d,e),l=this.applyTransferMapsToCanvas(d)}const c=this._scaleImage(l,ei(s));s.imageSmoothingEnabled=fv(mt(s),e.interpolate),nc(s,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,l=e.height,f=this.cachedCanvases.getCanvas("inlineImage",r,l).context;uv(f,e),s=this.applyTransferMapsToCanvas(f)}for(const r of t)n.save(),n.transform(...r.transform),n.scale(1,-1),nc(n,s,r.x,r.y,r.w,r.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(n||(this.pendingClip===hv?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=mt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:r}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const f=Math.abs(t),d=Math.abs(r);if(f===d)if(e===0)l=c=1/f;else{const g=f*e;l=c=g<1?1/g:1}else if(e===0)l=1/f,c=1/d;else{const g=f*e,v=d*e;l=g<1?1/g:1,c=v<1?1/v:1}}else{const f=Math.abs(t*r-n*s),d=Math.hypot(t,n),g=Math.hypot(s,r);if(e===0)l=g/f,c=d/f;else{const v=e*f;l=g>v?g/v:1,c=d>v?d/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[r,l]=this.getScaleForStroking();if(r===l){n.lineWidth=(s||1)*r,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(r,l),Df.a=1/r,Df.d=1/l;const f=new Path2D;if(f.addPath(e,Df),c.length>0){const d=Math.max(r,l);n.setLineDash(c.map(g=>g/d)),n.lineDashOffset/=d}n.lineWidth=s||1,n.stroke(f),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const i in _c)$o.prototype[i]!==void 0&&($o.prototype[_c[i]]=$o.prototype[i]);class Bs{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class R1{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Bo=Symbol("INTERNAL");class I1{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:r}){this.#e=!!(e&En.DISPLAY),this.#t=!!(e&En.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=r}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Bo&&nt("Internal method `_setVisible` called."),this.#n=n,this.#i=t}}class D1{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=En.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(const n of e.groups)this.#t.set(n.id,new I1(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(Bo,!1);for(const n of e.on)this.#t.get(n)._setVisible(Bo,!0);for(const n of e.off)this.#t.get(n)._setVisible(Bo,!1);this.#n=this.getHash()}}#o(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const r=e[s];let l;if(Array.isArray(r))l=this.#o(r);else if(this.#t.has(r))l=this.#t.get(r).visible;else return Pe(`Optional content group not found: ${r}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Vc("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Pe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#o(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Pe(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Pe(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Pe(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Pe(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Pe(`Unknown optional content policy ${e.policy}.`),!0}return Pe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){Pe(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const r of s.rbGroups)for(const l of r)l!==e&&this.#t.get(l)?._setVisible(Bo,!1,!0);s._setVisible(Bo,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const r=this.#t.get(s);if(r)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new TS;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class k1{constructor(e,{disableRange:t=!1,disableStream:n=!1}){It(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,r?.length>0){const f=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((f,d)=>{this._onReceiveData({begin:f,chunk:d})}),e.addProgressListener((f,d)=>{this._onProgress({loaded:f,total:d})}),e.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(n),!0)});It(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){It(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new L1(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new P1(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class L1{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=ip(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class P1{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function F1(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let g=c(t);return g=unescape(g),g=f(g),g=d(g),r(g)}if(t=l(i),t){const g=d(t);return r(g)}if(t=n("filename","i").exec(i),t){t=t[1];let g=c(t);return g=d(g),r(g)}function n(g,v){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function s(g,v){if(g){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const b=new TextDecoder(g,{fatal:!0}),C=Ra(v);v=b.decode(C),e=!1}catch{}}return v}function r(g){return e&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),e&&(g=s("iso-8859-1",g))),g}function l(g){const v=[];let b;const C=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=C.exec(g))!==null;){let[,A,_,w]=b;if(A=parseInt(A,10),A in v){if(A===0)break;continue}v[A]=[_,w]}const E=[];for(let A=0;A<v.length&&A in v;++A){let[_,w]=v[A];w=c(w),_&&(w=unescape(w),A===0&&(w=f(w))),E.push(w)}return E.join("")}function c(g){if(g.startsWith('"')){const v=g.slice(1).split('\\"');for(let b=0;b<v.length;++b){const C=v[b].indexOf('"');C!==-1&&(v[b]=v[b].slice(0,C),v.length=b+1),v[b]=v[b].replaceAll(/\\(.)/g,"$1")}g=v.join('"')}return g}function f(g){const v=g.indexOf("'");if(v===-1)return g;const b=g.slice(0,v),E=g.slice(v+1).replace(/^[^']*'/,"");return s(b,E)}function d(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,b,C,E){if(C==="q"||C==="Q")return E=E.replaceAll("_"," "),E=E.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,_){return String.fromCharCode(parseInt(_,16))}),s(b,E);try{E=atob(E)}catch{}return s(b,E)})}return""}function kS(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function jc(i){return URL.parse(i)?.origin??null}function LS({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function PS(i){const e=i.get("Content-Disposition");if(e){let t=F1(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(ip(t))return t}return null}function La(i,e){return new Tc(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function FS(i){return i===200||i===206}function OS(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function US(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Pe(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class O1{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=kS(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return It(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new U1(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new B1(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class U1{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,OS(n,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=jc(r.url),!FS(r.status))throw La(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const l=r.headers,{allowRangeRequests:c,suggestedLength:f}=LS({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=f||this._contentLength,this._filename=PS(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new fs("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:US(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class B1{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,OS(r,this._withCredentials,this._abortController)).then(c=>{const f=jc(c.url);if(f!==e._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${e._responseOrigin}".`);if(!FS(c.status))throw La(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:US(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const kf=200,Lf=206;function V1(i){const e=i.response;return typeof e!="string"?e:Ra(e).buffer}class G1{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=kS(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,l]of this.headers)t.setRequestHeader(r,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Lf):s.expectedStatus=kf,t.responseType="arraybuffer",It(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const r=s.status||kf;if(!(r===kf&&n.expectedStatus===Lf)&&r!==n.expectedStatus){n.onError(s.status);return}const c=V1(s);if(r===Lf){const f=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);d?n.onDone({begin:parseInt(d[1],10),chunk:c}):(Pe('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class q1{constructor(e){this._source=e,this._manager=new G1(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return It(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new H1(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new j1(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class H1{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=jc(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[f,...d]=c.split(": ");return[f,d.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:l}=LS({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=PS(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=La(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j1{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=jc(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=La(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const z1=/^[a-z][a-z0-9\-+.]+:/i;function $1(i){if(z1.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class Y1{constructor(e){this.source=e,this.url=$1(e.url),It(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return It(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new W1(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new K1(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class W1{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=La(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new fs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class K1{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const aa=Symbol("INITIAL_DATA");class BS{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:aa}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===aa)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==aa}delete(e){const t=this.#e[e];return!t||t.data===aa?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==aa&&(yield[e,t])}}}const X1=1e5,pv=30;class en{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#o=null;#s=null;#r=0;#a=0;#u=null;#c=null;#f=0;#l=0;#p=Object.create(null);#g=[];#h=null;#d=[];#m=new WeakMap;#x=null;static#y=new Map;static#S=new Map;static#C=new WeakMap;static#v=null;static#E=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#h=e;else if(typeof e=="object")this.#h=new ReadableStream({start(f){f.enqueue(e),f.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#l=n.scale*ai.pixelRatio,this.#f=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:r,pageX:l,pageY:c}=n.rawDims;this.#x=[1,0,0,-1,-l,c+r],this.#a=s,this.#r=r,en.#T(),Vs(t,n),this.#e.promise.finally(()=>{en.#E.delete(this),this.#s=null,this.#p=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=zt.platform;return Ge(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#o??=t.lang,Object.assign(this.#p,t.styles),this.#N(t.items),e()},this.#e.reject)};return this.#u=this.#h.getReader(),en.#E.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*ai.pixelRatio,s=e.rotation;if(s!==this.#f&&(t?.(),this.#f=s,Vs(this.#c,{rotation:s})),n!==this.#l){t?.(),this.#l=n;const r={div:null,properties:null,ctx:en.#M(this.#o)};for(const l of this.#d)r.properties=this.#m.get(l),r.div=l,this.#R(r)}}cancel(){const e=new fs("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#d}get textContentItemsStr(){return this.#g}#N(e){if(this.#n)return;this.#s.ctx??=en.#M(this.#o);const t=this.#d,n=this.#g;for(const s of e){if(t.length>X1){Pe("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const r=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),r.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#A(s)}}#A(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#d.push(t);const s=_e.transform(this.#x,e.transform);let r=Math.atan2(s[1],s[0]);const l=this.#p[e.fontName];l.vertical&&(r+=Math.PI/2);let c=this.#i&&l.fontSubstitution||l.fontFamily;c=en.fontFamilyMap.get(c)||c;const f=Math.hypot(s[2],s[3]),d=f*en.#D(c,l,this.#o);let g,v;r===0?(g=s[4],v=s[5]-d):(g=s[4]+d*Math.sin(r),v=s[5]-d*Math.cos(r));const b="calc(var(--total-scale-factor) *",C=t.style;this.#t===this.#c?(C.left=`${(100*g/this.#a).toFixed(2)}%`,C.top=`${(100*v/this.#r).toFixed(2)}%`):(C.left=`${b}${g.toFixed(2)}px)`,C.top=`${b}${v.toFixed(2)}px)`),C.fontSize=`${b}${(en.#v*f).toFixed(2)}px)`,C.fontFamily=c,n.fontSize=f,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),r!==0&&(n.angle=r*(180/Math.PI));let E=!1;if(e.str.length>1)E=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);A!==_&&Math.max(A,_)/Math.min(A,_)>1.5&&(E=!0)}if(E&&(n.canvasWidth=l.vertical?e.height:e.width),this.#m.set(t,n),this.#s.div=t,this.#s.properties=n,this.#R(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this.#t.append(A)}}#R(e){const{div:t,properties:n,ctx:s}=e,{style:r}=t;let l="";if(en.#v>1&&(l=`scale(${1/en.#v})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=r,{canvasWidth:f,fontSize:d}=n;en.#w(s,d*this.#l,c);const{width:g}=s.measureText(t.textContent);g>0&&(l=`scaleX(${f*this.#l/g}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(r.transform=l)}static cleanup(){if(!(this.#E.size>0)){this.#y.clear();for(const{canvas:e}of this.#S.values())e.remove();this.#S.clear()}}static#M(e=null){let t=this.#S.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#S.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#w(e,t,n){const s=this.#C.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#T(){if(this.#v!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#v=e.getBoundingClientRect().height,e.remove()}static#D(e,t,n){const s=this.#y.get(e);if(s)return s;const r=this.#M(n);r.canvas.width=r.canvas.height=pv,this.#w(r,pv,e);const l=r.measureText(""),c=l.fontBoundingBoxAscent,f=Math.abs(l.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let d=.8;return c?d=c/(c+f):(zt.platform.isFirefox&&Pe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#y.set(e,d),d}}class ba{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(r){if(!r)return;let l=null;const c=r.name;if(c==="#text")l=r.value;else if(ba.shouldBuildText(c))r?.attributes?.textContent?l=r.attributes.textContent:r.value&&(l=r.value);else return;if(l!==null&&t.push({str:l}),!!r.children)for(const f of r.children)s(f)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const J1=100;function Sh(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new up,{docId:t}=e,n=i.url?r1(i.url):null,s=i.data?a1(i.data):null,r=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,f=i.range instanceof VS?i.range:null,d=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let g=i.worker instanceof Sa?i.worker:null;const v=i.verbosity,b=typeof i.docBaseUrl=="string"&&!Gc(i.docBaseUrl)?i.docBaseUrl:null,C=ec(i.cMapUrl),E=i.cMapPacked!==!1,A=i.CMapReaderFactory||(nn?m1:nv),_=ec(i.iccUrl),w=ec(i.standardFontDataUrl),N=i.StandardFontDataFactory||(nn?g1:iv),M=ec(i.wasmUrl),k=i.WasmFactory||(nn?y1:sv),R=i.stopAtErrors!==!0,I=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,P=i.isEvalSupported!==!1,q=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!nn,F=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!nn&&(zt.platform.isFirefox||!globalThis.chrome),$=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,K=typeof i.disableFontFace=="boolean"?i.disableFontFace:nn,ne=i.fontExtraProperties===!0,ae=i.enableXfa===!0,ce=i.ownerDocument||globalThis.document,me=i.disableRange===!0,U=i.disableStream===!0,X=i.disableAutoFetch===!0,de=i.pdfBug===!0,te=i.CanvasFactory||(nn?p1:d1),L=i.FilterFactory||(nn?h1:f1),V=i.enableHWA===!0,W=i.useWasm!==!1,z=f?f.length:i.length??NaN,le=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!nn&&!K,xe=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(A===nv&&N===iv&&k===sv&&C&&w&&M&&ha(C,document.baseURI)&&ha(w,document.baseURI)&&ha(M,document.baseURI)),he=null;Uw(v);const Ee={canvasFactory:new te({ownerDocument:ce,enableHWA:V}),filterFactory:new L({docId:t,ownerDocument:ce}),cMapReaderFactory:xe?null:new A({baseUrl:C,isCompressed:E}),standardFontDataFactory:xe?null:new N({baseUrl:w}),wasmFactory:xe?null:new k({baseUrl:M})};g||(g=Sa.create({verbosity:v,port:Bs.workerPort}),e._worker=g);const Ne={docId:t,apiVersion:"5.4.54",data:s,password:c,disableAutoFetch:X,rangeChunkSize:d,length:z,docBaseUrl:b,enableXfa:ae,evaluatorOptions:{maxImageSize:I,disableFontFace:K,ignoreErrors:R,isEvalSupported:P,isOffscreenCanvasSupported:q,isImageDecoderSupported:F,canvasMaxAreaInBytes:$,fontExtraProperties:ne,useSystemFonts:le,useWasm:W,useWorkerFetch:xe,cMapUrl:C,iccUrl:_,standardFontDataUrl:w,wasmUrl:M}},Te={ownerDocument:ce,pdfBug:de,styleElement:he,loadingParams:{disableAutoFetch:X,enableXfa:ae}};return g.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ke=g.messageHandler.sendWithPromise("GetDocRequest",Ne,s?[s.buffer]:null);let $e;if(f)$e=new k1(f,{disableRange:me,disableStream:U});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ht=ha(n)?O1:nn?Y1:q1;$e=new ht({url:n,length:z,httpHeaders:r,withCredentials:l,rangeChunkSize:d,disableRange:me,disableStream:U})}return ke.then(ht=>{if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const xt=new pa(t,ht,g.port),Dt=new eM(xt,e,$e,Te,Ee,V);e._transport=Dt,xt.send("Ready",null)})}).catch(e._capability.reject),e}class up{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${up.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class VS{#e=Promise.withResolvers();#t=[];#n=[];#i=[];#o=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#o.push(e)}addProgressListener(e){this.#i.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#o)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#i)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){nt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Q1{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ge(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Z1{#e=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new Z0:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new BS,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:r=!1}={}){return new Da({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ge(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:r=ls.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:f=null,annotationCanvasMap:d=null,pageColors:g=null,printAnnotationStorage:v=null,isEditing:b=!1}){this._stats?.time("Overall");const C=this._transport.getRenderingIntent(s,r,v,b),{renderingIntent:E,cacheKey:A}=C;this.#e=!1,f||=this._transport.getOptionalContentConfig(E);let _=this._intentStates.get(A);_||(_=Object.create(null),this._intentStates.set(A,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const w=!!(E&En.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(C));const N=R=>{_.renderTasks.delete(M),w&&(this.#e=!0),this.#t(),R?(M.capability.reject(R),this._abortOperatorList({intentState:_,reason:R instanceof Error?R:new Error(R)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new Ho({callback:N,params:{canvas:t,canvasContext:e,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA});(_.renderTasks||=new Set).add(M);const k=M.task;return Promise.all([_.displayReadyCapability.promise,f]).then(([R,I])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(I.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:R,optionalContentConfig:I}),M.operatorListChanged()}).catch(N),k}getOperatorList({intent:e="display",annotationMode:t=ls.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(f))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let f;return c.opListReadCapability||(f=Object.create(null),f.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(f),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ba.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function r(){l.read().then(function({value:f,done:d}){if(d){n(c);return}c.lang??=f.lang,Object.assign(c.styles,f.styles),c.items.push(...f.items),r()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Z0),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:r,transfer:l}=n,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},l).getReader(),d=this._intentStates.get(t);d.streamReader=f;const g=()=>{f.read().then(({value:v,done:b})=>{if(b){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,d),g())},v=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const b of d.renderTasks)b.operatorListChanged();this.#t()}if(d.displayReadyCapability)d.displayReadyCapability.reject(v);else if(d.opListReadCapability)d.opListReadCapability.reject(v);else throw v}})};g()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof np){let s=J1;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new fs(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var cs,Hn,Mi,Fs,Dc,Os,Us,rn,pc,GS,qS,ma,Xo,mc;const ut=class ut{constructor({name:e=null,port:t=null,verbosity:n=Bw()}={}){Qn(this,rn);Qn(this,cs,Promise.withResolvers());Qn(this,Hn,null);Qn(this,Mi,null);Qn(this,Fs,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(ct(ut,Us).has(t))throw new Error("Cannot use more than one PDFWorker per port.");ct(ut,Us).set(t,this),Zn(this,rn,GS).call(this,t)}else Zn(this,rn,qS).call(this)}get promise(){return ct(this,cs).promise}get port(){return ct(this,Mi)}get messageHandler(){return ct(this,Hn)}destroy(){this.destroyed=!0,ct(this,Fs)?.terminate(),hn(this,Fs,null),ct(ut,Us).delete(ct(this,Mi)),hn(this,Mi,null),ct(this,Hn)?.destroy(),hn(this,Hn,null)}static create(e){const t=ct(this,Us).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ut(e)}static get workerSrc(){if(Bs.workerSrc)return Bs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ge(this,"_setupFakeWorkerGlobal",(async()=>ct(this,Xo,mc)?ct(this,Xo,mc):(await import(this.workerSrc)).WorkerMessageHandler)())}};cs=new WeakMap,Hn=new WeakMap,Mi=new WeakMap,Fs=new WeakMap,Dc=new WeakMap,Os=new WeakMap,Us=new WeakMap,rn=new WeakSet,pc=function(){ct(this,cs).resolve(),ct(this,Hn).send("configure",{verbosity:this.verbosity})},GS=function(e){hn(this,Mi,e),hn(this,Hn,new pa("main","worker",e)),ct(this,Hn).on("ready",()=>{}),Zn(this,rn,pc).call(this)},qS=function(){if(ct(ut,Os)||ct(ut,Xo,mc)){Zn(this,rn,ma).call(this);return}let{workerSrc:e}=ut;try{ut._isSameOrigin(window.location,e)||(e=ut._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new pa("main","worker",t),s=()=>{r.abort(),n.destroy(),t.terminate(),this.destroyed?ct(this,cs).reject(new Error("Worker was destroyed")):Zn(this,rn,ma).call(this)},r=new AbortController;t.addEventListener("error",()=>{ct(this,Fs)||s()},{signal:r.signal}),n.on("test",c=>{if(r.abort(),this.destroyed||!c){s();return}hn(this,Hn,n),hn(this,Mi,t),hn(this,Fs,t),Zn(this,rn,pc).call(this)}),n.on("ready",c=>{if(r.abort(),this.destroyed){s();return}try{l()}catch{Zn(this,rn,ma).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{Vc("The worker has been disabled.")}Zn(this,rn,ma).call(this)},ma=function(){ct(ut,Os)||(Pe("Setting up fake worker."),hn(ut,Os,!0)),ut._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){ct(this,cs).reject(new Error("Worker was destroyed"));return}const t=new u1;hn(this,Mi,t);const n=`fake${b0(ut,Dc)._++}`,s=new pa(n+"_worker",n,t);e.setup(s,t),hn(this,Hn,new pa(n,n+"_worker",t)),Zn(this,rn,pc).call(this)}).catch(e=>{ct(this,cs).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Xo=new WeakSet,mc=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Qn(ut,Xo),Qn(ut,Dc,0),Qn(ut,Os,!1),Qn(ut,Us,new WeakMap),nn&&(hn(ut,Os,!0),Bs.workerSrc||="./pdf.worker.mjs"),ut._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},ut._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},ut.fromPort=e=>{if(Jw("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return ut.create(e)};let Sa=ut;class eM{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#o=null;constructor(e,t,n,s,r,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new BS,this.fontLoader=new s1({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return Ge(this,"annotationStorage",new rp)}getRenderingIntent(e,t=ls.ENABLE,n=null,s=!1,r=!1){let l=En.DISPLAY,c=vh;switch(e){case"any":l=En.ANY;break;case"display":break;case"print":l=En.PRINT;break;default:Pe(`getRenderingIntent - invalid intent: ${e}`)}const f=l&En.PRINT&&n instanceof wS?n:this.annotationStorage;switch(t){case ls.DISABLE:l+=En.ANNOTATIONS_DISABLE;break;case ls.ENABLE:break;case ls.ENABLE_FORMS:l+=En.ANNOTATIONS_FORMS;break;case ls.ENABLE_STORAGE:l+=En.ANNOTATIONS_STORAGE,c=f.serializable;break;default:Pe(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=En.IS_EDITING),r&&(l+=En.OPLIST);const{ids:d,hash:g}=f.modifiedIds,v=[l,c.hash,g];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#o?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),en.cleanup(),this._networkStream?.cancelAllRequests(new fs("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{It(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:l}){if(l){s.close();return}It(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:l}=this._fullReader;return(!s||!r)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{It(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(n.begin,n.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:l,done:c}){if(c){s.close();return}It(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{r.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Q1(n,this))}),e.on("DocException",n=>{t._capability.reject(pn(n))}),e.on("PasswordRequest",n=>{this.#o=Promise.withResolvers();try{if(!t.onPassword)throw pn(n);const s=r=>{r instanceof Error?this.#o.reject(r):this.#o.resolve({password:r})};t.onPassword(s,n.code)}catch(s){this.#o.reject(s)}return this.#o.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,r])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in r){const d=r.error;Pe(`Error during font loading: ${d}`),this.commonObjs.resolve(n,d);break}const l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(d,g)=>globalThis.FontInspector.fontAdded(d,g):null,c=new o1(r,l);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:f}=r;It(f,"The imageRef must be defined.");for(const d of this.#t.values())for(const[,g]of d.objs)if(g?.ref===f)return g.dataLen?(this.commonObjs.resolve(n,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,r,l])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(r){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Pe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,e);const l=new Z1(t,r,this,this._params.pdfBug);return this.#t.set(t,l),l});return this.#n.set(t,s),s}getPageIndex(e){return xh(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new D1(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new R1(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),en.cleanup()}}cachedPageNumber(e){if(!xh(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}}class tM{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Ho{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:r,operatorList:l,pageIndex:c,canvasFactory:f,filterFactory:d,useRequestAnimationFrame:g=!1,pdfBug:v=!1,pageColors:b=null,enableHWA:C=!1}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=f,this.filterFactory=d,this._pdfBug=v,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new tM(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=C}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Ho.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ho.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:r}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new $o(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Ho.#t.delete(this._canvas),e||=new np(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ho.#t.delete(this._canvas),this.callback())))}}const nM="5.4.54",iM="295fb3ec4";class Fn{#e=null;#t=null;#n;#i=null;#o=!1;#s=!1;#r=null;#a;#u=null;#c=null;static#f=null;static get _keyboardManager(){return Ge(this,"_keyboardManager",new ka([[["Escape","mac+Escape"],Fn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Fn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Fn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Fn.prototype._moveToPrevious],[["Home","mac+Home"],Fn.prototype._moveToBeginning],[["End","mac+End"],Fn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#r=e):this.#s=!0,this.#c=e?._uiManager||t,this.#a=this.#c._eventBus,this.#n=e?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Fn.#f||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#r&&(e.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const t=this.#c._signal;e.addEventListener("click",this.#h.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){const e=this.#i=this.#l();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#l(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",Bn,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(e.id=`${this.#r.id}_colorpicker_dropdown`);for(const[n,s]of this.#c.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=n,r.setAttribute("data-l10n-id",Fn.#f[n]);const l=document.createElement("span");r.append(l),l.className="swatch",l.style.backgroundColor=s,r.ariaSelected=s===this.#n,r.addEventListener("click",this.#p.bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:ze.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#h(e);return}const t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#m){this.#h(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#h(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#m){this.#h(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#m){this.#h(e);return}this.#i.lastChild?.focus()}#g(e){Fn._keyboardManager.exec(this,e)}#h(e){if(this.#m){this.hideDropdown();return}if(this.#o=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#d.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#e.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const t=this.#i=this.#l();this.#e.append(t)}#d(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#u?.abort(),this.#u=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#m){this.#r?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#o})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;const t=this.#c.highlightColors.values();for(const n of this.#i.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}}class Ca{#e=null;#t=null;#n=null;static#i=null;constructor(e){this.#t=e,this.#n=e._uiManager,Ca.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,colorValue:n}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Ca.#i[e]),s.addEventListener("input",()=>{this.#n.updateParams(t,s.value)},{signal:this.#n._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function mv(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function la(i){return Math.max(0,Math.min(255,255*i))}class gv{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=la(e),[e,e,e]}static G_HTML([e]){const t=mv(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(la)}static RGB_HTML(e){return`#${e.map(mv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[la(1-Math.min(1,e+s)),la(1-Math.min(1,n+s)),la(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,r=1-t,l=1-n,c=Math.min(s,r,l);return["CMYK",s,r,l,c]}}class sM{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){nt("Abstract method `_createSVG` called.")}}class wc extends sM{_createSVG(e){return document.createElementNS(Ti,e)}}class HS{static setupStorage(e,t,n,s,r){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),r==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),r==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const f=c.target.options,d=f.selectedIndex===-1?"":f[f.selectedIndex].value;s.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:r}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[f,d]of Object.entries(l))if(d!=null)switch(f){case"class":d.length&&e.setAttribute(f,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!c||f!=="href"&&f!=="newWindow")&&e.setAttribute(f,d)}c&&r.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,r=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:r,linkService:n});const c=r!=="richText",f=e.div;if(f.append(l),e.viewport){const v=`matrix(${e.viewport.transform.join(",")})`;f.style.transform=v}c&&f.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const v=document.createTextNode(s.value);l.append(v),c&&ba.shouldBuildText(s.name)&&d.push(v)}return{textDivs:d}}const g=[[s,-1,l]];for(;g.length>0;){const[v,b,C]=g.at(-1);if(b+1===v.children.length){g.pop();continue}const E=v.children[++g.at(-1)[1]];if(E===null)continue;const{name:A}=E;if(A==="#text"){const w=document.createTextNode(E.value);d.push(w),C.append(w);continue}const _=E?.attributes?.xmlns?document.createElementNS(E.attributes.xmlns,A):document.createElement(A);if(C.append(_),E.attributes&&this.setAttributes({html:_,element:E,storage:t,intent:r,linkService:n}),E.children?.length>0)g.push([E,-1,_]);else if(E.value){const w=document.createTextNode(E.value);c&&ba.shouldBuildText(A)&&d.push(w),_.append(w)}}for(const v of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const oM=9,Gs=new WeakSet,rM=new Date().getTimezoneOffset()*60*1e3;class yv{static create(e){switch(e.data.annotationType){case Nt.LINK:return new dp(e);case Nt.TEXT:return new aM(e);case Nt.WIDGET:switch(e.data.fieldType){case"Tx":return new lM(e);case"Btn":return e.data.radioButton?new jS(e):e.data.checkBox?new uM(e):new dM(e);case"Ch":return new fM(e);case"Sig":return new cM(e)}return new $s(e);case Nt.POPUP:return new Ch(e);case Nt.FREETEXT:return new zS(e);case Nt.LINE:return new pM(e);case Nt.SQUARE:return new mM(e);case Nt.CIRCLE:return new gM(e);case Nt.POLYLINE:return new $S(e);case Nt.CARET:return new vM(e);case Nt.INK:return new fp(e);case Nt.POLYGON:return new yM(e);case Nt.HIGHLIGHT:return new YS(e);case Nt.UNDERLINE:return new xM(e);case Nt.SQUIGGLY:return new bM(e);case Nt.STRIKEOUT:return new SM(e);case Nt.STAMP:return new WS(e);case Nt.FILEATTACHMENT:return new CM(e);default:return new _t(e)}}}class _t{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return _t._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#i(t);let s=this.#n?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#n.popup),s&&(s.updateEdited(e),n?.deleted&&(s.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:f}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/r}%`,t.top=`${100*(l-e[3]+f)/l}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof $s)&&!(this instanceof dp)&&(r.tabIndex=0);const{style:l}=r;if(l.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Ch){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,r),r}const{width:c,height:f}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(A>0||_>0){const N=`calc(${A}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;l.borderRadius=N}else if(this instanceof jS){const N=`calc(${c}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;l.borderRadius=N}switch(t.borderStyle.style){case Uo.SOLID:l.borderStyle="solid";break;case Uo.DASHED:l.borderStyle="dashed";break;case Uo.BEVELED:Pe("Unimplemented border style: beveled");break;case Uo.INSET:Pe("Unimplemented border style: inset");break;case Uo.UNDERLINE:l.borderBottomStyle="solid";break}const w=t.borderColor||null;w?(this.#t=!0,l.borderColor=_e.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):l.borderWidth=0}const d=_e.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:v,pageX:b,pageY:C}=s.rawDims;l.left=`${100*(d[0]-b)/g}%`,l.top=`${100*(d[1]-C)/v}%`;const{rotation:E}=t;return t.hasOwnCanvas||E===0?(l.width=`${100*c/g}%`,l.height=`${100*f/v}%`):this.setRotation(E,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:l}=this;e%180!==0&&([r,l]=[l,r]),t.style.width=`${100*r/n}%`,t.style.height=`${100*l/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const r=s.detail[t],l=r[0],c=r.slice(1);s.target.style[n]=gv[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:gv[`${l}_rgb`](c)})};return Ge(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,r]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:r},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,r]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,_,w,N]=e.subarray(2,6);if(s===A&&r===_&&t===w&&n===N)return}const{style:l}=this.container;let c;if(this.#t){const{borderColor:A,borderWidth:_}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const f=s-t,d=r-n,{svgFactory:g}=this,v=g.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0),v.role="none";const b=g.createElement("defs");v.append(b);const C=g.createElement("clipPath"),E=`clippath_${this.data.id}`;C.setAttribute("id",E),C.setAttribute("clipPathUnits","objectBoundingBox"),b.append(C);for(let A=2,_=e.length;A<_;A+=8){const w=e[A],N=e[A+1],M=e[A+2],k=e[A+3],R=g.createElement("rect"),I=(M-t)/f,P=(r-N)/d,q=(w-M)/f,F=(N-k)/d;R.setAttribute("x",I),R.setAttribute("y",P),R.setAttribute("width",q),R.setAttribute("height",F),C.append(R),c?.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${P}" width="${q}" height="${F}"/>`)}this.#t&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(v),this.container.style.clipPath=`url(#${E})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate);const r=this.#n=new Ch({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(r.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}render(){nt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:l,exportValues:c}of s){if(r===-1||l===t)continue;const f=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!Gs.has(d)){Pe(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:f,domElement:d})}return n}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,l=s.getAttribute("data-element-id");l!==t&&Gs.has(s)&&n.push({id:l,exportValue:r,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class dp extends _t{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#n(n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#n(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const r=n.get(s);r&&(e[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Pe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:r,include:l}=t,c=[];if(s.length!==0||r.length!==0){const g=new Set(r);for(const v of s){const b=this._fieldObjects[v]||[];for(const{id:C}of b)g.add(C)}for(const v of Object.values(this._fieldObjects))for(const b of v)g.has(b.id)===l&&c.push(b)}else for(const g of Object.values(this._fieldObjects))c.push(...g);const f=this.annotationStorage,d=[];for(const g of c){const{id:v}=g;switch(d.push(v),g.type){case"text":{const C=g.defaultValue||"";f.setValue(v,{value:C});break}case"checkbox":case"radiobutton":{const C=g.defaultValue===g.exportValues;f.setValue(v,{value:C});break}case"combobox":case"listbox":{const C=g.defaultValue||"";f.setValue(v,{value:C});break}default:continue}const b=document.querySelector(`[data-element-id="${v}"]`);if(b){if(!Gs.has(b)){Pe(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class aM extends _t{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class $s extends _t{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return zt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,r){n.includes("mouse")?e.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(l)}})})}_setEventListeners(e,t,n,s){for(const[r,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,r,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":_e.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||oM,r=e.style;let l;const c=2,f=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(d/(wf*s))||1,v=d/g;l=Math.min(s,f(v/wf))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,f(d/wf))}r.fontSize=`calc(${l}px * var(--total-scale-factor))`,r.color=_e.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class lM extends $s{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const r=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),r.setValue(l.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let r=s.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&r.length>l&&(r=r.slice(0,l));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const f={userValue:r,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??r,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??r),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Gs.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:g,timeStep:v}=this.data,b=!!g&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",E=>{e.setValue(t,{value:E.target.value}),this.setPropertyOnSiblings(n,"value",E.target.value,"value"),f.formattedValue=null}),n.addEventListener("resetform",E=>{const A=this.data.defaultFieldValue??"";n.value=f.userValue=A,f.formattedValue=null});let C=E=>{const{formattedValue:A}=f;A!=null&&(E.target.value=A),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",A=>{if(f.focused)return;const{target:_}=A;if(b&&(_.type=g,v&&(_.step=v)),f.userValue){const w=f.userValue;if(b)if(g==="time"){const N=new Date(w),M=[N.getHours(),N.getMinutes(),N.getSeconds()];_.value=M.map(k=>k.toString().padStart(2,"0")).join(":")}else _.value=new Date(w-rM).toISOString().split(g==="date"?"T":".",1)[0];else _.value=w}f.lastCommittedValue=_.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),n.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const _={value(w){f.userValue=w.detail.value??"",b||e.setValue(t,{value:f.userValue.toString()}),w.target.value=f.userValue},formattedValue(w){const{formattedValue:N}=w.detail;f.formattedValue=N,N!=null&&w.target!==document.activeElement&&(w.target.value=N);const M={formattedValue:N};b&&(M.value=N),e.setValue(t,M)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:N}=w.detail,{target:M}=w;if(N===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",N);let k=f.userValue;!k||k.length<=N||(k=k.slice(0,N),M.value=f.userValue=k,e.setValue(t,{value:k}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(_,A)}),n.addEventListener("keydown",A=>{f.commitKey=1;let _=-1;if(A.key==="Escape"?_=0:A.key==="Enter"&&!this.data.multiLine?_=2:A.key==="Tab"&&(f.commitKey=3),_===-1)return;const{value:w}=A.target;f.lastCommittedValue!==w&&(f.lastCommittedValue=w,f.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:_,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const E=C;C=null,n.addEventListener("blur",A=>{if(!f.focused||!A.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{target:_}=A;let{value:w}=_;if(b){if(w&&g==="time"){const N=w.split(":").map(M=>parseInt(M,10));w=new Date(2e3,0,1,N[0],N[1],N[2]||0).valueOf(),_.step=""}else w=new Date(w).valueOf();_.type="text"}f.userValue=w,f.lastCommittedValue!==w&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:f.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}),E(A)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",A=>{f.lastCommittedValue=null;const{data:_,target:w}=A,{value:N,selectionStart:M,selectionEnd:k}=w;let R=M,I=k;switch(A.inputType){case"deleteWordBackward":{const P=N.substring(0,M).match(/\w*[^\w]*$/);P&&(R-=P[0].length);break}case"deleteWordForward":{const P=N.substring(M).match(/^[^\w]*\w*/);P&&(I+=P[0].length);break}case"deleteContentBackward":M===k&&(R-=1);break;case"deleteContentForward":M===k&&(I+=1);break}A.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,change:_||"",willCommit:!1,selStart:R,selEnd:I}})}),this._setEventListeners(n,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(C&&n.addEventListener("blur",C),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${A}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class cM extends $s{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class uM extends $s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Gs.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",l=>{const{name:c,checked:f}=l.target;for(const d of this._getElementsByName(c,n)){const g=f&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=g),e.setValue(d.id,{value:g})}e.setValue(n,{value:f})}),r.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",l=>{const c={value(f){f.target.checked=f.detail.value!=="Off",e.setValue(n,{value:f.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class jS extends $s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const r=document.createElement("input");if(Gs.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",l=>{const{name:c,checked:f}=l.target;for(const d of this._getElementsByName(c,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:f})}),r.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;r.addEventListener("updatefromsandbox",c=>{const f={value:d=>{const g=l===d.detail.value;for(const v of this._getElementsByName(d.target.name)){const b=g&&v.id===n;v.domElement&&(v.domElement.checked=b),e.setValue(v.id,{value:b})}}};this._dispatchEventFromSandbox(f,c)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class dM extends dp{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class fM extends $s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Gs.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const v=this.data.defaultFieldValue;for(const b of s.options)b.selected=b.value===v});for(const g of this.data.options){const v=document.createElement("option");v.textContent=g.displayValue,v.value=g.exportValue,n.value.includes(g.exportValue)&&(v.setAttribute("selected",!0),r=!1),s.append(v)}let l=null;if(r){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),l=()=>{g.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=g=>{const v=g?"value":"textContent",{options:b,multiple:C}=s;return C?Array.prototype.filter.call(b,E=>E.selected).map(E=>E[v]):b.selectedIndex===-1?null:b[b.selectedIndex][v]};let f=c(!1);const d=g=>{const v=g.target.options;return Array.prototype.map.call(v,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const v={value(b){l?.();const C=b.detail.value,E=new Set(Array.isArray(C)?C:[C]);for(const A of s.options)A.selected=E.has(A.value);e.setValue(t,{value:c(!0)}),f=c(!1)},multipleSelection(b){s.multiple=!0},remove(b){const C=s.options,E=b.detail.remove;C[E].selected=!1,s.remove(E),C.length>0&&Array.prototype.findIndex.call(C,_=>_.selected)===-1&&(C[0].selected=!0),e.setValue(t,{value:c(!0),items:d(b)}),f=c(!1)},clear(b){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),f=c(!1)},insert(b){const{index:C,displayValue:E,exportValue:A}=b.detail.insert,_=s.children[C],w=document.createElement("option");w.textContent=E,w.value=A,_?_.before(w):s.append(w),e.setValue(t,{value:c(!0),items:d(b)}),f=c(!1)},items(b){const{items:C}=b.detail;for(;s.length!==0;)s.remove(0);for(const E of C){const{displayValue:A,exportValue:_}=E,w=document.createElement("option");w.textContent=A,w.value=_,s.append(w)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:d(b)}),f=c(!1)},indices(b){const C=new Set(b.detail.indices);for(const E of b.target.options)E.selected=C.has(E.index);e.setValue(t,{value:c(!0)}),f=c(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(v,g)}),s.addEventListener("input",g=>{const v=c(!0),b=c(!1);e.setValue(t,{value:v}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,change:b,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Ch extends _t{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:_t._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new hM({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${tp}${s}`).join(",")),this.container}}class hM{#e=this.#R.bind(this);#t=this.#D.bind(this);#n=this.#T.bind(this);#i=this.#w.bind(this);#o=null;#s=null;#r=null;#a=null;#u=null;#c=null;#f=null;#l=!1;#p=null;#g=null;#h=null;#d=null;#m=null;#x=null;#y=null;#S=!1;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:r,contentsObj:l,richText:c,parent:f,rect:d,parentRect:g,open:v}){this.#s=e,this.#x=s,this.#r=l,this.#m=c,this.#c=f,this.#o=t,this.#d=d,this.#f=g,this.#u=n,this.#a=gh.toDateObject(r),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),this.#C(),this.#s.hidden=!0,v&&this.#w()}#C(){if(this.#g)return;this.#g=new AbortController;const{signal:e}=this.#g;for(const t of this.trigger)t.addEventListener("click",this.#i,{signal:e}),t.addEventListener("mouseenter",this.#n,{signal:e}),t.addEventListener("mouseleave",this.#t,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#u)t.container?.addEventListener("keydown",this.#e,{signal:e})}render(){if(this.#p)return;const e=this.#p=document.createElement("div");if(e.className="popup",this.#o){const s=e.style.outlineColor=_e.makeHexColor(...this.#o);e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(e.append(t),this.#a){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#a.valueOf()})),s.dateTime=this.#a.toISOString(),t.append(s)}const n=this.#v;if(n)HS.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#r);e.append(s)}this.#s.append(e)}get#v(){const e=this.#m,t=this.#r;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#E(){return this.#v?.attributes?.style?.fontSize||0}get#N(){return this.#v?.attributes?.style?.color||null}#A(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#N,fontSize:this.#E?`calc(${this.#E}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return n}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,l=s.length;r<l;++r){const c=s[r];n.append(document.createTextNode(c)),r<l-1&&n.append(document.createElement("br"))}return n}#R(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#l)&&this.#w()}updateEdited({rect:e,popup:t,deleted:n}){if(n||t?.deleted){this.remove();return}this.#C(),this.#y||={contentsObj:this.#r,richText:this.#m},e&&(this.#h=null),t&&(this.#m=this.#A(t.text),this.#a=gh.toDateObject(t.date),this.#r=null),this.#p?.remove(),this.#p=null}resetEdited(){this.#y&&({contentsObj:this.#r,richText:this.#m}=this.#y,this.#y=null,this.#p?.remove(),this.#p=null,this.#h=null)}remove(){this.#g?.abort(),this.#g=null,this.#p?.remove(),this.#p=null,this.#S=!1,this.#l=!1;for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#M(){if(this.#h!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:r}}}=this.#c;let l=!!this.#f,c=l?this.#f:this.#d;for(const E of this.#u)if(!c||_e.intersect(E.data.rect,c)!==null){c=E.data.rect,l=!0;break}const f=_e.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),g=l?c[2]-c[0]+5:0,v=f[0]+g,b=f[1];this.#h=[100*(v-s)/t,100*(b-r)/n];const{style:C}=this.#s;C.left=`${this.#h[0]}%`,C.top=`${this.#h[1]}%`}#w(){this.#l=!this.#l,this.#l?(this.#T(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#e)):(this.#D(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#e))}#T(){this.#p||this.render(),this.isVisible?this.#l&&this.#s.classList.add("focused"):(this.#M(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#D(){this.#s.classList.remove("focused"),!(this.#l||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#S=this.isVisible,this.#S&&(this.#s.hidden=!0)}maybeShow(){this.#C(),this.#S&&(this.#p||this.#T(),this.#S=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class zS extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Le.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class pM extends _t{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),r=this.#e=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class mM extends _t{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",r/2),l.setAttribute("y",r/2),l.setAttribute("width",t-r),l.setAttribute("height",n-r),l.setAttribute("stroke-width",r||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class gM extends _t{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",t/2),l.setAttribute("cy",n/2),l.setAttribute("rx",t/2-r/2),l.setAttribute("ry",n/2-r/2),l.setAttribute("stroke-width",r||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class $S extends _t{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:r,height:l}=this;if(!t)return this.container;const c=this.svgFactory.create(r,l,!0);let f=[];for(let g=0,v=t.length;g<v;g+=2){const b=t[g]-e[0],C=e[3]-t[g+1];f.push(`${b},${C}`)}f=f.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",f),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class yM extends $S{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class vM extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class fp extends _t{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Le.HIGHLIGHT:Le.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:r}}=this,{transform:l,width:c,height:f}=this.#n(t,e),d=this.svgFactory.create(c,f,!0),g=this.#e=this.svgFactory.createElement("svg:g");d.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let v=0,b=n.length;v<b;v++){const C=this.svgFactory.createElement(this.svgElementName);this.#t.push(C),C.setAttribute("points",n[v].join(",")),g.append(C)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,r=this.#e;if(t>=0&&r.setAttribute("stroke-width",t||1),n)for(let l=0,c=this.#t.length;l<c;l++)this.#t[l].setAttribute("points",n[l].join(","));if(s){const{transform:l,width:c,height:f}=this.#n(this.data.rotation,s);r.parentElement.setAttribute("viewBox",`0 0 ${c} ${f}`),r.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class YS extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Le.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class xM extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class bM extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class SM extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class WS extends _t{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Le.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class CM extends _t{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=zt.platform;return e.addEventListener("keydown",r=>{r.key==="Enter"&&(s?r.metaKey:r.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class hp{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:r,viewport:l,structTreeLayer:c}){this.div=e,this.#e=t,this.#t=n,this.#i=c||null,this.page=r,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}async#o(e,t,n){const s=e.firstChild||e,r=s.id=`${tp}${t}`,l=await this.#i?.getAriaAttributes(r);if(l)for(const[c,f]of l)s.setAttribute(c,f);n?n.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,s,!1))}async render(e){const{annotations:t}=e,n=this.div;Vs(n,this.viewport);const s=new Map,r={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new wc,annotationStorage:e.annotationStorage||new rp,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const c=l.annotationType===Nt.POPUP;if(c){const g=s.get(l.id);if(!g)continue;r.elements=g}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;r.data=l;const f=yv.create(r);if(!f.isRenderable)continue;if(!c&&l.popupRef){const g=s.get(l.popupRef);g?g.push(f):s.set(l.popupRef,[f])}const d=f.render();l.hidden&&(d.style.visibility="hidden"),await this.#o(d,l.id,r.elements),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}this.#s()}async addLinkAnnotations(e,t){const n={data:null,layer:this.div,linkService:t,svgFactory:new wc,parent:this};for(const s of e){s.borderStyle||=hp._defaultBorderStyle,n.data=s;const r=yv.create(n);if(!r.isRenderable)continue;const l=r.render();await this.#o(l,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Vs(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(n):r.classList.contains("annotationContent")?r.after(n):r.before(n):s.append(n);const l=this.#n.get(t);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}static get _defaultBorderStyle(){return Ge(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Uo.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const sc=/\r\n?|\n/g;class Pt extends we{#e;#t="";#n=`${this.id}-editor`;#i=null;#o;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Pt.prototype,t=r=>r.isEmpty(),n=hs.TRANSLATE_SMALL,s=hs.TRANSLATE_BIG;return Ge(this,"_keyboardManager",new ka([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Le.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Pt._defaultColor||we._defaultLineColor,this.#o=e.fontSize||Pt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){we.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case ze.FREETEXT_SIZE:Pt._defaultFontSize=t;break;case ze.FREETEXT_COLOR:Pt._defaultColor=t;break}}updateParams(e,t){switch(e){case ze.FREETEXT_SIZE:this.#s(t);break;case ze.FREETEXT_COLOR:this.#r(t);break}}static get defaultPropertiesToUpdate(){return[[ze.FREETEXT_SIZE,Pt._defaultFontSize],[ze.FREETEXT_COLOR,Pt._defaultColor||we._defaultLineColor]]}get propertiesToUpdate(){return[[ze.FREETEXT_SIZE,this.#o],[ze.FREETEXT_COLOR,this.#e]]}get toolbarButtons(){return this._colorPicker||=new Ca(this),[["colorPicker",this._colorPicker]]}get colorType(){return ze.FREETEXT_COLOR}get colorValue(){return this.#e}#s(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#o)*this.parentScale),this.#o=s,this.#u()},n=this.#o;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#r(e){const t=s=>{this.#e=this.editorDiv.style.color=s,this._colorPicker?.update(s)},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Pt._internalPadding*e,-(Pt._internalPadding+this.#o)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(Pt.#c(n)),t=n);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:r}=this,l=r.style.display,c=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",s.div.append(this.div),n=r.getBoundingClientRect(),r.remove(),r.style.display=l,r.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#a().trimEnd();if(e===t)return;const n=s=>{if(this.#t=s,!s){this.remove();return}this.#f(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Pt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#o}px * var(--total-scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,r]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,f]=this.getInitialTranslation();[c,f]=this.pageTranslationToScreen(c,f);const[d,g]=this.pageDimensions,[v,b]=this.pageTranslation;let C,E;switch(this.rotation){case 0:C=e+(l[0]-v)/d,E=t+this.height-(l[1]-b)/g;break;case 90:C=e+(l[0]-v)/d,E=t-(l[1]-b)/g,[c,f]=[f,-c];break;case 180:C=e-this.width+(l[0]-v)/d,E=t-(l[1]-b)/g,[c,f]=[-c,-f];break;case 270:C=e+(l[0]-v-this.height*g)/d,E=t+(l[1]-b-this.width*d)/g,[c,f]=[-f,c];break}this.setAt(C*s,E*r,c,f)}else this._moveAfterPaste(e,t);this.#f(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(sc,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=Pt.#p(t.getData("text")||"").replaceAll(sc,`
`);if(!s)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const l=r.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:c,startOffset:f}=l,d=[],g=[];if(c.nodeType===Node.TEXT_NODE){const C=c.parentElement;if(g.push(c.nodeValue.slice(f).replaceAll(sc,"")),C!==this.editorDiv){let E=d;for(const A of this.editorDiv.childNodes){if(A===C){E=g;continue}E.push(Pt.#c(A))}}d.push(c.nodeValue.slice(0,f).replaceAll(sc,""))}else if(c===this.editorDiv){let C=d,E=0;for(const A of this.editorDiv.childNodes)E++===f&&(C=g),C.push(Pt.#c(A))}this.#t=`${d.join(`
`)}${s}${g.join(`
`)}`,this.#f();const v=new Range;let b=Math.sumPrecise(d.map(C=>C.length));for(const{firstChild:C}of this.editorDiv.childNodes)if(C.nodeType===Node.TEXT_NODE){const E=C.nodeValue.length;if(b<=E){v.setStart(C,b),v.setEnd(C,b);break}b-=E}r.removeAllRanges(),r.addRange(v)}#f(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#l(){return this.#t.replaceAll(" "," ")}static#p(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,n){let s=null;if(e instanceof zS){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:f,rotation:d,id:g,popupRef:v,contentsObj:b},textContent:C,textPosition:E,parent:{page:{pageNumber:A}}}=e;if(!C||C.length===0)return null;s=e={annotationType:Le.FREETEXT,color:Array.from(c),fontSize:l,value:C.join(`
`),position:E,pageIndex:A-1,rect:f.slice(0),rotation:d,annotationElementId:g,id:g,deleted:!1,popupRef:v,comment:b?.str||null}}const r=await super.deserialize(e,t,n);return r.#o=e.fontSize,r.#e=_e.makeHexColor(...e.color),r.#t=Pt.#p(e.value),r._initialData=s,e.comment&&r.setCommentData(e.comment),r}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Pt._internalPadding*this.parentScale,n=this.getRect(t,t),s=we._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),r={annotationType:Le.FREETEXT,color:s,fontSize:this.#o,value:this.#l(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(r),e?(r.isCopy=!0,r):this.annotationElementId&&!this.#g(r)?null:(r.id=this.annotationElementId,r)}#g(e){const{value:t,fontSize:n,color:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((l,c)=>l!==s[c])||e.pageIndex!==r}renderAnnotationElement(e){const t=super.renderAnnotationElement(e),{style:n}=t;n.fontSize=`calc(${this.#o}px * var(--total-scale-factor))`,n.color=this.#e,t.replaceChildren();for(const l of this.#t.split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),t.append(c)}const s=Pt._internalPadding*this.parentScale,r={rect:this.getRect(s,s)};return r.popup=this.hasEditedComment?this.comment:{text:this.#t},e.updateEdited(r),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ve{static PRECISION=1e-4;toSVGPath(){nt("Abstract method `toSVGPath` must be implemented.")}get box(){nt("Abstract getter `box` must be implemented.")}serialize(e,t){nt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,r,l){l||=new Float32Array(e.length);for(let c=0,f=e.length;c<f;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*r;return l}static _rescaleAndSwap(e,t,n,s,r,l){l||=new Float32Array(e.length);for(let c=0,f=e.length;c<f;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*r;return l}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let r=0,l=e.length;r<l;r+=2)s[r]=t+e[r],s[r+1]=n+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,r){switch(r){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,r,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+r)/6,(5*s+l)/6,(n+r)/2,(s+l)/2]}}class Ps{#e;#t=[];#n;#i;#o=[];#s=new Float32Array(18);#r;#a;#u;#c;#f;#l;#p=[];static#g=8;static#h=2;static#d=Ps.#g+Ps.#h;constructor({x:e,y:t},n,s,r,l,c=0){this.#e=n,this.#l=r*s,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=c,this.#c=Ps.#g*s,this.#u=Ps.#d*s,this.#f=s,this.#p.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#m(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,s,r,l]=this.#e;return[(this.#r+(e[0]-t[0])/2-n)/r,(this.#a+(e[1]-t[1])/2-s)/l,(this.#r+(t[0]-e[0])/2-n)/r,(this.#a+(t[1]-e[1])/2-s)/l]}add({x:e,y:t}){this.#r=e,this.#a=t;const[n,s,r,l]=this.#e;let[c,f,d,g]=this.#s.subarray(8,12);const v=e-d,b=t-g,C=Math.hypot(v,b);if(C<this.#u)return!1;const E=C-this.#c,A=E/C,_=A*v,w=A*b;let N=c,M=f;c=d,f=g,d+=_,g+=w,this.#p?.push(e,t);const k=-w/E,R=_/E,I=k*this.#l,P=R*this.#l;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([d+I,g+P],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([d-I,g-P],16),isNaN(this.#s[6])?(this.#o.length===0&&(this.#s.set([c+I,f+P],2),this.#o.push(NaN,NaN,NaN,NaN,(c+I-n)/r,(f+P-s)/l),this.#s.set([c-I,f-P],14),this.#t.push(NaN,NaN,NaN,NaN,(c-I-n)/r,(f-P-s)/l)),this.#s.set([N,M,c,f,d,g],6),!this.isEmpty()):(this.#s.set([N,M,c,f,d,g],6),Math.abs(Math.atan2(M-f,N-c)-Math.atan2(w,_))<Math.PI/2?([c,f,d,g]=this.#s.subarray(2,6),this.#o.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/r,((f+g)/2-s)/l),[c,f,N,M]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((N+c)/2-n)/r,((M+f)/2-s)/l),!0):([N,M,c,f,d,g]=this.#s.subarray(0,6),this.#o.push(((N+5*c)/6-n)/r,((M+5*f)/6-s)/l,((5*c+d)/6-n)/r,((5*f+g)/6-s)/l,((c+d)/2-n)/r,((f+g)/2-s)/l),[d,g,c,f,N,M]=this.#s.subarray(12,18),this.#t.push(((N+5*c)/6-n)/r,((M+5*f)/6-s)/l,((5*c+d)/6-n)/r,((5*f+g)/6-s)/l,((c+d)/2-n)/r,((f+g)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#o,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#x();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#S(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#y(n),n.join(" ")}#x(){const[e,t,n,s]=this.#e,[r,l,c,f]=this.#m();return`M${(this.#s[2]-e)/n} ${(this.#s[3]-t)/s} L${(this.#s[4]-e)/n} ${(this.#s[5]-t)/s} L${r} ${l} L${c} ${f} L${(this.#s[16]-e)/n} ${(this.#s[17]-t)/s} L${(this.#s[14]-e)/n} ${(this.#s[15]-t)/s} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#S(e){const[t,n,s,r]=this.#e,l=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[f,d,g,v]=this.#m();e.push(`L${(l[0]-t)/s} ${(l[1]-n)/r} L${f} ${d} L${g} ${v} L${(c[0]-t)/s} ${(c[1]-n)/r}`)}newFreeDrawOutline(e,t,n,s,r,l){return new KS(e,t,n,s,r,l)}getOutlines(){const e=this.#o,t=this.#t,n=this.#s,[s,r,l,c]=this.#e,f=new Float32Array((this.#p?.length??0)+2);for(let v=0,b=f.length-2;v<b;v+=2)f[v]=(this.#p[v]-s)/l,f[v+1]=(this.#p[v+1]-r)/c;if(f[f.length-2]=(this.#r-s)/l,f[f.length-1]=(this.#a-r)/c,isNaN(n[6])&&!this.isEmpty())return this.#C(f);const d=new Float32Array(this.#o.length+24+this.#t.length);let g=e.length;for(let v=0;v<g;v+=2){if(isNaN(e[v])){d[v]=d[v+1]=NaN;continue}d[v]=e[v],d[v+1]=e[v+1]}g=this.#E(d,g);for(let v=t.length-6;v>=6;v-=6)for(let b=0;b<6;b+=2){if(isNaN(t[v+b])){d[g]=d[g+1]=NaN,g+=2;continue}d[g]=t[v+b],d[g+1]=t[v+b+1],g+=2}return this.#v(d,g),this.newFreeDrawOutline(d,f,this.#e,this.#f,this.#n,this.#i)}#C(e){const t=this.#s,[n,s,r,l]=this.#e,[c,f,d,g]=this.#m(),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(t[2]-n)/r,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/r,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,d,g,NaN,NaN,NaN,NaN,(t[16]-n)/r,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/r,(t[15]-s)/l],0),this.newFreeDrawOutline(v,e,this.#e,this.#f,this.#n,this.#i)}#v(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#E(e,t){const n=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[r,l,c,f]=this.#e,[d,g,v,b]=this.#m();return e.set([NaN,NaN,NaN,NaN,(n[0]-r)/c,(n[1]-l)/f,NaN,NaN,NaN,NaN,d,g,NaN,NaN,NaN,NaN,v,b,NaN,NaN,NaN,NaN,(s[0]-r)/c,(s[1]-l)/f],t),t+=24}}class KS extends ve{#e;#t=new Float32Array(4);#n;#i;#o;#s;#r;constructor(e,t,n,s,r,l){super(),this.#r=e,this.#o=t,this.#e=n,this.#s=s,this.#n=r,this.#i=l,this.lastPoint=[NaN,NaN],this.#a(l);const[c,f,d,g]=this.#t;for(let v=0,b=e.length;v<b;v+=2)e[v]=(e[v]-c)/d,e[v+1]=(e[v+1]-f)/g;for(let v=0,b=t.length;v<b;v+=2)t[v]=(t[v]-c)/d,t[v+1]=(t[v+1]-f)/g}toSVGPath(){const e=[`M${this.#r[4]} ${this.#r[5]}`];for(let t=6,n=this.#r.length;t<n;t+=6){if(isNaN(this.#r[t])){e.push(`L${this.#r[t+4]} ${this.#r[t+5]}`);continue}e.push(`C${this.#r[t]} ${this.#r[t+1]} ${this.#r[t+2]} ${this.#r[t+3]} ${this.#r[t+4]} ${this.#r[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],r){const l=n-e,c=s-t;let f,d;switch(r){case 0:f=ve._rescale(this.#r,e,s,l,-c),d=ve._rescale(this.#o,e,s,l,-c);break;case 90:f=ve._rescaleAndSwap(this.#r,e,t,l,c),d=ve._rescaleAndSwap(this.#o,e,t,l,c);break;case 180:f=ve._rescale(this.#r,n,t,-l,c),d=ve._rescale(this.#o,n,t,-l,c);break;case 270:f=ve._rescaleAndSwap(this.#r,n,s,-l,-c),d=ve._rescaleAndSwap(this.#o,n,s,-l,-c);break}return{outline:Array.from(f),points:[Array.from(d)]}}#a(e){const t=this.#r;let n=t[4],s=t[5];const r=[n,s,n,s];let l=n,c=s;const f=e?Math.max:Math.min;for(let g=6,v=t.length;g<v;g+=6){const b=t[g+4],C=t[g+5];if(isNaN(t[g]))_e.pointBoundingBox(b,C,r),c<C?(l=b,c=C):c===C&&(l=f(l,b));else{const E=[1/0,1/0,-1/0,-1/0];_e.bezierBoundingBox(n,s,...t.slice(g,g+6),E),_e.rectBoundingBox(...E,r),c<E[3]?(l=E[2],c=E[3]):c===E[3]&&(l=f(l,E[2]))}n=b,s=C}const d=this.#t;d[0]=r[0]-this.#n,d[1]=r[1]-this.#n,d[2]=r[2]-r[0]+2*this.#n,d[3]=r[3]-r[1]+2*this.#n,this.lastPoint=[l,c]}get box(){return this.#t}newOutliner(e,t,n,s,r,l=0){return new Ps(e,t,n,s,r,l)}getNewOutline(e,t){const[n,s,r,l]=this.#t,[c,f,d,g]=this.#e,v=r*d,b=l*g,C=n*d+c,E=s*g+f,A=this.newOutliner({x:this.#o[0]*v+C,y:this.#o[1]*b+E},this.#e,this.#s,e,this.#i,t??this.#n);for(let _=2;_<this.#o.length;_+=2)A.add({x:this.#o[_]*v+C,y:this.#o[_+1]*b+E});return A.getOutlines()}}class Ah{#e;#t;#n=[];#i=[];constructor(e,t=0,n=0,s=!0){const r=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:C,y:E,width:A,height:_}of e){const w=Math.floor((C-t)/l)*l,N=Math.ceil((C+A+t)/l)*l,M=Math.floor((E-t)/l)*l,k=Math.ceil((E+_+t)/l)*l,R=[w,M,k,!0],I=[N,M,k,!1];this.#n.push(R,I),_e.rectBoundingBox(w,M,N,k,r)}const c=r[2]-r[0]+2*n,f=r[3]-r[1]+2*n,d=r[0]-n,g=r[1]-n,v=this.#n.at(s?-1:-2),b=[v[0],v[2]];for(const C of this.#n){const[E,A,_]=C;C[0]=(E-d)/c,C[1]=(A-g)/f,C[2]=(_-g)/f}this.#e=new Float32Array([d,g,c,f]),this.#t=b}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#u(t)),this.#r(t)):(this.#a(t),e.push(...this.#u(t)));return this.#o(e)}#o(e){const t=[],n=new Set;for(const l of e){const[c,f,d]=l;t.push([c,f,l],[c,d,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const f=t[l][2],d=t[l+1][2];f.push(d),d.push(f),n.add(f),n.add(d)}const s=[];let r;for(;n.size>0;){const l=n.values().next().value;let[c,f,d,g,v]=l;n.delete(l);let b=c,C=f;for(r=[c,d],s.push(r);;){let E;if(n.has(g))E=g;else if(n.has(v))E=v;else break;n.delete(E),[c,f,d,g,v]=E,b!==c&&(r.push(b,C,c,C===f?f:d),b=c),C=C===f?d:f}r.push(b,C)}return new AM(s,this.#e,this.#t)}#s(e){const t=this.#i;let n=0,s=t.length-1;for(;n<=s;){const r=n+s>>1,l=t[r][0];if(l===e)return r;l<e?n=r+1:s=r-1}return s+1}#r([,e,t]){const n=this.#s(e);this.#i.splice(n,0,[e,t])}#a([,e,t]){const n=this.#s(e);for(let s=n;s<this.#i.length;s++){const[r,l]=this.#i[s];if(r!==e)break;if(r===e&&l===t){this.#i.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[r,l]=this.#i[s];if(r!==e)break;if(r===e&&l===t){this.#i.splice(s,1);return}}}#u(e){const[t,n,s]=e,r=[[t,n,s]],l=this.#s(s);for(let c=0;c<l;c++){const[f,d]=this.#i[c];for(let g=0,v=r.length;g<v;g++){const[,b,C]=r[g];if(!(d<=b||C<=f)){if(b>=f){if(C>d)r[g][1]=d;else{if(v===1)return[];r.splice(g,1),g--,v--}continue}r[g][2]=f,C>d&&r.push([t,d,C])}}}return r}}class AM extends ve{#e;#t;constructor(e,t,n){super(),this.#t=e,this.#e=t,this.lastPoint=n}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let r=2;r<t.length;r+=2){const l=t[r],c=t[r+1];l===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],r){const l=[],c=n-e,f=s-t;for(const d of this.#t){const g=new Array(d.length);for(let v=0;v<d.length;v+=2)g[v]=e+d[v]*c,g[v+1]=s-d[v+1]*f;l.push(g)}return l}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Eh extends Ps{newFreeDrawOutline(e,t,n,s,r,l){return new EM(e,t,n,s,r,l)}}class EM extends KS{newOutliner(e,t,n,s,r,l=0){return new Eh(e,t,n,s,r,l)}}class At extends we{#e=null;#t=0;#n;#i=null;#o=null;#s=null;#r=null;#a=0;#u=null;#c=null;#f=null;#l=!1;#p=null;#g;#h=null;#d="";#m;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Le.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=At.prototype;return Ge(this,"_keyboardManager",new ka([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||At._defaultColor,this.#m=e.thickness||At._defaultThickness,this.#g=e.opacity||At._defaultOpacity,this.#n=e.boxes||null,this.#x=e.methodOfCreation||"",this.#d=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#l=!0,this.#S(e),this.#A()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#r=e.focusNode,this.#a=e.focusOffset,this.#y(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#l?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new Ah(this.#n,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new Ah(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{lastPoint:n}=this.#s;this.#p=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#S({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#c=e;const s=1.5;if(this.#s=e.getNewOutline(this.#m/2+s,.0025),t>=0)this.#f=t,this.#i=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#h=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#f,{bbox:At.#R(this.#c.box,(g-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#h,{bbox:At.#R(this.#s.box,g),path:{d:this.#s.toSVGPath()}})}const[r,l,c,f]=e.box;switch(this.rotation){case 0:this.x=r,this.y=l,this.width=c,this.height=f;break;case 90:{const[g,v]=this.parentDimensions;this.x=l,this.y=1-r,this.width=c*v/g,this.height=f*g/v;break}case 180:this.x=1-r,this.y=1-l,this.width=c,this.height=f;break;case 270:{const[g,v]=this.parentDimensions;this.x=1-l,this.y=r,this.width=c*v/g,this.height=f*g/v;break}}const{lastPoint:d}=this.#s;this.#p=[(d[0]-r)/c,(d[1]-l)/f]}static initialize(e,t){we.initialize(e,t),At._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case ze.HIGHLIGHT_COLOR:At._defaultColor=t;break;case ze.HIGHLIGHT_THICKNESS:At._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#p}updateParams(e,t){switch(e){case ze.HIGHLIGHT_COLOR:this.#C(t);break;case ze.HIGHLIGHT_THICKNESS:this.#v(t);break}}static get defaultPropertiesToUpdate(){return[[ze.HIGHLIGHT_COLOR,At._defaultColor],[ze.HIGHLIGHT_THICKNESS,At._defaultThickness]]}get propertiesToUpdate(){return[[ze.HIGHLIGHT_COLOR,this.color||At._defaultColor],[ze.HIGHLIGHT_THICKNESS,this.#m||At._defaultThickness],[ze.HIGHLIGHT_FREE,this.#l]]}#C(e){const t=(r,l)=>{this.color=r,this.#g=l,this.parent?.drawLayer.updateProperties(this.#f,{root:{fill:r,"fill-opacity":l}}),this.#o?.updateColor(r)},n=this.color,s=this.#g;this.addCommands({cmd:t.bind(this,e,At._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#v(e){const t=this.#m,n=s=>{this.#m=s,this.#E(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#o=new Fn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#T())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#T())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#N(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#N():e&&(this.#A(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#E(e){if(!this.#l)return;this.#S({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#N(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#h),this.#h=null)}#A(e=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#i}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#l},path:{d:this.#c.toSVGPath()}},!1,!0),this.#h=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#l},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#l),this.#u&&(this.#u.style.clipPath=this.#i))}static#R([e,t,n,s],r){switch(r){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#l?(e=(e-this.rotation+360)%360,n=At.#R(this.#c.box,e)):n=At.#R([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#f,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#h,{bbox:At.#R(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#d&&(e.setAttribute("aria-label",this.#d),e.setAttribute("role","mark")),this.#l?e.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),_S(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#h,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#h,{rootClass:{hovered:!1}})}#M(e){At._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#w(!0);break;case 1:case 3:this.#w(!1);break}}#w(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#r,this.#a)}select(){super.select(),this.#h&&this.parent?.drawLayer.updateProperties(this.#h,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#h&&(this.parent?.drawLayer.updateProperties(this.#h,{rootClass:{selected:!1}}),this.#l||this.#w(!1))}get _mustFixPosition(){return!this.#l}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}))}#T(){return this.#l?this.rotation:0}#D(){if(this.#l)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,r=this.#n,l=new Float32Array(r.length*8);let c=0;for(const{x:f,y:d,width:g,height:v}of r){const b=f*e+n,C=(1-d)*t+s;l[c]=l[c+4]=b,l[c+1]=l[c+3]=C,l[c+2]=l[c+6]=b+g*e,l[c+5]=l[c+7]=C-v*t,c+=8}return l}#O(e){return this.#c.serialize(e,this.#T())}static startHighlighting(e,t,{target:n,x:s,y:r}){const{x:l,y:c,width:f,height:d}=n.getBoundingClientRect(),g=new AbortController,v=e.combinedSignal(g),b=C=>{g.abort(),this.#G(e,C)};window.addEventListener("blur",b,{signal:v}),window.addEventListener("pointerup",b,{signal:v}),window.addEventListener("pointerdown",Rt,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Bn,{signal:v}),n.addEventListener("pointermove",this.#k.bind(this,e),{signal:v}),this._freeHighlight=new Eh({x:s,y:r},[l,c,f,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#G(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof YS){const{data:{quadPoints:E,rect:A,rotation:_,id:w,color:N,opacity:M,popupRef:k,contentsObj:R},parent:{page:{pageNumber:I}}}=e;s=e={annotationType:Le.HIGHLIGHT,color:Array.from(N),opacity:M,quadPoints:E,boxes:null,pageIndex:I-1,rect:A.slice(0),rotation:_,annotationElementId:w,id:w,deleted:!1,popupRef:k,comment:R?.str||null}}else if(e instanceof fp){const{data:{inkLists:E,rect:A,rotation:_,id:w,color:N,borderStyle:{rawWidth:M},popupRef:k,contentsObj:R},parent:{page:{pageNumber:I}}}=e;s=e={annotationType:Le.HIGHLIGHT,color:Array.from(N),thickness:M,inkLists:E,boxes:null,pageIndex:I-1,rect:A.slice(0),rotation:_,annotationElementId:w,id:w,deleted:!1,popupRef:k,comment:R?.str||null}}const{color:r,quadPoints:l,inkLists:c,opacity:f}=e,d=await super.deserialize(e,t,n);d.color=_e.makeHexColor(...r),d.#g=f||1,c&&(d.#m=e.thickness),d._initialData=s,e.comment&&d.setCommentData(e.comment);const[g,v]=d.pageDimensions,[b,C]=d.pageTranslation;if(l){const E=d.#n=[];for(let A=0;A<l.length;A+=8)E.push({x:(l[A]-b)/g,y:1-(l[A+1]-C)/v,width:(l[A+2]-l[A])/g,height:(l[A+1]-l[A+5])/v});d.#y(),d.#A(),d.rotate(d.rotation)}else if(c){d.#l=!0;const E=c[0],A={x:E[0]-b,y:v-(E[1]-C)},_=new Eh(A,[0,0,g,v],1,d.#m/2,!0,.001);for(let M=0,k=E.length;M<k;M+=2)A.x=E[M]-b,A.y=v-(E[M+1]-C),_.add(A);const{id:w,clipPathId:N}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);d.#S({highlightOutlines:_.getOutlines(),highlightId:w,clipPathId:N}),d.#A(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),n=we._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:Le.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#m,quadPoints:this.#D(),outlines:this.#O(t),pageIndex:this.pageIndex,rect:t,rotation:this.#T(),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!this.#_(s)?null:(s.id=this.annotationElementId,s)}#_(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){const t={rect:this.getRect(0,0)};return this.hasEditedComment&&(t.popup=this.comment),e.updateEdited(t),null}static canCreateNewEmptyEditor(){return!1}}class XS{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){nt("Not implemented")}}class Ie extends we{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#o=null;static#s=NaN;static#r=null;static#a=null;static#u=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(this.#c(e),this.#p())}#c({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#f(e,this.parent),this.#d(e.box)}#f(e,t){const{id:n}=t.drawLayer.draw(Ie._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,r]of Object.entries(t))n.has(s)?Object.assign(e[s],r):e[s]=r;return e}static getDefaultDrawingOptions(e){nt("Not implemented")}static get typesMap(){nt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Ie.#n.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,r=s[t],l=c=>{s.updateProperty(t,c);const f=this.#e.updateProperty(t,c);f&&this.#d(f),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this._colorPicker?.update(c)};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Ie._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Ie._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#m()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Ie._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#p(),this.#d(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#l()):e&&(this._uiManager.addShouldRescale(this),this.#p(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#p(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#f(this.#e,e)}}#g([e,t,n,s]){const{parentDimensions:[r,l],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(l/r),s*(r/l)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(l/r),s*(r/l)];default:return[e,t,n,s]}}#h(){const{x:e,y:t,width:n,height:s,parentDimensions:[r,l],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(r/l),s*(l/r)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(r/l),s*(l/r)];default:return[e,t,n,s]}}#d(e){if([this.x,this.y,this.width,this.height]=this.#g(e),this.div){this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}this._onResized()}#m(){const{x:e,y:t,width:n,height:s,rotation:r,parentRotation:l,parentDimensions:[c,f]}=this;switch((r*4+l)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/f),s*(f/c),n*(c/f)];case 5:return[1-t,e,n*(c/f),s*(f/c)];case 6:return[1-e-s*(f/c),1-t,s*(f/c),n*(c/f)];case 7:return[t-n*(c/f),1-e-s*(f/c),n*(c/f),s*(f/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(f/c),t,s*(f/c),n*(c/f)];case 13:return[1-t-n*(c/f),e-s*(f/c),n*(c/f),s*(f/c)];case 14:return[1-e,1-t-n*(c/f),s*(f/c),n*(c/f)];case 15:return[t,1-e,n*(c/f),s*(f/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ie._mergeSVGProperties({bbox:this.#m()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#d(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[r,l]=this.parentDimensions;return this.setDims(this.width*r,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,r){nt("Not implemented")}static startDrawing(e,t,n,s){const{target:r,offsetX:l,offsetY:c,pointerId:f,pointerType:d}=s;if(Ie.#r&&Ie.#r!==d)return;const{viewport:{rotation:g}}=e,{width:v,height:b}=r.getBoundingClientRect(),C=Ie.#i=new AbortController,E=e.combinedSignal(C);if(Ie.#s||=f,Ie.#r??=d,window.addEventListener("pointerup",A=>{Ie.#s===A.pointerId?this._endDraw(A):Ie.#a?.delete(A.pointerId)},{signal:E}),window.addEventListener("pointercancel",A=>{Ie.#s===A.pointerId?this._currentParent.endDrawingSession():Ie.#a?.delete(A.pointerId)},{signal:E}),window.addEventListener("pointerdown",A=>{Ie.#r===A.pointerType&&((Ie.#a||=new Set).add(A.pointerId),Ie.#n.isCancellable()&&(Ie.#n.removeLastElement(),Ie.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Bn,{signal:E}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),r.addEventListener("touchmove",A=>{A.timeStamp===Ie.#u&&Rt(A)},{signal:E}),e.toggleDrawing(),t._editorUndoBar?.hide(),Ie.#n){e.drawLayer.updateProperties(this._currentDrawId,Ie.#n.startNew(l,c,v,b,g));return}t.updateUIForDefaultProperties(this),Ie.#n=this.createDrawerInstance(l,c,v,b,g),Ie.#o=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Ie.#o.toSVGProperties(),Ie.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(Ie.#u=-1,!Ie.#n)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(Ie.#s===s){if(Ie.#a?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Ie.#n.add(t,n)),Ie.#u=e.timeStamp,Rt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Ie.#n=null,Ie.#o=null,Ie.#r=null,Ie.#u=NaN),Ie.#i&&(Ie.#i.abort(),Ie.#i=null,Ie.#s=NaN,Ie.#a=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Ie.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=Ie.#n,s=this._currentDrawId,r=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(r))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:ze.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(ze.DRAW_STEP),!Ie.#n.isEmpty()){const{pageDimensions:[n,s],scale:r}=t,l=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Ie.#n.getOutlines(n*r,s*r,r,this._INNER_MARGIN),drawingOptions:Ie.#o,mustBeCommitted:!e});return this._cleanup(!0),l}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,r,l){nt("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}=t.viewport,f=this.deserializeDraw(l,c,s,r,this._INNER_MARGIN,e),d=await super.deserialize(e,t,n);return d.createDrawingOptions(e),d.#c({drawOutlines:f}),d.#p(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,n]=this.pageTranslation,[s,r]=this.pageDimensions;return this.#e.serialize([t,n,s,r],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class _M{#e=new Float64Array(6);#t;#n;#i;#o;#s;#r="";#a=0;#u=new Pa;#c;#f;constructor(e,t,n,s,r,l){this.#c=n,this.#f=s,this.#i=r,this.#o=l,[e,t]=this.#l(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#n=[{line:c,points:this.#s}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#o=t)}#l(e,t){return ve._normalizePoint(e,t,this.#c,this.#f,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#l(e,t);const[n,s,r,l]=this.#e.subarray(2,6),c=e-r,f=t-l;return Math.hypot(this.#c*c,this.#f*f)<=2?null:(this.#s.push(e,t),isNaN(n)?(this.#e.set([r,l,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,r,l,e,t],0),this.#t.push(...ve.createBezierPoints(n,s,r,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,r){this.#c=n,this.#f=s,this.#i=r,[e,t]=this.#l(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const c=this.#n.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#n.push({line:l,points:this.#s}),this.#e.set(l,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#s=e.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#r="";for(let e=0,t=this.#n.length;e<t;e++){const{line:n,points:s}=this.#n[e];this.#t=n,this.#s=s,this.#a=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const e=ve.svgRound(this.#t[4]),t=ve.svgRound(this.#t[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${e} ${t} Z`,this.#r;if(this.#s.length<=6){const s=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,s)} M ${e} ${t}`,this.#a=6}if(this.#s.length===4){const s=ve.svgRound(this.#t[10]),r=ve.svgRound(this.#t[11]);return this.#r=`${this.#r} L ${s} ${r}`,this.#a=12,this.#r}const n=[];this.#a===0&&(n.push(`M ${e} ${t}`),this.#a=6);for(let s=this.#a,r=this.#t.length;s<r;s+=6){const[l,c,f,d,g,v]=this.#t.slice(s,s+6).map(ve.svgRound);n.push(`C${l} ${c} ${f} ${d} ${g} ${v}`)}return this.#r+=n.join(" "),this.#a=this.#t.length,this.#r}getOutlines(e,t,n,s){const r=this.#n.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#u.build(this.#n,e,t,n,this.#i,this.#o,s),this.#e=null,this.#t=null,this.#n=null,this.#r=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Pa extends ve{#e;#t=0;#n;#i;#o;#s;#r;#a;#u;build(e,t,n,s,r,l,c){this.#o=t,this.#s=n,this.#r=s,this.#a=r,this.#u=l,this.#n=c??0,this.#i=e,this.#l()}get thickness(){return this.#u}setLastElement(e){return this.#i.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#i){if(e.push(`M${ve.svgRound(t[4])} ${ve.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${ve.svgRound(t[10])} ${ve.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[r,l,c,f,d,g]=t.subarray(n,n+6).map(ve.svgRound);e.push(`C${r} ${l} ${c} ${f} ${d} ${g}`)}}return e.join("")}serialize([e,t,n,s],r){const l=[],c=[],[f,d,g,v]=this.#f();let b,C,E,A,_,w,N,M,k;switch(this.#a){case 0:k=ve._rescale,b=e,C=t+s,E=n,A=-s,_=e+f*n,w=t+(1-d-v)*s,N=e+(f+g)*n,M=t+(1-d)*s;break;case 90:k=ve._rescaleAndSwap,b=e,C=t,E=n,A=s,_=e+d*n,w=t+f*s,N=e+(d+v)*n,M=t+(f+g)*s;break;case 180:k=ve._rescale,b=e+n,C=t,E=-n,A=s,_=e+(1-f-g)*n,w=t+d*s,N=e+(1-f)*n,M=t+(d+v)*s;break;case 270:k=ve._rescaleAndSwap,b=e+n,C=t+s,E=-n,A=-s,_=e+(1-d-v)*n,w=t+(1-f-g)*s,N=e+(1-d)*n,M=t+(1-f)*s;break}for(const{line:R,points:I}of this.#i)l.push(k(R,b,C,E,A,r?new Array(R.length):null)),c.push(k(I,b,C,E,A,r?new Array(I.length):null));return{lines:l,points:c,rect:[_,w,N,M]}}static deserialize(e,t,n,s,r,{paths:{lines:l,points:c},rotation:f,thickness:d}){const g=[];let v,b,C,E,A;switch(f){case 0:A=ve._rescale,v=-e/n,b=t/s+1,C=1/n,E=-1/s;break;case 90:A=ve._rescaleAndSwap,v=-t/s,b=-e/n,C=1/s,E=1/n;break;case 180:A=ve._rescale,v=e/n+1,b=-t/s,C=-1/n,E=1/s;break;case 270:A=ve._rescaleAndSwap,v=t/s+1,b=e/n+1,C=-1/s,E=-1/n;break}if(!l){l=[];for(const w of c){const N=w.length;if(N===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(N===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const M=new Float32Array(3*(N-2));l.push(M);let[k,R,I,P]=w.subarray(0,4);M.set([NaN,NaN,NaN,NaN,k,R],0);for(let q=4;q<N;q+=2){const F=w[q],$=w[q+1];M.set(ve.createBezierPoints(k,R,I,P,F,$),(q-2)*3),[k,R,I,P]=[I,P,F,$]}}}for(let w=0,N=l.length;w<N;w++)g.push({line:A(l[w].map(M=>M??NaN),v,b,C,E),points:A(c[w].map(M=>M??NaN),v,b,C,E)});const _=new this.prototype.constructor;return _.build(g,n,s,1,f,d,r),_}#c(e=this.#u){const t=this.#n+e/2*this.#r;return this.#a%180===0?[t/this.#o,t/this.#s]:[t/this.#s,t/this.#o]}#f(){const[e,t,n,s]=this.#e,[r,l]=this.#c(0);return[e+r,t+l,n-2*r,s-2*l]}#l(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#i){if(s.length<=12){for(let c=4,f=s.length;c<f;c+=6)_e.pointBoundingBox(s[c],s[c+1],e);continue}let r=s[4],l=s[5];for(let c=6,f=s.length;c<f;c+=6){const[d,g,v,b,C,E]=s.subarray(c,c+6);_e.bezierBoundingBox(r,l,d,g,v,b,C,E,e),r=C,l=E}}const[t,n]=this.#c();e[0]=sn(e[0]-t,0,1),e[1]=sn(e[1]-n,0,1),e[2]=sn(e[2]+t,0,1),e[3]=sn(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#p(t):null}#p(e){const[t,n]=this.#c();this.#u=e;const[s,r]=this.#c(),[l,c]=[s-t,r-n],f=this.#e;return f[0]-=l,f[1]-=c,f[2]+=2*l,f[3]+=2*c,f}updateParentDimensions([e,t],n){const[s,r]=this.#c();this.#o=e,this.#s=t,this.#r=n;const[l,c]=this.#c(),f=l-s,d=c-r,g=this.#e;return g[0]-=f,g[1]-=d,g[2]+=2*f,g[3]+=2*d,g}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ve.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,r=0,l=0,c=0,f=0;switch(this.#t){case 90:s=t/e,r=-e/t,c=e;break;case 180:n=-1,l=-1,c=e,f=t;break;case 270:s=-t/e,r=e/t,f=t;break;default:return""}return`matrix(${n} ${s} ${r} ${l} ${ve.svgRound(c)} ${ve.svgRound(f)})`}getPathResizingSVGProperties([e,t,n,s]){const[r,l]=this.#c(),[c,f,d,g]=this.#e;if(Math.abs(d-r)<=ve.PRECISION||Math.abs(g-l)<=ve.PRECISION){const A=e+n/2-(c+d/2),_=t+s/2-(f+g/2);return{path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:`${this.rotationTransform} translate(${A} ${_})`}}}const v=(n-2*r)/(d-2*r),b=(s-2*l)/(g-2*l),C=d/n,E=g/s;return{path:{"transform-origin":`${ve.svgRound(c)} ${ve.svgRound(f)}`,transform:`${this.rotationTransform} scale(${C} ${E}) translate(${ve.svgRound(r)} ${ve.svgRound(l)}) scale(${v} ${b}) translate(${ve.svgRound(-r)} ${ve.svgRound(-l)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[r,l]=this.#c(),c=this.#e,[f,d,g,v]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(g-r)<=ve.PRECISION||Math.abs(v-l)<=ve.PRECISION){const _=e+n/2-(f+g/2),w=t+s/2-(d+v/2);for(const{line:N,points:M}of this.#i)ve._translate(N,_,w,N),ve._translate(M,_,w,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(n-2*r)/(g-2*r),C=(s-2*l)/(v-2*l),E=-b*(f+r)+e+r,A=-C*(d+l)+t+l;if(b!==1||C!==1||E!==0||A!==0)for(const{line:_,points:w}of this.#i)ve._rescale(_,E,A,b,C,_),ve._rescale(w,E,A,b,C,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,r]=n,l=this.#e,c=e-l[0],f=t-l[1];if(this.#o===s&&this.#s===r)for(const{line:d,points:g}of this.#i)ve._translate(d,c,f,d),ve._translate(g,c,f,g);else{const d=this.#o/s,g=this.#s/r;this.#o=s,this.#s=r;for(const{line:v,points:b}of this.#i)ve._rescale(v,c,f,d,g,v),ve._rescale(b,c,f,d,g,b);l[2]*=d,l[3]*=g}return l[0]=e,l[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(e)} ${ve.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(e[0])} ${ve.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class zc extends XS{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:we._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new zc(this._viewParameters);return e.updateAll(this),e}}class pp extends Ie{static _type="ink";static _editorType=Le.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){we.initialize(e,t),this._defaultDrawingOptions=new zc(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ge(this,"typesMap",new Map([[ze.INK_THICKNESS,"stroke-width"],[ze.INK_COLOR,"stroke"],[ze.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,r){return new _M(e,t,n,s,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,r,l){return Pa.deserialize(e,t,n,s,r,l)}static async deserialize(e,t,n){let s=null;if(e instanceof fp){const{data:{inkLists:l,rect:c,rotation:f,id:d,color:g,opacity:v,borderStyle:{rawWidth:b},popupRef:C,contentsObj:E},parent:{page:{pageNumber:A}}}=e;s=e={annotationType:Le.INK,color:Array.from(g),thickness:b,opacity:v,paths:{points:l},boxes:null,pageIndex:A-1,rect:c.slice(0),rotation:f,annotationElementId:d,id:d,deleted:!1,popupRef:C,comment:E?.str||null}}const r=await super.deserialize(e,t,n);return r._initialData=s,e.comment&&r.setCommentData(e.comment),r}get toolbarButtons(){return this._colorPicker||=new Ca(this),[["colorPicker",this._colorPicker]]}get colorType(){return ze.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=pp.getDefaultDrawingOptions({stroke:_e.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,f={annotationType:Le.INK,color:we._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:t,points:n},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(f),e?(f.isCopy=!0,f):this.annotationElementId&&!this.#e(f)?null:(f.id=this.annotationElementId,f)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((l,c)=>l!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==r}renderAnnotationElement(e){const{points:t,rect:n}=this.serializeDraw(!1),s={rect:n,thickness:this._drawingOptions["stroke-width"],points:t};return this.hasEditedComment&&(s.popup=this.comment),e.updateEdited(s),null}}class _h extends Pa{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const oc=8,ca=3;class Vo{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(e,t,n,s,r,l,c){const f=this.#t(n,s,r,l);for(let d=0;d<8;d++){const g=(-d+f-c+16)%8,v=this.#n[2*g],b=this.#n[2*g+1];if(e[(n+v)*t+(s+b)]!==0)return g}return-1}static#o(e,t,n,s,r,l,c){const f=this.#t(n,s,r,l);for(let d=0;d<8;d++){const g=(d+f+c+16)%8,v=this.#n[2*g],b=this.#n[2*g+1];if(e[(n+v)*t+(s+b)]!==0)return g}return-1}static#s(e,t,n,s){const r=e.length,l=new Int32Array(r);for(let g=0;g<r;g++)l[g]=e[g]<=s?1:0;for(let g=1;g<n-1;g++)l[g*t]=l[g*t+t-1]=0;for(let g=0;g<t;g++)l[g]=l[t*n-1-g]=0;let c=1,f;const d=[];for(let g=1;g<n-1;g++){f=1;for(let v=1;v<t-1;v++){const b=g*t+v,C=l[b];if(C===0)continue;let E=g,A=v;if(C===1&&l[b-1]===0)c+=1,A-=1;else if(C>=1&&l[b+1]===0)c+=1,A+=1,C>1&&(f=C);else{C!==1&&(f=Math.abs(C));continue}const _=[v,g],w=A===v+1,N={isHole:w,points:_,id:c,parent:0};d.push(N);let M;for(const K of d)if(K.id===f){M=K;break}M?M.isHole?N.parent=w?M.parent:f:N.parent=w?f:M.parent:N.parent=w?f:0;const k=this.#i(l,t,g,v,E,A,0);if(k===-1){l[b]=-c,l[b]!==1&&(f=Math.abs(l[b]));continue}let R=this.#n[2*k],I=this.#n[2*k+1];const P=g+R,q=v+I;E=P,A=q;let F=g,$=v;for(;;){const K=this.#o(l,t,F,$,E,A,1);R=this.#n[2*K],I=this.#n[2*K+1];const ne=F+R,ae=$+I;_.push(ae,ne);const ce=F*t+$;if(l[ce+1]===0?l[ce]=-c:l[ce]===1&&(l[ce]=c),ne===g&&ae===v&&F===P&&$===q){l[b]!==1&&(f=Math.abs(l[b]));break}else E=F,A=$,F=ne,$=ae}}}return d}static#r(e,t,n,s){if(n-t<=4){for(let P=t;P<n-2;P+=2)s.push(e[P],e[P+1]);return}const r=e[t],l=e[t+1],c=e[n-4]-r,f=e[n-3]-l,d=Math.hypot(c,f),g=c/d,v=f/d,b=g*l-v*r,C=f/c,E=1/d,A=Math.atan(C),_=Math.cos(A),w=Math.sin(A),N=E*(Math.abs(_)+Math.abs(w)),M=E*(1-N+N**2),k=Math.max(Math.atan(Math.abs(w+_)*M),Math.atan(Math.abs(w-_)*M));let R=0,I=t;for(let P=t+2;P<n-2;P+=2){const q=Math.abs(b-g*e[P+1]+v*e[P]);q>R&&(I=P,R=q)}R>(d*k)**2?(this.#r(e,t,I+2,s),this.#r(e,I,n,s)):s.push(r,l)}static#a(e){const t=[],n=e.length;return this.#r(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#u(e,t,n,s,r,l){const c=new Float32Array(l**2),f=-2*s**2,d=l>>1;for(let A=0;A<l;A++){const _=(A-d)**2;for(let w=0;w<l;w++)c[A*l+w]=Math.exp((_+(w-d)**2)/f)}const g=new Float32Array(256),v=-2*r**2;for(let A=0;A<256;A++)g[A]=Math.exp(A**2/v);const b=e.length,C=new Uint8Array(b),E=new Uint32Array(256);for(let A=0;A<n;A++)for(let _=0;_<t;_++){const w=A*t+_,N=e[w];let M=0,k=0;for(let I=0;I<l;I++){const P=A+I-d;if(!(P<0||P>=n))for(let q=0;q<l;q++){const F=_+q-d;if(F<0||F>=t)continue;const $=e[P*t+F],K=c[I*l+q]*g[Math.abs($-N)];M+=$*K,k+=K}}const R=C[w]=Math.round(M/k);E[R]++}return[C,E]}static#c(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#f(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let c=0,f=n.length;c<f;c++){const d=n[c]=e[c<<2];s=Math.max(s,d),r=Math.min(r,d)}const l=255/(s-r);for(let c=0,f=n.length;c<f;c++)n[c]=(n[c]-r)*l;return n}static#l(e){let t,n=-1/0,s=-1/0;const r=e.findIndex(f=>f!==0);let l=r,c=r;for(t=r;t<256;t++){const f=e[t];f>n&&(t-l>s&&(s=t-l,c=t-1),n=f,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#p(e){const t=e,{width:n,height:s}=e,{maxDim:r}=this.#e;let l=n,c=s;if(n>r||s>r){let b=n,C=s,E=Math.log2(Math.max(n,s)/r);const A=Math.floor(E);E=E===A?A-1:A;for(let w=0;w<E;w++){l=Math.ceil(b/2),c=Math.ceil(C/2);const N=new OffscreenCanvas(l,c);N.getContext("2d").drawImage(e,0,0,b,C,0,0,l,c),b=l,C=c,e!==t&&e.close(),e=N.transferToImageBitmap()}const _=Math.min(r/l,r/c);l=Math.round(l*_),c=Math.round(c*_)}const d=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,c),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,l,c);const g=d.getImageData(0,0,l,c).data;return[this.#f(g),l,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},r,l,c,f){let d=new OffscreenCanvas(1,1),g=d.getContext("2d",{alpha:!1});const v=200,b=g.font=`${n} ${s} ${v}px ${t}`,{actualBoundingBoxLeft:C,actualBoundingBoxRight:E,actualBoundingBoxAscent:A,actualBoundingBoxDescent:_,fontBoundingBoxAscent:w,fontBoundingBoxDescent:N,width:M}=g.measureText(e),k=1.5,R=Math.ceil(Math.max(Math.abs(C)+Math.abs(E)||0,M)*k),I=Math.ceil(Math.max(Math.abs(A)+Math.abs(_)||v,Math.abs(w)+Math.abs(N)||v)*k);d=new OffscreenCanvas(R,I),g=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,R,I),g.fillStyle="black",g.fillText(e,R*(k-1)/2,I*(3-k)/2);const P=this.#f(g.getImageData(0,0,R,I).data),q=this.#c(P),F=this.#l(q),$=this.#s(P,R,I,F);return this.processDrawnLines({lines:{curves:$,width:R,height:I},pageWidth:r,pageHeight:l,rotation:c,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,r){const[l,c,f]=this.#p(e),[d,g]=this.#u(l,c,f,Math.hypot(c,f)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),v=this.#l(g),b=this.#s(d,c,f,v);return this.processDrawnLines({lines:{curves:b,width:c,height:f},pageWidth:t,pageHeight:n,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:r,mustSmooth:l,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:f,width:d,height:g}=e,v=e.thickness??0,b=[],C=Math.min(t/d,n/g),E=C/t,A=C/n,_=[];for(const{points:N}of f){const M=l?this.#a(N):N;if(!M)continue;_.push(M);const k=M.length,R=new Float32Array(k),I=new Float32Array(3*(k===2?2:k-2));if(b.push({line:I,points:R}),k===2){R[0]=M[0]*E,R[1]=M[1]*A,I.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[P,q,F,$]=M;P*=E,q*=A,F*=E,$*=A,R.set([P,q,F,$],0),I.set([NaN,NaN,NaN,NaN,P,q],0);for(let K=4;K<k;K+=2){const ne=R[K]=M[K]*E,ae=R[K+1]=M[K+1]*A;I.set(ve.createBezierPoints(P,q,F,$,ne,ae),(K-2)*3),[P,q,F,$]=[F,$,ne,ae]}}if(b.length===0)return null;const w=c?new _h:new Pa;return w.build(b,t,n,1,s,c?0:v,r),{outline:w,newCurves:_,areContours:c,thickness:v,width:d,height:g}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:r}){let l=1/0,c=-1/0,f=0;for(const M of e){f+=M.length;for(let k=2,R=M.length;k<R;k++){const I=M[k]-M[k-2];l=Math.min(l,I),c=Math.max(c,I)}}let d;l>=-128&&c<=127?d=Int8Array:l>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const g=e.length,v=oc+ca*g,b=new Uint32Array(v);let C=0;b[C++]=v*Uint32Array.BYTES_PER_ELEMENT+(f-2*g)*d.BYTES_PER_ELEMENT,b[C++]=0,b[C++]=s,b[C++]=r,b[C++]=t?0:1,b[C++]=Math.max(0,Math.floor(n??0)),b[C++]=g,b[C++]=d.BYTES_PER_ELEMENT;for(const M of e)b[C++]=M.length-2,b[C++]=M[0],b[C++]=M[1];const E=new CompressionStream("deflate-raw"),A=E.writable.getWriter();await A.ready,A.write(b);const _=d.prototype.constructor;for(const M of e){const k=new _(M.length-2);for(let R=2,I=M.length;R<I;R++)k[R-2]=M[R]-M[R-2];A.write(k)}A.close();const w=await new Response(E.readable).arrayBuffer(),N=new Uint8Array(w);return ES(N)}static async decompressSignature(e){try{const t=Ww(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let l=null,c=0;for await(const M of n)l||=new Uint8Array(new Uint32Array(M.buffer,0,4)[0]),l.set(M,c),c+=M.length;const f=new Uint32Array(l.buffer,0,l.length>>2),d=f[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const g=f[2],v=f[3],b=f[4]===0,C=f[5],E=f[6],A=f[7],_=[],w=(oc+ca*E)*Uint32Array.BYTES_PER_ELEMENT;let N;switch(A){case Int8Array.BYTES_PER_ELEMENT:N=new Int8Array(l.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:N=new Int16Array(l.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:N=new Int32Array(l.buffer,w);break}c=0;for(let M=0;M<E;M++){const k=f[ca*M+oc],R=new Float32Array(k+2);_.push(R);for(let I=0;I<ca-1;I++)R[I]=f[ca*M+oc+I+1];for(let I=0;I<k;I++)R[I+2]=R[I]+N[c++]}return{areContours:b,thickness:C,outlines:_,width:g,height:v}}catch(t){return Pe(`decompressSignature: ${t}`),null}}}class mp extends XS{constructor(){super(),super.updateProperties({fill:we._defaultLineColor,"stroke-width":0})}clone(){const e=new mp;return e.updateAll(this),e}}class gp extends zc{constructor(e){super(e),super.updateProperties({stroke:we._defaultLineColor,"stroke-width":1})}clone(){const e=new gp(this._viewParameters);return e.updateAll(this),e}}class ni extends Ie{#e=!1;#t=null;#n=null;#i=null;static _type="signature";static _editorType=Le.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){we.initialize(e,t),this._defaultDrawingOptions=new mp,this._defaultDrawnSignatureOptions=new gp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ge(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:s,mustSmooth:r,areContours:l,description:c,uuid:f,heightInPage:d}=this.#n,{rawDims:{pageWidth:g,pageHeight:v},rotation:b}=this.parent.viewport,C=Vo.processDrawnLines({lines:s,pageWidth:g,pageHeight:v,rotation:b,innerMargin:ni._INNER_MARGIN,mustSmooth:r,areContours:l});this.addSignature(C,d,c,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#i=e,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:r}=this.#n,l=Math.max(s,r),c=Vo.processDrawnLines({lines:{curves:e.map(f=>({points:f})),thickness:n,width:s,height:r},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:r,y:l}=this,{outline:c}=this.#n=e;this.#e=c instanceof _h,this.description=n;let f;this.#e?f=ni.getDefaultDrawingOptions():(f=ni._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:f});const[d,g]=this.parentDimensions,[,v]=this.pageDimensions;let b=t/v;b=b>=1?.5:b,this.width*=b/this.height,this.width>=1&&(b*=.9/this.width,this.width=.9),this.height=b,this.setDims(d*this.width,g*this.height),this.x=r,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return Vo.process(e,t,n,s,ni._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:r}=this.parent.viewport;return Vo.extractContoursFromText(e,t,n,s,r,ni._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return Vo.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:ni._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=ni.getDefaultDrawingOptions():(this._drawingOptions=ni._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n,rect:s}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,l={annotationType:Le.SIGNATURE,isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:r,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(l),e?(l.paths={lines:t,points:n},l.uuid=this.#i,l.isCopy=!0):l.lines=t,this.#t&&(l.accessibilityData={type:"Figure",alt:this.#t}),l}static deserializeDraw(e,t,n,s,r,l){return l.areContours?_h.deserialize(e,t,n,s,r,l):Pa.deserialize(e,t,n,s,r,l)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#i=e.uuid,s}}class TM extends we{#e=null;#t=null;#n=null;#i=null;#o=null;#s="";#r=null;#a=!1;#u=null;#c=!1;#f=!1;static _type="stamp";static _editorType=Le.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#i=e.bitmapUrl,this.#o=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){we.initialize(e,t)}static isHandlingMimeForPasting(e){return yh.includes(e)}static paste(e,t){t.pasteEditor({mode:Le.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#l(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#c=e.isSvg),e.file&&(this.#s=e.file.name),this.#h()}#p(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:r,height:l}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:r,height:l,channels:s.length/(r*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const f=c.output;return await this.setGuessedAltText(f),t&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#l(n,!0)).finally(()=>this.#p());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#l(s)).finally(()=>this.#p());return}if(this.#o){const n=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(s=>this.#l(s)).finally(()=>this.#p());return}const e=document.createElement("input");e.type="file",e.accept=yh.join(",");const t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#l(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#p()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#r?.remove(),this.#r=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#r===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#o||this.#t||this.#a)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#a||(this.#e?this.#h():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#a=!1,this.#h())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#u!==null&&clearTimeout(this.#u);const e=200;this.#u=setTimeout(()=>{this.#u=null,this.#m()},e)}#h(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,r]=this.pageDimensions,l=.75;if(this.width)t=this.width*s,n=this.height*r;else if(t>l*s||n>l*r){const g=Math.min(l*s/t,l*r/n);t*=g,n*=g}const[c,f]=this.parentDimensions;this.setDims(t*c/s,n*f/r),this._uiManager.enableWaiting(!1);const d=this.#r=document.createElement("canvas");d.setAttribute("role","img"),this.addContainer(d),this.width=t/s,this.height=n/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:r}=this.#e,l=new ai;let c=this.#e,f=s,d=r,g=null;if(t){if(s>t||r>t){const I=Math.min(t/s,t/r);f=Math.floor(s*I),d=Math.floor(r*I)}g=document.createElement("canvas");const b=g.width=Math.ceil(f*l.sx),C=g.height=Math.ceil(d*l.sy);this.#c||(c=this.#d(b,C));const E=g.getContext("2d");E.filter=this._uiManager.hcmFilter;let A="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",_="#42414d");const w=15,N=w*l.sx,M=w*l.sy,k=new OffscreenCanvas(N*2,M*2),R=k.getContext("2d");R.fillStyle=A,R.fillRect(0,0,N*2,M*2),R.fillStyle=_,R.fillRect(0,0,N,M),R.fillRect(N,M,N,M),E.fillStyle=E.createPattern(k,"repeat"),E.fillRect(0,0,b,C),E.drawImage(c,0,0,c.width,c.height,0,0,b,C)}let v=null;if(n){let b,C;if(l.symmetric&&c.width<e&&c.height<e)b=c.width,C=c.height;else if(c=this.#e,s>e||r>e){const _=Math.min(e/s,e/r);b=Math.floor(s*_),C=Math.floor(r*_),this.#c||(c=this.#d(b,C))}const A=new OffscreenCanvas(b,C).getContext("2d",{willReadFrequently:!0});A.drawImage(c,0,0,c.width,c.height,0,0,b,C),v={width:b,height:C,data:A.getImageData(0,0,b,C).data}}return{canvas:g,width:f,height:d,imageData:v}}#d(e,t){const{width:n,height:s}=this.#e;let r=n,l=s,c=this.#e;for(;r>2*e||l>2*t;){const f=r,d=l;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(r,l);g.getContext("2d").drawImage(c,0,0,f,d,0,0,r,l),c=g.transferToImageBitmap()}return c}#m(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,r=new ai,l=Math.ceil(n*e*r.sx),c=Math.ceil(s*t*r.sy),f=this.#r;if(!f||f.width===l&&f.height===c)return;f.width=l,f.height=c;const d=this.#c?this.#e:this.#d(l,c),g=f.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(d,0,0,d.width,d.height,0,0,l,c)}#x(e){if(e){if(this.#c){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#c){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*Jo.PDF_TO_CSS_UNITS),r=Math.round(this.height*n*Jo.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,r);return l.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,r),l.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,r=!1;if(e instanceof WS){const{data:{rect:A,rotation:_,id:w,structParent:N,popupRef:M,contentsObj:k},container:R,parent:{page:{pageNumber:I}},canvas:P}=e;let q,F;P?(delete e.canvas,{id:q,bitmap:F}=n.imageManager.getFromCanvas(R.id,P),P.remove()):(r=!0,e._hasNoCanvas=!0);const $=(await t._structTree.getAriaAttributes(`${tp}${w}`))?.get("aria-label")||"";s=e={annotationType:Le.STAMP,bitmapId:q,bitmap:F,pageIndex:I-1,rect:A.slice(0),rotation:_,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:$},isSvg:!1,structParent:N,popupRef:M,comment:k?.str||null}}const l=await super.deserialize(e,t,n),{rect:c,bitmap:f,bitmapUrl:d,bitmapId:g,isSvg:v,accessibilityData:b}=e;r?(n.addMissingCanvas(e.id,l),l.#a=!0):g&&n.imageManager.isValidId(g)?(l.#t=g,f&&(l.#e=f)):l.#i=d,l.#c=v;const[C,E]=l.pageDimensions;return l.width=(c[2]-c[0])/C,l.height=(c[3]-c[1])/E,b&&(l.altTextData=b),l._initialData=s,e.comment&&l.setCommentData(e.comment),l.#f=!!s,l}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Le.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(n),e)return n.bitmapUrl=this.#x(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:r}=this.serializeAltText(!1);if(!s&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const c=this.#y(n);if(c.isSame)return null;c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,t===null)return n;t.stamps||=new Map;const l=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:l,serialized:n}),n.bitmap=this.#x(!1);else if(this.#c){const c=t.stamps.get(this.#t);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#x(!1))}return n}#y(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,r=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}renderAnnotationElement(e){const t={rect:this.getRect(0,0)};return this.hasEditedComment&&(t.popup=this.comment),e.updateEdited(t),null}}class wi{#e;#t=!1;#n=null;#i=null;#o=null;#s=new Map;#r=!1;#a=!1;#u=!1;#c=null;#f=null;#l=null;#p=null;#g=null;#h=-1;#d;static _initialized=!1;static#m=new Map([Pt,pp,TM,At,ni].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:r,annotationLayer:l,drawLayer:c,textLayer:f,viewport:d,l10n:g}){const v=[...wi.#m.values()];if(!wi._initialized){wi._initialized=!0;for(const b of v)b.initialize(g,e)}e.registerEditorTypes(v),this.#d=e,this.pageIndex=t,this.div=n,this.#e=r,this.#n=l,this.viewport=d,this.#l=f,this.drawLayer=c,this._structTree=s,this.#d.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#d.getMode()===Le.NONE}updateToolbar(e){this.#d.updateToolbar(e)}updateMode(e=this.#d.getMode()){switch(this.#v(),e){case Le.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Le.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Le.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of wi.#m.values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#l?.div}setEditingState(e){this.#d.setEditingState(e)}addCommands(e){this.#d.addCommands(e)}cleanUndoStack(e){this.#d.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const e=new Set;for(const n of this.#s.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#d.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!this.#n){this.#u=!1;return}const t=this.#n.getEditableAnnotations();for(const n of t){if(n.hide(),this.#d.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#u=!1}disable(){if(this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#l&&!this.#g){this.#g=new AbortController;const s=this.#d.combinedSignal(this.#g);this.#l.div.addEventListener("pointerdown",r=>{const{clientX:c,clientY:f,timeStamp:d}=r,g=this.#h;if(d-g>500){this.#h=d;return}this.#h=-1;const{classList:v}=this.div;v.toggle("getElements",!0);const b=document.elementsFromPoint(c,f);if(v.toggle("getElements",!1),!this.div.contains(b[0]))return;let C;const E=new RegExp(`^${xS}[0-9]+$`);for(const _ of b)if(E.test(_.id)){C=_.id;break}if(!C)return;const A=this.#s.get(C);A?.annotationElementId===null&&(r.stopPropagation(),r.preventDefault(),A.dblclick())},{signal:s,capture:!0})}const e=new Map,t=new Map;for(const s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const r of s){const{id:l}=r.data;if(this.#d.isDeletedAnnotationElement(l)){r.updateEdited({deleted:!0});continue}let c=t.get(l);if(c){c.resetAnnotationElement(r),c.show(!1),r.show();continue}c=e.get(l),c&&(this.#d.addChangedExistingAnnotation(c),c.renderAnnotationElement(r)&&c.show(!1)),r.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of wi.#m.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#a=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#d.getActive()!==e&&this.#d.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#l?.div&&!this.#p){this.#p=new AbortController;const e=this.#d.combinedSignal(this.#p);this.#l.div.addEventListener("pointerdown",this.#x.bind(this),{signal:e}),this.#l.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#l?.div&&this.#p&&(this.#p.abort(),this.#p=null,this.#l.div.classList.remove("highlighting"))}#x(e){this.#d.unselectAll();const{target:t}=e;if(t===this.#l.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#l.div.contains(t)){const{isMac:n}=zt.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#d.showAllEditors("highlight",!0,!0),this.#l.div.classList.add("free"),this.toggleDrawing(),At.startHighlighting(this,this.#d.direction==="ltr",{target:this.#l.div,x:e.x,y:e.y}),this.#l.div.addEventListener("pointerup",()=>{this.#l.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#d._signal}),e.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const e=this.#d.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#i?.abort(),this.#i=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#d.isDeletedAnnotationElement(t)&&this.#d.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#a&&e.annotationElementId&&this.#d.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#d.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#d.addDeletedAnnotationElement(e.annotationElementId),we.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#d.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#u),this.#d.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#o&&(e._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#d._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return this.#d.getId()}get#y(){return wi.#m.get(this.#d.getMode())}combinedSignal(e){return this.#d.combinedSignal(e)}#S(e){const t=this.#y;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#d.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#C(),r=this.getNextId(),l=this.#S({parent:this,id:r,x:n,y:s,uiManager:this.#d,isCentered:!0,...t});l&&this.add(l)}async deserialize(e){return await wi.#m.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#d)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),r=this.#S({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#d,isCentered:t,...n});return r&&this.add(r),r}#C(){const{x:e,y:t,width:n,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),f=Math.min(window.innerHeight,t+s),d=(r+c)/2-e,g=(l+f)/2-t,[v,b]=this.viewport.rotation%180===0?[d,g]:[g,d];return{offsetX:v,offsetY:b}}addNewEditor(e={}){this.createAndAddNewEditor(this.#C(),!0,e)}setSelected(e){this.#d.setSelected(e)}toggleSelected(e){this.#d.toggleSelected(e)}unselect(e){this.#d.unselect(e)}pointerup(e){const{isMac:t}=zt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#r||(this.#r=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#d.getMode();if(n===Le.STAMP||n===Le.SIGNATURE){this.#d.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#d.getMode()===Le.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:t}=zt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#r=!0,this.#y?.isDrawer){this.startDrawingSession(e);return}const n=this.#d.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#c){this.#y.startDrawing(this,this.#d,!1,e);return}this.#d.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#d.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#f=null,this.commitOrRemove())},{signal:t}),this.#y.startDrawing(this,this.#d,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#f=t);return}this.#f&&setTimeout(()=>{this.#f?.focus(),this.#f=null},0)}endDrawingSession(e=!1){return this.#c?(this.#d.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#f=null,this.#y.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#d.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#d.getActive()?.parent===this&&(this.#d.commitOrRemove(),this.#d.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#d.removeLayer(this)}#v(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Vs(this.div,e);for(const t of this.#d.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#d.commitOrRemove(),this.#v();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Vs(this.div,{rotation:n}),t!==n)for(const s of this.#s.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#d.viewParameters.realScale}}class Ht{#e=null;#t=new Map;#n=new Map;static#i=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Ge(this,"_svgFactory",new wc)}static#o(e,[t,n,s,r]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*r}%`}#s(){const e=Ht._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#r(e,t){const n=Ht._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const r=Ht._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s}#a(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=Ht.#i++,r=this.#s(),l=Ht._svgFactory.createElement("defs");r.append(l);const c=Ht._svgFactory.createElement("path");l.append(c);const f=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",f),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(s,c);const d=n?this.#r(l,f):null,g=Ht._svgFactory.createElement("use");return r.append(g),g.setAttribute("href",`#${f}`),this.updateProperties(r,e),this.#t.set(s,r),{id:s,clipPathId:`url(#${d})`}}drawOutline(e,t){const n=Ht.#i++,s=this.#s(),r=Ht._svgFactory.createElement("defs");s.append(r);const l=Ht._svgFactory.createElement("path");r.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let f;if(t){const v=Ht._svgFactory.createElement("mask");r.append(v),f=`mask_p${this.pageIndex}_${n}`,v.setAttribute("id",f),v.setAttribute("maskUnits","objectBoundingBox");const b=Ht._svgFactory.createElement("rect");v.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const C=Ht._svgFactory.createElement("use");v.append(C),C.setAttribute("href",`#${c}`),C.setAttribute("stroke","none"),C.setAttribute("fill","black"),C.setAttribute("fill-rule","nonzero"),C.classList.add("mask")}const d=Ht._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${c}`),f&&d.setAttribute("mask",`url(#${f})`);const g=d.cloneNode();return s.append(g),d.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:r,path:l}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#a(c,n),s&&Ht.#o(c,s),r){const{classList:f}=c;for(const[d,g]of Object.entries(r))f.toggle(d,g)}if(l){const d=c.firstChild.firstChild;this.#a(d,l)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Ah};globalThis.pdfjsLib={AbortException:fs,AnnotationEditorLayer:wi,AnnotationEditorParamsType:ze,AnnotationEditorType:Le,AnnotationEditorUIManager:hs,AnnotationLayer:hp,AnnotationMode:ls,AnnotationType:Nt,build:iM,ColorPicker:Fn,createValidAbsoluteUrl:bS,DOMSVGFactory:wc,DrawLayer:Ht,FeatureTest:zt,fetchData:Ia,getDocument:Sh,getFilenameFromUrl:Kw,getPdfFilenameFromUrl:Xw,getRGB:qc,getUuid:AS,getXfaPageViewport:Qw,GlobalWorkerOptions:Bs,ImageKind:hc,InvalidPDFException:mh,isDataScheme:Gc,isPdfFile:ip,isValidExplicitDest:c1,MathClamp:sn,noContextMenu:Bn,normalizeUnicode:$w,OPS:_c,OutputScale:ai,PasswordResponses:Ow,PDFDataRangeTransport:VS,PDFDateString:gh,PDFWorker:Sa,PermissionFlag:Fw,PixelsPerInch:Jo,RenderingCancelledException:np,ResponseException:Tc,setLayerDimensions:Vs,shadow:Ge,SignatureExtractor:Vo,stopEvent:Rt,SupportedImageMimeTypes:yh,TextLayer:en,TouchManager:Hc,updateUrlHash:SS,Util:_e,VerbosityLevel:Uc,version:nM,XfaLayer:HS};var Pf={exports:{}},vv;function wM(){return vv||(vv=1,function(i){var e=function(t){var n=Object.prototype,s=n.hasOwnProperty,r=Object.defineProperty||function(te,L,V){te[L]=V.value},l,c=typeof Symbol=="function"?Symbol:{},f=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",g=c.toStringTag||"@@toStringTag";function v(te,L,V){return Object.defineProperty(te,L,{value:V,enumerable:!0,configurable:!0,writable:!0}),te[L]}try{v({},"")}catch{v=function(L,V,W){return L[V]=W}}function b(te,L,V,W){var z=L&&L.prototype instanceof M?L:M,le=Object.create(z.prototype),xe=new U(W||[]);return r(le,"_invoke",{value:ne(te,V,xe)}),le}t.wrap=b;function C(te,L,V){try{return{type:"normal",arg:te.call(L,V)}}catch(W){return{type:"throw",arg:W}}}var E="suspendedStart",A="suspendedYield",_="executing",w="completed",N={};function M(){}function k(){}function R(){}var I={};v(I,f,function(){return this});var P=Object.getPrototypeOf,q=P&&P(P(X([])));q&&q!==n&&s.call(q,f)&&(I=q);var F=R.prototype=M.prototype=Object.create(I);k.prototype=R,r(F,"constructor",{value:R,configurable:!0}),r(R,"constructor",{value:k,configurable:!0}),k.displayName=v(R,g,"GeneratorFunction");function $(te){["next","throw","return"].forEach(function(L){v(te,L,function(V){return this._invoke(L,V)})})}t.isGeneratorFunction=function(te){var L=typeof te=="function"&&te.constructor;return L?L===k||(L.displayName||L.name)==="GeneratorFunction":!1},t.mark=function(te){return Object.setPrototypeOf?Object.setPrototypeOf(te,R):(te.__proto__=R,v(te,g,"GeneratorFunction")),te.prototype=Object.create(F),te},t.awrap=function(te){return{__await:te}};function K(te,L){function V(le,xe,he,Ee){var Ne=C(te[le],te,xe);if(Ne.type==="throw")Ee(Ne.arg);else{var Te=Ne.arg,ke=Te.value;return ke&&typeof ke=="object"&&s.call(ke,"__await")?L.resolve(ke.__await).then(function($e){V("next",$e,he,Ee)},function($e){V("throw",$e,he,Ee)}):L.resolve(ke).then(function($e){Te.value=$e,he(Te)},function($e){return V("throw",$e,he,Ee)})}}var W;function z(le,xe){function he(){return new L(function(Ee,Ne){V(le,xe,Ee,Ne)})}return W=W?W.then(he,he):he()}r(this,"_invoke",{value:z})}$(K.prototype),v(K.prototype,d,function(){return this}),t.AsyncIterator=K,t.async=function(te,L,V,W,z){z===void 0&&(z=Promise);var le=new K(b(te,L,V,W),z);return t.isGeneratorFunction(L)?le:le.next().then(function(xe){return xe.done?xe.value:le.next()})};function ne(te,L,V){var W=E;return function(le,xe){if(W===_)throw new Error("Generator is already running");if(W===w){if(le==="throw")throw xe;return de()}for(V.method=le,V.arg=xe;;){var he=V.delegate;if(he){var Ee=ae(he,V);if(Ee){if(Ee===N)continue;return Ee}}if(V.method==="next")V.sent=V._sent=V.arg;else if(V.method==="throw"){if(W===E)throw W=w,V.arg;V.dispatchException(V.arg)}else V.method==="return"&&V.abrupt("return",V.arg);W=_;var Ne=C(te,L,V);if(Ne.type==="normal"){if(W=V.done?w:A,Ne.arg===N)continue;return{value:Ne.arg,done:V.done}}else Ne.type==="throw"&&(W=w,V.method="throw",V.arg=Ne.arg)}}}function ae(te,L){var V=L.method,W=te.iterator[V];if(W===l)return L.delegate=null,V==="throw"&&te.iterator.return&&(L.method="return",L.arg=l,ae(te,L),L.method==="throw")||V!=="return"&&(L.method="throw",L.arg=new TypeError("The iterator does not provide a '"+V+"' method")),N;var z=C(W,te.iterator,L.arg);if(z.type==="throw")return L.method="throw",L.arg=z.arg,L.delegate=null,N;var le=z.arg;if(!le)return L.method="throw",L.arg=new TypeError("iterator result is not an object"),L.delegate=null,N;if(le.done)L[te.resultName]=le.value,L.next=te.nextLoc,L.method!=="return"&&(L.method="next",L.arg=l);else return le;return L.delegate=null,N}$(F),v(F,g,"Generator"),v(F,f,function(){return this}),v(F,"toString",function(){return"[object Generator]"});function ce(te){var L={tryLoc:te[0]};1 in te&&(L.catchLoc=te[1]),2 in te&&(L.finallyLoc=te[2],L.afterLoc=te[3]),this.tryEntries.push(L)}function me(te){var L=te.completion||{};L.type="normal",delete L.arg,te.completion=L}function U(te){this.tryEntries=[{tryLoc:"root"}],te.forEach(ce,this),this.reset(!0)}t.keys=function(te){var L=Object(te),V=[];for(var W in L)V.push(W);return V.reverse(),function z(){for(;V.length;){var le=V.pop();if(le in L)return z.value=le,z.done=!1,z}return z.done=!0,z}};function X(te){if(te){var L=te[f];if(L)return L.call(te);if(typeof te.next=="function")return te;if(!isNaN(te.length)){var V=-1,W=function z(){for(;++V<te.length;)if(s.call(te,V))return z.value=te[V],z.done=!1,z;return z.value=l,z.done=!0,z};return W.next=W}}return{next:de}}t.values=X;function de(){return{value:l,done:!0}}return U.prototype={constructor:U,reset:function(te){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(me),!te)for(var L in this)L.charAt(0)==="t"&&s.call(this,L)&&!isNaN(+L.slice(1))&&(this[L]=l)},stop:function(){this.done=!0;var te=this.tryEntries[0],L=te.completion;if(L.type==="throw")throw L.arg;return this.rval},dispatchException:function(te){if(this.done)throw te;var L=this;function V(Ee,Ne){return le.type="throw",le.arg=te,L.next=Ee,Ne&&(L.method="next",L.arg=l),!!Ne}for(var W=this.tryEntries.length-1;W>=0;--W){var z=this.tryEntries[W],le=z.completion;if(z.tryLoc==="root")return V("end");if(z.tryLoc<=this.prev){var xe=s.call(z,"catchLoc"),he=s.call(z,"finallyLoc");if(xe&&he){if(this.prev<z.catchLoc)return V(z.catchLoc,!0);if(this.prev<z.finallyLoc)return V(z.finallyLoc)}else if(xe){if(this.prev<z.catchLoc)return V(z.catchLoc,!0)}else if(he){if(this.prev<z.finallyLoc)return V(z.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(te,L){for(var V=this.tryEntries.length-1;V>=0;--V){var W=this.tryEntries[V];if(W.tryLoc<=this.prev&&s.call(W,"finallyLoc")&&this.prev<W.finallyLoc){var z=W;break}}z&&(te==="break"||te==="continue")&&z.tryLoc<=L&&L<=z.finallyLoc&&(z=null);var le=z?z.completion:{};return le.type=te,le.arg=L,z?(this.method="next",this.next=z.finallyLoc,N):this.complete(le)},complete:function(te,L){if(te.type==="throw")throw te.arg;return te.type==="break"||te.type==="continue"?this.next=te.arg:te.type==="return"?(this.rval=this.arg=te.arg,this.method="return",this.next="end"):te.type==="normal"&&L&&(this.next=L),N},finish:function(te){for(var L=this.tryEntries.length-1;L>=0;--L){var V=this.tryEntries[L];if(V.finallyLoc===te)return this.complete(V.completion,V.afterLoc),me(V),N}},catch:function(te){for(var L=this.tryEntries.length-1;L>=0;--L){var V=this.tryEntries[L];if(V.tryLoc===te){var W=V.completion;if(W.type==="throw"){var z=W.arg;me(V)}return z}}throw new Error("illegal catch attempt")},delegateYield:function(te,L,V){return this.delegate={iterator:X(te),resultName:L,nextLoc:V},this.method==="next"&&(this.arg=l),N}},t}(i.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(Pf)),Pf.exports}var Ff,xv;function yp(){return xv||(xv=1,Ff=(i,e)=>`${i}-${e}-${Math.random().toString(16).slice(3,8)}`),Ff}var Of,bv;function JS(){if(bv)return Of;bv=1;const i=yp();let e=0;return Of=({id:t,action:n,payload:s={}})=>{let r=t;return typeof r>"u"&&(r=i("Job",e),e+=1),{id:r,action:n,payload:s}},Of}var ua={},Sv;function vp(){if(Sv)return ua;Sv=1;let i=!1;return ua.logging=i,ua.setLogging=e=>{i=e},ua.log=(...e)=>i?console.log.apply(this,e):null,ua}var Uf,Cv;function MM(){if(Cv)return Uf;Cv=1;const i=JS(),{log:e}=vp(),t=yp();let n=0;return Uf=()=>{const s=t("Scheduler",n),r={},l={};let c=[];n+=1;const f=()=>c.length,d=()=>Object.keys(r).length,g=()=>{if(c.length!==0){const A=Object.keys(r);for(let _=0;_<A.length;_+=1)if(typeof l[A[_]]>"u"){c[0](r[A[_]]);break}}},v=(A,_)=>new Promise((w,N)=>{const M=i({action:A,payload:_});c.push(async k=>{c.shift(),l[k.id]=M;try{w(await k[A].apply(this,[..._,M.id]))}catch(R){N(R)}finally{delete l[k.id],g()}}),e(`[${s}]: Add ${M.id} to JobQueue`),e(`[${s}]: JobQueue length=${c.length}`),g()});return{addWorker:A=>(r[A.id]=A,e(`[${s}]: Add ${A.id}`),e(`[${s}]: Number of workers=${d()}`),g(),A.id),addJob:async(A,..._)=>{if(d()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return v(A,_)},terminate:async()=>{Object.keys(r).forEach(async A=>{await r[A].terminate()}),c=[]},getQueueLen:f,getNumWorkers:d}},Uf}function NM(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bf,Av;function RM(){return Av||(Av=1,Bf=i=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof NM=="function"&&(e.type="node"),typeof i>"u"?e:e[i]}),Bf}var Vf,Ev;function IM(){if(Ev)return Vf;Ev=1;const e=RM()("type")==="browser"?t=>new URL(t,window.location.href).href:t=>t;return Vf=t=>{const n={...t};return["corePath","workerPath","langPath"].forEach(s=>{t[s]&&(n[s]=e(n[s]))}),n},Vf}var Gf,_v;function QS(){return _v||(_v=1,Gf={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),Gf}const DM="6.0.1",kM={version:DM};var qf,Tv;function LM(){return Tv||(Tv=1,qf={workerBlobURL:!0,logger:()=>{}}),qf}var Hf,wv;function PM(){if(wv)return Hf;wv=1;const i=kM.version;return Hf={...LM(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${i}/dist/worker.min.js`},Hf}var jf,Mv;function FM(){return Mv||(Mv=1,jf=({workerPath:i,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const n=new Blob([`importScripts("${i}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(n))}else t=new Worker(i);return t}),jf}var zf,Nv;function OM(){return Nv||(Nv=1,zf=i=>{i.terminate()}),zf}var $f,Rv;function UM(){return Rv||(Rv=1,$f=(i,e)=>{i.onmessage=({data:t})=>{e(t)}}),$f}var Yf,Iv;function BM(){return Iv||(Iv=1,Yf=async(i,e)=>{i.postMessage(e)}),Yf}var Wf,Dv;function VM(){if(Dv)return Wf;Dv=1;const i=t=>new Promise((n,s)=>{const r=new FileReader;r.onload=()=>{n(r.result)},r.onerror=({target:{error:{code:l}}})=>{s(Error(`File could not be read! Code=${l}`))},r.readAsArrayBuffer(t)}),e=async t=>{let n=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?n=atob(t.split(",")[1]).split("").map(s=>s.charCodeAt(0)):n=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(n=await e(t.src)),t.tagName==="VIDEO"&&(n=await e(t.poster)),t.tagName==="CANVAS"&&await new Promise(s=>{t.toBlob(async r=>{n=await i(r),s()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const s=await t.convertToBlob();n=await i(s)}else(t instanceof File||t instanceof Blob)&&(n=await i(t));return new Uint8Array(n)};return Wf=e,Wf}var Kf,kv;function GM(){if(kv)return Kf;kv=1;const i=PM(),e=FM(),t=OM(),n=UM(),s=BM(),r=VM();return Kf={defaultOptions:i,spawnWorker:e,terminateWorker:t,onMessage:n,send:s,loadImage:r},Kf}var Xf,Lv;function ZS(){if(Lv)return Xf;Lv=1;const i=IM(),e=JS(),{log:t}=vp(),n=yp(),s=QS(),{defaultOptions:r,spawnWorker:l,terminateWorker:c,onMessage:f,loadImage:d,send:g}=GM();let v=0;return Xf=async(b="eng",C=s.LSTM_ONLY,E={},A={})=>{const _=n("Worker",v),{logger:w,errorHandler:N,...M}=i({...r,...E}),k={},R=typeof b=="string"?b.split("+"):b;let I=C,P=A;const q=[s.DEFAULT,s.LSTM_ONLY].includes(C)&&!M.legacyCore;let F,$;const K=new Promise((Te,ke)=>{$=Te,F=ke}),ne=Te=>{F(Te.message)};let ae=l(M);ae.onerror=ne,v+=1;const ce=({id:Te,action:ke,payload:$e})=>new Promise((ht,xt)=>{t(`[${_}]: Start ${Te}, action=${ke}`);const Dt=`${ke}-${Te}`;k[Dt]={resolve:ht,reject:xt},g(ae,{workerId:_,jobId:Te,action:ke,payload:$e})}),me=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),U=Te=>ce(e({id:Te,action:"load",payload:{options:{lstmOnly:q,corePath:M.corePath,logging:M.logging}}})),X=(Te,ke,$e)=>ce(e({id:$e,action:"FS",payload:{method:"writeFile",args:[Te,ke]}})),de=(Te,ke)=>ce(e({id:ke,action:"FS",payload:{method:"readFile",args:[Te,{encoding:"utf8"}]}})),te=(Te,ke)=>ce(e({id:ke,action:"FS",payload:{method:"unlink",args:[Te]}})),L=(Te,ke,$e)=>ce(e({id:$e,action:"FS",payload:{method:Te,args:ke}})),V=(Te,ke)=>ce(e({id:ke,action:"loadLanguage",payload:{langs:Te,options:{langPath:M.langPath,dataPath:M.dataPath,cachePath:M.cachePath,cacheMethod:M.cacheMethod,gzip:M.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(I)&&!M.legacyLang}}})),W=(Te,ke,$e,ht)=>ce(e({id:ht,action:"initialize",payload:{langs:Te,oem:ke,config:$e}})),z=(Te="eng",ke,$e,ht)=>{if(q&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(ke))throw Error("Legacy model requested but code missing.");const xt=ke||I;I=xt;const Dt=$e||P;P=Dt;const ps=(typeof Te=="string"?Te.split("+"):Te).filter(an=>!R.includes(an));return R.push(...ps),ps.length>0?V(ps,ht).then(()=>W(Te,xt,Dt,ht)):W(Te,xt,Dt,ht)},le=(Te={},ke)=>ce(e({id:ke,action:"setParameters",payload:{params:Te}})),xe=async(Te,ke={},$e={text:!0},ht)=>ce(e({id:ht,action:"recognize",payload:{image:await d(Te),options:ke,output:$e}})),he=async(Te,ke)=>{if(q)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return ce(e({id:ke,action:"detect",payload:{image:await d(Te)}}))},Ee=async()=>(ae!==null&&(c(ae),ae=null),Promise.resolve());f(ae,({workerId:Te,jobId:ke,status:$e,action:ht,data:xt})=>{const Dt=`${ht}-${ke}`;if($e==="resolve")t(`[${Te}]: Complete ${ke}`),k[Dt].resolve({jobId:ke,data:xt}),delete k[Dt];else if($e==="reject")if(k[Dt].reject(xt),delete k[Dt],ht==="load"&&F(xt),N)N(xt);else throw Error(xt);else $e==="progress"&&w({...xt,userJobId:ke})});const Ne={id:_,worker:ae,load:me,writeText:X,readText:de,removeFile:te,FS:L,reinitialize:z,setParameters:le,recognize:xe,detect:he,terminate:Ee};return U().then(()=>V(b)).then(()=>W(b,C,A)).then(()=>$(Ne)).catch(()=>{}),K},Xf}var Jf,Pv;function qM(){if(Pv)return Jf;Pv=1;const i=ZS();return Jf={recognize:async(n,s,r)=>{const l=await i(s,1,r);return l.recognize(n).finally(async()=>{await l.terminate()})},detect:async(n,s)=>{const r=await i("osd",0,s);return r.detect(n).finally(async()=>{await r.terminate()})}},Jf}var Qf,Fv;function HM(){return Fv||(Fv=1,Qf={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Qf}var Zf,Ov;function jM(){return Ov||(Ov=1,Zf={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Zf}var eh,Uv;function zM(){if(Uv)return eh;Uv=1,wM();const i=MM(),e=ZS(),t=qM(),n=HM(),s=QS(),r=jM(),{setLogging:l}=vp();return eh={languages:n,OEM:s,PSM:r,createScheduler:i,createWorker:e,setLogging:l,...t},eh}var Bv=zM(),Vv;(function(i){i.STRING="string",i.NUMBER="number",i.INTEGER="integer",i.BOOLEAN="boolean",i.ARRAY="array",i.OBJECT="object"})(Vv||(Vv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gv;(function(i){i.LANGUAGE_UNSPECIFIED="language_unspecified",i.PYTHON="python"})(Gv||(Gv={}));var qv;(function(i){i.OUTCOME_UNSPECIFIED="outcome_unspecified",i.OUTCOME_OK="outcome_ok",i.OUTCOME_FAILED="outcome_failed",i.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(qv||(qv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv=["user","model","function","system"];var jv;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(jv||(jv={}));var zv;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(zv||(zv={}));var $v;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})($v||($v={}));var Yv;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER"})(Yv||(Yv={}));var ya;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.OTHER="OTHER"})(ya||(ya={}));var Wv;(function(i){i.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",i.RETRIEVAL_QUERY="RETRIEVAL_QUERY",i.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",i.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",i.CLASSIFICATION="CLASSIFICATION",i.CLUSTERING="CLUSTERING"})(Wv||(Wv={}));var Kv;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(Kv||(Kv={}));var Xv;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Xv||(Xv={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Oo extends Xt{constructor(e,t){super(e),this.response=t}}class eC extends Xt{constructor(e,t,n,s){super(e),this.status=t,this.statusText=n,this.errorDetails=s}}class ds extends Xt{}class tC extends Xt{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M="https://generativelanguage.googleapis.com",YM="v1beta",WM="0.24.1",KM="genai-js";var qs;(function(i){i.GENERATE_CONTENT="generateContent",i.STREAM_GENERATE_CONTENT="streamGenerateContent",i.COUNT_TOKENS="countTokens",i.EMBED_CONTENT="embedContent",i.BATCH_EMBED_CONTENTS="batchEmbedContents"})(qs||(qs={}));class XM{constructor(e,t,n,s,r){this.model=e,this.task=t,this.apiKey=n,this.stream=s,this.requestOptions=r}toString(){var e,t;const n=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||YM;let r=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||$M}/${n}/${this.model}:${this.task}`;return this.stream&&(r+="?alt=sse"),r}}function JM(i){const e=[];return i?.apiClient&&e.push(i.apiClient),e.push(`${KM}/${WM}`),e.join(" ")}async function QM(i){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",JM(i.requestOptions)),t.append("x-goog-api-key",i.apiKey);let n=(e=i.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(n){if(!(n instanceof Headers))try{n=new Headers(n)}catch(s){throw new ds(`unable to convert customHeaders value ${JSON.stringify(n)} to Headers: ${s.message}`)}for(const[s,r]of n.entries()){if(s==="x-goog-api-key")throw new ds(`Cannot set reserved header name ${s}`);if(s==="x-goog-api-client")throw new ds(`Header name ${s} can only be set using the apiClient field`);t.append(s,r)}}return t}async function ZM(i,e,t,n,s,r){const l=new XM(i,e,t,n,r);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},iN(r)),{method:"POST",headers:await QM(l),body:s})}}async function Fa(i,e,t,n,s,r={},l=fetch){const{url:c,fetchOptions:f}=await ZM(i,e,t,n,s,r);return eN(c,f,l)}async function eN(i,e,t=fetch){let n;try{n=await t(i,e)}catch(s){tN(s,i)}return n.ok||await nN(n,i),n}function tN(i,e){let t=i;throw t.name==="AbortError"?(t=new tC(`Request aborted when fetching ${e.toString()}: ${i.message}`),t.stack=i.stack):i instanceof eC||i instanceof ds||(t=new Xt(`Error fetching from ${e.toString()}: ${i.message}`),t.stack=i.stack),t}async function nN(i,e){let t="",n;try{const s=await i.json();t=s.error.message,s.error.details&&(t+=` ${JSON.stringify(s.error.details)}`,n=s.error.details)}catch{}throw new eC(`Error fetching from ${e.toString()}: [${i.status} ${i.statusText}] ${t}`,i.status,i.statusText,n)}function iN(i){const e={};if(i?.signal!==void 0||i?.timeout>=0){const t=new AbortController;i?.timeout>=0&&setTimeout(()=>t.abort(),i.timeout),i?.signal&&i.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(i){return i.text=()=>{if(i.candidates&&i.candidates.length>0){if(i.candidates.length>1&&console.warn(`This response had ${i.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),gc(i.candidates[0]))throw new Oo(`${as(i)}`,i);return sN(i)}else if(i.promptFeedback)throw new Oo(`Text not available. ${as(i)}`,i);return""},i.functionCall=()=>{if(i.candidates&&i.candidates.length>0){if(i.candidates.length>1&&console.warn(`This response had ${i.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),gc(i.candidates[0]))throw new Oo(`${as(i)}`,i);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Jv(i)[0]}else if(i.promptFeedback)throw new Oo(`Function call not available. ${as(i)}`,i)},i.functionCalls=()=>{if(i.candidates&&i.candidates.length>0){if(i.candidates.length>1&&console.warn(`This response had ${i.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),gc(i.candidates[0]))throw new Oo(`${as(i)}`,i);return Jv(i)}else if(i.promptFeedback)throw new Oo(`Function call not available. ${as(i)}`,i)},i}function sN(i){var e,t,n,s;const r=[];if(!((t=(e=i.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(s=(n=i.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)l.text&&r.push(l.text),l.executableCode&&r.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&r.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return r.length>0?r.join(""):""}function Jv(i){var e,t,n,s;const r=[];if(!((t=(e=i.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(s=(n=i.candidates)===null||n===void 0?void 0:n[0].content)===null||s===void 0?void 0:s.parts)l.functionCall&&r.push(l.functionCall);if(r.length>0)return r}const oN=[ya.RECITATION,ya.SAFETY,ya.LANGUAGE];function gc(i){return!!i.finishReason&&oN.includes(i.finishReason)}function as(i){var e,t,n;let s="";if((!i.candidates||i.candidates.length===0)&&i.promptFeedback)s+="Response was blocked",!((e=i.promptFeedback)===null||e===void 0)&&e.blockReason&&(s+=` due to ${i.promptFeedback.blockReason}`),!((t=i.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(s+=`: ${i.promptFeedback.blockReasonMessage}`);else if(!((n=i.candidates)===null||n===void 0)&&n[0]){const r=i.candidates[0];gc(r)&&(s+=`Candidate was blocked due to ${r.finishReason}`,r.finishMessage&&(s+=`: ${r.finishMessage}`))}return s}function Aa(i){return this instanceof Aa?(this.v=i,this):new Aa(i)}function rN(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,r=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(b){n[b]&&(s[b]=function(C){return new Promise(function(E,A){r.push([b,C,E,A])>1||c(b,C)})})}function c(b,C){try{f(n[b](C))}catch(E){v(r[0][3],E)}}function f(b){b.value instanceof Aa?Promise.resolve(b.value.v).then(d,g):v(r[0][2],b)}function d(b){c("next",b)}function g(b){c("throw",b)}function v(b,C){b(C),r.shift(),r.length&&c(r[0][0],r[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function aN(i){const e=i.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=uN(e),[n,s]=t.tee();return{stream:cN(n),response:lN(s)}}async function lN(i){const e=[],t=i.getReader();for(;;){const{done:n,value:s}=await t.read();if(n)return xp(dN(e));e.push(s)}}function cN(i){return rN(this,arguments,function*(){const t=i.getReader();for(;;){const{value:n,done:s}=yield Aa(t.read());if(s)break;yield yield Aa(xp(n))}})}function uN(i){const e=i.getReader();return new ReadableStream({start(n){let s="";return r();function r(){return e.read().then(({value:l,done:c})=>{if(c){if(s.trim()){n.error(new Xt("Failed to parse stream"));return}n.close();return}s+=l;let f=s.match(Qv),d;for(;f;){try{d=JSON.parse(f[1])}catch{n.error(new Xt(`Error parsing JSON response: "${f[1]}"`));return}n.enqueue(d),s=s.substring(f[0].length),f=s.match(Qv)}return r()}).catch(l=>{let c=l;throw c.stack=l.stack,c.name==="AbortError"?c=new tC("Request aborted when reading from the stream"):c=new Xt("Error reading from the stream"),c})}}})}function dN(i){const e=i[i.length-1],t={promptFeedback:e?.promptFeedback};for(const n of i){if(n.candidates){let s=0;for(const r of n.candidates)if(t.candidates||(t.candidates=[]),t.candidates[s]||(t.candidates[s]={index:s}),t.candidates[s].citationMetadata=r.citationMetadata,t.candidates[s].groundingMetadata=r.groundingMetadata,t.candidates[s].finishReason=r.finishReason,t.candidates[s].finishMessage=r.finishMessage,t.candidates[s].safetyRatings=r.safetyRatings,r.content&&r.content.parts){t.candidates[s].content||(t.candidates[s].content={role:r.content.role||"user",parts:[]});const l={};for(const c of r.content.parts)c.text&&(l.text=c.text),c.functionCall&&(l.functionCall=c.functionCall),c.executableCode&&(l.executableCode=c.executableCode),c.codeExecutionResult&&(l.codeExecutionResult=c.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),t.candidates[s].content.parts.push(l)}s++}n.usageMetadata&&(t.usageMetadata=n.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(i,e,t,n){const s=await Fa(e,qs.STREAM_GENERATE_CONTENT,i,!0,JSON.stringify(t),n);return aN(s)}async function iC(i,e,t,n){const r=await(await Fa(e,qs.GENERATE_CONTENT,i,!1,JSON.stringify(t),n)).json();return{response:xp(r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(i){if(i!=null){if(typeof i=="string")return{role:"system",parts:[{text:i}]};if(i.text)return{role:"system",parts:[i]};if(i.parts)return i.role?i:{role:"system",parts:i.parts}}}function Ea(i){let e=[];if(typeof i=="string")e=[{text:i}];else for(const t of i)typeof t=="string"?e.push({text:t}):e.push(t);return fN(e)}function fN(i){const e={role:"user",parts:[]},t={role:"function",parts:[]};let n=!1,s=!1;for(const r of i)"functionResponse"in r?(t.parts.push(r),s=!0):(e.parts.push(r),n=!0);if(n&&s)throw new Xt("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!s)throw new Xt("No content is provided for sending chat message.");return n?e:t}function hN(i,e){var t;let n={model:e?.model,generationConfig:e?.generationConfig,safetySettings:e?.safetySettings,tools:e?.tools,toolConfig:e?.toolConfig,systemInstruction:e?.systemInstruction,cachedContent:(t=e?.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const s=i.generateContentRequest!=null;if(i.contents){if(s)throw new ds("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=i.contents}else if(s)n=Object.assign(Object.assign({},n),i.generateContentRequest);else{const r=Ea(i);n.contents=[r]}return{generateContentRequest:n}}function Zv(i){let e;return i.contents?e=i:e={contents:[Ea(i)]},i.systemInstruction&&(e.systemInstruction=sC(i.systemInstruction)),e}function pN(i){return typeof i=="string"||Array.isArray(i)?{content:Ea(i)}:i}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],mN={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function gN(i){let e=!1;for(const t of i){const{role:n,parts:s}=t;if(!e&&n!=="user")throw new Xt(`First content should be with role 'user', got ${n}`);if(!Hv.includes(n))throw new Xt(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(Hv)}`);if(!Array.isArray(s))throw new Xt("Content should have 'parts' property with an array of Parts");if(s.length===0)throw new Xt("Each Content should have at least one part");const r={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of s)for(const f of ex)f in c&&(r[f]+=1);const l=mN[n];for(const c of ex)if(!l.includes(c)&&r[c]>0)throw new Xt(`Content with role '${n}' can't contain '${c}' part`);e=!0}}function tx(i){var e;if(i.candidates===void 0||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const n of t.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx="SILENT_ERROR";class yN{constructor(e,t,n,s={}){this.model=t,this.params=n,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,n?.history&&(gN(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var n,s,r,l,c,f;await this._sendPromise;const d=Ea(e),g={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,d]},v=Object.assign(Object.assign({},this._requestOptions),t);let b;return this._sendPromise=this._sendPromise.then(()=>iC(this._apiKey,this.model,g,v)).then(C=>{var E;if(tx(C.response)){this._history.push(d);const A=Object.assign({parts:[],role:"model"},(E=C.response.candidates)===null||E===void 0?void 0:E[0].content);this._history.push(A)}else{const A=as(C.response);A&&console.warn(`sendMessage() was unsuccessful. ${A}. Inspect response object for details.`)}b=C}).catch(C=>{throw this._sendPromise=Promise.resolve(),C}),await this._sendPromise,b}async sendMessageStream(e,t={}){var n,s,r,l,c,f;await this._sendPromise;const d=Ea(e),g={safetySettings:(n=this.params)===null||n===void 0?void 0:n.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,d]},v=Object.assign(Object.assign({},this._requestOptions),t),b=nC(this._apiKey,this.model,g,v);return this._sendPromise=this._sendPromise.then(()=>b).catch(C=>{throw new Error(nx)}).then(C=>C.response).then(C=>{if(tx(C)){this._history.push(d);const E=Object.assign({},C.candidates[0].content);E.role||(E.role="model"),this._history.push(E)}else{const E=as(C);E&&console.warn(`sendMessageStream() was unsuccessful. ${E}. Inspect response object for details.`)}}).catch(C=>{C.message!==nx&&console.error(C)}),b}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vN(i,e,t,n){return(await Fa(e,qs.COUNT_TOKENS,i,!1,JSON.stringify(t),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xN(i,e,t,n){return(await Fa(e,qs.EMBED_CONTENT,i,!1,JSON.stringify(t),n)).json()}async function bN(i,e,t,n){const s=t.requests.map(l=>Object.assign(Object.assign({},l),{model:e}));return(await Fa(e,qs.BATCH_EMBED_CONTENTS,i,!1,JSON.stringify({requests:s}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,t,n={}){this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=sC(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var n;const s=Zv(e),r=Object.assign(Object.assign({},this._requestOptions),t);return iC(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),r)}async generateContentStream(e,t={}){var n;const s=Zv(e),r=Object.assign(Object.assign({},this._requestOptions),t);return nC(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},s),r)}startChat(e){var t;return new yN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const n=hN(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),t);return vN(this.apiKey,this.model,n,s)}async embedContent(e,t={}){const n=pN(e),s=Object.assign(Object.assign({},this._requestOptions),t);return xN(this.apiKey,this.model,n,s)}async batchEmbedContents(e,t={}){const n=Object.assign(Object.assign({},this._requestOptions),t);return bN(this.apiKey,this.model,e,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Xt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ix(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new ds("Cached content must contain a `name` field.");if(!e.model)throw new ds("Cached content must contain a `model` field.");const s=["model","systemInstruction"];for(const l of s)if(t?.[l]&&e[l]&&t?.[l]!==e[l]){if(l==="model"){const c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,f=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===f)continue}throw new ds(`Different value for "${l}" specified in modelParams (${t[l]}) and cachedContent (${e[l]})`)}const r=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new ix(this.apiKey,r,n)}}class SN{genAI;model;currentModelIndex=0;FALLBACK_MODELS=["gemini-2.5-pro","gemini-2.5-flash","gemini-2.5-flash-lite","gemini-2.0-flash-15","gemini-2.0-flash-lite"];constructor(e){this.genAI=new bp(e),this.model=this.genAI.getGenerativeModel({model:this.FALLBACK_MODELS[0]}),console.log("🤖 Gemini configurado con modelo inicial:",this.FALLBACK_MODELS[0])}isQuotaExceededError(e){const t=e instanceof Error?e.message:String(e);return t.includes("429")||t.includes("quota")||t.includes("requests per day")||t.includes("QUOTA_EXCEEDED")||t.includes("Resource has been exhausted")}getCurrentModel(){return this.FALLBACK_MODELS[this.currentModelIndex]}async testConnection(){try{const n=(await(await this.model.generateContent("Test connection. Respond with: OK")).response).text();return console.log("🔗 Test de conexión Gemini:",n),n.includes("OK")||n.includes("ok")}catch(e){return console.error("❌ Test de conexión Gemini falló:",e),!1}}async callGeminiWithRetry(e,t=3){let n=null;for(let s=this.currentModelIndex;s<this.FALLBACK_MODELS.length;s++){s!==this.currentModelIndex&&(this.currentModelIndex=s,this.model=this.genAI.getGenerativeModel({model:this.FALLBACK_MODELS[this.currentModelIndex]}),console.log(`🔄 Probando con modelo: ${this.FALLBACK_MODELS[this.currentModelIndex]}`));for(let r=1;r<=t;r++)try{console.log(`🔄 Modelo ${this.getCurrentModel()} - Intento ${r}/${t}`);const f=(await(await this.model.generateContent(e)).response).text();return console.log(`✅ Exitoso con modelo ${this.getCurrentModel()} en intento ${r}`),f}catch(l){n=l;const c=l instanceof Error?l.message:String(l);if(console.log(`❌ Error con modelo ${this.getCurrentModel()}, intento ${r}:`,c),this.isQuotaExceededError(l)){console.log(`🚫 Error de cuota detectado con modelo ${this.getCurrentModel()}`);break}if((c.includes("overloaded")||c.includes("503"))&&r<t){const d=Math.pow(2,r)*1e3;console.log(`⏳ Modelo sobrecargado, reintentando en ${d}ms...`),await this.sleep(d);continue}if(r<t&&!this.isQuotaExceededError(l)){const d=1e3*r;console.log(`⏳ Reintentando en ${d}ms...`),await this.sleep(d);continue}}console.log(`❌ Modelo ${this.getCurrentModel()} agotado, probando siguiente modelo...`)}throw console.error("❌ Todos los modelos de Gemini han fallado"),new Error(`Todos los modelos de Gemini fallaron. Último error: ${n instanceof Error?n.message:"Error desconocido"}`)}sleep(e){return new Promise(t=>setTimeout(t,e))}async extractQuestionsFromText(e){const t=this.buildQuestionExtractionPrompt(e);console.log("🤖 Enviando a Gemini:",{textLength:e.length,textPreview:e.substring(0,200)+"..."});try{const n=await this.callGeminiWithRetry(t);if(console.log("📨 Respuesta de Gemini:",{responseLength:n.length,responsePreview:n.substring(0,300)+"..."}),!n||n.trim()==="")return console.error("❌ Gemini devolvió respuesta vacía"),[];const s=this.parseQuestionResponse(n);return console.log("✅ Preguntas parseadas:",s.length),s.map(r=>({...r,id:this.generateQuestionId(),confidence:.8,source:"text",needsReview:!1}))}catch(n){throw console.error("❌ Error extracting questions:",n),new Error(`Gemini API error: ${n instanceof Error?n.message:"Unknown error"}`)}}async generateExplanation(e,t){const n=`
Genera una explicación clara y concisa para esta pregunta de examen:

PREGUNTA: ${e}
RESPUESTA(S) CORRECTA(S): ${t.join(", ")}

Requisitos:
- Explicación en español
- Máximo 200 palabras
- Enfoque educativo
- Incluye el "por qué" es correcta la respuesta

Responde solo con la explicación, sin formato adicional:
`;try{return(await(await this.model.generateContent(n)).response).text().trim()}catch(s){return console.error("Error generating explanation:",s),"No se pudo generar explicación automáticamente."}}async findReferenceLinks(e,t){const n=`
Para esta pregunta de examen, sugiere un link de referencia oficial o educativo confiable:

PREGUNTA: ${e}
${t?`MATERIA: ${t}`:""}

Requisitos:
- Solo URLs oficiales (documentación, sitios educativos reconocidos)
- Preferir: Wikipedia, sitios .edu, documentación oficial
- Si no encuentras algo específico, sugiere una búsqueda en Google
- Responde solo con la URL, sin explicaciones

URL sugerida:
`;try{const l=(await(await this.model.generateContent(n)).response).text().trim();return this.isValidUrl(l)?l:`https://www.google.com/search?q=${encodeURIComponent(e.substring(0,100))}`}catch(s){return console.error("Error finding reference:",s),`https://www.google.com/search?q=${encodeURIComponent(e.substring(0,100))}`}}async improveOCRQuestion(e){const t=`
Analiza este texto extraído por OCR y conviértelo en una pregunta de examen estructurada:

TEXTO OCR: ${e}

Tareas:
1. Corregir errores de OCR comunes
2. Identificar la pregunta principal
3. Extraer las opciones de respuesta
4. Determinar cuál(es) es(son) correcta(s)
5. Generar una explicación breve

Responde en formato JSON exacto:
{
  "question_text": "pregunta corregida",
  "options": [
    {"option_letter": "A", "option_text": "opción A", "is_correct": false},
    {"option_letter": "B", "option_text": "opción B", "is_correct": true}
  ],
  "requires_multiple_answers": false,
  "explanation": "explicación breve",
  "link": ""
}

Si no puedes extraer una pregunta válida, responde: null
`;try{const r=(await(await this.model.generateContent(t)).response).text().trim();return r==="null"?null:{...JSON.parse(r),id:this.generateQuestionId(),confidence:.6,source:"ocr",needsReview:!0}}catch(n){return console.error("Error improving OCR question:",n),null}}buildQuestionExtractionPrompt(e){return`
Extrae TODAS las preguntas de examen del siguiente texto y devuelve SOLO un JSON array válido.

TEXTO:
${e.substring(0,4e3)} ${e.length>4e3?"...[texto truncado]":""}

IMPORTANTE: 
- Responde ÚNICAMENTE con JSON válido
- No agregues explicaciones antes o después del JSON
- Si no encuentras preguntas, responde: []

FORMATO JSON REQUERIDO:
[
  {
    "question_text": "pregunta completa aquí",
    "options": [
      {"option_letter": "A", "option_text": "opción A", "is_correct": false},
      {"option_letter": "B", "option_text": "opción B", "is_correct": true},
      {"option_letter": "C", "option_text": "opción C", "is_correct": false},
      {"option_letter": "D", "option_text": "opción D", "is_correct": false}
    ],
    "requires_multiple_answers": false,
    "explanation": "explicación breve",
    "link": ""
  }
]
`}async extractQuestionsWithFallback(e){try{const n=await this.extractQuestionsFromText(e);if(n.length>0)return n}catch(n){console.log("Prompt principal falló, intentando con prompt simplificado:",n)}const t=`
Extrae preguntas de examen del siguiente texto. Busca patrones como:
- Preguntas numeradas (1., 2., etc.)
- Opciones múltiples (A), B), C), D))
- Texto que termine en "?"

TEXTO:
${e}

Responde solo con JSON array:
[{"question_text": "pregunta", "options": [{"option_letter": "A", "option_text": "opción", "is_correct": true}], "requires_multiple_answers": false, "explanation": "", "link": ""}]

Si no hay preguntas, responde: []
`;try{const n=await this.callGeminiWithRetry(t);return this.parseQuestionResponse(n)}catch(n){return console.error("Todos los métodos de extracción fallaron:",n),[]}}parseQuestionResponse(e){console.log("🔍 Parseando respuesta de Gemini...");try{const t=e.replace(/```json/g,"").replace(/```/g,"").replace(/^[^[{]+/,"").replace(/[^}\]]+$/,"").trim();console.log("🧹 Texto limpiado:",{original:e.length,cleaned:t.length,cleanedPreview:t.substring(0,200)+"..."});const n=JSON.parse(t);return Array.isArray(n)?(console.log("✅ JSON parseado correctamente:",n.length,"elementos"),n):n&&typeof n=="object"?(console.log("📦 JSON es objeto, convirtiendo a array"),[n]):(console.error("❌ JSON no es array ni objeto válido:",typeof n),[])}catch(t){return console.error("❌ Error parsing JSON:",t),console.log("📝 Respuesta original que falló:",e),this.fallbackTextExtraction(e)}}fallbackTextExtraction(e){console.log("🔄 Intentando extracción manual...");const t=e.match(/question[_\s]*text["\s]*:[\s]*["']([^"']+)["']/gi);return t&&t.length>0?(console.log("🎯 Encontradas",t.length,"preguntas con extracción manual"),t.map(n=>({id:this.generateQuestionId(),question_text:n.replace(/question[_\s]*text["\s]*:[\s]*["']/,"").replace(/["']$/,""),options:[{option_letter:"A",option_text:"Opción A (extraída manualmente)",is_correct:!0},{option_letter:"B",option_text:"Opción B (extraída manualmente)",is_correct:!1}],requires_multiple_answers:!1,explanation:"Pregunta extraída mediante fallback manual",link:"",confidence:.3,source:"text",needsReview:!0}))):(console.log("❌ Extracción manual también falló"),[])}generateQuestionId(){return`q_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}static isConfigured(){return!1}static getUsageLimits(){return{freeQuota:{requestsPerMinute:60,requestsPerDay:1500,tokensPerMonth:1e6},fallbackModels:["gemini-2.5-pro","gemini-2.5-flash","gemini-2.5-flash-lite","gemini-2.0-flash-15","gemini-2.0-flash-lite"],recommendation:"El sistema cambiará automáticamente de modelo si se agota la cuota"}}getFallbackStatus(){return{currentModel:this.getCurrentModel(),currentModelIndex:this.currentModelIndex,totalModels:this.FALLBACK_MODELS.length,remainingModels:this.FALLBACK_MODELS.length-this.currentModelIndex-1,availableModels:this.FALLBACK_MODELS.slice(this.currentModelIndex+1)}}async extractQuestionsFromImage(e){console.log("🔍 Iniciando análisis de imagen con Gemini Vision...");const t=e.replace(/^data:image\/[a-z]+;base64,/,""),n=`
Analiza esta imagen que contiene preguntas de examen y extrae TODAS las preguntas que encuentres.

INSTRUCCIONES IMPORTANTES:
1. Extrae CADA pregunta visible en la imagen
2. Para cada pregunta, identifica TODAS las opciones de respuesta (A, B, C, D, E, etc.)
3. Determina cuál(es) opción(es) es/son correcta(s) si está marcado o indicado
4. Si no puedes determinar la respuesta correcta, marca la primera opción como correcta

Formato de respuesta (JSON array):
[
  {
    "question_text": "Texto completo de la pregunta",
    "options": [
      {"option_letter": "A", "option_text": "Texto de la opción A", "is_correct": false},
      {"option_letter": "B", "option_text": "Texto de la opción B", "is_correct": true},
      {"option_letter": "C", "option_text": "Texto de la opción C", "is_correct": false}
    ],
    "requires_multiple_answers": false,
    "explanation": "",
    "link": ""
  }
]

IMPORTANTE: Responde SOLO con el JSON array, sin texto adicional.
`;try{const l=(await(await this.model.generateContent([{inlineData:{data:t,mimeType:"image/png"}},n])).response).text();console.log("📝 Respuesta de Gemini Vision:",l.substring(0,200)+"...");const c=this.parseQuestionResponse(l);return console.log(`✅ Gemini Vision extrajo ${c.length} preguntas de la imagen`),c.map((f,d)=>({...f,id:`gemini_vision_${Date.now()}_${d}`,confidence:.8,source:"ocr",explanation:f.explanation||"Extraído mediante Gemini Vision",needsReview:!1}))}catch(s){throw console.error("❌ Error en Gemini Vision:",s),new Error(`Error procesando imagen con Gemini Vision: ${s instanceof Error?s.message:"Error desconocido"}`)}}}try{Bs.workerSrc="/study-lab/pdf.worker.mjs"}catch(i){console.warn("Worker local no disponible, usando fallback:",i),Bs.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js"}const sx={standardFontDataUrl:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/standard_fonts/",cMapUrl:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/cmaps/",cMapPacked:!0,disableFontFace:!1,disableRange:!1,disableStream:!1,isEvalSupported:!1,maxImageSize:1024*1024,verbosity:0};class Sp{geminiService=null;onProgress;onQuestionExtracted;constructor(e){e&&e.trim()!==""?(console.log("🔑 Configurando Gemini con API key..."),this.geminiService=new SN(e),console.log("✅ Gemini configurado correctamente")):console.log("⚠️ No se proporcionó API key de Gemini, funcionará sin IA")}async getPDFInfo(e){const t=await e.arrayBuffer();return{totalPages:(await Sh({data:t,...sx}).promise).numPages,fileSize:e.size}}async processPDF(e,t,n,s){this.onProgress=t,this.onQuestionExtracted=s;const r=Date.now();try{this.validateFile(e),this.updateProgress(0,0,"analyzing","Analizando archivo PDF...");const l=await this.loadPDF(e),c=l.numPages;let f;n&&n>0&&n<=c?(f=[n],console.log(`📊 PDF tiene ${c} páginas, procesando solo la página ${n}`)):(f=Array.from({length:c},(b,C)=>C+1),console.log(`📊 PDF tiene ${c} páginas, procesando todas`));const d=[],g=[];for(let b=0;b<f.length;b++){const C=f[b];this.updateProgress(b+1,f.length,"extracting-text",`Procesando página ${C}...`);try{const E=await this.processPage(l,C);d.push(E)}catch(E){const A=`Error en página ${C}: ${E instanceof Error?E.message:"Error desconocido"}`;g.push(A),console.error(A),d.push({pageNumber:C,hasText:!1,hasImages:!1,extractedQuestions:[],processingStatus:"error",error:A})}}const v=d.reduce((b,C)=>b+(C.extractedQuestions?.length||0),0);return this.updateProgress(f.length,f.length,"completed","Procesamiento completado"),{file:e,pages:d,totalQuestions:v,processingTime:Date.now()-r,errors:g}}catch(l){const c=l instanceof Error?l.message:"Error de procesamiento desconocido";throw new Error(`Error procesando PDF: ${c}`)}}async processPage(e,t){const n=await e.getPage(t),s=await n.getTextContent(),r=s.items.length>0,l=n.getViewport({scale:1.5}),c=document.createElement("canvas"),f=c.getContext("2d");if(!f)throw new Error("No se pudo obtener contexto del canvas");c.height=l.height,c.width=l.width,await n.render({canvasContext:f,viewport:l,canvas:c}).promise;const d=c.toDataURL("image/png"),g=await this.detectImages(c);let v={pageNumber:t,hasText:r,hasImages:g,imageData:d,extractedQuestions:[],processingStatus:"processing"};return r&&(v=await this.processTextContent(v,s)),g&&(!r||!v.extractedQuestions||v.extractedQuestions.length===0)&&(console.log(`🔍 Página ${v.pageNumber}: Procesando imágenes con OCR...`),v=await this.processImageContent(v,d)),this.geminiService&&(v.geminiVisionOption={available:!0,imageData:d,reason:v.extractedQuestions&&v.extractedQuestions.length>0?"Gemini Vision disponible como alternativa":"No se detectaron preguntas, Gemini Vision disponible"},console.log(`🔍 Página ${v.pageNumber}: Gemini Vision configurado como opción`)),v.processingStatus="completed",v}async processTextContent(e,t){const n=t.items.filter(l=>!!(l.str&&l.str.trim())).map(l=>l.str).join(" ").replace(/\s+/g," ").trim();if(e.textContent=n,console.log(`📄 Página ${e.pageNumber} - Texto extraído (${n.length} chars):`,n.substring(0,200)+(n.length>200?"...":"")),n.length<50)return console.log(`⚠️ Página ${e.pageNumber}: Texto insuficiente (${n.length} chars)`),e;if(![/\d+[.)]\s*/,/Question\s*\d+/i,/Pregunta\s*\d+/i,/[ABC][).]\s*/g,/\?\s*$/m,/Choose\s+(one|the|all)/i,/Select\s+(one|the|all)/i,/Which\s+of\s+the\s+following/i,/¿[^?]+\?/g].some(l=>l.test(n)))return console.log(`⚠️ Página ${e.pageNumber}: No se detectaron patrones de preguntas`),e;if(console.log(`✅ Página ${e.pageNumber}: Patrones de preguntas detectados, procesando con IA...`),!this.geminiService)return console.log(`⚠️ Página ${e.pageNumber}: Gemini no configurado`),this.extractQuestionsManually(e,n);try{this.updateProgress(e.pageNumber,1,"ai-processing","Procesando con IA...");const l=await this.geminiService.extractQuestionsWithFallback(n);if(console.log(`📊 Página ${e.pageNumber}: ${l.length} preguntas extraídas`),l.length>0){l.forEach(f=>{this.onQuestionExtracted&&this.onQuestionExtracted(f,e.pageNumber)});const c=await this.enhanceQuestions(l,e.pageNumber);e.extractedQuestions=c}else return console.log(`🔄 Página ${e.pageNumber}: IA no encontró preguntas, intentando extracción manual...`),this.extractQuestionsManually(e,n)}catch(l){console.error(`❌ Error procesando página ${e.pageNumber} con Gemini:`,l);const c=l instanceof Error?l.message:String(l);if(c.includes("overloaded")||c.includes("503"))return console.log(`🔄 Página ${e.pageNumber}: Gemini sobrecargado, usando extracción manual...`),this.extractQuestionsManually(e,n);e.error=`Error de IA: ${l instanceof Error?l.message:"Error desconocido"}`}return e}extractQuestionsManually(e,t){console.log(`🔧 Página ${e.pageNumber}: Extrayendo preguntas manualmente...`);const n=[];return this.splitIntoQuestionBlocks(t).forEach(r=>{const l=this.parseQuestionBlock(r);if(l){const c={...l,id:this.generateQuestionId(),confidence:.4,source:"text",needsReview:!0};n.push(c),this.onQuestionExtracted&&this.onQuestionExtracted(c,e.pageNumber)}}),console.log(`🔧 Página ${e.pageNumber}: ${n.length} preguntas extraídas manualmente`),e.extractedQuestions=n,e}splitIntoQuestionBlocks(e){const t=/(?:^|\n)\s*(?:\d+[.)]\s*|Question\s+\d+[.:]\s*|Pregunta\s+\d+[.:]\s*)/gi;return e.split(t).filter(s=>s.trim().length>20)}parseQuestionBlock(e){const t=e.trim().split(`
`).map(l=>l.trim()).filter(l=>l);if(t.length<3)return null;let n="",s=0;for(let l=0;l<t.length;l++)if(t[l].endsWith("?")||t[l].length>30&&!this.isOptionLine(t[l])){n=t[l],s=l+1;break}if(!n&&t[0].length>15&&(n=t[0],s=1),!n)return null;const r=[];for(let l=s;l<t.length;l++){const c=t[l].match(/^([A-E])[.)]\s*(.+)$/i);c&&r.push({option_letter:c[1].toUpperCase(),option_text:c[2].trim(),is_correct:!1})}return r.length<2?null:{id:this.generateQuestionId(),question_text:n,options:r,requires_multiple_answers:!1,explanation:"(Extracción manual - requiere revisión)",link:"",confidence:.4,source:"text",needsReview:!0}}isOptionLine(e){return/^[A-E][.)]\s/.test(e)}generateQuestionId(){return`q_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async processImageContent(e,t){try{this.updateProgress(e.pageNumber,1,"ocr","Ejecutando OCR mejorado..."),console.log(`🔍 Página ${e.pageNumber}: Iniciando OCR con preprocesamiento...`);const n=await this.preprocessImageForOCR(t),s=await Bv.createWorker(["eng","spa"],1,{logger:c=>{c.status==="recognizing text"&&console.log(`OCR Progreso: ${Math.round(c.progress*100)}%`)}});await s.setParameters({tessedit_pageseg_mode:Bv.PSM.SINGLE_BLOCK,tessedit_ocr_engine_mode:"3",tessedit_char_whitelist:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.,;:!?()[]{}"'-/\\+=*&%$#@^~\`|<> 
	¿¡áéíóúñüÁÉÍÓÚÑÜ`,preserve_interword_spaces:"1",tessedit_do_invert:"0",tessedit_write_images:"0"});const{data:{text:r,confidence:l}}=await s.recognize(n);if(await s.terminate(),console.log(`📝 OCR completado - Confianza: ${l.toFixed(1)}%, Texto: ${r.length} chars`),console.log("📄 Texto extraído:",r.substring(0,300)+(r.length>300?"...":"")),e.textContent=r,r.trim().length>20&&l>30){if(this.geminiService){this.updateProgress(e.pageNumber,1,"ai-processing","Procesando texto OCR con IA..."),console.log("🤖 Procesando texto OCR con IA...");try{const c=await this.geminiService.extractQuestionsWithFallback(r);if(c.length>0)return console.log(`✅ ${c.length} preguntas extraídas directamente del OCR`),e.extractedQuestions=await this.enhanceQuestions(c,e.pageNumber),e}catch(c){console.log("⚠️ Extracción directa falló:",c)}}}else console.log(`⚠️ OCR texto insuficiente o baja confianza: ${r.length} chars, ${l.toFixed(1)}%`);e.ocrFailed=!0,e.geminiVisionOption={available:!!this.geminiService,imageData:n,reason:l<30?"Baja confianza en OCR":"No se detectaron preguntas en el texto"}}catch(n){console.error("❌ Error en procesamiento OCR:",n),e.error=`Error OCR: ${n instanceof Error?n.message:"Error desconocido"}`}return e}async enhanceQuestions(e,t){return this.geminiService?await Promise.all(e.map(async(s,r)=>{try{if(console.log(`🔧 Mejorando pregunta ${r+1}/${e.length} de página ${t}...`),!s.explanation){const l=s.options.filter(c=>c.is_correct).map(c=>c.option_text);this.updateProgress(t||0,1,"ai-processing",`Generando explicación para pregunta ${r+1}...`),s.explanation=await this.geminiService.generateExplanation(s.question_text,l),this.onQuestionExtracted&&t&&this.onQuestionExtracted(s,t)}return s.link||(this.updateProgress(t||0,1,"ai-processing",`Buscando referencias para pregunta ${r+1}...`),s.link=await this.geminiService.findReferenceLinks(s.question_text),this.onQuestionExtracted&&t&&this.onQuestionExtracted(s,t)),console.log(`✅ Pregunta ${r+1} mejorada con explicación y links`),s}catch(l){return console.error("Error enhancing question:",l),s}})):e}async detectImages(e){const t=e.getContext("2d");if(!t)return!1;const s=t.getImageData(0,0,e.width,e.height).data;let r=0;for(let l=0;l<s.length;l+=4){const c=s[l],f=s[l+1],d=s[l+2],g=(c+f+d)/3;(Math.abs(c-g)>10||Math.abs(f-g)>10||Math.abs(d-g)>10)&&r++}return r>s.length/4*.1}async loadPDF(e){const t=await e.arrayBuffer(),n=Sh({data:t,...sx});return n.onProgress=s=>{console.log(`Cargando PDF: ${Math.round(s.loaded/s.total*100)}%`)},await n.promise}validateFile(e){if(e.type!=="application/pdf")throw new Error("Solo se permiten archivos PDF");const t="5"*1024*1024;if(e.size>t)throw new Error(`El archivo excede el tamaño máximo de ${t/1024/1024}MB`)}async preprocessImageForOCR(e){try{const t=document.createElement("canvas"),n=t.getContext("2d"),s=new Image;return n?new Promise(r=>{s.onload=()=>{t.width=s.width,t.height=s.height,n.drawImage(s,0,0);const l=n.getImageData(0,0,t.width,t.height),c=l.data;for(let f=0;f<c.length;f+=4){const g=c[f]*.299+c[f+1]*.587+c[f+2]*.114>128?255:0;c[f]=g,c[f+1]=g,c[f+2]=g}n.putImageData(l,0,0),r(t.toDataURL("image/png"))},s.onerror=()=>{console.warn("Error procesando imagen, usando original"),r(e)},s.src=e}):(console.warn("No se pudo obtener contexto del canvas, usando imagen original"),e)}catch(t){return console.warn("Error en preprocesamiento, usando imagen original:",t),e}}updateProgress(e,t,n,s){this.onProgress&&this.onProgress({currentPage:e,totalPages:t,stage:n,message:s})}static getMemoryLimitations(){return{maxPDFSize:"5MB",maxPages:"20",localStorageLimit:"~10MB total",recommendation:"Procesar PDFs pequeños de máximo 10-15 páginas"}}getGeminiService(){return this.geminiService}async processPageWithGeminiVision(e){if(!this.geminiService||!e.geminiVisionOption?.imageData)throw new Error("Gemini Vision no está disponible o no hay datos de imagen");console.log(`🔍 Procesando página ${e.pageNumber} con Gemini Vision...`);try{this.updateProgress(e.pageNumber,1,"ai-processing","Analizando imagen con Gemini Vision...");const t=await this.geminiService.extractQuestionsFromImage(e.geminiVisionOption.imageData);if(t.length>0){t.forEach(s=>{this.onQuestionExtracted&&this.onQuestionExtracted(s,e.pageNumber)});const n=await this.enhanceQuestions(t,e.pageNumber);e.extractedQuestions=n,e.processingStatus="completed",e.ocrFailed=!1,console.log(`✅ Gemini Vision completado: ${t.length} preguntas extraídas`)}else e.error="Gemini Vision no encontró preguntas en la imagen",e.processingStatus="error"}catch(t){console.error("❌ Error en Gemini Vision:",t),e.error=`Error Gemini Vision: ${t instanceof Error?t.message:"Error desconocido"}`,e.processingStatus="error"}return e}static estimateMemoryUsage(e){const n=e*2.5/1024/1024,s=n>8;return{estimated:`~${n.toFixed(1)}MB`,warning:s,recommendation:s?"Considera procesar el PDF en secciones más pequeñas":"Uso de memoria dentro de límites normales"}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let CN,AN;function EN(){return{geminiUrl:CN,vertexUrl:AN}}function _N(i,e,t,n){var s,r;if(!i?.baseUrl){const l=EN();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(r=l.geminiUrl)!==null&&r!==void 0?r:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ys{}function Ce(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function p(i,e,t){for(let r=0;r<e.length-1;r++){const l=e[r];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const f=i[c];if(Array.isArray(t))for(let d=0;d<f.length;d++){const g=f[d];p(g,e.slice(r+1),t[d])}else for(const d of f)p(d,e.slice(r+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const f=i[c];p(f[0],e.slice(r+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=t}function h(i,e){try{if(e.length===1&&e[0]==="_self")return i;for(let t=0;t<e.length;t++){if(typeof i!="object"||i===null)return;const n=e[t];if(n.endsWith("[]")){const s=n.slice(0,-2);if(s in i){const r=i[s];return Array.isArray(r)?r.map(l=>h(l,e.slice(t+1))):void 0}else return}else i=i[n]}return i}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Th(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ox;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ox||(ox={}));var rx;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(rx||(rx={}));var us;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(us||(us={}));var ax;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(ax||(ax={}));var lx;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(lx||(lx={}));var cx;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(cx||(cx={}));var ux;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(ux||(ux={}));var dx;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(dx||(dx={}));var fx;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(fx||(fx={}));var hx;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(hx||(hx={}));var px;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(px||(px={}));var mx;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(mx||(mx={}));var gx;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(gx||(gx={}));var yx;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(yx||(yx={}));var vx;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY"})(vx||(vx={}));var xx;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(xx||(xx={}));var Mc;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(Mc||(Mc={}));var bx;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(bx||(bx={}));var wh;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(wh||(wh={}));var Sx;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Sx||(Sx={}));var Cx;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Cx||(Cx={}));var Ax;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(Ax||(Ax={}));var Ex;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Ex||(Ex={}));var _x;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(_x||(_x={}));var Tx;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(Tx||(Tx={}));var wx;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(wx||(wx={}));var Mx;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(Mx||(Mx={}));var Nx;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Nx||(Nx={}));var Rx;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Rx||(Rx={}));var Ix;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ix||(Ix={}));var Dx;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Dx||(Dx={}));var kx;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(kx||(kx={}));var Lx;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(Lx||(Lx={}));var Px;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(Px||(Px={}));var Fx;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(Fx||(Fx={}));var Ox;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ox||(Ox={}));var Ux;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Ux||(Ux={}));var Bx;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(Bx||(Bx={}));var Vx;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Vx||(Vx={}));var Gx;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(Gx||(Gx={}));var qx;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(qx||(qx={}));var jo;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(jo||(jo={}));function TN(i,e){return{fileData:{fileUri:i,mimeType:e}}}class Mh{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class da{get text(){var e,t,n,s,r,l,c,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",g=!1;const v=[];for(const b of(f=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[C,E]of Object.entries(b))C!=="text"&&C!=="thought"&&(E!==null||E!==void 0)&&v.push(C);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;g=!0,d+=b.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?d:void 0}get data(){var e,t,n,s,r,l,c,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const g=[];for(const v of(f=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[b,C]of Object.entries(v))b!=="inlineData"&&(C!==null||C!==void 0)&&g.push(b);v.inlineData&&typeof v.inlineData.data=="string"&&(d+=atob(v.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,n,s,r,l,c,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(f=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,n,s,r,l,c,f,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(f=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,n,s,r,l,c,f,d;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(f=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.output}}class Hx{}class jx{}class wN{}class MN{}class zx{}class $x{}class Yx{}class NN{}class Wx{}class Kx{}class Xx{}class Jx{}class RN{}class IN{}class DN{}class Qx{}class kN{get text(){var e,t,n;let s="",r=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[f,d]of Object.entries(c))f!=="text"&&f!=="thought"&&d!==null&&l.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;r=!0,s+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,t,n;let s="";const r=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,f]of Object.entries(l))c!=="inlineData"&&f!==null&&r.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class Nc{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const n=new Nc;if(n.name=e.name,n.metadata=e.metadata,n.done=e.done,n.error=e.error,t){const s=e.response;if(s){const r=new Wx,l=s.videos;r.generatedVideos=l?.map(c=>({video:{uri:c.gcsUri,videoBytes:c.bytesBase64Encoded?Th(c.bytesBase64Encoded):void 0,mimeType:c.mimeType}})),r.raiMediaFilteredCount=s.raiMediaFilteredCount,r.raiMediaFilteredReasons=s.raiMediaFilteredReasons,n.response=r}}else{const s=e.response;if(s){const r=new Wx,l=s.generateVideoResponse,c=l?.generatedSamples;r.generatedVideos=c?.map(f=>{const d=f.video;return{video:{uri:d?.uri,videoBytes:d?.encodedVideo?Th(d?.encodedVideo):void 0,mimeType:f.encoding}}}),r.raiMediaFilteredCount=s.raiMediaFilteredCount,r.raiMediaFilteredReasons=s.raiMediaFilteredReasons,n.response=r}}return n}}class LN{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qe(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function oC(i,e){const t=Qe(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function rC(i){return Array.isArray(i)?i.map(e=>Rc(e)):[Rc(i)]}function Rc(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function aC(i){const e=Rc(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function lC(i){const e=Rc(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Zx(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function cC(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>Zx(e)):[Zx(i)]}function Nh(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function eb(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function tb(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function Jt(i){if(i==null)throw new Error("ContentUnion is required");return Nh(i)?i:{role:"user",parts:cC(i)}}function uC(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=Jt(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=Jt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Jt(t)):[Jt(e)]}function Un(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(eb(i)||tb(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Jt(i)]}const e=[],t=[],n=Nh(i[0]);for(const s of i){const r=Nh(s);if(r!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(eb(s)||tb(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:cC(t)}),e}function PN(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(us).includes(t[0].toUpperCase())?t[0].toUpperCase():us.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(us).includes(n.toUpperCase())?n.toUpperCase():us.TYPE_UNSPECIFIED})}}function Yo(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=i.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,i=r[1]):r[1].type==="null"&&(e.nullable=!0,i=r[0])),i.type instanceof Array&&PN(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(us).includes(c.toUpperCase())?c.toUpperCase():us.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Yo(c);else if(n.includes(l)){const f=[];for(const d of c){if(d.type=="null"){e.nullable=!0;continue}f.push(Yo(d))}e[l]=f}else if(s.includes(l)){const f={};for(const[d,g]of Object.entries(c))f[d]=Yo(g);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Cp(i){return Yo(i)}function Ap(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function Ep(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function er(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Yo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Yo(e.response));return i}function tr(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function FN(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Li(i,e){if(typeof e!="string")throw new Error("name must be a string");return FN(i,e,"cachedContents")}function dC(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function Ws(i){return Th(i)}function ON(i){return i!=null&&typeof i=="object"&&"name"in i}function UN(i){return i!=null&&typeof i=="object"&&"video"in i}function BN(i){return i!=null&&typeof i=="object"&&"uri"in i}function fC(i){var e;let t;if(ON(i)&&(t=i.name),!(BN(i)&&(t=i.uri,t===void 0))&&!(UN(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function hC(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function pC(i){for(const e of["models","tunedModels","publisherModels"])if(VN(i,e))return i[e];return[]}function VN(i,e){return i!==null&&typeof i=="object"&&e in i}function GN(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function qN(i,e={}){const t=[],n=new Set;for(const s of i){const r=s.name;if(n.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);n.add(r);const l=GN(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function mC(i,e){if(typeof e!="string"&&!Array.isArray(e)){if(i&&i.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function HN(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function nr(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function gC(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jN(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function zN(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function $N(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function YN(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],jN(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],zN(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],$N(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function yC(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>YN(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function WN(i){const e={},t=h(i,["anyOf"]);t!=null&&p(e,["anyOf"],t);const n=h(i,["default"]);n!=null&&p(e,["default"],n);const s=h(i,["description"]);s!=null&&p(e,["description"],s);const r=h(i,["enum"]);r!=null&&p(e,["enum"],r);const l=h(i,["example"]);l!=null&&p(e,["example"],l);const c=h(i,["format"]);c!=null&&p(e,["format"],c);const f=h(i,["items"]);f!=null&&p(e,["items"],f);const d=h(i,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(i,["maxLength"]);g!=null&&p(e,["maxLength"],g);const v=h(i,["maxProperties"]);v!=null&&p(e,["maxProperties"],v);const b=h(i,["maximum"]);b!=null&&p(e,["maximum"],b);const C=h(i,["minItems"]);C!=null&&p(e,["minItems"],C);const E=h(i,["minLength"]);E!=null&&p(e,["minLength"],E);const A=h(i,["minProperties"]);A!=null&&p(e,["minProperties"],A);const _=h(i,["minimum"]);_!=null&&p(e,["minimum"],_);const w=h(i,["nullable"]);w!=null&&p(e,["nullable"],w);const N=h(i,["pattern"]);N!=null&&p(e,["pattern"],N);const M=h(i,["properties"]);M!=null&&p(e,["properties"],M);const k=h(i,["propertyOrdering"]);k!=null&&p(e,["propertyOrdering"],k);const R=h(i,["required"]);R!=null&&p(e,["required"],R);const I=h(i,["title"]);I!=null&&p(e,["title"],I);const P=h(i,["type"]);return P!=null&&p(e,["type"],P),e}function KN(i){const e={};if(h(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(i,["category"]);t!=null&&p(e,["category"],t);const n=h(i,["threshold"]);return n!=null&&p(e,["threshold"],n),e}function XN(i){const e={},t=h(i,["behavior"]);t!=null&&p(e,["behavior"],t);const n=h(i,["description"]);n!=null&&p(e,["description"],n);const s=h(i,["name"]);s!=null&&p(e,["name"],s);const r=h(i,["parameters"]);r!=null&&p(e,["parameters"],r);const l=h(i,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(i,["response"]);c!=null&&p(e,["response"],c);const f=h(i,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function JN(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function QN(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],JN(t)),e}function ZN(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function eR(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],ZN(t)),e}function tR(){return{}}function nR(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>XN(d))),p(e,["functionDeclarations"],f)}if(h(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=h(i,["googleSearch"]);n!=null&&p(e,["googleSearch"],QN(n));const s=h(i,["googleSearchRetrieval"]);if(s!=null&&p(e,["googleSearchRetrieval"],eR(s)),h(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(i,["urlContext"])!=null&&p(e,["urlContext"],tR());const l=h(i,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(i,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function iR(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["allowedFunctionNames"]);return n!=null&&p(e,["allowedFunctionNames"],n),e}function sR(i){const e={},t=h(i,["latitude"]);t!=null&&p(e,["latitude"],t);const n=h(i,["longitude"]);return n!=null&&p(e,["longitude"],n),e}function oR(i){const e={},t=h(i,["latLng"]);t!=null&&p(e,["latLng"],sR(t));const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function rR(i){const e={},t=h(i,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],iR(t));const n=h(i,["retrievalConfig"]);return n!=null&&p(e,["retrievalConfig"],oR(n)),e}function aR(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function vC(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],aR(t)),e}function lR(i){const e={},t=h(i,["speaker"]);t!=null&&p(e,["speaker"],t);const n=h(i,["voiceConfig"]);return n!=null&&p(e,["voiceConfig"],vC(n)),e}function cR(i){const e={},t=h(i,["speakerVoiceConfigs"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>lR(s))),p(e,["speakerVoiceConfigs"],n)}return e}function uR(i){const e={},t=h(i,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],vC(t));const n=h(i,["multiSpeakerVoiceConfig"]);n!=null&&p(e,["multiSpeakerVoiceConfig"],cR(n));const s=h(i,["languageCode"]);return s!=null&&p(e,["languageCode"],s),e}function dR(i){const e={},t=h(i,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const n=h(i,["thinkingBudget"]);return n!=null&&p(e,["thinkingBudget"],n),e}function fR(i,e,t){const n={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&p(t,["systemInstruction"],yC(Jt(s)));const r=h(e,["temperature"]);r!=null&&p(n,["temperature"],r);const l=h(e,["topP"]);l!=null&&p(n,["topP"],l);const c=h(e,["topK"]);c!=null&&p(n,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(n,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(n,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&p(n,["responseLogprobs"],v);const b=h(e,["logprobs"]);b!=null&&p(n,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&p(n,["presencePenalty"],C);const E=h(e,["frequencyPenalty"]);E!=null&&p(n,["frequencyPenalty"],E);const A=h(e,["seed"]);A!=null&&p(n,["seed"],A);const _=h(e,["responseMimeType"]);_!=null&&p(n,["responseMimeType"],_);const w=h(e,["responseSchema"]);w!=null&&p(n,["responseSchema"],WN(Cp(w)));const N=h(e,["responseJsonSchema"]);if(N!=null&&p(n,["responseJsonSchema"],N),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=h(e,["safetySettings"]);if(t!==void 0&&M!=null){let K=M;Array.isArray(K)&&(K=K.map(ne=>KN(ne))),p(t,["safetySettings"],K)}const k=h(e,["tools"]);if(t!==void 0&&k!=null){let K=tr(k);Array.isArray(K)&&(K=K.map(ne=>nR(er(ne)))),p(t,["tools"],K)}const R=h(e,["toolConfig"]);if(t!==void 0&&R!=null&&p(t,["toolConfig"],rR(R)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=h(e,["cachedContent"]);t!==void 0&&I!=null&&p(t,["cachedContent"],Li(i,I));const P=h(e,["responseModalities"]);P!=null&&p(n,["responseModalities"],P);const q=h(e,["mediaResolution"]);q!=null&&p(n,["mediaResolution"],q);const F=h(e,["speechConfig"]);if(F!=null&&p(n,["speechConfig"],uR(Ap(F))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const $=h(e,["thinkingConfig"]);return $!=null&&p(n,["thinkingConfig"],dR($)),n}function hR(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["request","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>yC(c))),p(t,["request","contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["request","generationConfig"],fR(i,r,t)),t}function pR(i,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=h(e,["fileName"]);n!=null&&p(t,["fileName"],n);const s=h(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>hR(i,l))),p(t,["requests","requests"],r)}return t}function mR(i,e){const t={},n=h(i,["displayName"]);if(e!==void 0&&n!=null&&p(e,["batch","displayName"],n),h(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function gR(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["src"]);s!=null&&p(t,["batch","inputConfig"],pR(i,mC(i,s)));const r=h(e,["config"]);return r!=null&&p(t,["config"],mR(r,t)),t}function yR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function vR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function xR(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);if(e!==void 0&&s!=null&&p(e,["_query","pageToken"],s),h(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function bR(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],xR(t,e)),e}function SR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function CR(i){const e={},t=h(i,["format"]);t!=null&&p(e,["instancesFormat"],t);const n=h(i,["gcsUri"]);n!=null&&p(e,["gcsSource","uris"],n);const s=h(i,["bigqueryUri"]);if(s!=null&&p(e,["bigquerySource","inputUri"],s),h(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function AR(i){const e={},t=h(i,["format"]);t!=null&&p(e,["predictionsFormat"],t);const n=h(i,["gcsUri"]);n!=null&&p(e,["gcsDestination","outputUriPrefix"],n);const s=h(i,["bigqueryUri"]);if(s!=null&&p(e,["bigqueryDestination","outputUri"],s),h(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function ER(i,e){const t={},n=h(i,["displayName"]);e!==void 0&&n!=null&&p(e,["displayName"],n);const s=h(i,["dest"]);return e!==void 0&&s!=null&&p(e,["outputConfig"],AR(HN(s))),t}function _R(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["model"],Qe(i,n));const s=h(e,["src"]);s!=null&&p(t,["inputConfig"],CR(mC(i,s)));const r=h(e,["config"]);return r!=null&&p(t,["config"],ER(r,t)),t}function TR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function wR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function MR(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);e!==void 0&&s!=null&&p(e,["_query","pageToken"],s);const r=h(i,["filter"]);return e!==void 0&&r!=null&&p(e,["_query","filter"],r),t}function NR(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],MR(t,e)),e}function RR(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],nr(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function IR(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function DR(i){const e={},t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function kR(i){const e={},t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function LR(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],IR(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],DR(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],kR(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function PR(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>LR(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function FR(i){const e={},t=h(i,["citationSources"]);return t!=null&&p(e,["citations"],t),e}function OR(i){const e={},t=h(i,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const n=h(i,["urlRetrievalStatus"]);return n!=null&&p(e,["urlRetrievalStatus"],n),e}function UR(i){const e={},t=h(i,["urlMetadata"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>OR(s))),p(e,["urlMetadata"],n)}return e}function BR(i){const e={},t=h(i,["content"]);t!=null&&p(e,["content"],PR(t));const n=h(i,["citationMetadata"]);n!=null&&p(e,["citationMetadata"],FR(n));const s=h(i,["tokenCount"]);s!=null&&p(e,["tokenCount"],s);const r=h(i,["finishReason"]);r!=null&&p(e,["finishReason"],r);const l=h(i,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],UR(l));const c=h(i,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(i,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(i,["index"]);d!=null&&p(e,["index"],d);const g=h(i,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const v=h(i,["safetyRatings"]);return v!=null&&p(e,["safetyRatings"],v),e}function VR(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>BR(f))),p(e,["candidates"],c)}const s=h(i,["modelVersion"]);s!=null&&p(e,["modelVersion"],s);const r=h(i,["promptFeedback"]);r!=null&&p(e,["promptFeedback"],r);const l=h(i,["usageMetadata"]);return l!=null&&p(e,["usageMetadata"],l),e}function xC(i){const e={},t=h(i,["details"]);t!=null&&p(e,["details"],t);const n=h(i,["code"]);n!=null&&p(e,["code"],n);const s=h(i,["message"]);return s!=null&&p(e,["message"],s),e}function GR(i){const e={},t=h(i,["response"]);t!=null&&p(e,["response"],VR(t));const n=h(i,["error"]);return n!=null&&p(e,["error"],xC(n)),e}function qR(i){const e={},t=h(i,["responsesFile"]);t!=null&&p(e,["fileName"],t);const n=h(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>GR(r))),p(e,["inlinedResponses"],s)}return e}function Rh(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["metadata","displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["metadata","state"]);s!=null&&p(e,["state"],gC(s));const r=h(i,["metadata","createTime"]);r!=null&&p(e,["createTime"],r);const l=h(i,["metadata","endTime"]);l!=null&&p(e,["endTime"],l);const c=h(i,["metadata","updateTime"]);c!=null&&p(e,["updateTime"],c);const f=h(i,["metadata","model"]);f!=null&&p(e,["model"],f);const d=h(i,["metadata","output"]);return d!=null&&p(e,["dest"],qR(d)),e}function HR(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>Rh(l))),p(e,["batchJobs"],r)}return e}function jR(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["done"]);n!=null&&p(e,["done"],n);const s=h(i,["error"]);return s!=null&&p(e,["error"],xC(s)),e}function bC(i){const e={},t=h(i,["details"]);t!=null&&p(e,["details"],t);const n=h(i,["code"]);n!=null&&p(e,["code"],n);const s=h(i,["message"]);return s!=null&&p(e,["message"],s),e}function zR(i){const e={},t=h(i,["instancesFormat"]);t!=null&&p(e,["format"],t);const n=h(i,["gcsSource","uris"]);n!=null&&p(e,["gcsUri"],n);const s=h(i,["bigquerySource","inputUri"]);return s!=null&&p(e,["bigqueryUri"],s),e}function $R(i){const e={},t=h(i,["predictionsFormat"]);t!=null&&p(e,["format"],t);const n=h(i,["gcsDestination","outputUriPrefix"]);n!=null&&p(e,["gcsUri"],n);const s=h(i,["bigqueryDestination","outputUri"]);return s!=null&&p(e,["bigqueryUri"],s),e}function Ih(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["state"]);s!=null&&p(e,["state"],gC(s));const r=h(i,["error"]);r!=null&&p(e,["error"],bC(r));const l=h(i,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(i,["startTime"]);c!=null&&p(e,["startTime"],c);const f=h(i,["endTime"]);f!=null&&p(e,["endTime"],f);const d=h(i,["updateTime"]);d!=null&&p(e,["updateTime"],d);const g=h(i,["model"]);g!=null&&p(e,["model"],g);const v=h(i,["inputConfig"]);v!=null&&p(e,["src"],zR(v));const b=h(i,["outputConfig"]);return b!=null&&p(e,["dest"],$R(b)),e}function YR(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>Ih(l))),p(e,["batchJobs"],r)}return e}function WR(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["done"]);n!=null&&p(e,["done"],n);const s=h(i,["error"]);return s!=null&&p(e,["error"],bC(s)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hs;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Hs||(Hs={}));class Oa{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(r=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KR extends Ys{constructor(e){super(),this.apiClient=e,this.create=async t=>{if(this.apiClient.isVertexAI()){const s=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${s}`;else throw new Error("Unsupported source:"+t.src)}return await this.createInternal(t)},this.list=async(t={})=>new Oa(Hs.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t)}async createInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=_R(this.apiClient,e);return c=Ce("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>Ih(g))}else{const d=gR(this.apiClient,e);return c=Ce("{model}:batchGenerateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Rh(g))}}async get(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=TR(this.apiClient,e);return c=Ce("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>Ih(g))}else{const d=yR(this.apiClient,e);return c=Ce("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Rh(g))}}async cancel(e){var t,n,s,r;let l="",c={};if(this.apiClient.isVertexAI()){const f=wR(this.apiClient,e);l=Ce("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const f=vR(this.apiClient,e);l=Ce("batches/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=NR(e);return c=Ce("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=YR(g),b=new Qx;return Object.assign(b,v),b})}else{const d=bR(e);return c=Ce("batches",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=HR(g),b=new Qx;return Object.assign(b,v),b})}}async delete(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=RR(this.apiClient,e);return c=Ce("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>WR(g))}else{const d=SR(this.apiClient,e);return c=Ce("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>jR(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XR(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function JR(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function QR(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function ZR(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],XR(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],JR(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],QR(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function nb(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>ZR(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function e2(i){const e={},t=h(i,["behavior"]);t!=null&&p(e,["behavior"],t);const n=h(i,["description"]);n!=null&&p(e,["description"],n);const s=h(i,["name"]);s!=null&&p(e,["name"],s);const r=h(i,["parameters"]);r!=null&&p(e,["parameters"],r);const l=h(i,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(i,["response"]);c!=null&&p(e,["response"],c);const f=h(i,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function t2(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function n2(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t2(t)),e}function i2(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function s2(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],i2(t)),e}function o2(){return{}}function r2(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>e2(d))),p(e,["functionDeclarations"],f)}if(h(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=h(i,["googleSearch"]);n!=null&&p(e,["googleSearch"],n2(n));const s=h(i,["googleSearchRetrieval"]);if(s!=null&&p(e,["googleSearchRetrieval"],s2(s)),h(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(i,["urlContext"])!=null&&p(e,["urlContext"],o2());const l=h(i,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(i,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function a2(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["allowedFunctionNames"]);return n!=null&&p(e,["allowedFunctionNames"],n),e}function l2(i){const e={},t=h(i,["latitude"]);t!=null&&p(e,["latitude"],t);const n=h(i,["longitude"]);return n!=null&&p(e,["longitude"],n),e}function c2(i){const e={},t=h(i,["latLng"]);t!=null&&p(e,["latLng"],l2(t));const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function u2(i){const e={},t=h(i,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],a2(t));const n=h(i,["retrievalConfig"]);return n!=null&&p(e,["retrievalConfig"],c2(n)),e}function d2(i,e){const t={},n=h(i,["ttl"]);e!==void 0&&n!=null&&p(e,["ttl"],n);const s=h(i,["expireTime"]);e!==void 0&&s!=null&&p(e,["expireTime"],s);const r=h(i,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const l=h(i,["contents"]);if(e!==void 0&&l!=null){let g=Un(l);Array.isArray(g)&&(g=g.map(v=>nb(v))),p(e,["contents"],g)}const c=h(i,["systemInstruction"]);e!==void 0&&c!=null&&p(e,["systemInstruction"],nb(Jt(c)));const f=h(i,["tools"]);if(e!==void 0&&f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>r2(v))),p(e,["tools"],g)}const d=h(i,["toolConfig"]);if(e!==void 0&&d!=null&&p(e,["toolConfig"],u2(d)),h(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function f2(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["model"],oC(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],d2(s,t)),t}function h2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function p2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function m2(i,e){const t={},n=h(i,["ttl"]);e!==void 0&&n!=null&&p(e,["ttl"],n);const s=h(i,["expireTime"]);return e!==void 0&&s!=null&&p(e,["expireTime"],s),t}function g2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],m2(s,t)),t}function y2(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);return e!==void 0&&s!=null&&p(e,["_query","pageToken"],s),t}function v2(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],y2(t,e)),e}function x2(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function b2(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["data"]);n!=null&&p(e,["data"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function S2(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["fileUri"]);n!=null&&p(e,["fileUri"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function C2(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],x2(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],b2(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],S2(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function ib(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>C2(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function A2(i){const e={};if(h(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(i,["description"]);t!=null&&p(e,["description"],t);const n=h(i,["name"]);n!=null&&p(e,["name"],n);const s=h(i,["parameters"]);s!=null&&p(e,["parameters"],s);const r=h(i,["parametersJsonSchema"]);r!=null&&p(e,["parametersJsonSchema"],r);const l=h(i,["response"]);l!=null&&p(e,["response"],l);const c=h(i,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function E2(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function _2(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],E2(t)),e}function T2(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function w2(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],T2(t)),e}function M2(){return{}}function N2(i){const e={},t=h(i,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function R2(i){const e={},t=h(i,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],N2(t));const n=h(i,["authType"]);n!=null&&p(e,["authType"],n);const s=h(i,["googleServiceAccountConfig"]);s!=null&&p(e,["googleServiceAccountConfig"],s);const r=h(i,["httpBasicAuthConfig"]);r!=null&&p(e,["httpBasicAuthConfig"],r);const l=h(i,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(i,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function I2(i){const e={},t=h(i,["authConfig"]);return t!=null&&p(e,["authConfig"],R2(t)),e}function D2(){return{}}function k2(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(b=>A2(b))),p(e,["functionDeclarations"],v)}const n=h(i,["retrieval"]);n!=null&&p(e,["retrieval"],n);const s=h(i,["googleSearch"]);s!=null&&p(e,["googleSearch"],_2(s));const r=h(i,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],w2(r)),h(i,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],M2());const c=h(i,["googleMaps"]);c!=null&&p(e,["googleMaps"],I2(c)),h(i,["urlContext"])!=null&&p(e,["urlContext"],D2());const d=h(i,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(i,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function L2(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["allowedFunctionNames"]);return n!=null&&p(e,["allowedFunctionNames"],n),e}function P2(i){const e={},t=h(i,["latitude"]);t!=null&&p(e,["latitude"],t);const n=h(i,["longitude"]);return n!=null&&p(e,["longitude"],n),e}function F2(i){const e={},t=h(i,["latLng"]);t!=null&&p(e,["latLng"],P2(t));const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function O2(i){const e={},t=h(i,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],L2(t));const n=h(i,["retrievalConfig"]);return n!=null&&p(e,["retrievalConfig"],F2(n)),e}function U2(i,e){const t={},n=h(i,["ttl"]);e!==void 0&&n!=null&&p(e,["ttl"],n);const s=h(i,["expireTime"]);e!==void 0&&s!=null&&p(e,["expireTime"],s);const r=h(i,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const l=h(i,["contents"]);if(e!==void 0&&l!=null){let v=Un(l);Array.isArray(v)&&(v=v.map(b=>ib(b))),p(e,["contents"],v)}const c=h(i,["systemInstruction"]);e!==void 0&&c!=null&&p(e,["systemInstruction"],ib(Jt(c)));const f=h(i,["tools"]);if(e!==void 0&&f!=null){let v=f;Array.isArray(v)&&(v=v.map(b=>k2(b))),p(e,["tools"],v)}const d=h(i,["toolConfig"]);e!==void 0&&d!=null&&p(e,["toolConfig"],O2(d));const g=h(i,["kmsKeyName"]);return e!==void 0&&g!=null&&p(e,["encryption_spec","kmsKeyName"],g),t}function B2(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["model"],oC(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],U2(s,t)),t}function V2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function G2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function q2(i,e){const t={},n=h(i,["ttl"]);e!==void 0&&n!=null&&p(e,["ttl"],n);const s=h(i,["expireTime"]);return e!==void 0&&s!=null&&p(e,["expireTime"],s),t}function H2(i,e){const t={},n=h(e,["name"]);n!=null&&p(t,["_url","name"],Li(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],q2(s,t)),t}function j2(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);return e!==void 0&&s!=null&&p(e,["_query","pageToken"],s),t}function z2(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],j2(t,e)),e}function yc(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["model"]);s!=null&&p(e,["model"],s);const r=h(i,["createTime"]);r!=null&&p(e,["createTime"],r);const l=h(i,["updateTime"]);l!=null&&p(e,["updateTime"],l);const c=h(i,["expireTime"]);c!=null&&p(e,["expireTime"],c);const f=h(i,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function $2(){return{}}function Y2(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>yc(l))),p(e,["cachedContents"],r)}return e}function vc(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["model"]);s!=null&&p(e,["model"],s);const r=h(i,["createTime"]);r!=null&&p(e,["createTime"],r);const l=h(i,["updateTime"]);l!=null&&p(e,["updateTime"],l);const c=h(i,["expireTime"]);c!=null&&p(e,["expireTime"],c);const f=h(i,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function W2(){return{}}function K2(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>vc(l))),p(e,["cachedContents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X2 extends Ys{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(Hs.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=B2(this.apiClient,e);return c=Ce("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>vc(g))}else{const d=f2(this.apiClient,e);return c=Ce("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>yc(g))}}async get(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=V2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>vc(g))}else{const d=h2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>yc(g))}}async delete(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=G2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(()=>{const g=W2(),v=new Xx;return Object.assign(v,g),v})}else{const d=p2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=$2(),v=new Xx;return Object.assign(v,g),v})}}async update(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=H2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>vc(g))}else{const d=g2(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>yc(g))}}async listInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=z2(e);return c=Ce("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=K2(g),b=new Jx;return Object.assign(b,v),b})}else{const d=v2(e);return c=Ce("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=Y2(g),b=new Jx;return Object.assign(b,v),b})}}}function sb(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function at(i){return this instanceof at?(this.v=i,this):new at(i)}function Wo(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(C){return function(E){return Promise.resolve(E).then(C,v)}}function c(C,E){n[C]&&(s[C]=function(A){return new Promise(function(_,w){r.push([C,A,_,w])>1||f(C,A)})},E&&(s[C]=E(s[C])))}function f(C,E){try{d(n[C](E))}catch(A){b(r[0][3],A)}}function d(C){C.value instanceof at?Promise.resolve(C.value.v).then(g,v):b(r[0][2],C)}function g(C){f("next",C)}function v(C){f("throw",C)}function b(C,E){C(E),r.shift(),r.length&&f(r[0][0],r[0][1])}}function va(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof sb=="function"?sb(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=i[r]&&function(l){return new Promise(function(c,f){l=i[r](l),s(c,f,l.done,l.value)})}}function s(r,l,c,f){Promise.resolve(f).then(function(d){r({value:d,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J2(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:SC(t)}function SC(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function Q2(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function ob(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let r=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),r&&!SC(i[n])&&(r=!1),n++;r?e.push(...s):e.pop()}return e}class Z2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new eI(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class eI{constructor(e,t,n,s={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),Q2(r)}async sendMessage(e){var t;await this.sendPromise;const n=Jt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,l,c;const f=await s,d=(l=(r=f.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content,g=f.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let b=[];g!=null&&(b=(c=g.slice(v))!==null&&c!==void 0?c:[]);const C=d?[d]:[];this.recordHistory(n,C,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=Jt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,n)}getHistory(e=!1){const t=e?ob(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,s;return Wo(this,arguments,function*(){var l,c,f,d;const g=[];try{for(var v=!0,b=va(e),C;C=yield at(b.next()),l=C.done,!l;v=!0){d=C.value,v=!1;const E=d;if(J2(E)){const A=(s=(n=E.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content;A!==void 0&&g.push(A)}yield yield at(E)}}catch(E){c={error:E}}finally{try{!v&&!l&&(f=b.return)&&(yield at(f.call(b)))}finally{if(c)throw c.error}}this.recordHistory(t,g)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(r=>r.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...ob(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $c extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,$c.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tI(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);return e!==void 0&&s!=null&&p(e,["_query","pageToken"],s),t}function nI(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],tI(t,e)),e}function iI(i){const e={},t=h(i,["details"]);t!=null&&p(e,["details"],t);const n=h(i,["message"]);n!=null&&p(e,["message"],n);const s=h(i,["code"]);return s!=null&&p(e,["code"],s),e}function sI(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["mimeType"]);s!=null&&p(e,["mimeType"],s);const r=h(i,["sizeBytes"]);r!=null&&p(e,["sizeBytes"],r);const l=h(i,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(i,["expirationTime"]);c!=null&&p(e,["expirationTime"],c);const f=h(i,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(i,["sha256Hash"]);d!=null&&p(e,["sha256Hash"],d);const g=h(i,["uri"]);g!=null&&p(e,["uri"],g);const v=h(i,["downloadUri"]);v!=null&&p(e,["downloadUri"],v);const b=h(i,["state"]);b!=null&&p(e,["state"],b);const C=h(i,["source"]);C!=null&&p(e,["source"],C);const E=h(i,["videoMetadata"]);E!=null&&p(e,["videoMetadata"],E);const A=h(i,["error"]);return A!=null&&p(e,["error"],iI(A)),e}function oI(i){const e={},t=h(i,["file"]);t!=null&&p(e,["file"],sI(t));const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function rI(i){const e={},t=h(i,["name"]);t!=null&&p(e,["_url","file"],fC(t));const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function aI(i){const e={},t=h(i,["name"]);t!=null&&p(e,["_url","file"],fC(t));const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function lI(i){const e={},t=h(i,["details"]);t!=null&&p(e,["details"],t);const n=h(i,["message"]);n!=null&&p(e,["message"],n);const s=h(i,["code"]);return s!=null&&p(e,["code"],s),e}function Dh(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["mimeType"]);s!=null&&p(e,["mimeType"],s);const r=h(i,["sizeBytes"]);r!=null&&p(e,["sizeBytes"],r);const l=h(i,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(i,["expirationTime"]);c!=null&&p(e,["expirationTime"],c);const f=h(i,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(i,["sha256Hash"]);d!=null&&p(e,["sha256Hash"],d);const g=h(i,["uri"]);g!=null&&p(e,["uri"],g);const v=h(i,["downloadUri"]);v!=null&&p(e,["downloadUri"],v);const b=h(i,["state"]);b!=null&&p(e,["state"],b);const C=h(i,["source"]);C!=null&&p(e,["source"],C);const E=h(i,["videoMetadata"]);E!=null&&p(e,["videoMetadata"],E);const A=h(i,["error"]);return A!=null&&p(e,["error"],lI(A)),e}function cI(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>Dh(l))),p(e,["files"],r)}return e}function uI(i){const e={},t=h(i,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function dI(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fI extends Ys{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Oa(Hs.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Dh(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=nI(e);return r=Ce("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),s.then(f=>{const d=cI(f),g=new RN;return Object.assign(g,d),g})}}async createInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=oI(e);return r=Ce("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>{const d=uI(f),g=new IN;return Object.assign(g,d),g})}}async get(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rI(e);return r=Ce("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>Dh(f))}}async delete(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=aI(e);return r=Ce("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(()=>{const f=dI(),d=new DN;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hI(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function CC(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],hI(t)),e}function pI(i){const e={},t=h(i,["speaker"]);t!=null&&p(e,["speaker"],t);const n=h(i,["voiceConfig"]);return n!=null&&p(e,["voiceConfig"],CC(n)),e}function mI(i){const e={},t=h(i,["speakerVoiceConfigs"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>pI(s))),p(e,["speakerVoiceConfigs"],n)}return e}function gI(i){const e={},t=h(i,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],CC(t));const n=h(i,["multiSpeakerVoiceConfig"]);n!=null&&p(e,["multiSpeakerVoiceConfig"],mI(n));const s=h(i,["languageCode"]);return s!=null&&p(e,["languageCode"],s),e}function yI(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function vI(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function xI(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function bI(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],yI(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],vI(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],xI(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function SI(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>bI(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function CI(i){const e={},t=h(i,["behavior"]);t!=null&&p(e,["behavior"],t);const n=h(i,["description"]);n!=null&&p(e,["description"],n);const s=h(i,["name"]);s!=null&&p(e,["name"],s);const r=h(i,["parameters"]);r!=null&&p(e,["parameters"],r);const l=h(i,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(i,["response"]);c!=null&&p(e,["response"],c);const f=h(i,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function AI(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function EI(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],AI(t)),e}function _I(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function TI(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],_I(t)),e}function wI(){return{}}function MI(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>CI(d))),p(e,["functionDeclarations"],f)}if(h(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=h(i,["googleSearch"]);n!=null&&p(e,["googleSearch"],EI(n));const s=h(i,["googleSearchRetrieval"]);if(s!=null&&p(e,["googleSearchRetrieval"],TI(s)),h(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(i,["urlContext"])!=null&&p(e,["urlContext"],wI());const l=h(i,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(i,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function NI(i){const e={},t=h(i,["handle"]);if(t!=null&&p(e,["handle"],t),h(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function rb(){return{}}function RI(i){const e={},t=h(i,["disabled"]);t!=null&&p(e,["disabled"],t);const n=h(i,["startOfSpeechSensitivity"]);n!=null&&p(e,["startOfSpeechSensitivity"],n);const s=h(i,["endOfSpeechSensitivity"]);s!=null&&p(e,["endOfSpeechSensitivity"],s);const r=h(i,["prefixPaddingMs"]);r!=null&&p(e,["prefixPaddingMs"],r);const l=h(i,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function II(i){const e={},t=h(i,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],RI(t));const n=h(i,["activityHandling"]);n!=null&&p(e,["activityHandling"],n);const s=h(i,["turnCoverage"]);return s!=null&&p(e,["turnCoverage"],s),e}function DI(i){const e={},t=h(i,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function kI(i){const e={},t=h(i,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const n=h(i,["slidingWindow"]);return n!=null&&p(e,["slidingWindow"],DI(n)),e}function LI(i){const e={},t=h(i,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function PI(i,e){const t={},n=h(i,["generationConfig"]);e!==void 0&&n!=null&&p(e,["setup","generationConfig"],n);const s=h(i,["responseModalities"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","responseModalities"],s);const r=h(i,["temperature"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","temperature"],r);const l=h(i,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(i,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(i,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(i,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(i,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const v=h(i,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],gI(Ep(v)));const b=h(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],b);const C=h(i,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],SI(Jt(C)));const E=h(i,["tools"]);if(e!==void 0&&E!=null){let R=tr(E);Array.isArray(R)&&(R=R.map(I=>MI(er(I)))),p(e,["setup","tools"],R)}const A=h(i,["sessionResumption"]);e!==void 0&&A!=null&&p(e,["setup","sessionResumption"],NI(A));const _=h(i,["inputAudioTranscription"]);e!==void 0&&_!=null&&p(e,["setup","inputAudioTranscription"],rb());const w=h(i,["outputAudioTranscription"]);e!==void 0&&w!=null&&p(e,["setup","outputAudioTranscription"],rb());const N=h(i,["realtimeInputConfig"]);e!==void 0&&N!=null&&p(e,["setup","realtimeInputConfig"],II(N));const M=h(i,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],kI(M));const k=h(i,["proactivity"]);return e!==void 0&&k!=null&&p(e,["setup","proactivity"],LI(k)),t}function FI(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["setup","model"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],PI(s,t)),t}function OI(){return{}}function UI(){return{}}function BI(i){const e={},t=h(i,["media"]);t!=null&&p(e,["mediaChunks"],rC(t));const n=h(i,["audio"]);n!=null&&p(e,["audio"],lC(n));const s=h(i,["audioStreamEnd"]);s!=null&&p(e,["audioStreamEnd"],s);const r=h(i,["video"]);r!=null&&p(e,["video"],aC(r));const l=h(i,["text"]);return l!=null&&p(e,["text"],l),h(i,["activityStart"])!=null&&p(e,["activityStart"],OI()),h(i,["activityEnd"])!=null&&p(e,["activityEnd"],UI()),e}function AC(i){const e={},t=h(i,["text"]);t!=null&&p(e,["text"],t);const n=h(i,["weight"]);return n!=null&&p(e,["weight"],n),e}function VI(i){const e={},t=h(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>AC(s))),p(e,["weightedPrompts"],n)}return e}function EC(i){const e={},t=h(i,["temperature"]);t!=null&&p(e,["temperature"],t);const n=h(i,["topK"]);n!=null&&p(e,["topK"],n);const s=h(i,["seed"]);s!=null&&p(e,["seed"],s);const r=h(i,["guidance"]);r!=null&&p(e,["guidance"],r);const l=h(i,["bpm"]);l!=null&&p(e,["bpm"],l);const c=h(i,["density"]);c!=null&&p(e,["density"],c);const f=h(i,["brightness"]);f!=null&&p(e,["brightness"],f);const d=h(i,["scale"]);d!=null&&p(e,["scale"],d);const g=h(i,["muteBass"]);g!=null&&p(e,["muteBass"],g);const v=h(i,["muteDrums"]);v!=null&&p(e,["muteDrums"],v);const b=h(i,["onlyBassAndDrums"]);return b!=null&&p(e,["onlyBassAndDrums"],b),e}function GI(i){const e={},t=h(i,["musicGenerationConfig"]);return t!=null&&p(e,["musicGenerationConfig"],EC(t)),e}function _C(i){const e={},t=h(i,["model"]);return t!=null&&p(e,["model"],t),e}function TC(i){const e={},t=h(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>AC(s))),p(e,["weightedPrompts"],n)}return e}function kh(i){const e={},t=h(i,["setup"]);t!=null&&p(e,["setup"],_C(t));const n=h(i,["clientContent"]);n!=null&&p(e,["clientContent"],TC(n));const s=h(i,["musicGenerationConfig"]);s!=null&&p(e,["musicGenerationConfig"],EC(s));const r=h(i,["playbackControl"]);return r!=null&&p(e,["playbackControl"],r),e}function qI(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function HI(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],qI(t)),e}function jI(i){const e={},t=h(i,["voiceConfig"]);if(t!=null&&p(e,["voiceConfig"],HI(t)),h(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function zI(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function $I(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["data"]);n!=null&&p(e,["data"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function YI(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["fileUri"]);n!=null&&p(e,["fileUri"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function WI(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],zI(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],$I(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],YI(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function KI(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>WI(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function XI(i){const e={};if(h(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(i,["description"]);t!=null&&p(e,["description"],t);const n=h(i,["name"]);n!=null&&p(e,["name"],n);const s=h(i,["parameters"]);s!=null&&p(e,["parameters"],s);const r=h(i,["parametersJsonSchema"]);r!=null&&p(e,["parametersJsonSchema"],r);const l=h(i,["response"]);l!=null&&p(e,["response"],l);const c=h(i,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function JI(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function QI(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],JI(t)),e}function ZI(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function eD(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],ZI(t)),e}function tD(){return{}}function nD(i){const e={},t=h(i,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function iD(i){const e={},t=h(i,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],nD(t));const n=h(i,["authType"]);n!=null&&p(e,["authType"],n);const s=h(i,["googleServiceAccountConfig"]);s!=null&&p(e,["googleServiceAccountConfig"],s);const r=h(i,["httpBasicAuthConfig"]);r!=null&&p(e,["httpBasicAuthConfig"],r);const l=h(i,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(i,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function sD(i){const e={},t=h(i,["authConfig"]);return t!=null&&p(e,["authConfig"],iD(t)),e}function oD(){return{}}function rD(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(b=>XI(b))),p(e,["functionDeclarations"],v)}const n=h(i,["retrieval"]);n!=null&&p(e,["retrieval"],n);const s=h(i,["googleSearch"]);s!=null&&p(e,["googleSearch"],QI(s));const r=h(i,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],eD(r)),h(i,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],tD());const c=h(i,["googleMaps"]);c!=null&&p(e,["googleMaps"],sD(c)),h(i,["urlContext"])!=null&&p(e,["urlContext"],oD());const d=h(i,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(i,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function aD(i){const e={},t=h(i,["handle"]);t!=null&&p(e,["handle"],t);const n=h(i,["transparent"]);return n!=null&&p(e,["transparent"],n),e}function ab(){return{}}function lD(i){const e={},t=h(i,["disabled"]);t!=null&&p(e,["disabled"],t);const n=h(i,["startOfSpeechSensitivity"]);n!=null&&p(e,["startOfSpeechSensitivity"],n);const s=h(i,["endOfSpeechSensitivity"]);s!=null&&p(e,["endOfSpeechSensitivity"],s);const r=h(i,["prefixPaddingMs"]);r!=null&&p(e,["prefixPaddingMs"],r);const l=h(i,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function cD(i){const e={},t=h(i,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],lD(t));const n=h(i,["activityHandling"]);n!=null&&p(e,["activityHandling"],n);const s=h(i,["turnCoverage"]);return s!=null&&p(e,["turnCoverage"],s),e}function uD(i){const e={},t=h(i,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function dD(i){const e={},t=h(i,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const n=h(i,["slidingWindow"]);return n!=null&&p(e,["slidingWindow"],uD(n)),e}function fD(i){const e={},t=h(i,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function hD(i,e){const t={},n=h(i,["generationConfig"]);e!==void 0&&n!=null&&p(e,["setup","generationConfig"],n);const s=h(i,["responseModalities"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","responseModalities"],s);const r=h(i,["temperature"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","temperature"],r);const l=h(i,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(i,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(i,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(i,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(i,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const v=h(i,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],jI(Ep(v)));const b=h(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],b);const C=h(i,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],KI(Jt(C)));const E=h(i,["tools"]);if(e!==void 0&&E!=null){let R=tr(E);Array.isArray(R)&&(R=R.map(I=>rD(er(I)))),p(e,["setup","tools"],R)}const A=h(i,["sessionResumption"]);e!==void 0&&A!=null&&p(e,["setup","sessionResumption"],aD(A));const _=h(i,["inputAudioTranscription"]);e!==void 0&&_!=null&&p(e,["setup","inputAudioTranscription"],ab());const w=h(i,["outputAudioTranscription"]);e!==void 0&&w!=null&&p(e,["setup","outputAudioTranscription"],ab());const N=h(i,["realtimeInputConfig"]);e!==void 0&&N!=null&&p(e,["setup","realtimeInputConfig"],cD(N));const M=h(i,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],dD(M));const k=h(i,["proactivity"]);return e!==void 0&&k!=null&&p(e,["setup","proactivity"],fD(k)),t}function pD(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["setup","model"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],hD(s,t)),t}function mD(){return{}}function gD(){return{}}function yD(i){const e={},t=h(i,["media"]);t!=null&&p(e,["mediaChunks"],rC(t));const n=h(i,["audio"]);n!=null&&p(e,["audio"],lC(n));const s=h(i,["audioStreamEnd"]);s!=null&&p(e,["audioStreamEnd"],s);const r=h(i,["video"]);r!=null&&p(e,["video"],aC(r));const l=h(i,["text"]);return l!=null&&p(e,["text"],l),h(i,["activityStart"])!=null&&p(e,["activityStart"],mD()),h(i,["activityEnd"])!=null&&p(e,["activityEnd"],gD()),e}function vD(){return{}}function xD(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function bD(i){const e={},t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function SD(i){const e={},t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function CD(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],xD(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],bD(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],SD(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function AD(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>CD(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function lb(i){const e={},t=h(i,["text"]);t!=null&&p(e,["text"],t);const n=h(i,["finished"]);return n!=null&&p(e,["finished"],n),e}function ED(i){const e={},t=h(i,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const n=h(i,["urlRetrievalStatus"]);return n!=null&&p(e,["urlRetrievalStatus"],n),e}function _D(i){const e={},t=h(i,["urlMetadata"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>ED(s))),p(e,["urlMetadata"],n)}return e}function TD(i){const e={},t=h(i,["modelTurn"]);t!=null&&p(e,["modelTurn"],AD(t));const n=h(i,["turnComplete"]);n!=null&&p(e,["turnComplete"],n);const s=h(i,["interrupted"]);s!=null&&p(e,["interrupted"],s);const r=h(i,["groundingMetadata"]);r!=null&&p(e,["groundingMetadata"],r);const l=h(i,["generationComplete"]);l!=null&&p(e,["generationComplete"],l);const c=h(i,["inputTranscription"]);c!=null&&p(e,["inputTranscription"],lb(c));const f=h(i,["outputTranscription"]);f!=null&&p(e,["outputTranscription"],lb(f));const d=h(i,["urlContextMetadata"]);return d!=null&&p(e,["urlContextMetadata"],_D(d)),e}function wD(i){const e={},t=h(i,["id"]);t!=null&&p(e,["id"],t);const n=h(i,["args"]);n!=null&&p(e,["args"],n);const s=h(i,["name"]);return s!=null&&p(e,["name"],s),e}function MD(i){const e={},t=h(i,["functionCalls"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>wD(s))),p(e,["functionCalls"],n)}return e}function ND(i){const e={},t=h(i,["ids"]);return t!=null&&p(e,["ids"],t),e}function rc(i){const e={},t=h(i,["modality"]);t!=null&&p(e,["modality"],t);const n=h(i,["tokenCount"]);return n!=null&&p(e,["tokenCount"],n),e}function RD(i){const e={},t=h(i,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);const n=h(i,["cachedContentTokenCount"]);n!=null&&p(e,["cachedContentTokenCount"],n);const s=h(i,["responseTokenCount"]);s!=null&&p(e,["responseTokenCount"],s);const r=h(i,["toolUsePromptTokenCount"]);r!=null&&p(e,["toolUsePromptTokenCount"],r);const l=h(i,["thoughtsTokenCount"]);l!=null&&p(e,["thoughtsTokenCount"],l);const c=h(i,["totalTokenCount"]);c!=null&&p(e,["totalTokenCount"],c);const f=h(i,["promptTokensDetails"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(C=>rc(C))),p(e,["promptTokensDetails"],b)}const d=h(i,["cacheTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(C=>rc(C))),p(e,["cacheTokensDetails"],b)}const g=h(i,["responseTokensDetails"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(C=>rc(C))),p(e,["responseTokensDetails"],b)}const v=h(i,["toolUsePromptTokensDetails"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(C=>rc(C))),p(e,["toolUsePromptTokensDetails"],b)}return e}function ID(i){const e={},t=h(i,["timeLeft"]);return t!=null&&p(e,["timeLeft"],t),e}function DD(i){const e={},t=h(i,["newHandle"]);t!=null&&p(e,["newHandle"],t);const n=h(i,["resumable"]);n!=null&&p(e,["resumable"],n);const s=h(i,["lastConsumedClientMessageIndex"]);return s!=null&&p(e,["lastConsumedClientMessageIndex"],s),e}function kD(i){const e={};h(i,["setupComplete"])!=null&&p(e,["setupComplete"],vD());const n=h(i,["serverContent"]);n!=null&&p(e,["serverContent"],TD(n));const s=h(i,["toolCall"]);s!=null&&p(e,["toolCall"],MD(s));const r=h(i,["toolCallCancellation"]);r!=null&&p(e,["toolCallCancellation"],ND(r));const l=h(i,["usageMetadata"]);l!=null&&p(e,["usageMetadata"],RD(l));const c=h(i,["goAway"]);c!=null&&p(e,["goAway"],ID(c));const f=h(i,["sessionResumptionUpdate"]);return f!=null&&p(e,["sessionResumptionUpdate"],DD(f)),e}function LD(){return{}}function PD(i){const e={},t=h(i,["text"]);t!=null&&p(e,["text"],t);const n=h(i,["weight"]);return n!=null&&p(e,["weight"],n),e}function FD(i){const e={},t=h(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>PD(s))),p(e,["weightedPrompts"],n)}return e}function OD(i){const e={},t=h(i,["temperature"]);t!=null&&p(e,["temperature"],t);const n=h(i,["topK"]);n!=null&&p(e,["topK"],n);const s=h(i,["seed"]);s!=null&&p(e,["seed"],s);const r=h(i,["guidance"]);r!=null&&p(e,["guidance"],r);const l=h(i,["bpm"]);l!=null&&p(e,["bpm"],l);const c=h(i,["density"]);c!=null&&p(e,["density"],c);const f=h(i,["brightness"]);f!=null&&p(e,["brightness"],f);const d=h(i,["scale"]);d!=null&&p(e,["scale"],d);const g=h(i,["muteBass"]);g!=null&&p(e,["muteBass"],g);const v=h(i,["muteDrums"]);v!=null&&p(e,["muteDrums"],v);const b=h(i,["onlyBassAndDrums"]);return b!=null&&p(e,["onlyBassAndDrums"],b),e}function UD(i){const e={},t=h(i,["clientContent"]);t!=null&&p(e,["clientContent"],FD(t));const n=h(i,["musicGenerationConfig"]);return n!=null&&p(e,["musicGenerationConfig"],OD(n)),e}function BD(i){const e={},t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);n!=null&&p(e,["mimeType"],n);const s=h(i,["sourceMetadata"]);return s!=null&&p(e,["sourceMetadata"],UD(s)),e}function VD(i){const e={},t=h(i,["audioChunks"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>BD(s))),p(e,["audioChunks"],n)}return e}function GD(i){const e={},t=h(i,["text"]);t!=null&&p(e,["text"],t);const n=h(i,["filteredReason"]);return n!=null&&p(e,["filteredReason"],n),e}function qD(i){const e={};h(i,["setupComplete"])!=null&&p(e,["setupComplete"],LD());const n=h(i,["serverContent"]);n!=null&&p(e,["serverContent"],VD(n));const s=h(i,["filteredPrompt"]);return s!=null&&p(e,["filteredPrompt"],GD(s)),e}function HD(i){const e={},t=h(i,["sessionId"]);return t!=null&&p(e,["sessionId"],t),e}function jD(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function zD(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["data"]);n!=null&&p(e,["data"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function $D(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["fileUri"]);n!=null&&p(e,["fileUri"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function YD(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],jD(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],zD(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],$D(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function WD(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>YD(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function cb(i){const e={},t=h(i,["text"]);t!=null&&p(e,["text"],t);const n=h(i,["finished"]);return n!=null&&p(e,["finished"],n),e}function KD(i){const e={},t=h(i,["modelTurn"]);t!=null&&p(e,["modelTurn"],WD(t));const n=h(i,["turnComplete"]);n!=null&&p(e,["turnComplete"],n);const s=h(i,["interrupted"]);s!=null&&p(e,["interrupted"],s);const r=h(i,["groundingMetadata"]);r!=null&&p(e,["groundingMetadata"],r);const l=h(i,["generationComplete"]);l!=null&&p(e,["generationComplete"],l);const c=h(i,["inputTranscription"]);c!=null&&p(e,["inputTranscription"],cb(c));const f=h(i,["outputTranscription"]);return f!=null&&p(e,["outputTranscription"],cb(f)),e}function XD(i){const e={},t=h(i,["args"]);t!=null&&p(e,["args"],t);const n=h(i,["name"]);return n!=null&&p(e,["name"],n),e}function JD(i){const e={},t=h(i,["functionCalls"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>XD(s))),p(e,["functionCalls"],n)}return e}function QD(i){const e={},t=h(i,["ids"]);return t!=null&&p(e,["ids"],t),e}function ac(i){const e={},t=h(i,["modality"]);t!=null&&p(e,["modality"],t);const n=h(i,["tokenCount"]);return n!=null&&p(e,["tokenCount"],n),e}function ZD(i){const e={},t=h(i,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);const n=h(i,["cachedContentTokenCount"]);n!=null&&p(e,["cachedContentTokenCount"],n);const s=h(i,["candidatesTokenCount"]);s!=null&&p(e,["responseTokenCount"],s);const r=h(i,["toolUsePromptTokenCount"]);r!=null&&p(e,["toolUsePromptTokenCount"],r);const l=h(i,["thoughtsTokenCount"]);l!=null&&p(e,["thoughtsTokenCount"],l);const c=h(i,["totalTokenCount"]);c!=null&&p(e,["totalTokenCount"],c);const f=h(i,["promptTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(E=>ac(E))),p(e,["promptTokensDetails"],C)}const d=h(i,["cacheTokensDetails"]);if(d!=null){let C=d;Array.isArray(C)&&(C=C.map(E=>ac(E))),p(e,["cacheTokensDetails"],C)}const g=h(i,["candidatesTokensDetails"]);if(g!=null){let C=g;Array.isArray(C)&&(C=C.map(E=>ac(E))),p(e,["responseTokensDetails"],C)}const v=h(i,["toolUsePromptTokensDetails"]);if(v!=null){let C=v;Array.isArray(C)&&(C=C.map(E=>ac(E))),p(e,["toolUsePromptTokensDetails"],C)}const b=h(i,["trafficType"]);return b!=null&&p(e,["trafficType"],b),e}function ek(i){const e={},t=h(i,["timeLeft"]);return t!=null&&p(e,["timeLeft"],t),e}function tk(i){const e={},t=h(i,["newHandle"]);t!=null&&p(e,["newHandle"],t);const n=h(i,["resumable"]);n!=null&&p(e,["resumable"],n);const s=h(i,["lastConsumedClientMessageIndex"]);return s!=null&&p(e,["lastConsumedClientMessageIndex"],s),e}function nk(i){const e={},t=h(i,["setupComplete"]);t!=null&&p(e,["setupComplete"],HD(t));const n=h(i,["serverContent"]);n!=null&&p(e,["serverContent"],KD(n));const s=h(i,["toolCall"]);s!=null&&p(e,["toolCall"],JD(s));const r=h(i,["toolCallCancellation"]);r!=null&&p(e,["toolCallCancellation"],QD(r));const l=h(i,["usageMetadata"]);l!=null&&p(e,["usageMetadata"],ZD(l));const c=h(i,["goAway"]);c!=null&&p(e,["goAway"],ek(c));const f=h(i,["sessionResumptionUpdate"]);return f!=null&&p(e,["sessionResumptionUpdate"],tk(f)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ik(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function sk(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function ok(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function rk(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],ik(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],sk(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],ok(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function Yc(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>rk(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function ak(i){const e={},t=h(i,["anyOf"]);t!=null&&p(e,["anyOf"],t);const n=h(i,["default"]);n!=null&&p(e,["default"],n);const s=h(i,["description"]);s!=null&&p(e,["description"],s);const r=h(i,["enum"]);r!=null&&p(e,["enum"],r);const l=h(i,["example"]);l!=null&&p(e,["example"],l);const c=h(i,["format"]);c!=null&&p(e,["format"],c);const f=h(i,["items"]);f!=null&&p(e,["items"],f);const d=h(i,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(i,["maxLength"]);g!=null&&p(e,["maxLength"],g);const v=h(i,["maxProperties"]);v!=null&&p(e,["maxProperties"],v);const b=h(i,["maximum"]);b!=null&&p(e,["maximum"],b);const C=h(i,["minItems"]);C!=null&&p(e,["minItems"],C);const E=h(i,["minLength"]);E!=null&&p(e,["minLength"],E);const A=h(i,["minProperties"]);A!=null&&p(e,["minProperties"],A);const _=h(i,["minimum"]);_!=null&&p(e,["minimum"],_);const w=h(i,["nullable"]);w!=null&&p(e,["nullable"],w);const N=h(i,["pattern"]);N!=null&&p(e,["pattern"],N);const M=h(i,["properties"]);M!=null&&p(e,["properties"],M);const k=h(i,["propertyOrdering"]);k!=null&&p(e,["propertyOrdering"],k);const R=h(i,["required"]);R!=null&&p(e,["required"],R);const I=h(i,["title"]);I!=null&&p(e,["title"],I);const P=h(i,["type"]);return P!=null&&p(e,["type"],P),e}function lk(i){const e={};if(h(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(i,["category"]);t!=null&&p(e,["category"],t);const n=h(i,["threshold"]);return n!=null&&p(e,["threshold"],n),e}function ck(i){const e={},t=h(i,["behavior"]);t!=null&&p(e,["behavior"],t);const n=h(i,["description"]);n!=null&&p(e,["description"],n);const s=h(i,["name"]);s!=null&&p(e,["name"],s);const r=h(i,["parameters"]);r!=null&&p(e,["parameters"],r);const l=h(i,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(i,["response"]);c!=null&&p(e,["response"],c);const f=h(i,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function uk(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function dk(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],uk(t)),e}function fk(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function hk(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],fk(t)),e}function pk(){return{}}function mk(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>ck(d))),p(e,["functionDeclarations"],f)}if(h(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=h(i,["googleSearch"]);n!=null&&p(e,["googleSearch"],dk(n));const s=h(i,["googleSearchRetrieval"]);if(s!=null&&p(e,["googleSearchRetrieval"],hk(s)),h(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(i,["urlContext"])!=null&&p(e,["urlContext"],pk());const l=h(i,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(i,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function gk(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["allowedFunctionNames"]);return n!=null&&p(e,["allowedFunctionNames"],n),e}function yk(i){const e={},t=h(i,["latitude"]);t!=null&&p(e,["latitude"],t);const n=h(i,["longitude"]);return n!=null&&p(e,["longitude"],n),e}function vk(i){const e={},t=h(i,["latLng"]);t!=null&&p(e,["latLng"],yk(t));const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function xk(i){const e={},t=h(i,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],gk(t));const n=h(i,["retrievalConfig"]);return n!=null&&p(e,["retrievalConfig"],vk(n)),e}function bk(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function wC(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],bk(t)),e}function Sk(i){const e={},t=h(i,["speaker"]);t!=null&&p(e,["speaker"],t);const n=h(i,["voiceConfig"]);return n!=null&&p(e,["voiceConfig"],wC(n)),e}function Ck(i){const e={},t=h(i,["speakerVoiceConfigs"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>Sk(s))),p(e,["speakerVoiceConfigs"],n)}return e}function Ak(i){const e={},t=h(i,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],wC(t));const n=h(i,["multiSpeakerVoiceConfig"]);n!=null&&p(e,["multiSpeakerVoiceConfig"],Ck(n));const s=h(i,["languageCode"]);return s!=null&&p(e,["languageCode"],s),e}function Ek(i){const e={},t=h(i,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const n=h(i,["thinkingBudget"]);return n!=null&&p(e,["thinkingBudget"],n),e}function _k(i,e,t){const n={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&p(t,["systemInstruction"],Yc(Jt(s)));const r=h(e,["temperature"]);r!=null&&p(n,["temperature"],r);const l=h(e,["topP"]);l!=null&&p(n,["topP"],l);const c=h(e,["topK"]);c!=null&&p(n,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(n,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(n,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&p(n,["responseLogprobs"],v);const b=h(e,["logprobs"]);b!=null&&p(n,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&p(n,["presencePenalty"],C);const E=h(e,["frequencyPenalty"]);E!=null&&p(n,["frequencyPenalty"],E);const A=h(e,["seed"]);A!=null&&p(n,["seed"],A);const _=h(e,["responseMimeType"]);_!=null&&p(n,["responseMimeType"],_);const w=h(e,["responseSchema"]);w!=null&&p(n,["responseSchema"],ak(Cp(w)));const N=h(e,["responseJsonSchema"]);if(N!=null&&p(n,["responseJsonSchema"],N),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=h(e,["safetySettings"]);if(t!==void 0&&M!=null){let K=M;Array.isArray(K)&&(K=K.map(ne=>lk(ne))),p(t,["safetySettings"],K)}const k=h(e,["tools"]);if(t!==void 0&&k!=null){let K=tr(k);Array.isArray(K)&&(K=K.map(ne=>mk(er(ne)))),p(t,["tools"],K)}const R=h(e,["toolConfig"]);if(t!==void 0&&R!=null&&p(t,["toolConfig"],xk(R)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=h(e,["cachedContent"]);t!==void 0&&I!=null&&p(t,["cachedContent"],Li(i,I));const P=h(e,["responseModalities"]);P!=null&&p(n,["responseModalities"],P);const q=h(e,["mediaResolution"]);q!=null&&p(n,["mediaResolution"],q);const F=h(e,["speechConfig"]);if(F!=null&&p(n,["speechConfig"],Ak(Ap(F))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const $=h(e,["thinkingConfig"]);return $!=null&&p(n,["thinkingConfig"],Ek($)),n}function ub(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>Yc(c))),p(t,["contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["generationConfig"],_k(i,r,t)),t}function Tk(i,e){const t={},n=h(i,["taskType"]);e!==void 0&&n!=null&&p(e,["requests[]","taskType"],n);const s=h(i,["title"]);e!==void 0&&s!=null&&p(e,["requests[]","title"],s);const r=h(i,["outputDimensionality"]);if(e!==void 0&&r!=null&&p(e,["requests[]","outputDimensionality"],r),h(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function wk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);s!=null&&p(t,["requests[]","content"],uC(i,s));const r=h(e,["config"]);r!=null&&p(t,["config"],Tk(r,t));const l=h(e,["model"]);return l!==void 0&&p(t,["requests[]","model"],Qe(i,l)),t}function Mk(i,e){const t={};if(h(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=h(i,["numberOfImages"]);e!==void 0&&n!=null&&p(e,["parameters","sampleCount"],n);const s=h(i,["aspectRatio"]);e!==void 0&&s!=null&&p(e,["parameters","aspectRatio"],s);const r=h(i,["guidanceScale"]);if(e!==void 0&&r!=null&&p(e,["parameters","guidanceScale"],r),h(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&p(e,["parameters","safetySetting"],l);const c=h(i,["personGeneration"]);e!==void 0&&c!=null&&p(e,["parameters","personGeneration"],c);const f=h(i,["includeSafetyAttributes"]);e!==void 0&&f!=null&&p(e,["parameters","includeSafetyAttributes"],f);const d=h(i,["includeRaiReason"]);e!==void 0&&d!=null&&p(e,["parameters","includeRaiReason"],d);const g=h(i,["language"]);e!==void 0&&g!=null&&p(e,["parameters","language"],g);const v=h(i,["outputMimeType"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","mimeType"],v);const b=h(i,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&p(e,["parameters","outputOptions","compressionQuality"],b),h(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(i,["imageSize"])!==void 0)throw new Error("imageSize parameter is not supported in Gemini API.");if(h(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Nk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["prompt"]);s!=null&&p(t,["instances[0]","prompt"],s);const r=h(e,["config"]);return r!=null&&p(t,["config"],Mk(r,t)),t}function Rk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","name"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function Ik(i,e,t){const n={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&p(t,["_query","pageSize"],s);const r=h(e,["pageToken"]);t!==void 0&&r!=null&&p(t,["_query","pageToken"],r);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const c=h(e,["queryBase"]);return t!==void 0&&c!=null&&p(t,["_url","models_url"],hC(i,c)),n}function Dk(i,e){const t={},n=h(e,["config"]);return n!=null&&p(t,["config"],Ik(i,n,t)),t}function kk(i,e){const t={},n=h(i,["displayName"]);e!==void 0&&n!=null&&p(e,["displayName"],n);const s=h(i,["description"]);e!==void 0&&s!=null&&p(e,["description"],s);const r=h(i,["defaultCheckpointId"]);return e!==void 0&&r!=null&&p(e,["defaultCheckpointId"],r),t}function Lk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","name"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],kk(s,t)),t}function Pk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","name"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function Fk(i){const e={};if(h(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ok(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>Yc(c))),p(t,["contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["config"],Fk(r)),t}function Uk(i){const e={};if(h(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(i,["imageBytes"]);t!=null&&p(e,["bytesBase64Encoded"],Ws(t));const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function Bk(i,e){const t={},n=h(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&p(e,["parameters","sampleCount"],n),h(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=h(i,["durationSeconds"]);if(e!==void 0&&s!=null&&p(e,["parameters","durationSeconds"],s),h(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=h(i,["aspectRatio"]);if(e!==void 0&&r!=null&&p(e,["parameters","aspectRatio"],r),h(i,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(i,["personGeneration"]);if(e!==void 0&&l!=null&&p(e,["parameters","personGeneration"],l),h(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(i,["negativePrompt"]);e!==void 0&&c!=null&&p(e,["parameters","negativePrompt"],c);const f=h(i,["enhancePrompt"]);if(e!==void 0&&f!=null&&p(e,["parameters","enhancePrompt"],f),h(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(i,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Vk(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["prompt"]);s!=null&&p(t,["instances[0]","prompt"],s);const r=h(e,["image"]);if(r!=null&&p(t,["instances[0]","image"],Uk(r)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&p(t,["config"],Bk(l,t)),t}function Gk(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function qk(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["data"]);n!=null&&p(e,["data"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function Hk(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["fileUri"]);n!=null&&p(e,["fileUri"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function jk(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],Gk(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],qk(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],Hk(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function ir(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>jk(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function zk(i){const e={},t=h(i,["anyOf"]);t!=null&&p(e,["anyOf"],t);const n=h(i,["default"]);n!=null&&p(e,["default"],n);const s=h(i,["description"]);s!=null&&p(e,["description"],s);const r=h(i,["enum"]);r!=null&&p(e,["enum"],r);const l=h(i,["example"]);l!=null&&p(e,["example"],l);const c=h(i,["format"]);c!=null&&p(e,["format"],c);const f=h(i,["items"]);f!=null&&p(e,["items"],f);const d=h(i,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(i,["maxLength"]);g!=null&&p(e,["maxLength"],g);const v=h(i,["maxProperties"]);v!=null&&p(e,["maxProperties"],v);const b=h(i,["maximum"]);b!=null&&p(e,["maximum"],b);const C=h(i,["minItems"]);C!=null&&p(e,["minItems"],C);const E=h(i,["minLength"]);E!=null&&p(e,["minLength"],E);const A=h(i,["minProperties"]);A!=null&&p(e,["minProperties"],A);const _=h(i,["minimum"]);_!=null&&p(e,["minimum"],_);const w=h(i,["nullable"]);w!=null&&p(e,["nullable"],w);const N=h(i,["pattern"]);N!=null&&p(e,["pattern"],N);const M=h(i,["properties"]);M!=null&&p(e,["properties"],M);const k=h(i,["propertyOrdering"]);k!=null&&p(e,["propertyOrdering"],k);const R=h(i,["required"]);R!=null&&p(e,["required"],R);const I=h(i,["title"]);I!=null&&p(e,["title"],I);const P=h(i,["type"]);return P!=null&&p(e,["type"],P),e}function $k(i){const e={},t=h(i,["featureSelectionPreference"]);return t!=null&&p(e,["featureSelectionPreference"],t),e}function Yk(i){const e={},t=h(i,["method"]);t!=null&&p(e,["method"],t);const n=h(i,["category"]);n!=null&&p(e,["category"],n);const s=h(i,["threshold"]);return s!=null&&p(e,["threshold"],s),e}function Wk(i){const e={};if(h(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(i,["description"]);t!=null&&p(e,["description"],t);const n=h(i,["name"]);n!=null&&p(e,["name"],n);const s=h(i,["parameters"]);s!=null&&p(e,["parameters"],s);const r=h(i,["parametersJsonSchema"]);r!=null&&p(e,["parametersJsonSchema"],r);const l=h(i,["response"]);l!=null&&p(e,["response"],l);const c=h(i,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function Kk(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function Xk(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],Kk(t)),e}function Jk(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function Qk(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],Jk(t)),e}function Zk(){return{}}function eL(i){const e={},t=h(i,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function tL(i){const e={},t=h(i,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],eL(t));const n=h(i,["authType"]);n!=null&&p(e,["authType"],n);const s=h(i,["googleServiceAccountConfig"]);s!=null&&p(e,["googleServiceAccountConfig"],s);const r=h(i,["httpBasicAuthConfig"]);r!=null&&p(e,["httpBasicAuthConfig"],r);const l=h(i,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(i,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function nL(i){const e={},t=h(i,["authConfig"]);return t!=null&&p(e,["authConfig"],tL(t)),e}function iL(){return{}}function MC(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(b=>Wk(b))),p(e,["functionDeclarations"],v)}const n=h(i,["retrieval"]);n!=null&&p(e,["retrieval"],n);const s=h(i,["googleSearch"]);s!=null&&p(e,["googleSearch"],Xk(s));const r=h(i,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],Qk(r)),h(i,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],Zk());const c=h(i,["googleMaps"]);c!=null&&p(e,["googleMaps"],nL(c)),h(i,["urlContext"])!=null&&p(e,["urlContext"],iL());const d=h(i,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(i,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function sL(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["allowedFunctionNames"]);return n!=null&&p(e,["allowedFunctionNames"],n),e}function oL(i){const e={},t=h(i,["latitude"]);t!=null&&p(e,["latitude"],t);const n=h(i,["longitude"]);return n!=null&&p(e,["longitude"],n),e}function rL(i){const e={},t=h(i,["latLng"]);t!=null&&p(e,["latLng"],oL(t));const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function aL(i){const e={},t=h(i,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],sL(t));const n=h(i,["retrievalConfig"]);return n!=null&&p(e,["retrievalConfig"],rL(n)),e}function lL(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function cL(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],lL(t)),e}function uL(i){const e={},t=h(i,["voiceConfig"]);if(t!=null&&p(e,["voiceConfig"],cL(t)),h(i,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const n=h(i,["languageCode"]);return n!=null&&p(e,["languageCode"],n),e}function dL(i){const e={},t=h(i,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const n=h(i,["thinkingBudget"]);return n!=null&&p(e,["thinkingBudget"],n),e}function fL(i,e,t){const n={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&p(t,["systemInstruction"],ir(Jt(s)));const r=h(e,["temperature"]);r!=null&&p(n,["temperature"],r);const l=h(e,["topP"]);l!=null&&p(n,["topP"],l);const c=h(e,["topK"]);c!=null&&p(n,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(n,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(n,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(n,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&p(n,["responseLogprobs"],v);const b=h(e,["logprobs"]);b!=null&&p(n,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&p(n,["presencePenalty"],C);const E=h(e,["frequencyPenalty"]);E!=null&&p(n,["frequencyPenalty"],E);const A=h(e,["seed"]);A!=null&&p(n,["seed"],A);const _=h(e,["responseMimeType"]);_!=null&&p(n,["responseMimeType"],_);const w=h(e,["responseSchema"]);w!=null&&p(n,["responseSchema"],zk(Cp(w)));const N=h(e,["responseJsonSchema"]);N!=null&&p(n,["responseJsonSchema"],N);const M=h(e,["routingConfig"]);M!=null&&p(n,["routingConfig"],M);const k=h(e,["modelSelectionConfig"]);k!=null&&p(n,["modelConfig"],$k(k));const R=h(e,["safetySettings"]);if(t!==void 0&&R!=null){let me=R;Array.isArray(me)&&(me=me.map(U=>Yk(U))),p(t,["safetySettings"],me)}const I=h(e,["tools"]);if(t!==void 0&&I!=null){let me=tr(I);Array.isArray(me)&&(me=me.map(U=>MC(er(U)))),p(t,["tools"],me)}const P=h(e,["toolConfig"]);t!==void 0&&P!=null&&p(t,["toolConfig"],aL(P));const q=h(e,["labels"]);t!==void 0&&q!=null&&p(t,["labels"],q);const F=h(e,["cachedContent"]);t!==void 0&&F!=null&&p(t,["cachedContent"],Li(i,F));const $=h(e,["responseModalities"]);$!=null&&p(n,["responseModalities"],$);const K=h(e,["mediaResolution"]);K!=null&&p(n,["mediaResolution"],K);const ne=h(e,["speechConfig"]);ne!=null&&p(n,["speechConfig"],uL(Ap(ne)));const ae=h(e,["audioTimestamp"]);ae!=null&&p(n,["audioTimestamp"],ae);const ce=h(e,["thinkingConfig"]);return ce!=null&&p(n,["thinkingConfig"],dL(ce)),n}function db(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>ir(c))),p(t,["contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["generationConfig"],fL(i,r,t)),t}function hL(i,e){const t={},n=h(i,["taskType"]);e!==void 0&&n!=null&&p(e,["instances[]","task_type"],n);const s=h(i,["title"]);e!==void 0&&s!=null&&p(e,["instances[]","title"],s);const r=h(i,["outputDimensionality"]);e!==void 0&&r!=null&&p(e,["parameters","outputDimensionality"],r);const l=h(i,["mimeType"]);e!==void 0&&l!=null&&p(e,["instances[]","mimeType"],l);const c=h(i,["autoTruncate"]);return e!==void 0&&c!=null&&p(e,["parameters","autoTruncate"],c),t}function pL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);s!=null&&p(t,["instances[]","content"],uC(i,s));const r=h(e,["config"]);return r!=null&&p(t,["config"],hL(r,t)),t}function mL(i,e){const t={},n=h(i,["outputGcsUri"]);e!==void 0&&n!=null&&p(e,["parameters","storageUri"],n);const s=h(i,["negativePrompt"]);e!==void 0&&s!=null&&p(e,["parameters","negativePrompt"],s);const r=h(i,["numberOfImages"]);e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r);const l=h(i,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const c=h(i,["guidanceScale"]);e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c);const f=h(i,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const d=h(i,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);const g=h(i,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const v=h(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const b=h(i,["includeRaiReason"]);e!==void 0&&b!=null&&p(e,["parameters","includeRaiReason"],b);const C=h(i,["language"]);e!==void 0&&C!=null&&p(e,["parameters","language"],C);const E=h(i,["outputMimeType"]);e!==void 0&&E!=null&&p(e,["parameters","outputOptions","mimeType"],E);const A=h(i,["outputCompressionQuality"]);e!==void 0&&A!=null&&p(e,["parameters","outputOptions","compressionQuality"],A);const _=h(i,["addWatermark"]);e!==void 0&&_!=null&&p(e,["parameters","addWatermark"],_);const w=h(i,["imageSize"]);e!==void 0&&w!=null&&p(e,["parameters","sampleImageSize"],w);const N=h(i,["enhancePrompt"]);return e!==void 0&&N!=null&&p(e,["parameters","enhancePrompt"],N),t}function gL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["prompt"]);s!=null&&p(t,["instances[0]","prompt"],s);const r=h(e,["config"]);return r!=null&&p(t,["config"],mL(r,t)),t}function Wc(i){const e={},t=h(i,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const n=h(i,["imageBytes"]);n!=null&&p(e,["bytesBase64Encoded"],Ws(n));const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function yL(i){const e={},t=h(i,["maskMode"]);t!=null&&p(e,["maskMode"],t);const n=h(i,["segmentationClasses"]);n!=null&&p(e,["maskClasses"],n);const s=h(i,["maskDilation"]);return s!=null&&p(e,["dilation"],s),e}function vL(i){const e={},t=h(i,["controlType"]);t!=null&&p(e,["controlType"],t);const n=h(i,["enableControlImageComputation"]);return n!=null&&p(e,["computeControl"],n),e}function xL(i){const e={},t=h(i,["styleDescription"]);return t!=null&&p(e,["styleDescription"],t),e}function bL(i){const e={},t=h(i,["subjectType"]);t!=null&&p(e,["subjectType"],t);const n=h(i,["subjectDescription"]);return n!=null&&p(e,["subjectDescription"],n),e}function SL(i){const e={},t=h(i,["referenceImage"]);t!=null&&p(e,["referenceImage"],Wc(t));const n=h(i,["referenceId"]);n!=null&&p(e,["referenceId"],n);const s=h(i,["referenceType"]);s!=null&&p(e,["referenceType"],s);const r=h(i,["maskImageConfig"]);r!=null&&p(e,["maskImageConfig"],yL(r));const l=h(i,["controlImageConfig"]);l!=null&&p(e,["controlImageConfig"],vL(l));const c=h(i,["styleImageConfig"]);c!=null&&p(e,["styleImageConfig"],xL(c));const f=h(i,["subjectImageConfig"]);return f!=null&&p(e,["subjectImageConfig"],bL(f)),e}function CL(i,e){const t={},n=h(i,["outputGcsUri"]);e!==void 0&&n!=null&&p(e,["parameters","storageUri"],n);const s=h(i,["negativePrompt"]);e!==void 0&&s!=null&&p(e,["parameters","negativePrompt"],s);const r=h(i,["numberOfImages"]);e!==void 0&&r!=null&&p(e,["parameters","sampleCount"],r);const l=h(i,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const c=h(i,["guidanceScale"]);e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c);const f=h(i,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const d=h(i,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);const g=h(i,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const v=h(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&p(e,["parameters","includeSafetyAttributes"],v);const b=h(i,["includeRaiReason"]);e!==void 0&&b!=null&&p(e,["parameters","includeRaiReason"],b);const C=h(i,["language"]);e!==void 0&&C!=null&&p(e,["parameters","language"],C);const E=h(i,["outputMimeType"]);e!==void 0&&E!=null&&p(e,["parameters","outputOptions","mimeType"],E);const A=h(i,["outputCompressionQuality"]);e!==void 0&&A!=null&&p(e,["parameters","outputOptions","compressionQuality"],A);const _=h(i,["addWatermark"]);e!==void 0&&_!=null&&p(e,["parameters","addWatermark"],_);const w=h(i,["editMode"]);e!==void 0&&w!=null&&p(e,["parameters","editMode"],w);const N=h(i,["baseSteps"]);return e!==void 0&&N!=null&&p(e,["parameters","editConfig","baseSteps"],N),t}function AL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["prompt"]);s!=null&&p(t,["instances[0]","prompt"],s);const r=h(e,["referenceImages"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>SL(f))),p(t,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&p(t,["config"],CL(l,t)),t}function EL(i,e){const t={},n=h(i,["includeRaiReason"]);e!==void 0&&n!=null&&p(e,["parameters","includeRaiReason"],n);const s=h(i,["outputMimeType"]);e!==void 0&&s!=null&&p(e,["parameters","outputOptions","mimeType"],s);const r=h(i,["outputCompressionQuality"]);e!==void 0&&r!=null&&p(e,["parameters","outputOptions","compressionQuality"],r);const l=h(i,["enhanceInputImage"]);e!==void 0&&l!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(i,["imagePreservationFactor"]);e!==void 0&&c!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const f=h(i,["numberOfImages"]);e!==void 0&&f!=null&&p(e,["parameters","sampleCount"],f);const d=h(i,["mode"]);return e!==void 0&&d!=null&&p(e,["parameters","mode"],d),t}function _L(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["image"]);s!=null&&p(t,["instances[0]","image"],Wc(s));const r=h(e,["upscaleFactor"]);r!=null&&p(t,["parameters","upscaleConfig","upscaleFactor"],r);const l=h(e,["config"]);return l!=null&&p(t,["config"],EL(l,t)),t}function TL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","name"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function wL(i,e,t){const n={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&p(t,["_query","pageSize"],s);const r=h(e,["pageToken"]);t!==void 0&&r!=null&&p(t,["_query","pageToken"],r);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const c=h(e,["queryBase"]);return t!==void 0&&c!=null&&p(t,["_url","models_url"],hC(i,c)),n}function ML(i,e){const t={},n=h(e,["config"]);return n!=null&&p(t,["config"],wL(i,n,t)),t}function NL(i,e){const t={},n=h(i,["displayName"]);e!==void 0&&n!=null&&p(e,["displayName"],n);const s=h(i,["description"]);e!==void 0&&s!=null&&p(e,["description"],s);const r=h(i,["defaultCheckpointId"]);return e!==void 0&&r!=null&&p(e,["defaultCheckpointId"],r),t}function RL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],NL(s,t)),t}function IL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","name"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],s),t}function DL(i,e){const t={},n=h(i,["systemInstruction"]);e!==void 0&&n!=null&&p(e,["systemInstruction"],ir(Jt(n)));const s=h(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>MC(c))),p(e,["tools"],l)}const r=h(i,["generationConfig"]);return e!==void 0&&r!=null&&p(e,["generationConfig"],r),t}function kL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>ir(c))),p(t,["contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["config"],DL(r,t)),t}function LL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["contents"]);if(s!=null){let l=Un(s);Array.isArray(l)&&(l=l.map(c=>ir(c))),p(t,["contents"],l)}const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function PL(i){const e={},t=h(i,["uri"]);t!=null&&p(e,["gcsUri"],t);const n=h(i,["videoBytes"]);n!=null&&p(e,["bytesBase64Encoded"],Ws(n));const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function FL(i,e){const t={},n=h(i,["numberOfVideos"]);e!==void 0&&n!=null&&p(e,["parameters","sampleCount"],n);const s=h(i,["outputGcsUri"]);e!==void 0&&s!=null&&p(e,["parameters","storageUri"],s);const r=h(i,["fps"]);e!==void 0&&r!=null&&p(e,["parameters","fps"],r);const l=h(i,["durationSeconds"]);e!==void 0&&l!=null&&p(e,["parameters","durationSeconds"],l);const c=h(i,["seed"]);e!==void 0&&c!=null&&p(e,["parameters","seed"],c);const f=h(i,["aspectRatio"]);e!==void 0&&f!=null&&p(e,["parameters","aspectRatio"],f);const d=h(i,["resolution"]);e!==void 0&&d!=null&&p(e,["parameters","resolution"],d);const g=h(i,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const v=h(i,["pubsubTopic"]);e!==void 0&&v!=null&&p(e,["parameters","pubsubTopic"],v);const b=h(i,["negativePrompt"]);e!==void 0&&b!=null&&p(e,["parameters","negativePrompt"],b);const C=h(i,["enhancePrompt"]);e!==void 0&&C!=null&&p(e,["parameters","enhancePrompt"],C);const E=h(i,["generateAudio"]);e!==void 0&&E!=null&&p(e,["parameters","generateAudio"],E);const A=h(i,["lastFrame"]);e!==void 0&&A!=null&&p(e,["instances[0]","lastFrame"],Wc(A));const _=h(i,["compressionQuality"]);return e!==void 0&&_!=null&&p(e,["parameters","compressionQuality"],_),t}function OL(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["_url","model"],Qe(i,n));const s=h(e,["prompt"]);s!=null&&p(t,["instances[0]","prompt"],s);const r=h(e,["image"]);r!=null&&p(t,["instances[0]","image"],Wc(r));const l=h(e,["video"]);l!=null&&p(t,["instances[0]","video"],PL(l));const c=h(e,["config"]);return c!=null&&p(t,["config"],FL(c,t)),t}function UL(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function BL(i){const e={},t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function VL(i){const e={},t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function GL(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],UL(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],BL(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],VL(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function qL(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>GL(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function HL(i){const e={},t=h(i,["citationSources"]);return t!=null&&p(e,["citations"],t),e}function jL(i){const e={},t=h(i,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const n=h(i,["urlRetrievalStatus"]);return n!=null&&p(e,["urlRetrievalStatus"],n),e}function zL(i){const e={},t=h(i,["urlMetadata"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>jL(s))),p(e,["urlMetadata"],n)}return e}function $L(i){const e={},t=h(i,["content"]);t!=null&&p(e,["content"],qL(t));const n=h(i,["citationMetadata"]);n!=null&&p(e,["citationMetadata"],HL(n));const s=h(i,["tokenCount"]);s!=null&&p(e,["tokenCount"],s);const r=h(i,["finishReason"]);r!=null&&p(e,["finishReason"],r);const l=h(i,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],zL(l));const c=h(i,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(i,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(i,["index"]);d!=null&&p(e,["index"],d);const g=h(i,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const v=h(i,["safetyRatings"]);return v!=null&&p(e,["safetyRatings"],v),e}function fb(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(f=>$L(f))),p(e,["candidates"],c)}const s=h(i,["modelVersion"]);s!=null&&p(e,["modelVersion"],s);const r=h(i,["promptFeedback"]);r!=null&&p(e,["promptFeedback"],r);const l=h(i,["usageMetadata"]);return l!=null&&p(e,["usageMetadata"],l),e}function YL(i){const e={},t=h(i,["values"]);return t!=null&&p(e,["values"],t),e}function WL(){return{}}function KL(i){const e={},t=h(i,["embeddings"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>YL(r))),p(e,["embeddings"],s)}return h(i,["metadata"])!=null&&p(e,["metadata"],WL()),e}function XL(i){const e={},t=h(i,["bytesBase64Encoded"]);t!=null&&p(e,["imageBytes"],Ws(t));const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function NC(i){const e={},t=h(i,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const n=h(i,["safetyAttributes","scores"]);n!=null&&p(e,["scores"],n);const s=h(i,["contentType"]);return s!=null&&p(e,["contentType"],s),e}function JL(i){const e={},t=h(i,["_self"]);t!=null&&p(e,["image"],XL(t));const n=h(i,["raiFilteredReason"]);n!=null&&p(e,["raiFilteredReason"],n);const s=h(i,["_self"]);return s!=null&&p(e,["safetyAttributes"],NC(s)),e}function QL(i){const e={},t=h(i,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>JL(r))),p(e,["generatedImages"],s)}const n=h(i,["positivePromptSafetyAttributes"]);return n!=null&&p(e,["positivePromptSafetyAttributes"],NC(n)),e}function ZL(i){const e={},t=h(i,["baseModel"]);t!=null&&p(e,["baseModel"],t);const n=h(i,["createTime"]);n!=null&&p(e,["createTime"],n);const s=h(i,["updateTime"]);return s!=null&&p(e,["updateTime"],s),e}function Lh(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["description"]);s!=null&&p(e,["description"],s);const r=h(i,["version"]);r!=null&&p(e,["version"],r);const l=h(i,["_self"]);l!=null&&p(e,["tunedModelInfo"],ZL(l));const c=h(i,["inputTokenLimit"]);c!=null&&p(e,["inputTokenLimit"],c);const f=h(i,["outputTokenLimit"]);f!=null&&p(e,["outputTokenLimit"],f);const d=h(i,["supportedGenerationMethods"]);return d!=null&&p(e,["supportedActions"],d),e}function eP(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["_self"]);if(s!=null){let r=pC(s);Array.isArray(r)&&(r=r.map(l=>Lh(l))),p(e,["models"],r)}return e}function tP(){return{}}function nP(i){const e={},t=h(i,["totalTokens"]);t!=null&&p(e,["totalTokens"],t);const n=h(i,["cachedContentTokenCount"]);return n!=null&&p(e,["cachedContentTokenCount"],n),e}function iP(i){const e={},t=h(i,["video","uri"]);t!=null&&p(e,["uri"],t);const n=h(i,["video","encodedVideo"]);n!=null&&p(e,["videoBytes"],Ws(n));const s=h(i,["encoding"]);return s!=null&&p(e,["mimeType"],s),e}function sP(i){const e={},t=h(i,["_self"]);return t!=null&&p(e,["video"],iP(t)),e}function oP(i){const e={},t=h(i,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>sP(l))),p(e,["generatedVideos"],r)}const n=h(i,["raiMediaFilteredCount"]);n!=null&&p(e,["raiMediaFilteredCount"],n);const s=h(i,["raiMediaFilteredReasons"]);return s!=null&&p(e,["raiMediaFilteredReasons"],s),e}function rP(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["metadata"]);n!=null&&p(e,["metadata"],n);const s=h(i,["done"]);s!=null&&p(e,["done"],s);const r=h(i,["error"]);r!=null&&p(e,["error"],r);const l=h(i,["response","generateVideoResponse"]);return l!=null&&p(e,["response"],oP(l)),e}function aP(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function lP(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["data"]);n!=null&&p(e,["data"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function cP(i){const e={},t=h(i,["displayName"]);t!=null&&p(e,["displayName"],t);const n=h(i,["fileUri"]);n!=null&&p(e,["fileUri"],n);const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function uP(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],aP(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],lP(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],cP(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function dP(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>uP(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function fP(i){const e={},t=h(i,["citations"]);return t!=null&&p(e,["citations"],t),e}function hP(i){const e={},t=h(i,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const n=h(i,["urlRetrievalStatus"]);return n!=null&&p(e,["urlRetrievalStatus"],n),e}function pP(i){const e={},t=h(i,["urlMetadata"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>hP(s))),p(e,["urlMetadata"],n)}return e}function mP(i){const e={},t=h(i,["content"]);t!=null&&p(e,["content"],dP(t));const n=h(i,["citationMetadata"]);n!=null&&p(e,["citationMetadata"],fP(n));const s=h(i,["finishMessage"]);s!=null&&p(e,["finishMessage"],s);const r=h(i,["finishReason"]);r!=null&&p(e,["finishReason"],r);const l=h(i,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],pP(l));const c=h(i,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(i,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(i,["index"]);d!=null&&p(e,["index"],d);const g=h(i,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const v=h(i,["safetyRatings"]);return v!=null&&p(e,["safetyRatings"],v),e}function hb(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(g=>mP(g))),p(e,["candidates"],d)}const s=h(i,["createTime"]);s!=null&&p(e,["createTime"],s);const r=h(i,["responseId"]);r!=null&&p(e,["responseId"],r);const l=h(i,["modelVersion"]);l!=null&&p(e,["modelVersion"],l);const c=h(i,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const f=h(i,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function gP(i){const e={},t=h(i,["truncated"]);t!=null&&p(e,["truncated"],t);const n=h(i,["token_count"]);return n!=null&&p(e,["tokenCount"],n),e}function yP(i){const e={},t=h(i,["values"]);t!=null&&p(e,["values"],t);const n=h(i,["statistics"]);return n!=null&&p(e,["statistics"],gP(n)),e}function vP(i){const e={},t=h(i,["billableCharacterCount"]);return t!=null&&p(e,["billableCharacterCount"],t),e}function xP(i){const e={},t=h(i,["predictions[]","embeddings"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>yP(r))),p(e,["embeddings"],s)}const n=h(i,["metadata"]);return n!=null&&p(e,["metadata"],vP(n)),e}function bP(i){const e={},t=h(i,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const n=h(i,["bytesBase64Encoded"]);n!=null&&p(e,["imageBytes"],Ws(n));const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function RC(i){const e={},t=h(i,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const n=h(i,["safetyAttributes","scores"]);n!=null&&p(e,["scores"],n);const s=h(i,["contentType"]);return s!=null&&p(e,["contentType"],s),e}function _p(i){const e={},t=h(i,["_self"]);t!=null&&p(e,["image"],bP(t));const n=h(i,["raiFilteredReason"]);n!=null&&p(e,["raiFilteredReason"],n);const s=h(i,["_self"]);s!=null&&p(e,["safetyAttributes"],RC(s));const r=h(i,["prompt"]);return r!=null&&p(e,["enhancedPrompt"],r),e}function SP(i){const e={},t=h(i,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>_p(r))),p(e,["generatedImages"],s)}const n=h(i,["positivePromptSafetyAttributes"]);return n!=null&&p(e,["positivePromptSafetyAttributes"],RC(n)),e}function CP(i){const e={},t=h(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>_p(s))),p(e,["generatedImages"],n)}return e}function AP(i){const e={},t=h(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>_p(s))),p(e,["generatedImages"],n)}return e}function EP(i){const e={},t=h(i,["endpoint"]);t!=null&&p(e,["name"],t);const n=h(i,["deployedModelId"]);return n!=null&&p(e,["deployedModelId"],n),e}function _P(i){const e={},t=h(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&p(e,["baseModel"],t);const n=h(i,["createTime"]);n!=null&&p(e,["createTime"],n);const s=h(i,["updateTime"]);return s!=null&&p(e,["updateTime"],s),e}function TP(i){const e={},t=h(i,["checkpointId"]);t!=null&&p(e,["checkpointId"],t);const n=h(i,["epoch"]);n!=null&&p(e,["epoch"],n);const s=h(i,["step"]);return s!=null&&p(e,["step"],s),e}function Ph(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["displayName"]);n!=null&&p(e,["displayName"],n);const s=h(i,["description"]);s!=null&&p(e,["description"],s);const r=h(i,["versionId"]);r!=null&&p(e,["version"],r);const l=h(i,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(b=>EP(b))),p(e,["endpoints"],v)}const c=h(i,["labels"]);c!=null&&p(e,["labels"],c);const f=h(i,["_self"]);f!=null&&p(e,["tunedModelInfo"],_P(f));const d=h(i,["defaultCheckpointId"]);d!=null&&p(e,["defaultCheckpointId"],d);const g=h(i,["checkpoints"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(b=>TP(b))),p(e,["checkpoints"],v)}return e}function wP(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["_self"]);if(s!=null){let r=pC(s);Array.isArray(r)&&(r=r.map(l=>Ph(l))),p(e,["models"],r)}return e}function MP(){return{}}function NP(i){const e={},t=h(i,["totalTokens"]);return t!=null&&p(e,["totalTokens"],t),e}function RP(i){const e={},t=h(i,["tokensInfo"]);return t!=null&&p(e,["tokensInfo"],t),e}function IP(i){const e={},t=h(i,["gcsUri"]);t!=null&&p(e,["uri"],t);const n=h(i,["bytesBase64Encoded"]);n!=null&&p(e,["videoBytes"],Ws(n));const s=h(i,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function DP(i){const e={},t=h(i,["_self"]);return t!=null&&p(e,["video"],IP(t)),e}function kP(i){const e={},t=h(i,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>DP(l))),p(e,["generatedVideos"],r)}const n=h(i,["raiMediaFilteredCount"]);n!=null&&p(e,["raiMediaFilteredCount"],n);const s=h(i,["raiMediaFilteredReasons"]);return s!=null&&p(e,["raiMediaFilteredReasons"],s),e}function LP(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["metadata"]);n!=null&&p(e,["metadata"],n);const s=h(i,["done"]);s!=null&&p(e,["done"],s);const r=h(i,["error"]);r!=null&&p(e,["error"],r);const l=h(i,["response"]);return l!=null&&p(e,["response"],kP(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PP="Content-Type",FP="X-Server-Timeout",OP="User-Agent",Fh="x-goog-api-client",UP="1.11.0",BP=`google-genai-sdk/${UP}`,VP="v1beta1",GP="v1beta",pb=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class qP{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:VP,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:GP,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))s.searchParams.append(l,String(c));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(t))typeof r=="object"?n[s]=Object.assign(Object.assign({},n[s]),r):r!==void 0&&(n[s]=r);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const s=new AbortController,r=s.signal;if(t.timeout&&t?.timeout>0){const l=setTimeout(()=>s.abort(),t.timeout);l&&typeof l.unref=="function"&&l.unref()}n&&n.addEventListener("abort",()=>{s.abort()}),e.signal=r}return t&&t.extraBody!==null&&HP(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await mb(s),new Mh(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await mb(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Wo(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:f}=yield at(s.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=r.decode(f,{stream:!0});try{const v=JSON.parse(d);if("error"in v){const b=JSON.parse(JSON.stringify(v.error)),C=b.status,E=b.code,A=`got status: ${C}. ${JSON.stringify(v)}`;if(E>=400&&E<600)throw new $c({message:A,status:E})}}catch(v){if(v.name==="ApiError")throw v}l+=d;let g=l.match(pb);for(;g;){const v=g[1];try{const b=new Response(v,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield at(new Mh(b)),l=l.slice(g[0].length),g=l.match(pb)}catch(b){throw new Error(`exception parsing stream chunk ${v}. ${b}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=BP+" "+this.clientOptions.userAgentExtra;return e[OP]=t,e[Fh]=t,e[PP]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,s]of Object.entries(e.headers))t.append(n,s);e.timeout&&e.timeout>0&&t.append(FP,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,l=await r.stat(e);s.sizeBytes=String(l.size);const c=(n=t?.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const f=await this.fetchUploadUrl(s,t);return r.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var n;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},l=await this.request({path:Ce("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:s});if(!l||!l?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(n=l?.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function mb(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new $c({message:s,status:t}):new Error(s)}}function HP(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const r=JSON.parse(i.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(r,l){const c=Object.assign({},r);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const d=l[f],g=c[f];d&&typeof d=="object"&&!Array.isArray(d)&&g&&typeof g=="object"&&!Array.isArray(g)?c[f]=n(g,d):(g&&d&&typeof g!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof g}, New type: ${typeof d}. Overwriting.`),c[f]=d)}return c}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jP="mcp_used/unknown";let zP=!1;function IC(i){for(const e of i)if($P(e)||typeof e=="object"&&"inputSchema"in e)return!0;return zP}function DC(i){var e;const t=(e=i[Fh])!==null&&e!==void 0?e:"";i[Fh]=(t+` ${jP}`).trimStart()}function $P(i){return i!==null&&typeof i=="object"&&i instanceof Tp}function YP(i,e=100){return Wo(this,arguments,function*(){let n,s=0;for(;s<e;){const r=yield at(i.listTools({cursor:n}));for(const l of r.tools)yield yield at(l),s++;if(!r.nextCursor)break;n=r.nextCursor}})}class Tp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Tp(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const r={},l=[];for(const g of this.mcpClients)try{for(var c=!0,f=(t=void 0,va(YP(g))),d;d=await f.next(),e=d.done,!e;c=!0){s=d.value,c=!1;const v=s;l.push(v);const b=v.name;if(r[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);r[b]=g}}catch(v){t={error:v}}finally{try{!c&&!e&&(n=f.return)&&await n.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),qN(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,r);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function WP(i,e,t){const n=new LN;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data);const r=qD(s);Object.assign(n,r),e(n)}class KP{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),l=QP(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${c}`;let d=()=>{};const g=new Promise(M=>{d=M}),v=e.callbacks,b=function(){d({})},C=this.apiClient,E={onopen:b,onmessage:M=>{WP(C,v.onmessage,M)},onerror:(t=v?.onerror)!==null&&t!==void 0?t:function(M){},onclose:(n=v?.onclose)!==null&&n!==void 0?n:function(M){}},A=this.webSocketFactory.create(f,JP(l),E);A.connect(),await g;const _=Qe(this.apiClient,e.model),w=_C({model:_}),N=kh({setup:w});return A.send(JSON.stringify(N)),new XP(A,this.apiClient)}}class XP{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=VI(e),n=TC(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=GI(e),n=kh(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const t=kh({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(jo.PLAY)}pause(){this.sendPlaybackControl(jo.PAUSE)}stop(){this.sendPlaybackControl(jo.STOP)}resetContext(){this.sendPlaybackControl(jo.RESET_CONTEXT)}close(){this.conn.close()}}function JP(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function QP(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function eF(i,e,t){const n=new kN;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const r=JSON.parse(s);if(i.isVertexAI()){const l=nk(r);Object.assign(n,l)}else{const l=kD(r);Object.assign(n,l)}e(n)}class tF{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new KP(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,r,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let g;const v=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&IC(e.config.tools)&&DC(v);const b=oF(v);if(this.apiClient.isVertexAI())g=`${f}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const F=this.apiClient.getApiKey();let $="BidiGenerateContent",K="key";F?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),$="BidiGenerateContentConstrained",K="access_token"),g=`${f}/ws/google.ai.generativelanguage.${d}.GenerativeService.${$}?${K}=${F}`}let C=()=>{};const E=new Promise(F=>{C=F}),A=e.callbacks,_=function(){var F;(F=A?.onopen)===null||F===void 0||F.call(A),C({})},w=this.apiClient,N={onopen:_,onmessage:F=>{eF(w,A.onmessage,F)},onerror:(t=A?.onerror)!==null&&t!==void 0?t:function(F){},onclose:(n=A?.onclose)!==null&&n!==void 0?n:function(F){}},M=this.webSocketFactory.create(g,sF(b),N);M.connect(),await E;let k=Qe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&k.startsWith("publishers/")){const F=this.apiClient.getProject(),$=this.apiClient.getLocation();k=`projects/${F}/locations/${$}/`+k}let R={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Mc.AUDIO]}:e.config.responseModalities=[Mc.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],P=[];for(const F of I)if(this.isCallableTool(F)){const $=F;P.push(await $.tool())}else P.push(F);P.length>0&&(e.config.tools=P);const q={model:k,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?R=pD(this.apiClient,q):R=FI(this.apiClient,q),delete R.config,M.send(JSON.stringify(R)),new iF(M,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const nF={turnComplete:!0};class iF{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=Un(t.turns),e.isVertexAI()?n=n.map(s=>ir(s)):n=n.map(s=>Yc(s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const r of n){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(ZP)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},nF),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:yD(e)}:t={realtimeInput:BI(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function sF(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function oF(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gb=10;function yb(i){var e,t,n;if(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i?.tools)!==null&&t!==void 0?t:[])if(Ko(l)){s=!0;break}if(!s)return!0;const r=(n=i?.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Ko(i){return"callTool"in i&&typeof i.callTool=="function"}function rF(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>Ko(s)))!==null&&n!==void 0?n:!1}function aF(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!Ko(s)))!==null&&n!==void 0?n:!1}function vb(i){var e;return!(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lF extends Ys{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,r,l,c;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!rF(t)||yb(t.config))return await this.generateContentInternal(f);if(aF(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,g;const v=Un(f.contents),b=(r=(s=(n=f.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:gb;let C=0;for(;C<b&&(d=await this.generateContentInternal(f),!(!d.functionCalls||d.functionCalls.length===0));){const E=d.candidates[0].content,A=[];for(const _ of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Ko(_)){const N=await _.callTool(d.functionCalls);A.push(...N)}C++,g={role:"user",parts:A},f.contents=Un(f.contents),f.contents.push(E),f.contents.push(g),vb(f.config)&&(v.push(E),v.push(g))}return vb(f.config)&&(d.automaticFunctionCallingHistory=v),d},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),yb(t.config)){const n=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let r;const l=[];if(n?.generatedImages)for(const f of n.generatedImages)f&&f?.safetyAttributes&&((s=f?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=f?.safetyAttributes:l.push(f);let c;return r?c={generatedImages:l,positivePromptSafetyAttributes:r}:c={generatedImages:l},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Oa(Hs.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const l=await Promise.all(r.map(async f=>Ko(f)?await f.tool():f)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&IC(e.config.tools)){const f=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},f);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),DC(d),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return c}async initAfcToolsMap(e){var t,n,s;const r=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Ko(l)){const c=l,f=await c.tool();for(const d of(s=f.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(r.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);r.set(d.name,c)}}return r}async processAfcStream(e){var t,n,s;const r=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:gb;let l=!1,c=0;const f=await this.initAfcToolsMap(e);return function(d,g,v){var b,C;return Wo(this,arguments,function*(){for(var E,A,_,w;c<r;){l&&(c++,l=!1);const R=yield at(d.processParamsMaybeAddMcpUsage(v)),I=yield at(d.generateContentStreamInternal(R)),P=[],q=[];try{for(var N=!0,M=(A=void 0,va(I)),k;k=yield at(M.next()),E=k.done,!E;N=!0){w=k.value,N=!1;const F=w;if(yield yield at(F),F.candidates&&(!((b=F.candidates[0])===null||b===void 0)&&b.content)){q.push(F.candidates[0].content);for(const $ of(C=F.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(c<r&&$.functionCall){if(!$.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has($.functionCall.name)){const K=yield at(g.get($.functionCall.name).callTool([$.functionCall]));P.push(...K)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${$.functionCall.name}`)}}}}catch(F){A={error:F}}finally{try{!N&&!E&&(_=M.return)&&(yield at(_.call(M)))}finally{if(A)throw A.error}}if(P.length>0){l=!0;const F=new da;F.candidates=[{content:{role:"user",parts:P}}],yield yield at(F);const $=[];$.push(...q),$.push({role:"user",parts:P});const K=Un(v.contents).concat($);v.contents=K}else break}})}(this,f,e)}async generateContentInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=db(this.apiClient,e);return c=Ce("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=hb(g),b=new da;return Object.assign(b,v),b})}else{const d=ub(this.apiClient,e);return c=Ce("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=fb(g),b=new da;return Object.assign(b,v),b})}}async generateContentStreamInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=db(this.apiClient,e);return c=Ce("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(v){return Wo(this,arguments,function*(){var b,C,E,A;try{for(var _=!0,w=va(v),N;N=yield at(w.next()),b=N.done,!b;_=!0){A=N.value,_=!1;const M=A,k=hb(yield at(M.json()));k.sdkHttpResponse={headers:M.headers};const R=new da;Object.assign(R,k),yield yield at(R)}}catch(M){C={error:M}}finally{try{!_&&!b&&(E=w.return)&&(yield at(E.call(w)))}finally{if(C)throw C.error}}})})}else{const d=ub(this.apiClient,e);return c=Ce("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return Wo(this,arguments,function*(){var b,C,E,A;try{for(var _=!0,w=va(v),N;N=yield at(w.next()),b=N.done,!b;_=!0){A=N.value,_=!1;const M=A,k=fb(yield at(M.json()));k.sdkHttpResponse={headers:M.headers};const R=new da;Object.assign(R,k),yield yield at(R)}}catch(M){C={error:M}}finally{try{!_&&!b&&(E=w.return)&&(yield at(E.call(w)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=pL(this.apiClient,e);return c=Ce("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const v=xP(g),b=new Hx;return Object.assign(b,v),b})}else{const d=wk(this.apiClient,e);return c=Ce("{model}:batchEmbedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=KL(g),b=new Hx;return Object.assign(b,v),b})}}async generateImagesInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=gL(this.apiClient,e);return c=Ce("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const v=SP(g),b=new jx;return Object.assign(b,v),b})}else{const d=Nk(this.apiClient,e);return c=Ce("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=QL(g),b=new jx;return Object.assign(b,v),b})}}async editImageInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI()){const c=AL(this.apiClient,e);return r=Ce("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>{const d=CP(f),g=new wN;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI()){const c=_L(this.apiClient,e);return r=Ce("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>{const d=AP(f),g=new MN;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=TL(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>Ph(g))}else{const d=Rk(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lh(g))}}async listInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=ML(this.apiClient,e);return c=Ce("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=wP(g),b=new zx;return Object.assign(b,v),b})}else{const d=Dk(this.apiClient,e);return c=Ce("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=eP(g),b=new zx;return Object.assign(b,v),b})}}async update(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=RL(this.apiClient,e);return c=Ce("{model}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>Ph(g))}else{const d=Lk(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lh(g))}}async delete(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=IL(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(()=>{const g=MP(),v=new $x;return Object.assign(v,g),v})}else{const d=Pk(this.apiClient,e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=tP(),v=new $x;return Object.assign(v,g),v})}}async countTokens(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=kL(this.apiClient,e);return c=Ce("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const v=NP(g),b=new Yx;return Object.assign(b,v),b})}else{const d=Ok(this.apiClient,e);return c=Ce("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=nP(g),b=new Yx;return Object.assign(b,v),b})}}async computeTokens(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI()){const c=LL(this.apiClient,e);return r=Ce("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>{const d=RP(f),g=new NN;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=OL(this.apiClient,e);return c=Ce("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const v=LP(g),b=new Nc;return Object.assign(b,v),b})}else{const d=Vk(this.apiClient,e);return c=Ce("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=rP(g),b=new Nc;return Object.assign(b,v),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cF(i){const e={},t=h(i,["operationName"]);t!=null&&p(e,["_url","operationName"],t);const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function uF(i){const e={},t=h(i,["operationName"]);t!=null&&p(e,["_url","operationName"],t);const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function dF(i){const e={},t=h(i,["operationName"]);t!=null&&p(e,["operationName"],t);const n=h(i,["resourceName"]);n!=null&&p(e,["_url","resourceName"],n);const s=h(i,["config"]);return s!=null&&p(e,["config"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fF extends Ys{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;n&&"httpOptions"in n&&(r=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;n&&"httpOptions"in n&&(r=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=uF(e);return c=Ce("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l}else{const d=cF(e);return c=Ce("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI()){const c=dF(e);return r=Ce("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hF(i){const e={},t=h(i,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function kC(i){const e={},t=h(i,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],hF(t)),e}function pF(i){const e={},t=h(i,["speaker"]);t!=null&&p(e,["speaker"],t);const n=h(i,["voiceConfig"]);return n!=null&&p(e,["voiceConfig"],kC(n)),e}function mF(i){const e={},t=h(i,["speakerVoiceConfigs"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>pF(s))),p(e,["speakerVoiceConfigs"],n)}return e}function gF(i){const e={},t=h(i,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],kC(t));const n=h(i,["multiSpeakerVoiceConfig"]);n!=null&&p(e,["multiSpeakerVoiceConfig"],mF(n));const s=h(i,["languageCode"]);return s!=null&&p(e,["languageCode"],s),e}function yF(i){const e={},t=h(i,["fps"]);t!=null&&p(e,["fps"],t);const n=h(i,["endOffset"]);n!=null&&p(e,["endOffset"],n);const s=h(i,["startOffset"]);return s!=null&&p(e,["startOffset"],s),e}function vF(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["data"]);t!=null&&p(e,["data"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function xF(i){const e={};if(h(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(i,["fileUri"]);t!=null&&p(e,["fileUri"],t);const n=h(i,["mimeType"]);return n!=null&&p(e,["mimeType"],n),e}function bF(i){const e={},t=h(i,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],yF(t));const n=h(i,["thought"]);n!=null&&p(e,["thought"],n);const s=h(i,["inlineData"]);s!=null&&p(e,["inlineData"],vF(s));const r=h(i,["fileData"]);r!=null&&p(e,["fileData"],xF(r));const l=h(i,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(i,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(i,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(i,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(i,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const v=h(i,["text"]);return v!=null&&p(e,["text"],v),e}function SF(i){const e={},t=h(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>bF(r))),p(e,["parts"],s)}const n=h(i,["role"]);return n!=null&&p(e,["role"],n),e}function CF(i){const e={},t=h(i,["behavior"]);t!=null&&p(e,["behavior"],t);const n=h(i,["description"]);n!=null&&p(e,["description"],n);const s=h(i,["name"]);s!=null&&p(e,["name"],s);const r=h(i,["parameters"]);r!=null&&p(e,["parameters"],r);const l=h(i,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(i,["response"]);c!=null&&p(e,["response"],c);const f=h(i,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function AF(i){const e={},t=h(i,["startTime"]);t!=null&&p(e,["startTime"],t);const n=h(i,["endTime"]);return n!=null&&p(e,["endTime"],n),e}function EF(i){const e={},t=h(i,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],AF(t)),e}function _F(i){const e={},t=h(i,["mode"]);t!=null&&p(e,["mode"],t);const n=h(i,["dynamicThreshold"]);return n!=null&&p(e,["dynamicThreshold"],n),e}function TF(i){const e={},t=h(i,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],_F(t)),e}function wF(){return{}}function MF(i){const e={},t=h(i,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>CF(d))),p(e,["functionDeclarations"],f)}if(h(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=h(i,["googleSearch"]);n!=null&&p(e,["googleSearch"],EF(n));const s=h(i,["googleSearchRetrieval"]);if(s!=null&&p(e,["googleSearchRetrieval"],TF(s)),h(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(i,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(i,["urlContext"])!=null&&p(e,["urlContext"],wF());const l=h(i,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(i,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function NF(i){const e={},t=h(i,["handle"]);if(t!=null&&p(e,["handle"],t),h(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xb(){return{}}function RF(i){const e={},t=h(i,["disabled"]);t!=null&&p(e,["disabled"],t);const n=h(i,["startOfSpeechSensitivity"]);n!=null&&p(e,["startOfSpeechSensitivity"],n);const s=h(i,["endOfSpeechSensitivity"]);s!=null&&p(e,["endOfSpeechSensitivity"],s);const r=h(i,["prefixPaddingMs"]);r!=null&&p(e,["prefixPaddingMs"],r);const l=h(i,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function IF(i){const e={},t=h(i,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],RF(t));const n=h(i,["activityHandling"]);n!=null&&p(e,["activityHandling"],n);const s=h(i,["turnCoverage"]);return s!=null&&p(e,["turnCoverage"],s),e}function DF(i){const e={},t=h(i,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function kF(i){const e={},t=h(i,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const n=h(i,["slidingWindow"]);return n!=null&&p(e,["slidingWindow"],DF(n)),e}function LF(i){const e={},t=h(i,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function PF(i,e){const t={},n=h(i,["generationConfig"]);e!==void 0&&n!=null&&p(e,["setup","generationConfig"],n);const s=h(i,["responseModalities"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","responseModalities"],s);const r=h(i,["temperature"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","temperature"],r);const l=h(i,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(i,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(i,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(i,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(i,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const v=h(i,["speechConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","speechConfig"],gF(Ep(v)));const b=h(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],b);const C=h(i,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],SF(Jt(C)));const E=h(i,["tools"]);if(e!==void 0&&E!=null){let R=tr(E);Array.isArray(R)&&(R=R.map(I=>MF(er(I)))),p(e,["setup","tools"],R)}const A=h(i,["sessionResumption"]);e!==void 0&&A!=null&&p(e,["setup","sessionResumption"],NF(A));const _=h(i,["inputAudioTranscription"]);e!==void 0&&_!=null&&p(e,["setup","inputAudioTranscription"],xb());const w=h(i,["outputAudioTranscription"]);e!==void 0&&w!=null&&p(e,["setup","outputAudioTranscription"],xb());const N=h(i,["realtimeInputConfig"]);e!==void 0&&N!=null&&p(e,["setup","realtimeInputConfig"],IF(N));const M=h(i,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],kF(M));const k=h(i,["proactivity"]);return e!==void 0&&k!=null&&p(e,["setup","proactivity"],LF(k)),t}function FF(i,e){const t={},n=h(e,["model"]);n!=null&&p(t,["setup","model"],Qe(i,n));const s=h(e,["config"]);return s!=null&&p(t,["config"],PF(s,t)),t}function OF(i,e,t){const n={},s=h(e,["expireTime"]);t!==void 0&&s!=null&&p(t,["expireTime"],s);const r=h(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&p(t,["newSessionExpireTime"],r);const l=h(e,["uses"]);t!==void 0&&l!=null&&p(t,["uses"],l);const c=h(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&p(t,["bidiGenerateContentSetup"],FF(i,c));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&p(t,["fieldMask"],f),n}function UF(i,e){const t={},n=h(e,["config"]);return n!=null&&p(t,["config"],OF(i,n,t)),t}function BF(i){const e={},t=h(i,["name"]);return t!=null&&p(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VF(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(r=>`${t}.${r}`);e.push(...s)}else e.push(t)}return e.join(",")}function GF(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const r=n.setup;typeof r=="object"&&r!==null?(i.bidiGenerateContentSetup=r,t=r):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const r=VF(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)r?i.fieldMask=r:delete i.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(d=>l.includes(d)?`generationConfig.${d}`:d));const f=[];r&&f.push(r),c.length>0&&f.push(...c),f.length>0?i.fieldMask=f.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class qF extends Ys{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=UF(this.apiClient,e);r=Ce("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const f=GF(c,e.config);return s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),s.then(d=>BF(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HF(i){const e={},t=h(i,["name"]);t!=null&&p(e,["_url","name"],t);const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function jF(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);e!==void 0&&s!=null&&p(e,["_query","pageToken"],s);const r=h(i,["filter"]);return e!==void 0&&r!=null&&p(e,["_query","filter"],r),t}function zF(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],jF(t,e)),e}function $F(i){const e={},t=h(i,["textInput"]);t!=null&&p(e,["textInput"],t);const n=h(i,["output"]);return n!=null&&p(e,["output"],n),e}function YF(i){const e={};if(h(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(i,["examples"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>$F(s))),p(e,["examples","examples"],n)}return e}function WF(i,e){const t={};if(h(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const n=h(i,["tunedModelDisplayName"]);if(e!==void 0&&n!=null&&p(e,["displayName"],n),h(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=h(i,["epochCount"]);e!==void 0&&s!=null&&p(e,["tuningTask","hyperparameters","epochCount"],s);const r=h(i,["learningRateMultiplier"]);if(r!=null&&p(t,["tuningTask","hyperparameters","learningRateMultiplier"],r),h(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(i,["batchSize"]);e!==void 0&&l!=null&&p(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(i,["learningRate"]);return e!==void 0&&c!=null&&p(e,["tuningTask","hyperparameters","learningRate"],c),t}function KF(i){const e={},t=h(i,["baseModel"]);t!=null&&p(e,["baseModel"],t);const n=h(i,["trainingDataset"]);n!=null&&p(e,["tuningTask","trainingData"],YF(n));const s=h(i,["config"]);return s!=null&&p(e,["config"],WF(s,e)),e}function XF(i){const e={},t=h(i,["name"]);t!=null&&p(e,["_url","name"],t);const n=h(i,["config"]);return n!=null&&p(e,["config"],n),e}function JF(i,e){const t={},n=h(i,["pageSize"]);e!==void 0&&n!=null&&p(e,["_query","pageSize"],n);const s=h(i,["pageToken"]);e!==void 0&&s!=null&&p(e,["_query","pageToken"],s);const r=h(i,["filter"]);return e!==void 0&&r!=null&&p(e,["_query","filter"],r),t}function QF(i){const e={},t=h(i,["config"]);return t!=null&&p(e,["config"],JF(t,e)),e}function ZF(i,e){const t={},n=h(i,["gcsUri"]);e!==void 0&&n!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],n);const s=h(i,["vertexDatasetResource"]);if(e!==void 0&&s!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],s),h(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function eO(i,e){const t={},n=h(i,["gcsUri"]);n!=null&&p(t,["validationDatasetUri"],n);const s=h(i,["vertexDatasetResource"]);return e!==void 0&&s!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],s),t}function tO(i,e){const t={},n=h(i,["validationDataset"]);e!==void 0&&n!=null&&p(e,["supervisedTuningSpec"],eO(n,t));const s=h(i,["tunedModelDisplayName"]);e!==void 0&&s!=null&&p(e,["tunedModelDisplayName"],s);const r=h(i,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);const l=h(i,["epochCount"]);e!==void 0&&l!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(i,["learningRateMultiplier"]);e!==void 0&&c!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const f=h(i,["exportLastCheckpointOnly"]);e!==void 0&&f!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const d=h(i,["adapterSize"]);if(e!==void 0&&d!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),h(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function nO(i){const e={},t=h(i,["baseModel"]);t!=null&&p(e,["baseModel"],t);const n=h(i,["trainingDataset"]);n!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],ZF(n,e));const s=h(i,["config"]);return s!=null&&p(e,["config"],tO(s,e)),e}function iO(i){const e={},t=h(i,["name"]);t!=null&&p(e,["model"],t);const n=h(i,["name"]);return n!=null&&p(e,["endpoint"],n),e}function LC(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["state"]);n!=null&&p(e,["state"],dC(n));const s=h(i,["createTime"]);s!=null&&p(e,["createTime"],s);const r=h(i,["tuningTask","startTime"]);r!=null&&p(e,["startTime"],r);const l=h(i,["tuningTask","completeTime"]);l!=null&&p(e,["endTime"],l);const c=h(i,["updateTime"]);c!=null&&p(e,["updateTime"],c);const f=h(i,["description"]);f!=null&&p(e,["description"],f);const d=h(i,["baseModel"]);d!=null&&p(e,["baseModel"],d);const g=h(i,["_self"]);g!=null&&p(e,["tunedModel"],iO(g));const v=h(i,["distillationSpec"]);v!=null&&p(e,["distillationSpec"],v);const b=h(i,["experiment"]);b!=null&&p(e,["experiment"],b);const C=h(i,["labels"]);C!=null&&p(e,["labels"],C);const E=h(i,["pipelineJob"]);E!=null&&p(e,["pipelineJob"],E);const A=h(i,["satisfiesPzi"]);A!=null&&p(e,["satisfiesPzi"],A);const _=h(i,["satisfiesPzs"]);_!=null&&p(e,["satisfiesPzs"],_);const w=h(i,["serviceAccount"]);w!=null&&p(e,["serviceAccount"],w);const N=h(i,["tunedModelDisplayName"]);return N!=null&&p(e,["tunedModelDisplayName"],N),e}function sO(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["tunedModels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>LC(l))),p(e,["tuningJobs"],r)}return e}function oO(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["metadata"]);n!=null&&p(e,["metadata"],n);const s=h(i,["done"]);s!=null&&p(e,["done"],s);const r=h(i,["error"]);return r!=null&&p(e,["error"],r),e}function rO(i){const e={},t=h(i,["checkpointId"]);t!=null&&p(e,["checkpointId"],t);const n=h(i,["epoch"]);n!=null&&p(e,["epoch"],n);const s=h(i,["step"]);s!=null&&p(e,["step"],s);const r=h(i,["endpoint"]);return r!=null&&p(e,["endpoint"],r),e}function aO(i){const e={},t=h(i,["model"]);t!=null&&p(e,["model"],t);const n=h(i,["endpoint"]);n!=null&&p(e,["endpoint"],n);const s=h(i,["checkpoints"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>rO(l))),p(e,["checkpoints"],r)}return e}function Oh(i){const e={},t=h(i,["name"]);t!=null&&p(e,["name"],t);const n=h(i,["state"]);n!=null&&p(e,["state"],dC(n));const s=h(i,["createTime"]);s!=null&&p(e,["createTime"],s);const r=h(i,["startTime"]);r!=null&&p(e,["startTime"],r);const l=h(i,["endTime"]);l!=null&&p(e,["endTime"],l);const c=h(i,["updateTime"]);c!=null&&p(e,["updateTime"],c);const f=h(i,["error"]);f!=null&&p(e,["error"],f);const d=h(i,["description"]);d!=null&&p(e,["description"],d);const g=h(i,["baseModel"]);g!=null&&p(e,["baseModel"],g);const v=h(i,["tunedModel"]);v!=null&&p(e,["tunedModel"],aO(v));const b=h(i,["supervisedTuningSpec"]);b!=null&&p(e,["supervisedTuningSpec"],b);const C=h(i,["tuningDataStats"]);C!=null&&p(e,["tuningDataStats"],C);const E=h(i,["encryptionSpec"]);E!=null&&p(e,["encryptionSpec"],E);const A=h(i,["partnerModelTuningSpec"]);A!=null&&p(e,["partnerModelTuningSpec"],A);const _=h(i,["distillationSpec"]);_!=null&&p(e,["distillationSpec"],_);const w=h(i,["experiment"]);w!=null&&p(e,["experiment"],w);const N=h(i,["labels"]);N!=null&&p(e,["labels"],N);const M=h(i,["pipelineJob"]);M!=null&&p(e,["pipelineJob"],M);const k=h(i,["satisfiesPzi"]);k!=null&&p(e,["satisfiesPzi"],k);const R=h(i,["satisfiesPzs"]);R!=null&&p(e,["satisfiesPzs"],R);const I=h(i,["serviceAccount"]);I!=null&&p(e,["serviceAccount"],I);const P=h(i,["tunedModelDisplayName"]);return P!=null&&p(e,["tunedModelDisplayName"],P),e}function lO(i){const e={},t=h(i,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const n=h(i,["nextPageToken"]);n!=null&&p(e,["nextPageToken"],n);const s=h(i,["tuningJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>Oh(l))),p(e,["tuningJobs"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cO extends Ys{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Oa(Hs.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const n=await this.tuneMldevInternal(t);let s="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?s=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(s=n.name.split("/operations/")[0]),{name:s,state:wh.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=XF(e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>Oh(g))}else{const d=HF(e);return c=Ce("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>LC(g))}}async listInternal(e){var t,n,s,r;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=QF(e);return c=Ce("tuningJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=lO(g),b=new Kx;return Object.assign(b,v),b})}else{const d=zF(e);return c=Ce("tunedModels",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const b=v;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const v=sO(g),b=new Kx;return Object.assign(b,v),b})}}async tuneInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI()){const c=nO(e);return r=Ce("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>Oh(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=KF(e);return r=Ce("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>oO(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uO{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const dO=1024*1024*8,fO=3,hO=1e3,pO=2,th="x-goog-upload-status";async function mO(i,e,t){var n,s,r;let l=0,c=0,f=new Mh(new Response),d="upload";for(l=i.size;c<l;){const v=Math.min(dO,l-c),b=i.slice(c,c+v);c+v>=l&&(d+=", finalize");let C=0,E=hO;for(;C<fO&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(c),"Content-Length":String(v)}}}),!(!((n=f?.headers)===null||n===void 0)&&n[th]));)C++,await yO(E),E=E*pO;if(c+=v,((s=f?.headers)===null||s===void 0?void 0:s[th])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await f?.json();if(((r=f?.headers)===null||r===void 0?void 0:r[th])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function gO(i){return{size:i.size,type:i.type}}function yO(i){return new Promise(e=>setTimeout(e,i))}class vO{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await mO(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await gO(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xO{create(e,t,n){return new bO(e,t,n)}}class bO{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bb="x-goog-api-key";class SO{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(bb)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(bb,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CO="gl-node/";class PC{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=_N(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const s=new SO(this.apiKey);this.apiClient=new qP({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:CO+"web",uploader:new vO,downloader:new uO}),this.models=new lF(this.apiClient),this.live=new tF(this.apiClient,s,new xO),this.batches=new KR(this.apiClient),this.chats=new Z2(this.models,this.apiClient),this.caches=new X2(this.apiClient),this.files=new fI(this.apiClient),this.operations=new fF(this.apiClient),this.authTokens=new qF(this.apiClient),this.tunings=new cO(this.apiClient)}}class AO{ai;GEMINI_MODEL="gemini-2.5-pro";constructor(e){this.ai=new PC({apiKey:e}),console.log("🤖 Gemini PDF Service configurado con modelo:",this.GEMINI_MODEL)}async extractQuestionsFromPDF(e){console.log("📄 Iniciando procesamiento directo de PDF con Gemini...");try{console.log("📤 Subiendo PDF a Gemini...");const t=await this.ai.files.upload({file:e,config:{displayName:e.name}});if(console.log("⏳ Esperando procesamiento del archivo..."),!t.name)throw new Error("No se obtuvo el nombre del archivo subido");let n=await this.ai.files.get({name:t.name});for(;n.state==="PROCESSING";)console.log(`📊 Estado del archivo: ${n.state}`),await new Promise(c=>{setTimeout(c,2e3)}),n=await this.ai.files.get({name:t.name});if(n.state==="FAILED")throw new Error("El procesamiento del archivo falló en Gemini");console.log("✅ Archivo procesado exitosamente");const s=`
Analyze this PDF document and extract ALL exam questions you find.

INSTRUCTIONS:
1. Look for questions throughout the ENTIRE document
2. Identify answer options (A, B, C, D, etc.)
3. If you cannot determine the correct answer, mark the first one as correct
4. Extract maximum 50 questions to avoid very long responses
5. ALL extracted content must be in English only

REQUIRED JSON FORMAT:
[
  {
    "question_text": "What is the capital of France?",
    "options": [
      {"option_letter": "A", "option_text": "Madrid", "is_correct": false},
      {"option_letter": "B", "option_text": "Paris", "is_correct": true},
      {"option_letter": "C", "option_text": "London", "is_correct": false}
    ],
    "requires_multiple_answers": false,
    "explanation": "",
    "link": ""
  }
]

IMPORTANT: 
- Respond ONLY with the JSON array
- Do not add text before or after the JSON
- ALL text must be in English
- If no questions are found, respond: []
`,r=[s];if(n.uri&&n.mimeType){const c=TN(n.uri,n.mimeType);r.push(c)}else throw new Error("No se pudo obtener la URI del archivo procesado");console.log("🤖 Generando análisis con Gemini..."),console.log("📄 Enviando contenido:",{promptLength:s.length,hasFileContent:!!n.uri,fileUri:n.uri?.substring(0,50)+"..."});const l=Date.now();try{console.log("⏳ Enviando solicitud a Gemini...");const c=new Promise((C,E)=>setTimeout(()=>E(new Error("Timeout: Gemini tardó más de 2 minutos")),3e5)),f=this.ai.models.generateContent({model:this.GEMINI_MODEL,contents:r}),d=await Promise.race([f,c]),g=Date.now();console.log(`⏱️ Gemini respondió en ${g-l}ms`);const v=d.text;if(!v||v.trim()==="")throw console.error("❌ Respuesta vacía de Gemini"),new Error("Gemini devolvió una respuesta vacía");console.log("📝 Respuesta de Gemini PDF recibida:",{length:v.length,preview:v.substring(0,300)+"...",endsWithBracket:v.trim().endsWith("]"),startsWithBracket:v.trim().startsWith("[")});const b=this.parseQuestionsResponse(v);console.log(`✅ Extraídas ${b.length} preguntas del PDF completo`);try{t.name&&(await this.ai.files.delete({name:t.name}),console.log("🗑️ Archivo temporal eliminado de Gemini"))}catch(C){console.warn("⚠️ No se pudo eliminar el archivo temporal:",C)}return b}catch(c){console.error("❌ Error específico de Gemini:",c);try{t.name&&(await this.ai.files.delete({name:t.name}),console.log("🗑️ Archivo temporal eliminado tras error"))}catch(f){console.warn("⚠️ No se pudo eliminar archivo tras error:",f)}throw new Error(`Error en generación de Gemini: ${c instanceof Error?c.message:"Error desconocido"}`)}}catch(t){throw console.error("❌ Error en procesamiento de PDF con Gemini:",t),new Error(`Error procesando PDF: ${t instanceof Error?t.message:"Error desconocido"}`)}}parseQuestionsResponse(e){console.log("🔍 Iniciando parseo de respuesta..."),console.log("📄 Respuesta completa de Gemini:",e);try{let t=e.replace(/```json\s*/gi,"").replace(/```\s*/gi,"").trim();if((t.endsWith("...")||t.endsWith('"'))&&(console.log("⚠️ JSON parece estar truncado, intentando completar..."),t.lastIndexOf("[")>t.lastIndexOf("]")&&(t.trim().endsWith("]")||(t=t.trim(),t.endsWith(",")&&(t=t.slice(0,-1)),t+="]",console.log("🔧 JSON completado automáticamente")))),!t.startsWith("[")){const l=t.indexOf("[");l!==-1&&(t=t.substring(l))}const n=t.lastIndexOf("]");if(n!==-1&&n<t.length-1&&(t=t.substring(0,n+1)),console.log("🧹 Texto limpio para parsear:",t.substring(0,500)+"..."),!t.startsWith("[")){console.log("⚠️ No se detectó JSON válido, buscando array en el texto...");const l=[/\[[\s\S]*?\]/g,/```json\s*(\[[\s\S]*?\])\s*```/gi,/JSON:\s*(\[[\s\S]*?\])/gi,/(\[[\s\S]*?\])/g];let c=!1;for(const f of l){const d=e.match(f);if(d&&d.length>0){t=d.reduce((g,v)=>v.length>g.length?v:g,""),t=t.replace(/```json\s*/gi,"").replace(/```\s*/gi,"").replace(/JSON:\s*/gi,"").trim(),console.log("🔄 JSON extraído del texto:",t.substring(0,200)+"..."),c=!0;break}}if(!c)return console.error("❌ No se encontró JSON válido en la respuesta"),console.error("📄 Respuesta completa para debug:",e),[]}const s=JSON.parse(t);if(!Array.isArray(s))return console.error("❌ La respuesta no es un array válido:",typeof s),[];console.log(`📊 Array parseado exitosamente con ${s.length} elementos`);const r=s.map((l,c)=>(console.log(`🔍 Procesando pregunta ${c+1}:`,{question_text:l.question_text?.substring(0,50)+"...",options_count:l.options?.length||0,requires_multiple_answers:l.requires_multiple_answers}),{id:`gemini_pdf_${Date.now()}_${c}`,question_text:l.question_text||"",options:(l.options||[]).map(f=>({option_letter:f.option_letter||"",option_text:f.option_text||"",is_correct:f.is_correct||!1})),requires_multiple_answers:l.requires_multiple_answers||!1,explanation:l.explanation||"Extraído directamente del PDF con Gemini",link:l.link||"",confidence:.9,source:"text",needsReview:!1,page_number:l.page_number||1}));return console.log(`✅ Se procesaron exitosamente ${r.length} preguntas`),r.filter(l=>l.question_text&&l.options.length>=2)}catch(t){throw console.error("❌ Error al parsear respuesta JSON:",t),console.error("📄 Texto completo que falló:",e),t instanceof SyntaxError&&(console.error("🔍 Error de sintaxis JSON:",t.message),console.error("🔍 Posición del error:",t.position||"No disponible")),new Error("No se pudo parsear la respuesta de Gemini como JSON válido")}}static isConfigured(e){return!!(e&&e.trim()!==""&&e!=="your_gemini_api_key_here")}}class EO{ai;GEMINI_MODEL="gemini-2.5-flash";constructor(e){this.ai=new PC({apiKey:e}),console.log("🤖 Gemini Question Processor configurado con modelo:",this.GEMINI_MODEL)}async processQuestionsIndividually(e,t,n){console.log(`🔄 Iniciando procesamiento individual de ${e.length} preguntas`);const s=[];for(let r=0;r<e.length;r++){const l=e[r],c=t+r;n&&n({currentQuestion:r+1,totalQuestions:e.length,stage:"processing",currentQuestionText:l.question_text.substring(0,100)+"..."}),console.log(`📝 Procesando pregunta ${r+1}/${e.length}: ${l.question_text.substring(0,50)}...`);try{const f=await this.enhanceQuestionWithExplanation(l),d={question_number:c,question_text:f.question_text,options:f.options.map(g=>({option_letter:g.option_letter,option_text:g.option_text,is_correct:g.is_correct})),requires_multiple_answers:f.requires_multiple_answers,link:f.link||"",explanation:f.explanation||""};s.push(d),console.log(`✅ Pregunta ${c} procesada exitosamente`),await new Promise(g=>setTimeout(g,500))}catch(f){console.error(`❌ Error procesando pregunta ${r+1}:`,f);const d={question_number:c,question_text:l.question_text,options:l.options.map(g=>({option_letter:g.option_letter,option_text:g.option_text,is_correct:g.is_correct})),requires_multiple_answers:l.requires_multiple_answers,link:l.link||"",explanation:l.explanation||"Explicación no disponible (error en procesamiento)"};s.push(d),console.log(`⚠️ Pregunta ${c} guardada sin explicación mejorada`)}}return n&&n({currentQuestion:e.length,totalQuestions:e.length,stage:"complete"}),console.log(`✅ Procesamiento individual completado: ${s.length} preguntas procesadas`),s}async enhanceQuestionWithExplanation(e){const t=e.options.filter(r=>r.is_correct).map(r=>`${r.option_letter}) ${r.option_text}`).join(", "),n=e.options.map(r=>`${r.option_letter}) ${r.option_text}`).join(`
`),s=`
You are an expert educational content creator. Given this exam question, provide a detailed explanation of why the correct answer is valid and include a reference link where students can learn more about this topic.

QUESTION:
${e.question_text}

OPTIONS:
${n}

CORRECT ANSWER(S): ${t}

Please provide a response in this EXACT JSON format:
{
  "explanation": "A detailed explanation of why the correct answer is right, including the reasoning and key concepts involved. Keep it educational and clear.",
  "link": "A relevant educational URL where students can learn more about this topic (use reputable sources like Wikipedia, educational institutions, or official documentation)"
}

REQUIREMENTS:
- Explanation must be comprehensive but concise (2-4 sentences)
- Link must be a real, accessible URL to a reputable source
- Response must be in English
- Provide ONLY the JSON response, no additional text
`;try{console.log("🤖 Enviando pregunta individual a Gemini para explicación...");const l=(await this.ai.models.generateContent({model:this.GEMINI_MODEL,contents:[s]})).text;if(!l||l.trim()==="")throw new Error("Respuesta vacía de Gemini");console.log("📝 Respuesta de explicación recibida:",l.substring(0,200)+"...");const c=this.parseEnhancementResponse(l);return{...e,explanation:c.explanation,link:c.link}}catch(r){return console.error("❌ Error obteniendo explicación:",r),e}}parseEnhancementResponse(e){try{const t=e.replace(/```json\s*/gi,"").replace(/```\s*/gi,"").trim(),n=JSON.parse(t);return{explanation:n.explanation||"Explicación no disponible",link:n.link||""}}catch(t){return console.error("❌ Error parseando respuesta de explicación:",t),{explanation:"Explicación no disponible (error en parseo)",link:""}}}}const _O=(i,e)=>i.map((t,n)=>({question_number:e+n,question_text:t.question_text,options:t.options,requires_multiple_answers:t.requires_multiple_answers,explanation:t.explanation,link:t.link})),TO=({geminiApiKey:i,nextQuestionNumber:e,showAlert:t,showConfirm:n,onImportQuestions:s})=>{const[r,l]=O.useState(!1),[c,f]=O.useState(""),[d,g]=O.useState(null),[v,b]=O.useState("gemini-2.5-pro"),[C,E]=O.useState(null),A=O.useCallback((k,R)=>{console.error("Error procesando PDF:",k);const I=k instanceof Error?k.message:"Error desconocido",P=R.getGeminiService()?.getFallbackStatus();P&&(E(P),b(P.currentModel)),I.includes("503")||I.includes("overloaded")?t("⚠️ El servicio de Gemini está temporalmente sobrecargado. Intenta de nuevo en unos minutos.",{title:"Servicio sobrecargado",type:"warning"}):I.includes("429")||I.includes("quota")||I.includes("Todos los modelos de Gemini fallaron")?t(`⚠️ Se agotó la cuota de todos los modelos de Gemini disponibles.

🕐 Espera unas horas para que se restablezcan las cuotas diarias.

💡 Tip: Las cuotas se restablecen automáticamente cada 24 horas.`,{title:"Cuota agotada",type:"warning"}):t(`❌ Error procesando PDF: ${I}`,{title:"Error de procesamiento",type:"error"})},[t]),_=O.useCallback(async(k,R)=>{if(!k||!i.trim()){t("Por favor asegúrate de tener un archivo y API key configurados",{title:"Configuración incompleta",type:"warning"});return}l(!0),console.log(`🚀 Iniciando procesamiento de página ${R} de ${k.name}`);const I=new Sp(i);try{const P=I.getGeminiService()?.getFallbackStatus();P&&(E(P),b(P.currentModel));const q=await I.processPDF(k,K=>{console.log(`Progreso: ${K.stage} - página ${K.currentPage}/${K.totalPages}`)},R,(K,ne)=>{console.log(`Pregunta extraída de página ${ne}:`,K.question_text)}),F=I.getGeminiService()?.getFallbackStatus();F&&(E(F),b(F.currentModel)),console.log("✅ Procesamiento completado:",q);const $=q.pages.flatMap(K=>K.extractedQuestions||[]);if($.length>0){const K=_O($,e);s(K),t(`✅ ¡Procesamiento exitoso!

📋 Se extrajeron ${$.length} pregunta${$.length>1?"s":""} de la página ${R}
🔍 Cada pregunta incluye explicación detallada y link de referencia
📝 Las preguntas se han añadido a tu lista con numeración consecutiva

🎯 Números asignados: ${e} - ${e+$.length-1}`,{title:"Importación completada",type:"success",buttonText:"Excelente!"})}else t(`⚠️ No se encontraron preguntas en la página ${R} del PDF.`,{title:"Sin resultados",type:"warning"})}catch(P){A(P,I)}finally{l(!1)}},[i,e,s,t,A]),w=O.useCallback(async k=>{await _(k,1)},[_]),N=O.useCallback(async k=>{l(!0),f("🚀 Iniciando procesamiento directo de PDF..."),g(null),console.log(`🚀 Iniciando procesamiento directo de PDF: ${k.name}`);try{f("📄 Preparando archivo PDF...");const R=new AO(i);f("🤖 Analizando contenido con Gemini (esto puede tomar 1-3 minutos)...");const I=await R.extractQuestionsFromPDF(k);if(I.length===0){t("⚠️ No se encontraron preguntas en el PDF completo.",{title:"Sin resultados",type:"warning"});return}console.log(`📋 Se extrajeron ${I.length} preguntas del PDF`),f(`✅ PDF analizado: ${I.length} preguntas encontradas`),f("🔄 Procesando preguntas individualmente...");const q=await new EO(i).processQuestionsIndividually(I,e,F=>{g(F),F.stage==="processing"&&f(`🔄 Procesando pregunta ${F.currentQuestion}/${F.totalQuestions}: ${F.currentQuestionText||"Obteniendo explicación..."}`)});f("✅ Todas las preguntas procesadas exitosamente"),g(null),s(q),t(`✅ ¡Procesamiento CON IMÁGENES exitoso!

🖼️ Se analizó todo el PDF incluyendo contenido visual
📋 Se extrajeron ${q.length} preguntas del PDF completo
🔍 Cada pregunta incluye explicación detallada y link de referencia
📝 Las preguntas se han añadido a tu lista con numeración consecutiva

🎯 Números asignados: ${e} - ${e+q.length-1}`,{title:"Procesamiento completo exitoso",type:"success",buttonText:"Excelente!"})}catch(R){console.error("Error en procesamiento directo:",R);const I=R instanceof Error?R.message:"Error desconocido";t(`❌ Error en procesamiento directo: ${I}`,{title:"Error de procesamiento",type:"error"})}finally{l(!1),f(""),g(null)}},[i,e,s,t]),M=O.useCallback(async(k,R,I)=>{if(!k||!i.trim()){t("Se requiere archivo y API key para el procesamiento",{title:"Configuración incompleta",type:"warning"});return}const P=I==="text-only";n(`📄 Archivo: ${k.name} (${R} página${R>1?"s":""})
🔧 Método: ${P?"Extracción de texto + IA para explicaciones":"Análisis completo con Gemini Vision"}
💰 Costo: ${P?"Bajo (solo explicaciones)":"Moderado (análisis completo)"}
⏱️ Tiempo estimado: ${P?"1-2 minutos":"3-5 minutos"}
🎯 Resultado: ${P?"Preguntas de texto con explicaciones":"Análisis completo incluyendo imágenes"}`,async()=>{P?await w(k):await N(k)},{title:`Procesar como contenido ${P?"SOLO TEXTO":"CON IMÁGENES"}`,confirmText:"Sí, Procesar",cancelText:"Cancelar"})},[i,t,n,w,N]);return{isProcessing:r,processingProgress:c,individualProcessingProgress:d,currentGeminiModel:v,fallbackStatus:C,startSinglePageProcessing:_,startIntelligentProcessing:M}};/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),MO=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),Sb=i=>{const e=MO(i);return e.charAt(0).toUpperCase()+e.slice(1)},FC=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),NO=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=O.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:r,iconNode:l,...c},f)=>O.createElement("svg",{ref:f,...RO,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:FC("lucide",s),...!r&&!NO(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,g])=>O.createElement(d,g)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=(i,e)=>{const t=O.forwardRef(({className:n,...s},r)=>O.createElement(IO,{ref:r,iconNode:e,className:FC(`lucide-${wO(Sb(i))}`,`lucide-${i}`,n),...s}));return t.displayName=Sb(i),t};/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],kO=zn("check",DO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wp=zn("chevron-down",LO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Mp=zn("chevron-up",PO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Uh=zn("circle-alert",FO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],UO=zn("clock",OO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],VO=zn("eye",BO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],qO=zn("file-text",GO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Cb=zn("send",HO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zO=zn("settings",jO);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ab=zn("upload",$O);/**
 * @license lucide-react v0.528.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],WO=zn("zap",YO),fa="gemini_api_validation_cache",Eb=i=>{let e=0;for(let t=0;t<i.length;t++){const n=i.charCodeAt(t);e=(e<<5)-e+n,e=e&e}return Math.abs(e).toString(36)},KO=()=>{const[i,e]=O.useState({isValid:!1,isValidating:!1,error:null}),t=O.useRef(""),n=O.useRef(!1);O.useEffect(()=>{const f=(()=>{try{const d=localStorage.getItem(fa);if(d){const g=JSON.parse(d);if(!(Date.now()-g.timestamp>1440*60*1e3)&&g.isValid)return g}}catch(d){console.warn("Failed to load validation cache:",d)}return null})();f&&e({isValid:f.isValid,isValidating:!1,error:null,validatedApiKey:"cached"})},[]);const s=i.isValid&&i.validatedApiKey!==void 0,r=O.useCallback(async c=>{if(!c||c.trim()===""){e({isValid:!1,isValidating:!1,error:"API key no puede estar vacía"}),t.current="",localStorage.removeItem(fa);return}try{const f=localStorage.getItem(fa);if(f){const d=JSON.parse(f),g=Eb(c);if(!(Date.now()-d.timestamp>1440*60*1e3)&&d.apiKeyHash===g&&d.isValid){e({isValid:!0,isValidating:!1,error:null,validatedApiKey:"cached"}),t.current=c;return}}}catch(f){console.warn("Failed to check validation cache:",f)}if(c!==t.current&&!n.current){n.current=!0,t.current=c,e({isValid:!1,isValidating:!0,error:null});try{if((await(await new bp(c).getGenerativeModel({model:"gemini-2.0-flash"}).generateContent("Responde solo: OK")).response).text().trim().toLowerCase().includes("ok")){const C={apiKeyHash:Eb(c),isValid:!0,timestamp:Date.now()};localStorage.setItem(fa,JSON.stringify(C)),e({isValid:!0,isValidating:!1,error:null,validatedApiKey:c})}else e({isValid:!1,isValidating:!1,error:"La API key no respondió correctamente"})}catch(f){let d="API key inválida";f instanceof Error&&(f.message?.includes("API_KEY_INVALID")?d="La API key proporcionada no es válida":f.message?.includes("PERMISSION_DENIED")?d="La API key no tiene permisos suficientes":f.message?.includes("QUOTA_EXCEEDED")?d="Se ha excedido la cuota de la API key":f.message?.includes("RATE_LIMIT_EXCEEDED")?d="Se ha excedido el límite de velocidad, intenta más tarde":d=f.message),console.error("❌ Error validando API key:",f),e({isValid:!1,isValidating:!1,error:d})}finally{n.current=!1}}},[]),l=O.useCallback(()=>{e({isValid:!1,isValidating:!1,error:null}),t.current="",n.current=!1,localStorage.removeItem(fa)},[]);return{validationResult:i,validateApiKey:r,resetValidation:l,isApiKeyLocked:s}},XO=({geminiApiKey:i,saveGeminiApiKey:e,currentGeminiModel:t,fallbackStatus:n})=>{const[s,r]=O.useState(!i||i.trim()===""),{validationResult:l,validateApiKey:c,resetValidation:f,isApiKeyLocked:d}=KO(),[g,v]=O.useState(!1),b=i&&i.trim()!=="",C=b&&l.isValid,E=b&&l.error;O.useEffect(()=>{if(!b){f();return}if(d&&!g)return;const R=setTimeout(()=>{b&&!l.isValidating&&!d&&c(i)},1e3);return()=>clearTimeout(R)},[i,b,f,c,l.isValidating,d,g]);const A=()=>l.isValidating?y.jsx(QT,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}):C?y.jsx(O0,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}):E?y.jsx(Sc,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}):y.jsx(Uh,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),_=()=>l.isValidating?"bg-blue-50 border-blue-200":C?"bg-green-50 border-green-200":E?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200",N=l.isValidating?{title:"text-blue-800",description:"text-blue-700",chevron:"text-blue-600"}:C?{title:"text-green-800",description:"text-green-700",chevron:"text-green-600"}:E?{title:"text-red-800",description:"text-red-700",chevron:"text-red-600"}:{title:"text-yellow-800",description:"text-yellow-700",chevron:"text-yellow-600"},M=()=>l.isValidating?{main:"Validando API Key...",additional:null}:C?{main:"API Key Configurada",additional:". Haz clic para ver detalles o cambiar."}:E?{main:"API Key Inválida",additional:null}:{main:"Configuración API Key",additional:null},k=()=>l.isValidating?"Verificando la validez de la API key...":C?null:E?`Error: ${l.error}. Haz clic para corregir.`:"Se requiere API key de Google Gemini. Haz clic para configurar.";return y.jsxs("div",{className:`border rounded-lg p-4 mb-6 ${_()}`,children:[y.jsxs("button",{onClick:()=>r(!s),onMouseDown:R=>R.preventDefault(),tabIndex:-1,className:"w-full flex items-start justify-between space-x-3 text-left focus:outline-none focus:ring-0",children:[y.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[A(),y.jsxs("div",{className:"flex-1",children:[y.jsxs("h3",{className:`font-medium flex items-center ${N.title}`,children:[y.jsx("span",{className:"font-medium",children:M().main}),M().additional&&y.jsx("span",{className:"font-normal",children:M().additional})]}),k()&&y.jsx("p",{className:`text-sm mt-1 ${N.description}`,children:k()})]})]}),y.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s?y.jsx(Mp,{className:`w-5 h-5 ${N.chevron}`}):y.jsx(wp,{className:`w-5 h-5 ${N.chevron}`})})]}),s&&y.jsxs("div",{className:"mt-3",children:[!b&&y.jsxs("p",{className:`text-sm mb-2 ${N.description}`,children:["Configura tu API key de Google Gemini para usar esta función.",y.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"underline ml-1",children:"Obtener API key gratuita"})]}),y.jsx("input",{type:"password",placeholder:"Pega tu API key de Gemini aquí...",value:i,onChange:R=>e(R.target.value),readOnly:d&&!g,className:`mt-2 w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 ${d&&!g?"bg-gray-50 cursor-not-allowed border-gray-300":l.isValidating?"border-blue-300 focus:ring-blue-500 focus:border-blue-500":C?"border-green-300 focus:ring-green-500 focus:border-green-500":E?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-amber-300 focus:ring-amber-500 focus:border-amber-500"}`}),d&&!g&&y.jsxs("div",{className:"mt-2 flex items-center justify-between p-2 bg-green-50 rounded border border-green-200",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsx(O0,{className:"w-4 h-4 mr-2"}),y.jsx("span",{className:"text-sm text-green-700 font-medium",children:"API key validada y bloqueada por seguridad"})]}),y.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-2 py-1 text-xs text-green-700 hover:text-green-800 hover:bg-green-100 rounded transition-colors","aria-label":"Desbloquear para editar API key",children:[y.jsx(ZT,{className:"w-3 h-3 mr-1"}),"Cambiar"]})]}),g&&d&&y.jsxs("div",{className:"mt-2 p-2 bg-yellow-50 rounded border border-yellow-200",children:[y.jsxs("p",{className:"text-xs text-yellow-700 mb-2 flex items-center",children:[y.jsx(lh,{className:"w-4 h-4 mr-1"}),"Estás editando una API key ya validada. Los cambios requerirán nueva validación."]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>{v(!1)},className:"px-2 py-1 text-xs text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"Cancelar"}),y.jsx("button",{onClick:()=>{f(),v(!1)},className:"px-2 py-1 text-xs text-yellow-700 hover:text-yellow-800 hover:bg-yellow-100 rounded transition-colors",children:"Confirmar cambios"})]})]}),E&&y.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded border border-red-200",children:y.jsxs("p",{className:"text-xs text-red-700 flex items-center",children:[y.jsx(Sc,{className:"w-4 h-4 mr-1"}),l.error]})}),C&&y.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded border border-blue-200",children:[y.jsxs("p",{className:"text-xs text-blue-700 mb-1 flex items-center",children:[y.jsx(JT,{className:"w-4 h-4 mr-1"}),y.jsx("strong",{children:"Modelo actual:"})," ",t]}),n&&y.jsxs("div",{className:"text-xs text-blue-600",children:[y.jsxs("p",{className:"flex items-center",children:[y.jsx(Wh,{className:"w-4 h-4 mr-1"}),"Modelo ",n.currentModelIndex+1," de ",n.totalModels]}),n.remainingModels>0&&y.jsxs("p",{className:"flex items-center",children:[y.jsx(KT,{className:"w-4 h-4 mr-1"}),n.remainingModels," modelos de respaldo disponibles"]}),n.remainingModels===0&&y.jsxs("p",{className:"text-amber-600 flex items-center",children:[y.jsx(lh,{className:"w-4 h-4 mr-1"}),"Último modelo disponible"]})]})]})]})]})},JO=({geminiApiKey:i,selectedFile:e,isProcessing:t})=>{const n=!!(i&&i.trim()!==""),s=(l,c=!1)=>c?y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}):l?y.jsx(kO,{className:"w-4 h-4 text-green-600"}):y.jsx(UO,{className:"w-4 h-4 text-gray-400"}),r=[{id:"api-key",text:"Configurar API Key",completed:n,inProgress:!1},{id:"select-file",text:"Seleccionar archivo PDF",completed:n&&!!e,inProgress:!1},{id:"process",text:"Procesar preguntas",completed:!1,inProgress:t},{id:"import",text:"Importar a la lista",completed:!1,inProgress:!1}];return y.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[y.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"🚀 Progreso:"}),y.jsx("div",{className:"space-y-3",children:r.map(l=>y.jsxs("div",{className:"flex items-center space-x-3",children:[s(l.completed,l.inProgress),y.jsx("span",{className:`text-sm ${l.completed?"text-gray-700 font-medium":l.inProgress?"text-blue-600 font-medium":"text-gray-500"}`,children:l.text})]},l.id))}),y.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded border border-blue-200",children:y.jsxs("p",{className:"text-xs text-blue-700",children:["💡 ",y.jsx("strong",{children:"Tip:"}),' Usa el "Procesamiento Directo" para mejores resultados. Analiza todo el PDF automáticamente y genera explicaciones detalladas.']})})]})},QO=()=>{const[i,e]=O.useState(!1);return y.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[y.jsxs("button",{onClick:()=>e(!i),className:"w-full flex items-start justify-between space-x-3 text-left focus:outline-none",children:[y.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[y.jsx("div",{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5",children:"🤖"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("h3",{className:"font-medium text-blue-800",children:"Sistema de Modelos con Fallback Automático"}),y.jsx("p",{className:"text-sm text-blue-700 mt-1",children:i?"El sistema usa automáticamente diferentes modelos de Gemini si se agota la cuota diaria:":"Haz clic para ver detalles del sistema de respaldo automático de modelos"})]})]}),y.jsx("div",{className:"flex-shrink-0 mt-0.5",children:i?y.jsx(Mp,{className:"w-5 h-5 text-blue-600"}):y.jsx(wp,{className:"w-5 h-5 text-blue-600"})})]}),i&&y.jsxs("div",{className:"mt-3 pl-8",children:[y.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[y.jsxs("p",{children:["🥇 ",y.jsx("strong",{children:"Primero:"})," gemini-2.5-pro (mejor calidad)"]}),y.jsxs("p",{children:["🥈 ",y.jsx("strong",{children:"Respaldo 1:"})," gemini-2.5-flash"]}),y.jsxs("p",{children:["🥉 ",y.jsx("strong",{children:"Respaldo 2:"})," gemini-2.5-flash-lite"]}),y.jsxs("p",{children:["🔄 ",y.jsx("strong",{children:"Respaldo 3:"})," gemini-2.0-flash-15"]}),y.jsxs("p",{children:["🔄 ",y.jsx("strong",{children:"Respaldo 4:"})," gemini-2.0-flash-lite"]})]}),y.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"💡 Si todos los modelos se agotan, espera unas horas para que se restablezcan las cuotas."})]})]})},ZO=({geminiApiKey:i})=>{const[e,t]=O.useState(null),[n,s]=O.useState(0),[r,l]=O.useState(!1),[c,f]=O.useState(null),d=O.useCallback(async v=>{l(!0),f(null),t(v);try{const C=await new Sp(i||"temp").getPDFInfo(v);s(C.totalPages),console.log(`📄 PDF cargado: ${v.name} - ${C.totalPages} páginas`)}catch(b){console.error("Error cargando PDF:",b);const C=Math.floor(Math.random()*45)+5;s(C);const E=b instanceof Error?b.message:"Error desconocido";f(`Error al cargar información del PDF: ${E}. Usando páginas simuladas.`),console.log(`📄 PDF cargado (simulado): ${v.name} - ${C} páginas`)}finally{l(!1)}},[i]),g=O.useCallback(()=>{t(null),s(0),f(null)},[]);return{selectedFile:e,totalPages:n,isLoadingFile:r,fileError:c,handleFileSelect:d,clearFile:g}},_b=({geminiApiKey:i,selectedFile:e,totalPages:t,onChangeFile:n})=>{if(!i?.trim())return null;const s="p-4 bg-blue-50 rounded-lg border border-blue-200";return e&&t?y.jsx("div",{className:s,children:y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex-1",children:[y.jsxs("div",{className:"text-sm text-blue-800 flex items-center mb-2",children:[y.jsx(eS,{className:"w-4 h-4 text-blue-600 mr-2 flex-shrink-0"}),y.jsx("strong",{children:"Archivo cargado:"})," ",e.name]}),y.jsxs("div",{className:"text-sm text-blue-600 flex items-center",children:[y.jsx(Wh,{className:"w-4 h-4 text-blue-600 mr-2 flex-shrink-0"}),y.jsx("strong",{children:"Total de páginas:"})," ",t]})]}),n&&y.jsxs("button",{onClick:n,className:"ml-4 inline-flex items-center px-3 py-1.5 text-xs font-medium text-blue-600 bg-white border border-blue-200 rounded-md hover:bg-blue-50 hover:border-blue-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",children:[y.jsx(nS,{className:"w-3 h-3 mr-1"}),"Cambiar archivo"]})]})}):y.jsx("div",{className:`${s} mb-6`,children:y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(Yh,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-sm font-medium text-blue-800",children:"¡Listo para comenzar!"}),y.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Arrastra un archivo PDF en el área de arriba para extraer preguntas automáticamente."})]})]})})},e4=({onFileSelect:i,selectedFile:e,totalPages:t,geminiApiKey:n,onResetFile:s})=>{const{isLoadingFile:r,fileError:l,handleFileSelect:c}=ZO({geminiApiKey:n}),f=O.useCallback(async b=>{try{await c(b);const E=await new Sp(n||"temp").getPDFInfo(b);i(b,E.totalPages)}catch(C){console.error("Error getting PDF info:",C)}},[c,n,i]),d=O.useCallback(b=>{const C=b.target.files?.[0];C&&f(C)},[f]),g="inline-flex items-center justify-center px-6 py-3 text-sm font-semibold rounded-md cursor-pointer transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 text-white border shadow-sm",v=r?`${g} bg-gray-400 border-gray-400 cursor-not-allowed`:`${g} bg-blue-600 border-blue-600 hover:bg-blue-700 hover:border-blue-700 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0`;return e?y.jsx(_b,{geminiApiKey:n,selectedFile:e,totalPages:t,onChangeFile:s}):y.jsxs(y.Fragment,{children:[l&&y.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:y.jsxs("div",{className:"text-sm text-red-800 flex items-center",children:[y.jsx(Sc,{className:"w-4 h-4 text-red-600 mr-2 flex-shrink-0"}),y.jsx("strong",{children:"Error:"})," ",l]})}),y.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-blue-400 hover:bg-blue-50 transition-all duration-300 mb-6",children:[y.jsx(Ab,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Arrastra un archivo PDF aquí"}),y.jsx("p",{className:"text-gray-600 mb-6 font-medium",children:"o haz clic para seleccionar un archivo"}),y.jsx("input",{type:"file",accept:".pdf",className:"hidden",id:"pdf-upload-input",disabled:r,onChange:d}),y.jsxs("label",{htmlFor:"pdf-upload-input",className:v,children:[y.jsx(Ab,{className:"w-4 h-4 mr-2"}),r?"Procesando...":"Seleccionar PDF"]})]}),y.jsx(_b,{geminiApiKey:n,selectedFile:null,totalPages:0})]})},t4=({isProcessing:i,isDisabled:e,onClick:t})=>y.jsx("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-300 w-full justify-center text-white border shadow-sm ${e?"bg-gray-400 border-gray-400 text-gray-500 cursor-not-allowed":"bg-blue-600 border-blue-600 hover:bg-blue-700 hover:border-blue-700 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0"}`,children:i?y.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),y.jsx("span",{children:"Procesando..."})]}):"🚀 Iniciar procesamiento"}),n4=({showManualProcessing:i,selectedFile:e,totalPages:t,pageToProcess:n,setPageToProcess:s,isProcessing:r,geminiApiKey:l,onStartProcessing:c})=>!e||!i?null:y.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[y.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[y.jsx(zO,{className:"w-5 h-5 text-gray-600"}),y.jsx("h3",{className:"font-medium text-gray-800",children:"Configuración de procesamiento"})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Página a procesar"}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("input",{type:"number",min:"1",max:t,value:n,onChange:f=>s(parseInt(f.target.value)||1),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),y.jsxs("span",{className:"text-sm text-gray-500",children:["de ",t]})]}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Especifica qué página del PDF quieres procesar"})]}),y.jsx("div",{className:"flex items-end",children:y.jsx(t4,{isProcessing:r,isDisabled:r||!e||!l.trim(),onClick:c})})]})]}),Tb=({isProcessing:i,onClick:e,children:t})=>y.jsx("button",{onClick:e,disabled:i,className:`w-full flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-300 text-white border shadow-sm ${i?"bg-gray-400 border-gray-400 cursor-not-allowed":"bg-emerald-500 border-emerald-500 hover:bg-emerald-600 hover:border-emerald-600 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0"}`,children:i?y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Procesando..."]}):y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("span",{children:"🚀"}),t||"Procesar PDF"]})}),i4=({selectedFile:i,isProcessing:e,processingProgress:t,individualProcessingProgress:n,onIntelligentProcessing:s,showManualProcessing:r,setShowManualProcessing:l})=>i?y.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[y.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[y.jsx(qO,{className:"w-5 h-5 text-green-600"}),y.jsx("h3",{className:"font-medium text-green-800",children:"🚀 Procesar PDF Completo"})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("p",{className:"text-sm text-green-700 text-center",children:"Para optimizar el procesamiento, indica qué tipo de contenido tiene tu PDF:"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[y.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[y.jsx("span",{className:"text-2xl",children:"📝"}),y.jsx("h4",{className:"font-semibold text-gray-800",children:"Solo texto"})]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"PDF con preguntas en texto simple, sin imágenes complejas"}),y.jsx(Tb,{isProcessing:e,onClick:()=>s("text-only"),children:"Solo texto"})]}),y.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[y.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[y.jsx("span",{className:"text-2xl",children:"🖼️"}),y.jsx("h4",{className:"font-semibold text-gray-800",children:"Con imágenes"})]}),y.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"PDF con diagramas, tablas complejas o preguntas con imágenes"}),y.jsx(Tb,{isProcessing:e,onClick:()=>s("with-images"),children:"Con imágenes"})]})]}),y.jsx("div",{className:"text-center",children:y.jsxs("button",{onClick:()=>l(!r),className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-300 text-xs underline bg-gray-100 text-gray-700 border border-gray-300 shadow-sm hover:bg-gray-200 hover:border-gray-400 hover:shadow-md transform hover:-translate-y-0.5",children:[r?"🔽 Ocultar":"⚙️ Mostrar"," configuración manual (página específica)"]})}),e&&t&&y.jsxs("div",{className:"mt-4 p-3 bg-green-100 border border-green-200 rounded-md",children:[y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}),y.jsx("span",{className:"text-sm text-green-700",children:t})]}),n&&n.stage==="processing"&&y.jsxs("div",{className:"mt-3 space-y-2",children:[y.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[y.jsx("span",{children:"Procesando preguntas individualmente"}),y.jsxs("span",{children:[n.currentQuestion,"/",n.totalQuestions]})]}),y.jsx("div",{className:"w-full bg-green-200 rounded-full h-2",children:y.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.round(n.currentQuestion/n.totalQuestions*100)}%`}})}),n.currentQuestionText&&y.jsxs("p",{className:"text-xs text-green-600 truncate",children:["📝 ",n.currentQuestionText]})]})]})]})]}):null,s4=({onImportQuestions:i,appState:e,nextQuestionNumber:t,showAlert:n,showConfirm:s})=>{const[r,l]=O.useState(!1),{geminiApiKey:c,saveGeminiApiKey:f,selectedFile:d,updateSelectedFile:g,totalPages:v,setTotalPages:b,pageToProcess:C,setPageToProcess:E}=e,{isProcessing:A,processingProgress:_,individualProcessingProgress:w,currentGeminiModel:N,fallbackStatus:M,startSinglePageProcessing:k,startIntelligentProcessing:R}=TO({geminiApiKey:c,nextQuestionNumber:t,showAlert:n,showConfirm:s,onImportQuestions:i}),I=O.useCallback(()=>!d||!c?.trim()?(n("Se requiere archivo y API key para el procesamiento",{title:"Configuración incompleta",type:"warning"}),!1):!0,[d,c,n]),P=O.useCallback((ne,ae)=>{d?.name===ne.name&&v===ae||(g(ne,ae),b(ae),E(1))},[g,b,E,d,v]),q=O.useCallback(()=>{g(null),b(0),E(1)},[g,b,E]),F=O.useCallback(async()=>{!I()||!d||await k(d,C)},[I,d,C,k]),$=O.useCallback(async ne=>{!I()||!d||await R(d,v,ne)},[I,d,v,R]),K=!!c?.trim();return y.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[y.jsx(XO,{geminiApiKey:c,saveGeminiApiKey:f,currentGeminiModel:N,fallbackStatus:M}),K&&y.jsx(QO,{}),y.jsx(e4,{selectedFile:d,totalPages:v,onFileSelect:P,geminiApiKey:c,onResetFile:q}),y.jsx(i4,{selectedFile:d,isProcessing:A,processingProgress:_,individualProcessingProgress:w,onIntelligentProcessing:$,showManualProcessing:r,setShowManualProcessing:l}),y.jsx(n4,{showManualProcessing:r,selectedFile:d,totalPages:v,pageToProcess:C,setPageToProcess:E,isProcessing:A,geminiApiKey:c,onStartProcessing:F}),y.jsx(JO,{geminiApiKey:c,selectedFile:d,isProcessing:A})]})},o4=({onImportQuestions:i,appState:e,nextQuestionNumber:t,showAlert:n,showConfirm:s})=>y.jsx("div",{className:"py-16",children:y.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[y.jsx(Oc,{title:"Importar preguntas desde PDF",description:"Sube un archivo PDF para extraer preguntas automáticamente."}),y.jsx(s4,{onImportQuestions:i,appState:e,nextQuestionNumber:t,showAlert:n,showConfirm:s})]})}),r4=({appState:i,showAlert:e})=>{const{geminiApiKey:t,saveGeminiApiKey:n}=i,[s,r]=O.useState("Explain how AI works in a few words"),[l,c]=O.useState(""),[f,d]=O.useState(!1),[g,v]=O.useState(""),[b,C]=O.useState(null),[E,A]=O.useState("gemini-2.5-flash"),[_,w]=O.useState(!1),N=["gemini-2.5-flash","gemini-2.5-pro","gemini-2.5-flash-lite","gemini-1.5-flash","gemini-1.5-pro"],M=["Explain how AI works in a few words",'Extract questions from this text: "1. What is JavaScript? A) A language B) A framework"',"Convert this to JSON: Question: What is React? Options: A) Library B) Language","Hello, are you working?"],k=async()=>{if(!t.trim()){v("Por favor ingresa tu API key para continuar");return}if(!s.trim()){v("Por favor ingresa un prompt para probar");return}d(!0),v(""),c(""),C(null);const I=Date.now();try{const F=await new bp(t).getGenerativeModel({model:E}).generateContent(s),$=Date.now()-I,K=F.response.text();c(K),C({model:E,duration:`${$}ms`,responseLength:K.length,timestamp:new Date().toLocaleTimeString(),success:!0}),e("Respuesta generada exitosamente",{title:"✅ Éxito",type:"success",buttonText:"Perfecto"})}catch(P){const q=Date.now()-I,F=P instanceof Error?P.message:"Error desconocido";v(F),C({model:E,duration:`${q}ms`,error:F,timestamp:new Date().toLocaleTimeString(),success:!1})}finally{d(!1)}},R=()=>{const I=`curl -X POST "https://generativelanguage.googleapis.com/v1beta/models/${E}:generateContent?key=${t}" \\
  -H "Content-Type: application/json" \\
  -d '{
    "contents": [{
      "parts": [{
        "text": "${s.replace(/"/g,'\\"')}"
      }]
    }]
  }'`;navigator.clipboard.writeText(I),e("Comando cURL copiado al portapapeles",{title:"Copiado",type:"success",buttonText:"Perfecto"})};return y.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8 space-y-12",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"api-key-input",className:"block text-sm font-semibold mb-4",style:{color:"var(--secondary-900)"},children:"API Key"}),y.jsx("input",{id:"api-key-input",type:"password",value:t,onChange:I=>n(I.target.value),placeholder:"Ingresa tu API key de Google AI Studio",className:"w-full px-4 py-4 rounded-lg border-2 focus:outline-none focus:border-blue-500 transition-all",style:{backgroundColor:"white",borderColor:t.trim()?"var(--success-400)":"var(--secondary-300)",color:"var(--secondary-900)",fontSize:"14px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)"}}),y.jsx("p",{className:"mt-3 text-xs",style:{color:"var(--secondary-600)"},children:"Obtén tu clave en Google AI Studio"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"model-select",className:"block text-sm font-semibold mb-4",style:{color:"var(--secondary-900)"},children:"Modelo"}),y.jsx("select",{id:"model-select",value:E,onChange:I=>A(I.target.value),className:"w-full p-4 rounded-lg border-2 focus:outline-none focus:border-blue-500 transition-all appearance-none",style:{backgroundColor:"white",borderColor:"var(--secondary-300)",color:"var(--secondary-900)",fontSize:"14px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)",backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.25em 1.25em",paddingRight:"2.5rem"},children:N.map(I=>y.jsx("option",{value:I,children:I},I))}),y.jsx("p",{className:"mt-3 text-xs",style:{color:"var(--secondary-600)"},children:"Selecciona el modelo a usar"})]})]}),y.jsx("div",{className:"space-y-6",children:y.jsxs("div",{children:[y.jsx("label",{htmlFor:"prompt-textarea",className:"block text-sm font-semibold mb-4",style:{color:"var(--secondary-900)"},children:"Prompt de prueba"}),y.jsxs("div",{className:"mb-6",children:[y.jsx("p",{className:"text-sm font-medium mb-4",style:{color:"var(--secondary-900)"},children:"Prueba con estos ejemplos:"}),y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:M.map((I,P)=>y.jsx("button",{onClick:()=>r(I),className:"text-sm px-4 py-3 rounded-lg border-2 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 text-left",style:{backgroundColor:"white",borderColor:"var(--secondary-300)",color:"var(--secondary-900)"},onMouseEnter:q=>{q.currentTarget.style.borderColor="var(--primary-400)",q.currentTarget.style.backgroundColor="var(--primary-50)"},onMouseLeave:q=>{q.currentTarget.style.borderColor="var(--secondary-300)",q.currentTarget.style.backgroundColor="white"},children:I.length>50?`${I.substring(0,50)}...`:I},P))})]}),y.jsx("textarea",{id:"prompt-textarea",value:s,onChange:I=>r(I.target.value),placeholder:"Escribe tu prompt aquí... Por ejemplo: 'Explica cómo funciona la IA'",rows:6,className:"w-full px-4 py-4 rounded-lg border-2 focus:outline-none focus:border-blue-500 transition-all resize-y",style:{backgroundColor:"white",borderColor:s.trim()?"var(--success-400)":"var(--secondary-300)",color:"var(--secondary-900)",fontSize:"14px",lineHeight:"1.6",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)",fontFamily:'ui-monospace, SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace'}}),y.jsx("p",{className:"mt-3 text-xs",style:{color:"var(--secondary-600)"},children:"Escribe una pregunta o instrucción para Gemini"})]})}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[y.jsxs("button",{onClick:k,disabled:f||!t.trim()||!s.trim(),className:"flex items-center justify-center gap-3 px-8 py-4 rounded-lg border-2 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:f?"var(--secondary-100)":"var(--primary-500)",borderColor:f?"var(--secondary-300)":"var(--primary-500)",color:f?"var(--secondary-500)":"white",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)"},children:[y.jsx(Cb,{size:18}),f?"Enviando...":"Enviar a Gemini"]}),y.jsxs("button",{onClick:R,disabled:!t.trim()||!s.trim(),className:"flex items-center justify-center gap-3 px-8 py-4 rounded-lg border-2 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"white",borderColor:"var(--secondary-300)",color:"var(--secondary-700)",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)"},onMouseEnter:I=>{I.currentTarget.disabled||(I.currentTarget.style.backgroundColor="var(--secondary-50)",I.currentTarget.style.borderColor="var(--secondary-400)")},onMouseLeave:I=>{I.currentTarget.disabled||(I.currentTarget.style.backgroundColor="white",I.currentTarget.style.borderColor="var(--secondary-300)")},children:[y.jsx(VO,{size:18}),"Generar cURL"]})]}),b&&y.jsx("div",{className:"p-6 rounded-lg border-l-4",style:{backgroundColor:b.success?"var(--success-50)":"var(--error-50)",borderLeftColor:b.success?"var(--success-400)":"var(--error-400)",borderWidth:"1px",borderLeftWidth:"4px",borderColor:b.success?"var(--success-200)":"var(--error-200)"},children:y.jsxs("div",{className:"space-y-3",children:[y.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2",style:{color:b.success?"var(--success-700)":"var(--error-700)"},children:[y.jsx(Uh,{size:16}),b.success?"Petición exitosa":"Error en la petición"]}),y.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-xs",children:[y.jsxs("div",{children:[y.jsx("span",{style:{color:"var(--secondary-600)"},children:"Modelo:"}),y.jsx("div",{style:{color:"var(--secondary-900)"},className:"font-mono mt-1",children:b.model})]}),y.jsxs("div",{children:[y.jsx("span",{style:{color:"var(--secondary-600)"},children:"Duración:"}),y.jsx("div",{style:{color:"var(--secondary-900)"},className:"font-mono mt-1",children:b.duration})]}),y.jsxs("div",{children:[y.jsx("span",{style:{color:"var(--secondary-600)"},children:"Hora:"}),y.jsx("div",{style:{color:"var(--secondary-900)"},className:"font-mono mt-1",children:b.timestamp})]}),b.responseLength&&y.jsxs("div",{children:[y.jsx("span",{style:{color:"var(--secondary-600)"},children:"Caracteres:"}),y.jsx("div",{style:{color:"var(--secondary-900)"},className:"font-mono mt-1",children:b.responseLength})]})]})]})}),l&&y.jsxs("div",{className:"p-6 rounded-lg border-l-4",style:{backgroundColor:"var(--success-50)",borderLeftColor:"var(--success-400)",borderWidth:"1px",borderLeftWidth:"4px",borderColor:"var(--success-200)"},children:[y.jsxs("h3",{className:"font-semibold text-sm mb-4 flex items-center gap-2",style:{color:"var(--success-700)"},children:[y.jsx(Cb,{size:16}),"Respuesta de Gemini"]}),y.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap font-mono",style:{color:"var(--secondary-900)",lineHeight:"1.7"},children:l})]}),g&&y.jsxs("div",{className:"p-6 rounded-lg border-l-4",style:{backgroundColor:"var(--error-50)",borderLeftColor:"var(--error-400)",borderWidth:"1px",borderLeftWidth:"4px",borderColor:"var(--error-200)"},children:[y.jsxs("h3",{className:"font-semibold text-sm mb-4 flex items-center gap-2",style:{color:"var(--error-700)"},children:[y.jsx(Uh,{size:16}),"Error"]}),y.jsx("div",{className:"text-sm leading-relaxed font-mono break-words overflow-hidden",style:{color:"var(--error-600)",lineHeight:"1.7",wordBreak:"break-all",overflowWrap:"anywhere"},children:g})]}),y.jsx("div",{className:"py-4"}),y.jsxs("div",{className:"border rounded-lg",style:{borderColor:"var(--secondary-300)",backgroundColor:"var(--secondary-50)"},children:[y.jsxs("button",{onClick:()=>w(!_),className:"w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[y.jsx("span",{className:"font-medium text-sm",style:{color:"var(--secondary-900)"},children:"📖 Documentación y Ayuda"}),_?y.jsx(Mp,{size:20,style:{color:"var(--secondary-600)"}}):y.jsx(wp,{size:20,style:{color:"var(--secondary-600)"}})]}),_&&y.jsxs("div",{className:"p-6 border-t space-y-4",style:{borderTopColor:"var(--secondary-300)"},children:[y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-sm mb-2",style:{color:"var(--secondary-900)"},children:"🔑 Cómo obtener tu API Key"}),y.jsxs("p",{className:"text-xs leading-relaxed",style:{color:"var(--secondary-600)"},children:["1. Ve a ",y.jsx("strong",{children:"Google AI Studio"}),y.jsx("br",{}),"2. Inicia sesión con tu cuenta de Google",y.jsx("br",{}),"3. Crea un nuevo proyecto o selecciona uno existente",y.jsx("br",{}),'4. Ve a "API Keys" y genera una nueva clave',y.jsx("br",{}),"5. Copia la clave y pégala en el campo de arriba"]})]}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-sm mb-2",style:{color:"var(--secondary-900)"},children:"🤖 Modelos disponibles"}),y.jsxs("div",{className:"text-xs leading-relaxed space-y-1",style:{color:"var(--secondary-600)"},children:[y.jsxs("div",{children:[y.jsx("strong",{children:"gemini-2.5-flash:"})," Rápido y eficiente"]}),y.jsxs("div",{children:[y.jsx("strong",{children:"gemini-2.5-pro:"})," Máximo rendimiento"]}),y.jsxs("div",{children:[y.jsx("strong",{children:"gemini-1.5-flash:"})," Versión estable rápida"]}),y.jsxs("div",{children:[y.jsx("strong",{children:"gemini-1.5-pro:"})," Versión estable completa"]})]})]}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-sm mb-2",style:{color:"var(--secondary-900)"},children:"💡 Consejos de uso"}),y.jsxs("p",{className:"text-xs leading-relaxed",style:{color:"var(--secondary-600)"},children:["• Usa prompts claros y específicos",y.jsx("br",{}),"• El modelo Flash es más rápido para tareas simples",y.jsx("br",{}),"• El modelo Pro es mejor para tareas complejas",y.jsx("br",{}),"• Puedes generar comandos cURL para testing externo"]})]})]})]})]})},wb=({appState:i,showAlert:e})=>y.jsx("div",{className:"min-h-screen",style:{backgroundColor:"var(--color-background)"},children:y.jsxs("div",{className:"max-w-6xl mx-auto p-8",children:[y.jsxs("div",{className:"rounded-lg mb-8 text-center p-8",style:{backgroundColor:"var(--surface-elevated)",border:"1px solid var(--border-subtle)"},children:[y.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[y.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--color-primary-100)"},children:y.jsx(WO,{className:"w-6 h-6",style:{color:"var(--color-primary-600)"}})}),y.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--color-text-primary)"},children:"Test de API Gemini"})]}),y.jsx("p",{className:"text-lg",style:{color:"var(--color-text-secondary)"},children:"Prueba la conexión y configuración de la API de Google AI Studio"})]}),y.jsx(r4,{appState:i,showAlert:e})]})}),Mb="question-generator-questions",Nb="question-generator-initial-number",Ua=()=>{const[i,e]=O.useState([]),[t,n]=O.useState(!1),[s,r]=O.useState(1);return O.useEffect(()=>{try{const C=localStorage.getItem(Mb);if(C){const A=JSON.parse(C);e(A)}const E=localStorage.getItem(Nb);E&&r(parseInt(E,10))}catch(C){console.error("Error al cargar preguntas del localStorage:",C)}finally{n(!0)}},[]),O.useEffect(()=>{if(t)try{localStorage.setItem(Mb,JSON.stringify(i))}catch(C){console.error("Error al guardar preguntas en localStorage:",C)}},[i,t]),{questions:i,addQuestion:C=>{let E;i.length===0?E=s:E=Math.max(...i.map(_=>_.question_number))+1;const A={...C,question_number:E};e(_=>[..._,A])},addQuestionsWithNumbers:C=>{e(E=>[...E,...C])},removeQuestion:C=>{e(E=>E.filter(A=>A.question_number!==C))},updateQuestion:(C,E)=>{e(A=>A.map(_=>_.question_number===C?{...E,question_number:C}:_))},clearAllQuestions:()=>{e([])},getNextQuestionNumber:()=>i.length===0?s:Math.max(...i.map(C=>C.question_number))+1,setCustomInitialNumber:C=>{r(C),localStorage.setItem(Nb,C.toString())},initialQuestionNumber:s,isLoaded:t}},nh="study-lab-sessions",ih="study-lab-analytics",lc="study-lab-current-session",Kc=()=>{const[i,e]=O.useState([]),[t,n]=O.useState(null),[s,r]=O.useState(null),[l,c]=O.useState(!1),f=()=>`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;O.useEffect(()=>{try{const A=localStorage.getItem(nh);if(A){const M=JSON.parse(A).map(k=>({...k,startTime:new Date(k.startTime),endTime:k.endTime?new Date(k.endTime):void 0}));e(M)}const _=localStorage.getItem(ih);if(_){const N=JSON.parse(_),M={...N,createdAt:new Date(N.createdAt),updatedAt:new Date(N.updatedAt),questionsStats:Object.keys(N.questionsStats).reduce((k,R)=>(k[parseInt(R)]={...N.questionsStats[R],lastStudied:new Date(N.questionsStats[R].lastStudied)},k),{})};n(M)}const w=localStorage.getItem(lc);if(w){const N=JSON.parse(w),M={...N,startTime:new Date(N.startTime),endTime:N.endTime?new Date(N.endTime):void 0};r(M)}}catch(A){console.error("Error al cargar datos de estudio del localStorage:",A)}finally{c(!0)}},[]),O.useEffect(()=>{if(l)try{localStorage.setItem(nh,JSON.stringify(i))}catch(A){console.error("Error al guardar sesiones en localStorage:",A)}},[i,l]),O.useEffect(()=>{if(l&&t)try{localStorage.setItem(ih,JSON.stringify(t))}catch(A){console.error("Error al guardar analytics en localStorage:",A)}},[t,l]),O.useEffect(()=>{if(l)try{s?localStorage.setItem(lc,JSON.stringify(s)):localStorage.removeItem(lc)}catch(A){console.error("Error al guardar sesión actual en localStorage:",A)}},[s,l]);const d=O.useCallback((A,_)=>{let w=[];switch(A.scope){case"all":w=[..._];break;case"range":A.rangeStart&&A.rangeEnd&&(w=_.filter(k=>k.question_number>=A.rangeStart&&k.question_number<=A.rangeEnd));break;case"random":{const k=[..._].sort(()=>Math.random()-.5),R=Math.min(A.randomCount||60,_.length);w=k.slice(0,R);break}}const N=w.map(k=>({questionId:k.question_number,answered:!1,selectedOptions:[],timeSpent:0,markedForReview:!1,skipped:!1})),M={id:f(),startTime:new Date,config:A,questions:N,totalQuestions:w.length,correctAnswers:0,status:"in-progress"};return r(M),M},[]),g=O.useCallback(A=>{if(s){const _={...s,...A};r(_)}},[s]),v=O.useCallback(A=>{const _=new Date,w=_.toISOString().split("T")[0];n(N=>{const M=N||{totalSessions:0,totalTimeStudied:0,averageScore:0,questionsStats:{},dailyProgress:{},weakestQuestions:[],strongestQuestions:[],createdAt:_,updatedAt:_},k=A.endTime?(A.endTime.getTime()-A.startTime.getTime())/(1e3*60):0,R=A.totalQuestions>0?A.correctAnswers/A.totalQuestions*100:0,I={...M.questionsStats};A.questions.forEach(ae=>{I[ae.questionId]||(I[ae.questionId]={questionId:ae.questionId,timesStudied:0,timesCorrect:0,averageTimeSpent:0,lastStudied:_,difficultyScore:0});const ce=I[ae.questionId],me=ce.timesStudied+1,U=ce.timesCorrect+(ae.isCorrect?1:0),X=(ce.averageTimeSpent*ce.timesStudied+ae.timeSpent)/me;I[ae.questionId]={...ce,timesStudied:me,timesCorrect:U,averageTimeSpent:X,lastStudied:_,difficultyScore:1-U/me}});const P=M.totalSessions+1,q=M.totalTimeStudied+k,F=(M.averageScore*M.totalSessions+R)/P,$={...M.dailyProgress};$[w]=($[w]||0)+1;const ne=[...Object.values(I)].sort((ae,ce)=>ce.difficultyScore-ae.difficultyScore);return{...M,totalSessions:P,totalTimeStudied:q,averageScore:F,questionsStats:I,dailyProgress:$,weakestQuestions:ne.slice(0,10).map(ae=>ae.questionId),strongestQuestions:ne.slice(-10).map(ae=>ae.questionId).reverse(),updatedAt:_}})},[]),b=O.useCallback(A=>{const _={...A,endTime:new Date,status:"completed"};return e(w=>[...w,_]),v(_),r(null),_},[v]),C=O.useCallback(()=>{if(s){const A={...s,endTime:new Date,status:"abandoned"};e(_=>[..._,A]),r(null)}},[s]),E=O.useCallback(()=>{e([]),n(null),r(null),localStorage.removeItem(nh),localStorage.removeItem(ih),localStorage.removeItem(lc)},[]);return{sessions:i,analytics:t,currentSession:s,isLoaded:l,createStudySession:d,updateCurrentSession:g,completeSession:b,abandonSession:C,updateAnalytics:v,clearAllStudyData:E,generateSessionId:f}},OC=()=>{const[i,e]=O.useState(!1),[t,n]=O.useState(""),[s,r]=O.useState({}),l=O.useCallback((f,d={})=>{n(f),r(d),e(!0)},[]),c=O.useCallback(()=>{e(!1),n(""),r({})},[]);return{isAlertOpen:i,alertMessage:t,alertOptions:s,showAlert:l,hideAlert:c}},UC=({children:i,className:e="",containerClassName:t="",fullWidth:n=!1})=>y.jsx("div",{className:`surface-base min-h-screen theme-transition ${e}`,children:y.jsx("main",{className:n?"":"content-container",children:y.jsx("div",{className:t,children:i})})}),a4=({title:i,description:e,icon:t,isSelected:n,onClick:s})=>y.jsx("button",{onClick:s,className:`p-6 rounded-xl border-2 transition-all duration-200 text-left hover:shadow-md ${n?"border-blue-500 bg-blue-50 shadow-lg ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"}`,children:y.jsxs("div",{className:"flex items-top gap-3",children:[y.jsx("div",{className:`w-12 h-12 min-w-12 min-h-12 rounded-lg flex items-center justify-center flex-shrink-0 ${n?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:y.jsx("div",{className:"w-6 h-6",children:t})}),y.jsxs("div",{children:[y.jsx("h3",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-semibold)",marginBottom:"var(--space-sm)"},children:i}),y.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"var(--font-size-sm)"},children:e})]})]})}),l4=({mode:i,onModeChange:e})=>{const t=[{id:"flashcards",title:"Flash Cards",description:"Tarjetas interactivas con preguntas y respuestas. Perfecto para memorización y repaso rápido.",icon:y.jsx(nw,{className:"w-6 h-6"})},{id:"exam",title:"Examen",description:"Examen con preguntas de opción múltiple. Incluye puntuación y análisis de resultados.",icon:y.jsx(Kh,{className:"w-6 h-6"})}];return y.jsxs("div",{className:"mb-10 pb-8 border-b",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Tipo de Práctica"}),y.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:t.map(n=>y.jsx(a4,{title:n.title,description:n.description,icon:n.icon,isSelected:i===n.id,onClick:()=>e(n.id)},n.id))})]})},c4=({scope:i,onScopeChange:e,questionsCount:t,rangeStart:n,rangeEnd:s,randomCount:r,rangeError:l,onRangeStartChange:c,onRangeEndChange:f,onRandomCountChange:d})=>{const[g,v]=O.useState(null),[b,C]=O.useState(!1),[E,A]=O.useState(!1),_=()=>{C(!0)},w=I=>{I.currentTarget.contains(I.relatedTarget)||C(!1)},N=()=>{A(!0)},M=I=>{I.currentTarget.contains(I.relatedTarget)||A(!1)},k=g==="rangeStart"||g==="rangeEnd"||b,R=g==="randomCount"||E;return y.jsxs("div",{className:"mb-10 pb-8 border-b",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Preguntas a Estudiar"}),y.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:y.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 max-w-none",children:[y.jsxs("p",{className:"text-blue-800 text-sm flex-1",children:[y.jsx("strong",{children:"Por defecto:"})," Si no seleccionas ninguna opción específica, la práctica iniciará con todas las preguntas disponibles (",t," pregunta",t!==1?"s":"",")."]}),(i==="range"||i==="random")&&y.jsx(pe,{onClick:()=>e(null),variant:"primary",size:"sm",className:"self-start md:ml-4 whitespace-nowrap",children:"Usar todas"})]})}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[y.jsxs("button",{onClick:()=>e("range"),onFocusCapture:_,onBlurCapture:w,className:`p-6 rounded-xl transition-all duration-200 text-left hover:shadow-md flex flex-col min-h-[140px] focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 ${i==="range"?"border-2 border-blue-500 bg-blue-50 shadow-lg ring-2 ring-blue-200":k?"border-2 border-blue-500 bg-blue-50 shadow-lg":"border border-gray-200"}`,children:[y.jsx("div",{className:"flex-1 mb-4",children:y.jsxs("div",{className:"grid grid-cols-[auto_1fr_auto] gap-3",children:[y.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 ${i==="range"||k?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:y.jsx(Yh,{className:"w-6 h-6"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-base font-semibold",children:"Rango específico"}),y.jsx("p",{className:"text-gray-600 text-xs",children:"Ingresa el rango de preguntas a estudiar"})]}),y.jsx("div",{className:"flex items-start",children:y.jsx(bc,{className:"text-blue-500",size:"md",tooltip:"Elige preguntas por número (ej: 1-10)"})})]})}),y.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-3",children:[y.jsx("div",{className:"w-12"}),y.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[y.jsx("input",{type:"number",placeholder:"Desde",value:n,onChange:I=>c(I.target.value),onClick:I=>{e("range"),I.stopPropagation()},onFocus:()=>v("rangeStart"),onBlur:()=>v(null),className:"scope-card-input flex-1 min-w-0 p-2 border border-gray-300 rounded-lg text-sm bg-white focus:border-blue-500 focus:outline-none",min:"1"}),y.jsx("span",{className:"text-gray-500 text-sm flex-shrink-0",children:"a"}),y.jsx("input",{type:"number",placeholder:"Hasta",value:s,onChange:I=>f(I.target.value),onClick:I=>{e("range"),I.stopPropagation()},onFocus:()=>v("rangeEnd"),onBlur:()=>v(null),className:"scope-card-input flex-1 min-w-0 p-2 border border-gray-300 rounded-lg text-sm bg-white focus:border-blue-500 focus:outline-none",min:"1"}),l&&y.jsx("p",{className:"text-red-600 text-xs mt-2",children:l})]})]})]}),y.jsxs("button",{onClick:()=>e("random"),onFocusCapture:N,onBlurCapture:M,className:`p-6 rounded-xl transition-all duration-200 text-left hover:shadow-md flex flex-col min-h-[140px] focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 ${i==="random"?"border-2 border-blue-500 bg-blue-50 shadow-lg ring-2 ring-blue-200":R?"border-2 border-blue-500 bg-blue-50 shadow-lg":"border border-gray-200"}`,children:[y.jsx("div",{className:"flex-1 mb-4",children:y.jsxs("div",{className:"grid grid-cols-[auto_1fr_auto] gap-3",children:[y.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 ${i==="random"||R?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:y.jsx(nS,{className:"w-6 h-6"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-base font-semibold",children:"Preguntas aleatorias"}),y.jsx("p",{className:"text-gray-600 text-xs",children:"Selecciona cuántas preguntas aleatorias quieres estudiar"})]}),y.jsx("div",{className:"flex items-start",children:y.jsx(bc,{className:"text-blue-500",size:"md",tooltip:"Cantidad fija de preguntas aleatorias"})})]})}),y.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-3",children:[y.jsx("div",{className:"w-12"}),y.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[y.jsx("input",{type:"number",placeholder:"Cantidad",value:r,onChange:I=>d(I.target.value),onClick:I=>{e("random"),I.stopPropagation()},onFocus:()=>v("randomCount"),onBlur:()=>v(null),className:"scope-card-input flex-1 min-w-0 p-2 border border-gray-300 rounded-lg text-sm bg-white focus:border-blue-500 focus:outline-none",min:"1",max:t}),y.jsxs("span",{className:"text-gray-500 text-sm flex-shrink-0",children:["(máx. ",t,")"]})]})]})]})]})]})},u4=({showAnswersMode:i,onShowAnswersModeChange:e,timeLimit:t,onTimeLimitChange:n})=>{const s=[{id:"immediate",title:"Inmediatamente",description:"Después de cada pregunta"},{id:"end",title:"Al finalizar",description:"Después de terminar todo el examen"}];return y.jsxs("div",{className:"mb-10 pb-8 border-b",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Configuración del Examen"}),y.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"p-6 border border-gray-200 rounded-xl",children:[y.jsx("div",{className:"mb-3",children:y.jsx("h3",{className:"text-base font-semibold",children:"Mostrar Respuestas"})}),y.jsx("p",{className:"mb-4 text-sm text-gray-500",children:"Elige cuándo quieres ver las respuestas correctas durante el examen"}),y.jsx("div",{className:"space-y-3",children:s.map(r=>y.jsxs("button",{onClick:()=>e(r.id),className:`w-full p-3 rounded-lg border transition-colors text-left ${i===r.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[y.jsx("h4",{className:"font-medium mb-1",children:r.title}),y.jsx("p",{className:"text-sm text-gray-600",children:r.description})]},r.id))})]}),y.jsxs("div",{className:"p-6 border border-gray-200 rounded-xl",children:[y.jsx("div",{className:"mb-3",children:y.jsx("h3",{className:"text-base font-semibold",children:"Límite de Tiempo (opcional)"})}),y.jsxs("p",{className:"mb-4 text-sm text-gray-500",children:["Establece un tiempo límite para completar el examen. ",y.jsx("b",{children:"Deja vacío para tiempo ilimitado"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("input",{type:"number",placeholder:"Ej: 30",value:t,onChange:r=>n(r.target.value),className:"flex-1 p-3 border border-gray-300 rounded-lg",min:"1"}),y.jsx("span",{className:"text-gray-500",children:"minutos"})]}),y.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"Deja vacío para tiempo ilimitado"})]})]})]})},d4=({mode:i,onStartSession:e})=>y.jsx("div",{children:y.jsxs(pe,{onClick:e,variant:"primary",size:"xl",icon:y.jsx(Yh,{}),iconPosition:"left",children:["Iniciar ",i==="flashcards"?"Flash Cards":"Exam"]})}),f4=()=>{const i=js(),{questions:e}=Ua(),{createStudySession:t}=Kc(),{showAlert:n}=OC(),[s,r]=O.useState("flashcards"),[l,c]=O.useState(null),[f,d]=O.useState(""),[g,v]=O.useState(""),[b,C]=O.useState(""),[E,A]=O.useState("end"),[_,w]=O.useState(""),[N,M]=O.useState("");O.useEffect(()=>{if(e.length>0&&b===""){const F=Math.min(60,e.length);C(F.toString())}},[e.length,b]);const k=(F,$)=>{if(!F||!$){M("");return}const K=parseInt(F),ne=parseInt($);if(isNaN(K)||isNaN(ne)){M("Los valores deben ser números válidos");return}if(K<1){M("El número inicial no puede ser menor a 1");return}if(e.length>0){const ae=Math.max(...e.map(ce=>ce.question_number));if(ne>ae){M(`El número final no puede ser mayor a ${ae}`);return}}if(K>ne){M("El número inicial no puede ser mayor que el final");return}M("")},R=F=>{d(F),k(F,g)},I=F=>{v(F),k(f,F)},P=()=>{if(e.length===0)return"No hay preguntas disponibles. Crea algunas preguntas primero.";if(l==="range"){const F=parseInt(f),$=parseInt(g);if(!f||!g||isNaN(F)||isNaN($))return"Por favor ingresa un rango válido de preguntas.";if(F>$)return"El número inicial no puede ser mayor que el final.";const K=Math.max(...e.map(ae=>ae.question_number)),ne=Math.min(...e.map(ae=>ae.question_number));if(F<ne||$>K)return`El rango debe estar entre ${ne} y ${K}.`}if(l==="random"){const F=parseInt(b);if(!b||isNaN(F)||F<=0)return"Por favor ingresa un número válido de preguntas aleatorias.";if(F>e.length)return`No puedes seleccionar más de ${e.length} preguntas.`}return null},q=()=>{const F=P();if(F){n(F,{type:"error"});return}const $={mode:s,scope:l||"all",rangeStart:l==="range"?parseInt(f):void 0,rangeEnd:l==="range"?parseInt(g):void 0,randomCount:l==="random"?parseInt(b):void 0,showAnswersMode:s==="exam"?E:"end",timeLimit:s==="exam"&&_?parseInt(_):void 0};t($,e),i(s==="flashcards"?"/study-lab/study/flashcards":"/study-lab/study/exam")};return y.jsx(UC,{children:y.jsx("div",{className:"py-16",children:y.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[y.jsx(Oc,{title:"Centro de Estudio",description:"Centro de control para tus sesiones de estudio. Crea preguntas, importa contenido o configura tu práctica personalizada."}),e.length===0?y.jsx(yS,{onCreate:()=>i("/study-lab/create"),onImport:()=>i("/study-lab/import")}):y.jsxs(y.Fragment,{children:[y.jsx(l4,{mode:s,onModeChange:r}),y.jsx(c4,{scope:l||"all",onScopeChange:c,questionsCount:e.length,rangeStart:f,rangeEnd:g,randomCount:b,rangeError:N,onRangeStartChange:R,onRangeEndChange:I,onRandomCountChange:C}),s==="exam"&&y.jsx(u4,{showAnswersMode:E,onShowAnswersModeChange:A,timeLimit:_,onTimeLimitChange:w}),y.jsx(d4,{mode:s,onStartSession:q})]})]})})})},BC=(i,e)=>{const[t,n]=O.useState(0),[s,r]=O.useState(null),l=O.useRef(null);O.useEffect(()=>{i?i.id!==l.current&&(n(0),r(new Date),l.current=i.id):(n(0),r(null),l.current=null)},[i]);const c=O.useCallback(()=>{if(!i||!e.length)return null;const I=i.questions[t];return I&&e.find(P=>P.question_number===I.questionId)||null},[i,e,t]),f=O.useCallback(()=>i&&i.questions[t]||null,[i,t]),d=O.useCallback(()=>i&&t<i.questions.length-1?(n(I=>I+1),!0):!1,[i,t]),g=O.useCallback(()=>t>0?(n(I=>I-1),!0):!1,[t]),v=O.useCallback(I=>i&&I>=0&&I<i.questions.length?(n(I),!0):!1,[i]),b=O.useCallback((I,P)=>{const q=P.options.filter($=>$.is_correct).map($=>$.option_letter).sort(),F=[...I].sort();return q.length===F.length&&q.every(($,K)=>$===F[K])},[]),C=O.useCallback((I,P,q)=>{const F=b(P,q),K=s?(new Date().getTime()-s.getTime())/1e3:0;return{...I,answered:!0,selectedOptions:P,isCorrect:F,timeSpent:K}},[b,s]),E=O.useCallback(I=>{const P=I??t;return!(!i||P<0||P>=i.questions.length)},[i,t]),A=O.useCallback(I=>{const P=I??t;return!(!i||P<0||P>=i.questions.length)},[i,t]),_=O.useCallback(()=>i?{current:t+1,total:i.questions.length,percentage:(t+1)/i.questions.length*100}:{current:0,total:0,percentage:0},[i,t]),w=O.useCallback(()=>i?i.questions.reduce((P,q)=>({answered:P.answered+(q.answered?1:0),correct:P.correct+(q.isCorrect?1:0),skipped:P.skipped+(q.skipped?1:0),markedForReview:P.markedForReview+(q.markedForReview?1:0),total:P.total+1}),{answered:0,correct:0,skipped:0,markedForReview:0,total:0}):{answered:0,correct:0,skipped:0,markedForReview:0,total:0},[i]),N=O.useCallback(()=>i?i.config.mode==="flashcards"?t>=i.questions.length-1:i.questions.every(I=>I.answered||I.skipped):!1,[i,t]),M=O.useCallback(()=>i?t<i.questions.length-1:!1,[i,t]),k=O.useCallback(()=>t>0,[t]),R=O.useCallback(()=>i?i.questions.map((I,P)=>({...I,index:P})).filter(I=>!I.answered&&!I.skipped):[],[i]);return{currentQuestionIndex:t,startTime:s,goToNext:d,goToPrevious:g,goToQuestion:v,canGoNext:M,canGoPrevious:k,getCurrentQuestion:c,getCurrentSessionQuestion:f,updateQuestionAnswer:C,toggleMarkForReview:E,skipQuestion:A,checkAnswer:b,getProgress:_,getSessionStats:w,isSessionComplete:N,getPendingQuestions:R}},VC=({explanation:i,link:e,className:t=""})=>!i&&!e?null:y.jsxs("div",{className:`mb-6 ${t}`,children:[i&&y.jsxs(y.Fragment,{children:[y.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Explicación:"}),y.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:y.jsx("p",{className:"text-gray-900 leading-relaxed",children:i})})]}),e&&y.jsx("div",{className:"border-t pt-4 mt-4",children:y.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[y.jsx(ah,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),y.jsx("span",{className:"text-gray-500 font-medium",children:"Fuente:"}),y.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors truncate flex-1 hover:underline",children:e})]})})]}),GC=({label:i,helper:e})=>y.jsxs("div",{className:"flex items-center justify-between mb-4",children:[y.jsx("span",{className:"text-sm font-medium text-blue-600 bg-blue-100 px-3 py-1 rounded-full",children:i}),y.jsx("span",{className:"text-xs text-gray-500",children:e})]}),qC=({helper:i})=>y.jsx("div",{className:"text-center",children:y.jsxs("div",{className:"inline-flex items-center text-sm text-gray-500",children:[y.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),i]})}),h4=({question:i})=>y.jsxs("div",{className:"p-6 h-full flex flex-col",children:[y.jsx(GC,{label:`Pregunta #${i.question_number}`,helper:"Click para ver respuesta"}),y.jsx("div",{className:"flex-1 flex items-center justify-center",children:y.jsx("p",{className:"text-xl text-gray-800 text-center leading-relaxed",children:i.question_text})}),y.jsx(qC,{helper:"Toca para voltear"})]}),p4=({correctOptions:i,multi:e})=>y.jsxs("div",{className:"p-6 h-full flex flex-col",children:[y.jsx(GC,{label:e?"Respuestas Correctas":"Respuesta Correcta",helper:"Click para volver"}),y.jsxs("div",{className:"flex-1 flex flex-col justify-center space-y-4",children:[e&&y.jsx("div",{className:"text-center mb-2",children:y.jsxs("span",{className:"text-sm font-medium","data-testid":"flashcard-answer",children:[i.length," respuestas correctas"]})}),i.map((t,n)=>y.jsxs("span",{className:"block text-xl font-medium text-gray-800 text-center","data-testid":"flashcard-answer",children:[e&&y.jsx("span",{className:"font-bold text-lg mr-3 bg-white rounded-full w-8 h-8 inline-flex items-center justify-center border border-gray-300",children:n+1}),t.option_text]},n))]}),y.jsx(qC,{helper:"Toca para volver"})]}),m4=({question:i,onNext:e,onPrevious:t,canGoNext:n,canGoPrevious:s})=>{const[r,l]=O.useState(!1),c=()=>{l(!r)},f=()=>{l(!1),e()},d=()=>{l(!1),t()},g=i.options.filter(v=>v.is_correct);return y.jsxs("div",{className:"w-full max-w-none mx-auto",children:[y.jsx("div",{className:"relative h-96 mb-6 w-full flex justify-center",children:y.jsxs("div",{className:`w-full max-w-2xl h-full transition-transform duration-500 transform-style-preserve-3d cursor-pointer ${r?"rotate-y-180":""}`,onClick:c,children:[y.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden bg-white rounded-lg shadow-lg border-2 border-gray-200 hover:border-blue-300 transition-colors",children:y.jsx(h4,{question:i})}),y.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180 bg-white rounded-lg shadow-lg border-2 border-gray-200 hover:border-blue-300 transition-colors",children:y.jsx(p4,{correctOptions:g,multi:g.length>1})})]})}),y.jsxs("div",{className:"flex justify-between items-center w-full mb-6",children:[y.jsx(pe,{onClick:d,disabled:!s,variant:"secondary",buttonType:"outline",size:"md",icon:y.jsx($h,{}),iconPosition:"left",children:"Anterior"}),y.jsx("div",{className:"flex space-x-2",children:y.jsx(pe,{onClick:c,variant:"info",buttonType:"outline",size:"md",icon:y.jsx(Zb,{}),iconPosition:"left",children:r?"Ver Pregunta":"Ver Respuesta"})}),y.jsx(pe,{onClick:f,disabled:!n,variant:"secondary",buttonType:"outline",size:"md",icon:y.jsx(Qb,{}),iconPosition:"right",children:"Siguiente"})]}),y.jsx("div",{className:"w-full space-y-4 border-t pt-6",children:y.jsx(VC,{explanation:i.explanation,link:i.link})})]})},g4=()=>y.jsx("div",{className:"container py-8",children:y.jsx("div",{className:"text-center",children:y.jsxs("div",{className:"inline-flex items-center justify-center space-x-2",children:[y.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),y.jsx("p",{className:"text-gray-600",children:"Cargando sesión de estudio..."})]})})}),y4=({current:i,total:e,className:t=""})=>{const n=e>0?Math.round((i+1)/e*100):0;return y.jsxs("div",{className:`w-full ${t}`,children:[y.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[y.jsxs("span",{children:["Pregunta ",i+1," de ",e]}),y.jsxs("span",{children:[n,"%"]})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:y.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]})},Rb=i=>{if(typeof i!="number"||isNaN(i)||i<0)return"";const e=Math.floor(i/60),t=i%60;return`${e}:${t.toString().padStart(2,"0")}`},HC=({icon:i,title:e,subtitle:t,progressCurrent:n,progressTotal:s,timeLeft:r,onExit:l,showProgressBar:c=!1,showTimer:f=!1})=>y.jsxs("div",{className:"w-full mb-8",children:[y.jsx("div",{className:"bg-white border-b top-0 z-10",children:y.jsx("div",{className:"max-w-4xl mx-auto py-4",children:y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("div",{className:"flex items-start w-full",children:[y.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-blue-100 text-blue-600 mr-3 mt-1",children:i}),y.jsxs("div",{className:"flex flex-col w-full",children:[y.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:e}),t&&y.jsx("p",{className:"text-sm text-gray-600",children:t})]})]}),y.jsxs("div",{className:"flex items-center gap-4 ml-4",children:[f&&typeof r=="number"&&!isNaN(r)&&r>=0&&Rb(r)!==""&&y.jsxs("div",{className:`text-base font-mono ${r<300?"text-red-600":"text-gray-700"}`,children:["⏰ ",Rb(r)]}),y.jsx(pe,{onClick:l,variant:"danger",buttonType:"outline",size:"sm","aria-label":"Exit activity",children:"Salir"})]})]})})}),c&&typeof n=="number"&&typeof s=="number"&&y.jsx("div",{className:"w-full bg-white",children:y.jsx("div",{className:"max-w-4xl mx-auto pt-2 pb-0",children:y.jsx(y4,{current:n,total:s})})})]});function jC(i){switch(i.scope){case"all":return"Todas las preguntas";case"range":return`Preguntas ${i.rangeStart} - ${i.rangeEnd}`;case"random":return`${i.randomCount} preguntas aleatorias`;default:return""}}const v4=({showConfirm:i})=>{const e=js(),{questions:t}=Ua(),{currentSession:n,completeSession:s,abandonSession:r,isLoaded:l,createStudySession:c}=Kc(),[f,d]=O.useState(!1),{currentQuestionIndex:g,goToNext:v,goToPrevious:b,canGoNext:C,canGoPrevious:E,getCurrentQuestion:A}=BC(n,t);O.useEffect(()=>{if(l&&!f){d(!0);const k=localStorage.getItem("repeat-session-config");if(k&&!n)try{const R=JSON.parse(k);c(R,t),localStorage.removeItem("repeat-session-config")}catch{localStorage.removeItem("repeat-session-config"),e("/study-lab/study")}else setTimeout(()=>{(!n||n.config.mode!=="flashcards")&&e("/study-lab/study")},100)}},[n,e,l,f,c,t]);const _=()=>{C()?v():w()},w=async()=>{if(n)try{await i("¿Has terminado de revisar las flash cards?",()=>{const k={...n,questions:n.questions.map(R=>({...R,answered:!0,timeSpent:0})),correctAnswers:n.questions.length};s(k),e("/study-lab/study/session-results")})}catch{}},N=async()=>{try{await i("¿Estás seguro de que quieres salir?",()=>{r(),e("/study-lab/study")})}catch{}},M=A();return!n||!M?y.jsx(g4,{}):y.jsx("div",{className:"min-h-screen",children:y.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[y.jsx(HC,{icon:y.jsx(tS,{className:"w-5 h-5"}),title:"Modo Flashcards",subtitle:jC(n.config),progressCurrent:g,progressTotal:n.questions.length,onExit:N,showProgressBar:!0}),y.jsx(m4,{question:M,onNext:_,onPrevious:b,canGoNext:C()||g===n.questions.length-1,canGoPrevious:E()})]})})},x4=({questionText:i,options:e,selectedAnswers:t,requiresMultipleAnswers:n,showAnswers:s,onSelect:r})=>y.jsxs("div",{className:"mb-6 h-auto md:h-[400px] overflow-y-auto",children:[y.jsx("div",{className:"mb-4",children:y.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:i})}),y.jsx("div",{className:"space-y-3",children:e.map(l=>{const c=t.includes(l.option_letter),f=l.is_correct,d=s&&f,g=s&&c&&!f;return y.jsx("div",{className:`p-2 cursor-pointer transition-all ${d?"bg-green-50":g?"bg-red-50":c?"bg-blue-50":""} ${s?"cursor-default":""}`,onClick:()=>r(l.option_letter),children:y.jsxs("div",{className:"flex items-center",children:[y.jsx("div",{className:`w-6 h-6 flex items-center justify-center mr-3 rounded-full border-2 transition-colors
                ${d?"border-green-500 bg-green-50 text-green-600":g?"border-red-500 bg-red-50 text-red-600":c?"border-blue-500 bg-blue-50 text-blue-600":"border-gray-300 bg-white text-gray-400"}
              `,children:n?c||d?y.jsx("span",{className:"text-lg",children:"✓"}):g?y.jsx("span",{className:"text-lg",children:"✗"}):null:c||d?y.jsx("span",{className:"w-3 h-3 bg-current rounded-full block"}):g?y.jsx("span",{className:"text-lg",children:"✗"}):null}),y.jsxs("span",{className:"font-medium mr-2",children:[l.option_letter,")"]}),y.jsx("span",{className:"flex-1",children:l.option_text}),s&&f&&y.jsx("span",{className:"text-green-600 ml-2",children:"✓ Correcta"}),s&&c&&!f&&y.jsx("span",{className:"text-red-600 ml-2",children:"✗ Incorrecta"})]})},l.option_letter)})})]}),b4=({onPrevious:i,onNext:e,onSkip:t,onMarkForReview:n,canGoPrevious:s,canGoNext:r,isAnswered:l,selectedAnswers:c,markedForReview:f,showExplanation:d,onToggleExplanation:g,hasExplanation:v})=>y.jsxs("div",{className:"p-0",children:[y.jsx("div",{className:"mb-4 pb-4 border-b",children:y.jsxs("div",{className:"flex space-x-3",children:[y.jsx(pe,{onClick:n,variant:f?"warning":"secondary",buttonType:f?"solid":"outline",size:"sm",icon:y.jsx(ew,{}),iconPosition:"left",children:f?"Marcada para revisión":"Marcar para revisión"}),v&&y.jsx(pe,{onClick:g,variant:d?"info":"secondary",buttonType:"outline",size:"sm",icon:y.jsx(eS,{}),iconPosition:"left",children:d?"Ocultar explicación":"Ver explicación"})]})}),y.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[y.jsx(pe,{onClick:i,disabled:!s,variant:"secondary",buttonType:"outline",size:"md",icon:y.jsx($h,{}),iconPosition:"left",children:"Anterior"}),y.jsxs("div",{className:"flex space-x-3",children:[y.jsx(pe,{onClick:t,variant:"secondary",buttonType:"outline",size:"md",children:"Saltar"}),y.jsx(pe,{onClick:e,disabled:c.length===0&&!l,variant:"primary",size:"md",icon:y.jsx(Qb,{}),iconPosition:"right",children:r?"Siguiente":"Finalizar Test"})]})]})]}),Ib=()=>{const i=js(),{questions:e}=Ua(),{currentSession:t,completeSession:n,updateCurrentSession:s,isLoaded:r,createStudySession:l}=Kc(),[c,f]=O.useState([]),[d,g]=O.useState(null),[v,b]=O.useState(new Date),[C,E]=O.useState(!1),[A,_]=O.useState(!1),[w,N]=O.useState(!1),{currentQuestionIndex:M,goToNext:k,goToPrevious:R,canGoNext:I,canGoPrevious:P,getCurrentQuestion:q,updateQuestionAnswer:F}=BC(t,e);O.useEffect(()=>{if(r&&!w){N(!0);const V=localStorage.getItem("repeat-session-config");if(V&&!t)try{const W=JSON.parse(V);l(W,e),localStorage.removeItem("repeat-session-config")}catch{localStorage.removeItem("repeat-session-config"),i("/study-lab/study")}else setTimeout(()=>{let W=t;if(!W){const z=localStorage.getItem("study-lab-current-session");if(z)try{const le=JSON.parse(z);W={...le,startTime:new Date(le.startTime),endTime:le.endTime?new Date(le.endTime):void 0}}catch{W=null}}!W||W.config.mode!=="exam"?i("/study-lab/study"):W.config.timeLimit&&g(W.config.timeLimit*60)},250)}},[t,i,r,w,l,e]),O.useEffect(()=>{if(d===null||d<=0)return;const V=setInterval(()=>{g(W=>W&&W<=1?(t&&(n(t),i("/study-lab/study/session-results")),0):W?W-1:null)},1e3);return()=>clearInterval(V)},[d,t,n,i]),O.useEffect(()=>{if(t&&M!==void 0){const V=t.questions[M];if(V){f(V.selectedOptions);const W=t.config.showAnswersMode==="immediate";E(V.answered&&W),_(V.answered&&W)}}},[M,t]);const $=q();if(!t||!$)return y.jsx("div",{className:"container py-8",children:y.jsx("div",{className:"text-center",children:y.jsx("p",{className:"text-gray-600",children:"Cargando test..."})})});const K=V=>{if(C)return;let W;$.requires_multiple_answers?W=c.includes(V)?c.filter(z=>z!==V):[...c,V]:W=[V],f(W),t&&t.config.showAnswersMode==="immediate"&&!t.questions[M]?.answered&&ne(W)},ne=V=>{if(V.length===0||!t)return;const W=t.questions[M],z=F(W,V,$),le=[...t.questions];le[M]=z;const xe=le.filter(he=>he.isCorrect).length;s({questions:le,correctAnswers:xe}),E(!0),_(!0)},ae=V=>{if(V.length===0||!t)return;const W=t.questions[M],z=F(W,V,$),le=[...t.questions];le[M]=z;const xe=le.filter(he=>he.isCorrect).length;s({questions:le,correctAnswers:xe}),t.config.showAnswersMode==="immediate"&&E(!0)},ce=()=>{c.length>0&&!t?.questions[M]?.answered&&t?.config.showAnswersMode!=="immediate"&&ae(c),I()?(f([]),E(!1),_(!1),b(new Date),k()):t&&(n(t),i("/study-lab/study/session-results"))},me=()=>{P()&&(E(!1),_(!1),R())},U=()=>{if(!t)return;const V=t.questions[M],W={...V,answered:!1,selectedOptions:[],timeSpent:Math.floor((new Date().getTime()-v.getTime())/1e3),markedForReview:V.markedForReview||!1,skipped:!0},z=[...t.questions];z[M]=W,s({questions:z}),I()?(f([]),E(!1),_(!1),b(new Date),k()):(n(t),i("/study-lab/study/session-results"))},X=()=>{const V=t.questions[M],W={...V,markedForReview:!V.markedForReview},z=[...t.questions];z[M]=W,s({questions:z})},de=()=>{t?(n(t),i("/study-lab/study/session-results")):i("/study-lab/study")},te=t.questions[M],L=te?.answered||!1;return y.jsx("div",{className:"container py-8",children:y.jsxs("div",{className:"max-w-4xl mx-auto",children:[y.jsx(HC,{icon:y.jsx(Kh,{className:"w-5 h-5"}),title:"Modo Examen",subtitle:jC(t.config),progressCurrent:M,progressTotal:t.totalQuestions,timeLeft:d??void 0,onExit:de,showProgressBar:!0,showTimer:!0}),y.jsx(x4,{questionText:$.question_text,options:$.options,selectedAnswers:c,requiresMultipleAnswers:$.requires_multiple_answers,showAnswers:C,onSelect:K}),y.jsx(b4,{onPrevious:me,onNext:ce,onSkip:U,onMarkForReview:X,canGoPrevious:P(),canGoNext:I(),isAnswered:L,selectedAnswers:c,markedForReview:te?.markedForReview,showExplanation:A,onToggleExplanation:()=>_(V=>!V),hasExplanation:!!$.explanation}),A&&($.explanation||$.link)&&y.jsx("div",{className:"mt-6",children:y.jsx(VC,{explanation:$.explanation,link:$.link})})]})})},Db=()=>{const i=js(),{sessions:e}=Kc(),{questions:t}=Ua(),[n,s]=O.useState(null),r=e.filter(N=>N.status==="completed").sort((N,M)=>new Date(M.endTime||0).getTime()-new Date(N.endTime||0).getTime())[0];if(!r)return y.jsx("div",{className:"surface-base min-h-screen theme-transition",children:y.jsx("div",{className:"content-container py-16",children:y.jsxs("div",{className:"surface-elevated card-spacing text-center max-w-2xl mx-auto",children:[y.jsxs("div",{className:"mb-6",children:[y.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center",children:y.jsx("svg",{className:"w-10 h-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),y.jsx("h1",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"var(--font-weight-bold)",marginBottom:"var(--space-lg)"},children:"No hay resultados disponibles"}),y.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"var(--space-xl)"},children:"No se encontraron sesiones de estudio completadas."})]}),y.jsxs("button",{onClick:()=>i("/study-lab/study"),className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-medium rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Iniciar Nueva Sesión"]})]})})});const l=r.endTime&&r.startTime?Math.round((new Date(r.endTime).getTime()-new Date(r.startTime).getTime())/(1e3*60)):0,c=r.totalQuestions>0?Math.round(r.correctAnswers/r.totalQuestions*100):0,f=r.questions.filter(N=>N.answered&&!N.isCorrect).map(N=>N.questionId),d=N=>t.find(M=>M.question_number===N),g=N=>r.questions.find(M=>M.questionId===N),v=N=>{s(N)},b=()=>{s(null)},C=()=>{if(!r)return;const N=r.config;localStorage.setItem("repeat-session-config",JSON.stringify(N)),N.mode==="flashcards"?i("/study-lab/study/flashcards"):i("/study-lab/study/exam")},E=()=>{f.length!==0&&(localStorage.setItem("failed-questions-practice",JSON.stringify(f)),i("/study-lab/study"))},_=(N=>N>=80?{gradient:"from-green-500 to-emerald-600",bg:"bg-green-50",text:"text-green-700",icon:"🎉",title:"¡Excelente dominio!",message:"Tienes un gran conocimiento del material. ¡Sigue así!"}:N>=60?{gradient:"from-blue-500 to-blue-600",bg:"bg-blue-50",text:"text-blue-700",icon:"💪",title:"¡Muy buen progreso!",message:"Vas por excelente camino. Con un poco más de práctica serás un experto."}:N>=40?{gradient:"from-yellow-500 to-orange-500",bg:"bg-yellow-50",text:"text-orange-700",icon:"📚",title:"En buen camino",message:"Tienes una buena base. Repasa las preguntas falladas para mejorar aún más."}:{gradient:"from-red-500 to-red-600",bg:"bg-red-50",text:"text-red-700",icon:"🚀",title:"¡Sigue adelante!",message:"Cada intento te acerca más al éxito. Dedica más tiempo al estudio y verás resultados."})(c),w=()=>{if(n===null)return null;const N=d(n),M=g(n);return!N||!M?null:y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:y.jsx("div",{className:"surface-elevated max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:y.jsxs("div",{className:"card-spacing",children:[y.jsxs("div",{className:"flex justify-between items-center element-spacing pb-4 border-b",style:{borderColor:"var(--border-light)"},children:[y.jsxs("h3",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-semibold)"},children:["Pregunta ",N.question_number]}),y.jsx("button",{onClick:b,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",style:{color:"var(--text-tertiary)"},children:"×"})]}),y.jsxs("div",{className:"element-spacing",children:[y.jsx("div",{className:"surface-elevated card-spacing mb-6",children:y.jsx("p",{style:{fontSize:"var(--font-size-lg)",lineHeight:"var(--line-height-relaxed)"},children:N.question_text})}),y.jsx("div",{className:"space-y-3 mb-6",children:N.options.map(k=>{const R=M.selectedOptions.includes(k.option_letter),I=k.is_correct;let P="surface-elevated p-4 transition-all duration-200",q=null;return I?(P+=" status-success",q=y.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:R?"Tu respuesta - Correcta":"Respuesta correcta"})):R&&(P+=" status-error",q=y.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Tu respuesta - Incorrecta"})),y.jsx("div",{className:P,children:y.jsxs("div",{className:"flex items-start justify-between gap-4",children:[y.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[y.jsxs("span",{className:"font-bold text-lg min-w-[1.5rem]",children:[k.option_letter,"."]}),y.jsx("span",{className:"text-base leading-relaxed",children:k.option_text})]}),q&&y.jsx("div",{className:"flex-shrink-0",children:q})]})},k.option_letter)})}),N.explanation&&y.jsxs("div",{className:"status-info surface-elevated card-spacing border-l-4 border-blue-400 mb-6",children:[y.jsx("h4",{className:"font-semibold mb-3 text-lg",children:"Explicación"}),y.jsx("p",{className:"leading-relaxed",children:N.explanation})]}),M.skipped&&y.jsx("div",{className:"status-warning surface-elevated p-4 border-l-4 border-yellow-400",children:y.jsx("p",{className:"font-medium",children:"Esta pregunta fue saltada durante el test"})})]}),y.jsx("div",{className:"flex justify-center pt-4 border-t",style:{borderColor:"var(--border-light)"},children:y.jsx("button",{onClick:b,className:"px-6 py-2.5 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors",children:"Cerrar"})})]})})})};return y.jsxs("div",{className:"surface-base min-h-screen theme-transition",children:[y.jsx("div",{className:"content-container py-16",children:y.jsx("div",{className:"surface-elevated max-w-5xl mx-auto",children:y.jsxs("div",{className:"card-spacing",children:[y.jsxs("div",{className:"text-center section-spacing",children:[y.jsxs("div",{className:"mb-6",children:[y.jsx("div",{className:"mb-4",children:y.jsx("h1",{style:{fontSize:"var(--font-size-4xl)",fontWeight:"var(--font-weight-bold)"},children:"Sesión Completada"})}),y.jsx("p",{style:{fontSize:"var(--font-size-xl)",color:"var(--text-secondary)"},children:r.config.mode==="flashcards"?"Modo Flash Cards":"Modo Examen"})]}),y.jsxs("div",{className:"mb-12",children:[y.jsx("div",{className:`inline-flex items-center justify-center w-32 h-32 rounded-full bg-gradient-to-br ${_.gradient} text-white shadow-xl mb-4`,children:y.jsxs("span",{style:{fontSize:"var(--font-size-4xl)",fontWeight:"var(--font-weight-bold)"},children:[c,"%"]})}),y.jsx("div",{className:`inline-block px-6 py-3 rounded-xl ${_.bg}`,children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-2xl",children:_.icon}),y.jsxs("div",{children:[y.jsx("p",{className:`font-semibold text-lg ${_.text}`,children:_.title}),y.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"var(--font-size-sm)"},children:_.message})]})]})})]})]}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 section-spacing",children:[y.jsxs("div",{className:"text-center p-4 rounded-xl bg-gray-50 border border-gray-100",children:[y.jsx("div",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"var(--font-weight-bold)",color:"var(--text-primary)"},children:r.totalQuestions}),y.jsx("div",{style:{fontSize:"var(--font-size-sm)",color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Total de Preguntas"})]}),y.jsxs("div",{className:"text-center p-4 rounded-xl bg-green-50 border border-green-100",children:[y.jsx("div",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"var(--font-weight-bold)"},className:"text-green-600",children:r.correctAnswers}),y.jsx("div",{style:{fontSize:"var(--font-size-sm)",color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Respuestas Correctas"})]}),y.jsxs("div",{className:"text-center p-4 rounded-xl bg-red-50 border border-red-100",children:[y.jsx("div",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"var(--font-weight-bold)"},className:"text-red-600",children:r.totalQuestions-r.correctAnswers}),y.jsx("div",{style:{fontSize:"var(--font-size-sm)",color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Respuestas Incorrectas"})]}),y.jsxs("div",{className:"text-center p-4 rounded-xl bg-yellow-50 border border-yellow-100",children:[y.jsx("div",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"var(--font-weight-bold)"},className:"text-yellow-600",children:r.questions.filter(N=>N.skipped).length}),y.jsx("div",{style:{fontSize:"var(--font-size-sm)",color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Preguntas Saltadas"})]})]}),y.jsxs("div",{className:"section-spacing",children:[y.jsx("h2",{className:"border-b pb-3",style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-semibold)",marginBottom:"var(--space-lg)",borderColor:"var(--border-light)"},children:"Detalles de la Sesión"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex justify-between items-center py-3 border-b",style:{borderColor:"var(--border-light)"},children:[y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Duración total:"}),y.jsxs("span",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)"},children:[l," minutos"]})]}),y.jsxs("div",{className:"flex justify-between items-center py-3",children:[y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Porcentaje de aciertos:"}),y.jsxs("span",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)"},children:[c,"%"]})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex justify-between items-center py-3 border-b",style:{borderColor:"var(--border-light)"},children:[y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Fecha de realización:"}),y.jsx("span",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)"},children:new Date(r.startTime).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]}),y.jsxs("div",{className:"flex justify-between items-center py-3",children:[y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Hora de finalización:"}),y.jsx("span",{style:{fontSize:"var(--font-size-sm)",fontWeight:"var(--font-weight-medium)"},children:new Date(r.startTime).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]})]})]}),y.jsxs("div",{className:"section-spacing",children:[y.jsx("h2",{className:"border-b pb-3",style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-semibold)",marginBottom:"var(--space-lg)",borderColor:"var(--border-light)"},children:"Mapa de Respuestas"}),y.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 md:grid-cols-12 lg:grid-cols-15 xl:grid-cols-20 gap-2 mb-6",children:r.questions.map(N=>{const M=d(N.questionId);if(!M)return null;let k="bg-gray-100 hover:bg-gray-200 border-gray-300 text-gray-700";return N.skipped?k="bg-yellow-100 hover:bg-yellow-200 border-yellow-300 text-yellow-800":N.answered&&N.isCorrect?k="bg-green-100 hover:bg-green-200 border-green-300 text-green-800":N.answered&&!N.isCorrect&&(k="bg-red-100 hover:bg-red-200 border-red-300 text-red-800"),y.jsx("button",{onClick:()=>v(N.questionId),className:`${k} p-2 rounded-lg border font-medium transition-all duration-200 cursor-pointer min-h-[2.5rem] flex items-center justify-center hover:shadow-sm text-sm`,title:`Pregunta ${M.question_number} - ${N.skipped?"Saltada":N.isCorrect?"Correcta":"Incorrecta"}`,children:M.question_number},N.questionId)})}),y.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-sm",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-4 h-4 bg-green-100 border border-green-300 rounded"}),y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Correcta"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-4 h-4 bg-red-100 border border-red-300 rounded"}),y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Incorrecta"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded"}),y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"Saltada"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"w-4 h-4 bg-gray-100 border border-gray-300 rounded"}),y.jsx("span",{style:{color:"var(--text-secondary)",fontWeight:"var(--font-weight-medium)"},children:"No respondida"})]})]})]}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center pt-6 border-t",style:{borderColor:"var(--border-light)"},children:[y.jsxs("button",{onClick:()=>i("/study-lab/study"),className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-medium rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C20.168 18.477 18.582 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Ir a Estudiar"]}),y.jsxs("button",{onClick:C,className:"inline-flex items-center gap-2 px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-xl transition-all duration-200",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Repetir Test"]}),f.length>0&&y.jsxs("button",{onClick:E,className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-medium rounded-xl hover:from-orange-600 hover:to-orange-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Practicar Falladas (",f.length,")"]})]})]})})}),w()]})},S4=()=>{const i=()=>y.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e=()=>y.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t=()=>y.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})});return y.jsxs("div",{className:"p-8 max-w-6xl mx-auto space-y-8",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Button Component Examples"}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Variantes"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{variant:"primary",children:"Primary"}),y.jsx(pe,{variant:"secondary",children:"Secondary"}),y.jsx(pe,{variant:"danger",children:"Danger"}),y.jsx(pe,{variant:"success",children:"Success"}),y.jsx(pe,{variant:"warning",children:"Warning"}),y.jsx(pe,{variant:"info",children:"Info"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Tipos de Botón"}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Solid"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{variant:"primary",buttonType:"solid",children:"Primary Solid"}),y.jsx(pe,{variant:"secondary",buttonType:"solid",children:"Secondary Solid"}),y.jsx(pe,{variant:"danger",buttonType:"solid",children:"Danger Solid"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Outline"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{variant:"primary",buttonType:"outline",children:"Primary Outline"}),y.jsx(pe,{variant:"secondary",buttonType:"outline",children:"Secondary Outline"}),y.jsx(pe,{variant:"danger",buttonType:"outline",children:"Danger Outline"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Ghost"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{variant:"primary",buttonType:"ghost",children:"Primary Ghost"}),y.jsx(pe,{variant:"secondary",buttonType:"ghost",children:"Secondary Ghost"}),y.jsx(pe,{variant:"danger",buttonType:"ghost",children:"Danger Ghost"})]})]})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Tamaños"}),y.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[y.jsx(pe,{size:"sm",children:"Small"}),y.jsx(pe,{size:"md",children:"Medium"}),y.jsx(pe,{size:"lg",children:"Large"}),y.jsx(pe,{size:"xl",children:"Extra Large"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Con Íconos"}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Con Emojis"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{icon:"💾",iconPosition:"left",children:"Guardar"}),y.jsx(pe,{icon:"🗑️",variant:"danger",iconPosition:"left",children:"Eliminar"}),y.jsx(pe,{icon:"📥",variant:"info",iconPosition:"left",children:"Descargar"}),y.jsx(pe,{icon:"➡️",iconPosition:"right",children:"Siguiente"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Con SVG Icons"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{icon:y.jsx(i,{}),iconPosition:"left",children:"Agregar"}),y.jsx(pe,{icon:y.jsx(e,{}),variant:"danger",iconPosition:"left",children:"Eliminar"}),y.jsx(pe,{icon:y.jsx(t,{}),variant:"success",iconPosition:"left",children:"Descargar"}),y.jsx(pe,{icon:y.jsx(i,{}),iconPosition:"right",buttonType:"outline",children:"Agregar Nuevo"})]})]})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Estados"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{children:"Normal"}),y.jsx(pe,{disabled:!0,children:"Disabled"}),y.jsx(pe,{isLoading:!0,children:"Loading"}),y.jsx(pe,{isLoading:!0,variant:"secondary",children:"Loading Secondary"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ancho Completo"}),y.jsxs("div",{className:"space-y-4",children:[y.jsx(pe,{fullWidth:!0,children:"Botón de ancho completo"}),y.jsx(pe,{fullWidth:!0,buttonType:"outline",icon:"📋",children:"Botón outline ancho completo"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Border Radius"}),y.jsxs("div",{className:"flex flex-wrap gap-4",children:[y.jsx(pe,{rounded:"sm",children:"Small Radius"}),y.jsx(pe,{rounded:"md",children:"Medium Radius"}),y.jsx(pe,{rounded:"lg",children:"Large Radius"}),y.jsx(pe,{rounded:"xl",children:"Extra Large Radius"}),y.jsx(pe,{rounded:"full",children:"Full Radius"})]})]}),y.jsxs("section",{children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ejemplos de Uso Real"}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Formulario"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(pe,{type:"submit",icon:"💾",children:"Guardar Pregunta"}),y.jsx(pe,{variant:"secondary",type:"button",children:"Cancelar"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Modal de Confirmación"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(pe,{variant:"danger",icon:"🗑️",children:"Eliminar"}),y.jsx(pe,{variant:"secondary",children:"Cancelar"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Navegación"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(pe,{variant:"primary",icon:y.jsx(i,{}),children:"Crear Preguntas"}),y.jsx(pe,{variant:"info",buttonType:"outline",icon:"📥",children:"Importar PDF"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-medium mb-2",children:"Estudios"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(pe,{variant:"success",size:"lg",icon:"🎯",children:"Iniciar Test"}),y.jsx(pe,{variant:"info",size:"lg",buttonType:"outline",icon:"📚",children:"Flash Cards"})]})]})]})]})]})},C4=()=>y.jsx(UC,{children:y.jsx("div",{className:"py-8",children:y.jsxs("div",{className:"max-w-6xl mx-auto",children:[y.jsxs("div",{className:"mb-8 text-center",children:[y.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Componente Button Unificado"}),y.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Este es el nuevo componente Button que unifica todos los estilos de botones de la aplicación. Reemplaza los botones personalizados que antes tenían estilos inline complejos."})]}),y.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-8",children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Características principales:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"6 variantes de color:"})," primary, secondary, danger, success, warning, info"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"3 tipos de estilo:"})," solid, outline, ghost"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"4 tamaños:"})," sm, md, lg, xl"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Soporte para íconos:"})," emojis y componentes SVG"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Estados automáticos:"})," hover, focus, disabled, loading"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Personalizable:"})," ancho completo, border radius, posición del ícono"]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Accesible:"})," soporte para navegación por teclado y lectores de pantalla"]})]})]}),y.jsx(S4,{}),y.jsxs("div",{className:"bg-gray-50 rounded-xl p-8 mt-8",children:[y.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Cómo usar:"}),y.jsx("div",{className:"bg-gray-900 rounded-lg p-4 overflow-x-auto",children:y.jsx("pre",{className:"text-green-400 text-sm",children:`import Button from './components/Button';

// Botón básico
<Button>Texto del botón</Button>

// Botón con variante y tamaño
<Button variant="danger" size="lg">Eliminar</Button>

// Botón con ícono
<Button variant="primary" icon="💾" iconPosition="left">
  Guardar
</Button>

// Botón de solo ícono
<Button variant="danger" icon="🗑️" title="Eliminar" />

// Botón de carga
<Button isLoading variant="primary">Procesando...</Button>

// Botón outline ancho completo
<Button buttonType="outline" fullWidth>
  Botón ancho completo
</Button>`})})]})]})})}),A4=()=>{const i=[{id:"original",name:"Azul Original",description:"Confianza, profesionalismo y estabilidad académica",file:"/icons/study-lab-original.svg",psychology:"Versión corporativa oficial"},{id:"verde",name:"Verde Academia",description:"Crecimiento, éxito académico y tranquilidad",file:"/icons/study-lab-verde.svg",psychology:"Progreso y desarrollo educativo"},{id:"naranja",name:"Naranja Energético",description:"Creatividad, entusiasmo e innovación",file:"/icons/study-lab-naranja.svg",psychology:"Motivar creatividad y pensamiento lateral"},{id:"morado",name:"Morado Académico",description:"Sabiduría, conocimiento profundo y prestigio",file:"/icons/study-lab-morado.svg",psychology:"Excelencia académica y pensamiento crítico"},{id:"azul-nocturno",name:"Azul Nocturno",description:"Concentración, focus profundo y productividad",file:"/icons/study-lab-azul-nocturno.svg",psychology:"Sesiones de estudio intensivo"},{id:"azul-nocturno-optimized",name:"Azul Nocturno Optimizado",description:"Versión mejorada con menos saturación visual",file:"/icons/study-lab-azul-nocturno-optimized.svg",psychology:"Diseño simplificado para mejor legibilidad"},{id:"azul-nocturno-simple",name:"Azul Nocturno Simple",description:"Versión ultra-simple para favicons pequeños",file:"/icons/study-lab-azul-nocturno-simple.svg",psychology:"Óptimo para tamaños 16px y 24px"},{id:"rojo-energia",name:"Rojo Energía",description:"Motivación, acción y determinación",file:"/icons/study-lab-rojo-energia.svg",psychology:"Impulsar acción y superar procrastinación"}];return y.jsxs("div",{className:"container space-y-6",children:[y.jsxs("div",{className:"text-center mb-12",children:[y.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Selección de Icono para Study Lab"}),y.jsx("p",{className:"text-gray-600 text-lg",children:"Elige el icono que mejor represente la identidad de la aplicación"})]}),y.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8",children:i.map(e=>y.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200 hover:shadow-xl transition-shadow duration-300",children:[y.jsxs("div",{className:"text-center mb-6",children:[y.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),y.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),y.jsx("p",{className:"text-blue-600 text-xs font-medium italic",children:e.psychology})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[y.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-3 text-center",children:"Vista de Detalle:"}),y.jsx("div",{className:"flex justify-center",children:y.jsx("div",{className:"bg-white rounded-lg p-4 shadow-inner border",children:y.jsx("img",{src:e.file,alt:e.name,className:"w-32 h-32 mx-auto",style:{width:"128px",height:"128px"}})})})]}),y.jsxs("div",{className:"bg-blue-800 rounded-lg p-3",children:[y.jsx("h4",{className:"text-xs font-semibold text-white mb-2 text-center opacity-70",children:"Header Preview:"}),y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx("img",{src:e.file,alt:e.name,className:"w-8 h-8"}),y.jsx("span",{className:"text-white font-bold text-lg",children:"Study Lab"})]})]}),y.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[y.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-3 text-center",children:"Tamaños:"}),y.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[y.jsxs("div",{className:"text-center",children:[y.jsx("img",{src:e.file,alt:e.name,className:"w-4 h-4 mx-auto mb-1"}),y.jsx("span",{className:"text-xs text-gray-500",children:"16px"})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("img",{src:e.file,alt:e.name,className:"w-6 h-6 mx-auto mb-1"}),y.jsx("span",{className:"text-xs text-gray-500",children:"24px"})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("img",{src:e.file,alt:e.name,className:"w-8 h-8 mx-auto mb-1"}),y.jsx("span",{className:"text-xs text-gray-500",children:"32px"})]}),y.jsxs("div",{className:"text-center",children:[y.jsx("img",{src:e.file,alt:e.name,className:"w-12 h-12 mx-auto mb-1"}),y.jsx("span",{className:"text-xs text-gray-500",children:"48px"})]})]})]}),y.jsx("div",{className:"text-center pt-2",children:y.jsx("button",{className:"w-full px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200",onClick:()=>alert(`Seleccionaste: ${e.name}

Esta variante será perfecta para Study Lab!`),children:"Seleccionar esta variante"})})]})]},e.id))}),y.jsxs("div",{className:"text-center mt-12 p-8 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-200",children:[y.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"🎨 Paleta de Colores Educativos Study Lab"}),y.jsx("p",{className:"text-gray-700 text-base mb-6",children:"Cada color está diseñado con psicología educativa específica para diferentes momentos del aprendizaje"}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 max-w-4xl mx-auto",children:[y.jsxs("div",{className:"bg-blue-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-blue-800 font-semibold",children:"🔵 Azul Original"}),y.jsx("div",{className:"text-blue-600 text-sm",children:"Confianza profesional"})]}),y.jsxs("div",{className:"bg-green-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-green-800 font-semibold",children:"🟢 Verde Academia"}),y.jsx("div",{className:"text-green-600 text-sm",children:"Crecimiento y éxito"})]}),y.jsxs("div",{className:"bg-orange-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-orange-800 font-semibold",children:"🟠 Naranja Energético"}),y.jsx("div",{className:"text-orange-600 text-sm",children:"Creatividad innovadora"})]}),y.jsxs("div",{className:"bg-purple-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-purple-800 font-semibold",children:"🟣 Morado Académico"}),y.jsx("div",{className:"text-purple-600 text-sm",children:"Sabiduría profunda"})]}),y.jsxs("div",{className:"bg-slate-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-slate-800 font-semibold",children:"🔵 Azul Nocturno"}),y.jsx("div",{className:"text-slate-600 text-sm",children:"Concentración intensa"})]}),y.jsxs("div",{className:"bg-red-100 p-4 rounded-lg",children:[y.jsx("div",{className:"text-red-800 font-semibold",children:"🔴 Rojo Energía"}),y.jsx("div",{className:"text-red-600 text-sm",children:"Motivación y acción"})]})]}),y.jsx("p",{className:"text-gray-600 text-sm mt-6",children:"Todos los iconos mantienen elementos de IA con destellos de 4 puntas, diseño de libro digital con laboratorio integrado y elementos científicos"})]})]})},E4=({isOpen:i,onClose:e,title:t,message:n,type:s="info",buttonText:r="Entendido"})=>{const l=c=>{(c.key==="Enter"||c.key===" ")&&e()};return y.jsx(mS,{isOpen:i,onClose:e,title:t,type:s,showCloseButton:!1,children:y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"text-gray-700 whitespace-pre-wrap text-sm leading-relaxed",children:n}),y.jsx("div",{className:"flex justify-center pt-2",children:y.jsx(pe,{onClick:e,onKeyDown:l,autoFocus:!0,variant:"primary",size:"lg",children:r})})]})})},Ic="question-generator-key",_4=i=>btoa(i.split("").map((e,t)=>String.fromCharCode(e.charCodeAt(0)^Ic.charCodeAt(t%Ic.length))).join("")),T4=i=>{try{return atob(i).split("").map((e,t)=>String.fromCharCode(e.charCodeAt(0)^Ic.charCodeAt(t%Ic.length))).join("")}catch{return""}},w4=()=>{const[i,e]=O.useState(""),[t,n]=O.useState(null),[s,r]=O.useState(0),[l,c]=O.useState(1),[f,d]=O.useState(!1);return O.useEffect(()=>{try{const b=localStorage.getItem("gemini-api-key-encrypted");if(b){const C=T4(b);e(C)}else e("")}catch(b){console.error("Error loading API key:",b),e("")}finally{d(!0)}},[]),{geminiApiKey:i,saveGeminiApiKey:b=>{e(b);try{if(b.trim()){const C=_4(b);localStorage.setItem("gemini-api-key-encrypted",C)}else localStorage.removeItem("gemini-api-key-encrypted")}catch(C){console.error("Error saving API key:",C)}},selectedFile:t,updateSelectedFile:(b,C)=>{n(b),C&&r(C),c(1)},totalPages:s,setTotalPages:r,pageToProcess:l,setPageToProcess:c,isLoaded:f}};function M4(){const i=js(),{questions:e,addQuestion:t,addQuestionsWithNumbers:n,removeQuestion:s,updateQuestion:r,clearAllQuestions:l,getNextQuestionNumber:c,isLoaded:f}=Ua(),d=w4(),{isAlertOpen:g,alertMessage:v,alertOptions:b,showAlert:C,hideAlert:E}=OC(),{isConfirmOpen:A,confirmMessage:_,confirmOptions:w,confirmCallback:N,showConfirm:M,hideConfirm:k}=vS(),R=O.useCallback(C,[C]),I=O.useCallback(M,[M]),P=F=>{const $=F.options.map((K,ne)=>({option_letter:String.fromCharCode(65+ne),option_text:K.option_text,is_correct:K.is_correct}));t({question_text:F.question_text,options:$,requires_multiple_answers:F.requires_multiple_answers,explanation:F.explanation,link:F.link})},q=F=>{n(F),i("/study-lab/questions")};return!f||!d.isLoaded?y.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"}),y.jsx("p",{className:"text-gray-600",children:"Cargando..."})]})}):y.jsx("div",{className:"min-h-screen bg-gray-50",children:y.jsxs("div",{className:"max-w-4xl mx-auto bg-white min-h-screen",children:[y.jsx(GT,{questions:e}),y.jsx("main",{className:"main-content pt-20",children:y.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:y.jsxs(iT,{children:[y.jsx(Zt,{path:"/study-lab/",element:y.jsx(iw,{})}),y.jsx(Zt,{path:"/study-lab/create",element:y.jsx(_w,{onSubmit:P,nextQuestionNumber:c()})}),y.jsx(Zt,{path:"/study-lab/questions",element:y.jsx(Pw,{questions:e,onRemoveQuestion:s,onUpdateQuestion:r,onClearAll:l,showAlert:R,showConfirmModal:I})}),y.jsx(Zt,{path:"/study-lab/import",element:y.jsx(o4,{onImportQuestions:q,appState:d,nextQuestionNumber:c(),showAlert:R,showConfirm:I})}),y.jsx(Zt,{path:"/study-lab/api-test",element:y.jsx(wb,{appState:d,showAlert:R})}),y.jsx(Zt,{path:"/study-lab/test",element:y.jsx(wb,{appState:d,showAlert:R})}),y.jsx(Zt,{path:"/study-lab/study",element:y.jsx(f4,{})}),y.jsx(Zt,{path:"/study-lab/study/flashcards",element:y.jsx(v4,{showConfirm:I})}),y.jsx(Zt,{path:"/study-lab/study/exam",element:y.jsx(Ib,{})}),y.jsx(Zt,{path:"/study-lab/study/test",element:y.jsx(Ib,{})}),y.jsx(Zt,{path:"/study-lab/study/session-results",element:y.jsx(Db,{})}),y.jsx(Zt,{path:"/study-lab/study/results",element:y.jsx(Db,{})}),y.jsx(Zt,{path:"/study-lab/dev/buttons",element:y.jsx(C4,{})}),y.jsx(Zt,{path:"/study-lab/dev/icons",element:y.jsx(A4,{})})]})})}),y.jsx(E4,{isOpen:g,onClose:E,title:b.title,message:v,type:b.type,buttonText:b.buttonText}),y.jsx(gS,{isOpen:A,onConfirm:N||(()=>{}),onCancel:k,title:w.title,message:_,confirmText:w.confirmText,cancelText:w.cancelText,type:w.type})]})})}h_.createRoot(document.getElementById("root")).render(y.jsx(O.StrictMode,{children:y.jsx(TT,{children:y.jsx(M4,{})})}));
